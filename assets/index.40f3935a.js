var AP=Object.defineProperty;var DP=(t,e,n)=>e in t?AP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var FP=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var jC=(t,e,n)=>(DP(t,typeof e!="symbol"?e+"":e,n),n);var dye=FP((co,uo)=>{function OP(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const s=Object.getOwnPropertyDescriptor(r,o);s&&Object.defineProperty(t,o,s.get?s:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function F0(t,e){const n=Object.create(null),r=t.split(",");for(let o=0;o<r.length;o++)n[r[o]]=!0;return e?o=>!!n[o.toLowerCase()]:o=>!!n[o]}function O0(t){if(pt(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],o=jn(r)?BP(r):O0(r);if(o)for(const s in o)e[s]=o[s]}return e}else{if(jn(t))return t;if(bn(t))return t}}const PP=/;(?![^(]*\))/g,MP=/:([^]+)/,LP=/\/\*.*?\*\//gs;function BP(t){const e={};return t.replace(LP,"").split(PP).forEach(n=>{if(n){const r=n.split(MP);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function P0(t){let e="";if(jn(t))e=t;else if(pt(t))for(let n=0;n<t.length;n++){const r=P0(t[n]);r&&(e+=r+" ")}else if(bn(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const zP="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",WP=F0(zP);function h2(t){return!!t||t===""}const Ip=t=>jn(t)?t:t==null?"":pt(t)||bn(t)&&(t.toString===g2||!xt(t.toString))?JSON.stringify(t,f2,2):String(t),f2=(t,e)=>e&&e.__v_isRef?f2(t,e.value):Jl(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,o])=>(n[`${r} =>`]=o,n),{})}:p2(e)?{[`Set(${e.size})`]:[...e.values()]}:bn(e)&&!pt(e)&&!b2(e)?String(e):e,hn={},Zl=[],Zo=()=>{},VP=()=>!1,UP=/^on[^a-z]/,wm=t=>UP.test(t),M0=t=>t.startsWith("onUpdate:"),or=Object.assign,L0=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},HP=Object.prototype.hasOwnProperty,Ft=(t,e)=>HP.call(t,e),pt=Array.isArray,Jl=t=>Cm(t)==="[object Map]",p2=t=>Cm(t)==="[object Set]",xt=t=>typeof t=="function",jn=t=>typeof t=="string",B0=t=>typeof t=="symbol",bn=t=>t!==null&&typeof t=="object",m2=t=>bn(t)&&xt(t.then)&&xt(t.catch),g2=Object.prototype.toString,Cm=t=>g2.call(t),GP=t=>Cm(t).slice(8,-1),b2=t=>Cm(t)==="[object Object]",z0=t=>jn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,fp=F0(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),$m=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},jP=/-(\w)/g,Fs=$m(t=>t.replace(jP,(e,n)=>n?n.toUpperCase():"")),KP=/\B([A-Z])/g,Ac=$m(t=>t.replace(KP,"-$1").toLowerCase()),Sm=$m(t=>t.charAt(0).toUpperCase()+t.slice(1)),Ub=$m(t=>t?`on${Sm(t)}`:""),Ju=(t,e)=>!Object.is(t,e),Hb=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},kp=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},W0=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let KC;const qP=()=>KC||(KC=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let io;class v2{constructor(e=!1){this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=io,!e&&io&&(this.index=(io.scopes||(io.scopes=[])).push(this)-1)}run(e){if(this.active){const n=io;try{return io=this,e()}finally{io=n}}}on(){io=this}off(){io=this.parent}stop(e){if(this.active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0,this.active=!1}}}function x2(t){return new v2(t)}function XP(t,e=io){e&&e.active&&e.effects.push(t)}function V0(){return io}function y2(t){io&&io.cleanups.push(t)}const U0=t=>{const e=new Set(t);return e.w=0,e.n=0,e},w2=t=>(t.w&Pi)>0,C2=t=>(t.n&Pi)>0,YP=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Pi},ZP=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const o=e[r];w2(o)&&!C2(o)?o.delete(t):e[n++]=o,o.w&=~Pi,o.n&=~Pi}e.length=n}},Bv=new WeakMap;let ku=0,Pi=1;const zv=30;let qo;const La=Symbol(""),Wv=Symbol("");class H0{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,XP(this,r)}run(){if(!this.active)return this.fn();let e=qo,n=Ni;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=qo,qo=this,Ni=!0,Pi=1<<++ku,ku<=zv?YP(this):qC(this),this.fn()}finally{ku<=zv&&ZP(this),Pi=1<<--ku,qo=this.parent,Ni=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){qo===this?this.deferStop=!0:this.active&&(qC(this),this.onStop&&this.onStop(),this.active=!1)}}function qC(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Ni=!0;const $2=[];function Dc(){$2.push(Ni),Ni=!1}function Fc(){const t=$2.pop();Ni=t===void 0?!0:t}function fo(t,e,n){if(Ni&&qo){let r=Bv.get(t);r||Bv.set(t,r=new Map);let o=r.get(n);o||r.set(n,o=U0()),S2(o)}}function S2(t,e){let n=!1;ku<=zv?C2(t)||(t.n|=Pi,n=!w2(t)):n=!t.has(qo),n&&(t.add(qo),qo.deps.push(t))}function Qs(t,e,n,r,o,s){const i=Bv.get(t);if(!i)return;let a=[];if(e==="clear")a=[...i.values()];else if(n==="length"&&pt(t)){const l=W0(r);i.forEach((c,u)=>{(u==="length"||u>=l)&&a.push(c)})}else switch(n!==void 0&&a.push(i.get(n)),e){case"add":pt(t)?z0(n)&&a.push(i.get("length")):(a.push(i.get(La)),Jl(t)&&a.push(i.get(Wv)));break;case"delete":pt(t)||(a.push(i.get(La)),Jl(t)&&a.push(i.get(Wv)));break;case"set":Jl(t)&&a.push(i.get(La));break}if(a.length===1)a[0]&&Vv(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);Vv(U0(l))}}function Vv(t,e){const n=pt(t)?t:[...t];for(const r of n)r.computed&&XC(r);for(const r of n)r.computed||XC(r)}function XC(t,e){(t!==qo||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const JP=F0("__proto__,__v_isRef,__isVue"),I2=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(B0)),QP=G0(),e3=G0(!1,!0),t3=G0(!0),YC=n3();function n3(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=At(this);for(let s=0,i=this.length;s<i;s++)fo(r,"get",s+"");const o=r[e](...n);return o===-1||o===!1?r[e](...n.map(At)):o}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Dc();const r=At(this)[e].apply(this,n);return Fc(),r}}),t}function G0(t=!1,e=!1){return function(r,o,s){if(o==="__v_isReactive")return!t;if(o==="__v_isReadonly")return t;if(o==="__v_isShallow")return e;if(o==="__v_raw"&&s===(t?e?v3:N2:e?R2:E2).get(r))return r;const i=pt(r);if(!t&&i&&Ft(YC,o))return Reflect.get(YC,o,s);const a=Reflect.get(r,o,s);return(B0(o)?I2.has(o):JP(o))||(t||fo(r,"get",o),e)?a:$n(a)?i&&z0(o)?a:a.value:bn(a)?t?ei(a):pl(a):a}}const r3=k2(),o3=k2(!0);function k2(t=!1){return function(n,r,o,s){let i=n[r];if(uc(i)&&$n(i)&&!$n(o))return!1;if(!t&&(!Tp(o)&&!uc(o)&&(i=At(i),o=At(o)),!pt(n)&&$n(i)&&!$n(o)))return i.value=o,!0;const a=pt(n)&&z0(r)?Number(r)<n.length:Ft(n,r),l=Reflect.set(n,r,o,s);return n===At(s)&&(a?Ju(o,i)&&Qs(n,"set",r,o):Qs(n,"add",r,o)),l}}function s3(t,e){const n=Ft(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&Qs(t,"delete",e,void 0),r}function i3(t,e){const n=Reflect.has(t,e);return(!B0(e)||!I2.has(e))&&fo(t,"has",e),n}function a3(t){return fo(t,"iterate",pt(t)?"length":La),Reflect.ownKeys(t)}const T2={get:QP,set:r3,deleteProperty:s3,has:i3,ownKeys:a3},l3={get:t3,set(t,e){return!0},deleteProperty(t,e){return!0}},c3=or({},T2,{get:e3,set:o3}),j0=t=>t,Im=t=>Reflect.getPrototypeOf(t);function _f(t,e,n=!1,r=!1){t=t.__v_raw;const o=At(t),s=At(e);n||(e!==s&&fo(o,"get",e),fo(o,"get",s));const{has:i}=Im(o),a=r?j0:n?X0:Qu;if(i.call(o,e))return a(t.get(e));if(i.call(o,s))return a(t.get(s));t!==o&&t.get(e)}function Af(t,e=!1){const n=this.__v_raw,r=At(n),o=At(t);return e||(t!==o&&fo(r,"has",t),fo(r,"has",o)),t===o?n.has(t):n.has(t)||n.has(o)}function Df(t,e=!1){return t=t.__v_raw,!e&&fo(At(t),"iterate",La),Reflect.get(t,"size",t)}function ZC(t){t=At(t);const e=At(this);return Im(e).has.call(e,t)||(e.add(t),Qs(e,"add",t,t)),this}function JC(t,e){e=At(e);const n=At(this),{has:r,get:o}=Im(n);let s=r.call(n,t);s||(t=At(t),s=r.call(n,t));const i=o.call(n,t);return n.set(t,e),s?Ju(e,i)&&Qs(n,"set",t,e):Qs(n,"add",t,e),this}function QC(t){const e=At(this),{has:n,get:r}=Im(e);let o=n.call(e,t);o||(t=At(t),o=n.call(e,t)),r&&r.call(e,t);const s=e.delete(t);return o&&Qs(e,"delete",t,void 0),s}function e$(){const t=At(this),e=t.size!==0,n=t.clear();return e&&Qs(t,"clear",void 0,void 0),n}function Ff(t,e){return function(r,o){const s=this,i=s.__v_raw,a=At(i),l=e?j0:t?X0:Qu;return!t&&fo(a,"iterate",La),i.forEach((c,u)=>r.call(o,l(c),l(u),s))}}function Of(t,e,n){return function(...r){const o=this.__v_raw,s=At(o),i=Jl(s),a=t==="entries"||t===Symbol.iterator&&i,l=t==="keys"&&i,c=o[t](...r),u=n?j0:e?X0:Qu;return!e&&fo(s,"iterate",l?Wv:La),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:a?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function pi(t){return function(...e){return t==="delete"?!1:this}}function u3(){const t={get(s){return _f(this,s)},get size(){return Df(this)},has:Af,add:ZC,set:JC,delete:QC,clear:e$,forEach:Ff(!1,!1)},e={get(s){return _f(this,s,!1,!0)},get size(){return Df(this)},has:Af,add:ZC,set:JC,delete:QC,clear:e$,forEach:Ff(!1,!0)},n={get(s){return _f(this,s,!0)},get size(){return Df(this,!0)},has(s){return Af.call(this,s,!0)},add:pi("add"),set:pi("set"),delete:pi("delete"),clear:pi("clear"),forEach:Ff(!0,!1)},r={get(s){return _f(this,s,!0,!0)},get size(){return Df(this,!0)},has(s){return Af.call(this,s,!0)},add:pi("add"),set:pi("set"),delete:pi("delete"),clear:pi("clear"),forEach:Ff(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Of(s,!1,!1),n[s]=Of(s,!0,!1),e[s]=Of(s,!1,!0),r[s]=Of(s,!0,!0)}),[t,n,e,r]}const[d3,h3,f3,p3]=u3();function K0(t,e){const n=e?t?p3:f3:t?h3:d3;return(r,o,s)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?r:Reflect.get(Ft(n,o)&&o in r?n:r,o,s)}const m3={get:K0(!1,!1)},g3={get:K0(!1,!0)},b3={get:K0(!0,!1)},E2=new WeakMap,R2=new WeakMap,N2=new WeakMap,v3=new WeakMap;function x3(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function y3(t){return t.__v_skip||!Object.isExtensible(t)?0:x3(GP(t))}function pl(t){return uc(t)?t:q0(t,!1,T2,m3,E2)}function w3(t){return q0(t,!1,c3,g3,R2)}function ei(t){return q0(t,!0,l3,b3,N2)}function q0(t,e,n,r,o){if(!bn(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=o.get(t);if(s)return s;const i=y3(t);if(i===0)return t;const a=new Proxy(t,i===2?r:n);return o.set(t,a),a}function Zs(t){return uc(t)?Zs(t.__v_raw):!!(t&&t.__v_isReactive)}function uc(t){return!!(t&&t.__v_isReadonly)}function Tp(t){return!!(t&&t.__v_isShallow)}function _2(t){return Zs(t)||uc(t)}function At(t){const e=t&&t.__v_raw;return e?At(e):t}function dc(t){return kp(t,"__v_skip",!0),t}const Qu=t=>bn(t)?pl(t):t,X0=t=>bn(t)?ei(t):t;function A2(t){Ni&&qo&&(t=At(t),S2(t.dep||(t.dep=U0())))}function D2(t,e){t=At(t),t.dep&&Vv(t.dep)}function $n(t){return!!(t&&t.__v_isRef===!0)}function Ne(t){return O2(t,!1)}function F2(t){return O2(t,!0)}function O2(t,e){return $n(t)?t:new C3(t,e)}class C3{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:At(e),this._value=n?e:Qu(e)}get value(){return A2(this),this._value}set value(e){const n=this.__v_isShallow||Tp(e)||uc(e);e=n?e:At(e),Ju(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:Qu(e),D2(this))}}function kt(t){return $n(t)?t.value:t}const $3={get:(t,e,n)=>kt(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const o=t[e];return $n(o)&&!$n(n)?(o.value=n,!0):Reflect.set(t,e,n,r)}};function P2(t){return Zs(t)?t:new Proxy(t,$3)}function S3(t){const e=pt(t)?new Array(t.length):{};for(const n in t)e[n]=Bn(t,n);return e}class I3{constructor(e,n,r){this._object=e,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function Bn(t,e,n){const r=t[e];return $n(r)?r:new I3(t,e,n)}var M2;class k3{constructor(e,n,r,o){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[M2]=!1,this._dirty=!0,this.effect=new H0(e,()=>{this._dirty||(this._dirty=!0,D2(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=r}get value(){const e=At(this);return A2(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}M2="__v_isReadonly";function T3(t,e,n=!1){let r,o;const s=xt(t);return s?(r=t,o=Zo):(r=t.get,o=t.set),new k3(r,o,s||!o,n)}function _i(t,e,n,r){let o;try{o=r?t(...r):t()}catch(s){km(s,e,n)}return o}function Ao(t,e,n,r){if(xt(t)){const s=_i(t,e,n,r);return s&&m2(s)&&s.catch(i=>{km(i,e,n)}),s}const o=[];for(let s=0;s<t.length;s++)o.push(Ao(t[s],e,n,r));return o}function km(t,e,n,r=!0){const o=e?e.vnode:null;if(e){let s=e.parent;const i=e.proxy,a=n;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,i,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){_i(l,null,10,[t,i,a]);return}}E3(t,n,o,r)}function E3(t,e,n,r=!0){console.error(t)}let ed=!1,Uv=!1;const Cr=[];let Ss=0;const Ql=[];let Hs=null,Ca=0;const L2=Promise.resolve();let Y0=null;function Do(t){const e=Y0||L2;return t?e.then(this?t.bind(this):t):e}function R3(t){let e=Ss+1,n=Cr.length;for(;e<n;){const r=e+n>>>1;td(Cr[r])<t?e=r+1:n=r}return e}function Z0(t){(!Cr.length||!Cr.includes(t,ed&&t.allowRecurse?Ss+1:Ss))&&(t.id==null?Cr.push(t):Cr.splice(R3(t.id),0,t),B2())}function B2(){!ed&&!Uv&&(Uv=!0,Y0=L2.then(W2))}function N3(t){const e=Cr.indexOf(t);e>Ss&&Cr.splice(e,1)}function _3(t){pt(t)?Ql.push(...t):(!Hs||!Hs.includes(t,t.allowRecurse?Ca+1:Ca))&&Ql.push(t),B2()}function t$(t,e=ed?Ss+1:0){for(;e<Cr.length;e++){const n=Cr[e];n&&n.pre&&(Cr.splice(e,1),e--,n())}}function z2(t){if(Ql.length){const e=[...new Set(Ql)];if(Ql.length=0,Hs){Hs.push(...e);return}for(Hs=e,Hs.sort((n,r)=>td(n)-td(r)),Ca=0;Ca<Hs.length;Ca++)Hs[Ca]();Hs=null,Ca=0}}const td=t=>t.id==null?1/0:t.id,A3=(t,e)=>{const n=td(t)-td(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function W2(t){Uv=!1,ed=!0,Cr.sort(A3);const e=Zo;try{for(Ss=0;Ss<Cr.length;Ss++){const n=Cr[Ss];n&&n.active!==!1&&_i(n,null,14)}}finally{Ss=0,Cr.length=0,z2(),ed=!1,Y0=null,(Cr.length||Ql.length)&&W2()}}function D3(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||hn;let o=n;const s=e.startsWith("update:"),i=s&&e.slice(7);if(i&&i in r){const u=`${i==="modelValue"?"model":i}Modifiers`,{number:d,trim:h}=r[u]||hn;h&&(o=n.map(f=>jn(f)?f.trim():f)),d&&(o=n.map(W0))}let a,l=r[a=Ub(e)]||r[a=Ub(Fs(e))];!l&&s&&(l=r[a=Ub(Ac(e))]),l&&Ao(l,t,6,o);const c=r[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Ao(c,t,6,o)}}function V2(t,e,n=!1){const r=e.emitsCache,o=r.get(t);if(o!==void 0)return o;const s=t.emits;let i={},a=!1;if(!xt(t)){const l=c=>{const u=V2(c,e,!0);u&&(a=!0,or(i,u))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(bn(t)&&r.set(t,null),null):(pt(s)?s.forEach(l=>i[l]=null):or(i,s),bn(t)&&r.set(t,i),i)}function Tm(t,e){return!t||!wm(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ft(t,e[0].toLowerCase()+e.slice(1))||Ft(t,Ac(e))||Ft(t,e))}let fr=null,U2=null;function Ep(t){const e=fr;return fr=t,U2=t&&t.type.__scopeId||null,e}function Sn(t,e=fr,n){if(!e||t._n)return t;const r=(...o)=>{r._d&&h$(-1);const s=Ep(e);let i;try{i=t(...o)}finally{Ep(s),r._d&&h$(1)}return i};return r._n=!0,r._c=!0,r._d=!0,r}function Gb(t){const{type:e,vnode:n,proxy:r,withProxy:o,props:s,propsOptions:[i],slots:a,attrs:l,emit:c,render:u,renderCache:d,data:h,setupState:f,ctx:p,inheritAttrs:m}=t;let g,b;const v=Ep(t);try{if(n.shapeFlag&4){const y=o||r;g=ys(u.call(y,y,d,s,f,h,p)),b=l}else{const y=e;g=ys(y.length>1?y(s,{attrs:l,slots:a,emit:c}):y(s,null)),b=e.props?l:F3(l)}}catch(y){Bu.length=0,km(y,t,1),g=Tt(Fo)}let w=g;if(b&&m!==!1){const y=Object.keys(b),{shapeFlag:C}=w;y.length&&C&7&&(i&&y.some(M0)&&(b=O3(b,i)),w=Os(w,b))}return n.dirs&&(w=Os(w),w.dirs=w.dirs?w.dirs.concat(n.dirs):n.dirs),n.transition&&(w.transition=n.transition),g=w,Ep(v),g}const F3=t=>{let e;for(const n in t)(n==="class"||n==="style"||wm(n))&&((e||(e={}))[n]=t[n]);return e},O3=(t,e)=>{const n={};for(const r in t)(!M0(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function P3(t,e,n){const{props:r,children:o,component:s}=t,{props:i,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return r?n$(r,i,c):!!i;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(i[h]!==r[h]&&!Tm(c,h))return!0}}}else return(o||a)&&(!a||!a.$stable)?!0:r===i?!1:r?i?n$(r,i,c):!0:!!i;return!1}function n$(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let o=0;o<r.length;o++){const s=r[o];if(e[s]!==t[s]&&!Tm(n,s))return!0}return!1}function M3({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const L3=t=>t.__isSuspense;function B3(t,e){e&&e.pendingBranch?pt(t)?e.effects.push(...t):e.effects.push(t):_3(t)}function Yr(t,e){if(nr){let n=nr.provides;const r=nr.parent&&nr.parent.provides;r===n&&(n=nr.provides=Object.create(r)),n[t]=e}}function Kt(t,e,n=!1){const r=nr||fr;if(r){const o=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(o&&t in o)return o[t];if(arguments.length>1)return n&&xt(e)?e.call(r.proxy):e}}function hc(t,e){return J0(t,null,e)}const Pf={};function Fn(t,e,n){return J0(t,e,n)}function J0(t,e,{immediate:n,deep:r,flush:o,onTrack:s,onTrigger:i}=hn){const a=nr;let l,c=!1,u=!1;if($n(t)?(l=()=>t.value,c=Tp(t)):Zs(t)?(l=()=>t,r=!0):pt(t)?(u=!0,c=t.some(w=>Zs(w)||Tp(w)),l=()=>t.map(w=>{if($n(w))return w.value;if(Zs(w))return Ra(w);if(xt(w))return _i(w,a,2)})):xt(t)?e?l=()=>_i(t,a,2):l=()=>{if(!(a&&a.isUnmounted))return d&&d(),Ao(t,a,3,[h])}:l=Zo,e&&r){const w=l;l=()=>Ra(w())}let d,h=w=>{d=b.onStop=()=>{_i(w,a,4)}},f;if(id)if(h=Zo,e?n&&Ao(e,a,3,[l(),u?[]:void 0,h]):l(),o==="sync"){const w=RM();f=w.__watcherHandles||(w.__watcherHandles=[])}else return Zo;let p=u?new Array(t.length).fill(Pf):Pf;const m=()=>{if(!!b.active)if(e){const w=b.run();(r||c||(u?w.some((y,C)=>Ju(y,p[C])):Ju(w,p)))&&(d&&d(),Ao(e,a,3,[w,p===Pf?void 0:u&&p[0]===Pf?[]:p,h]),p=w)}else b.run()};m.allowRecurse=!!e;let g;o==="sync"?g=m:o==="post"?g=()=>Hr(m,a&&a.suspense):(m.pre=!0,a&&(m.id=a.uid),g=()=>Z0(m));const b=new H0(l,g);e?n?m():p=b.run():o==="post"?Hr(b.run.bind(b),a&&a.suspense):b.run();const v=()=>{b.stop(),a&&a.scope&&L0(a.scope.effects,b)};return f&&f.push(v),v}function z3(t,e,n){const r=this.proxy,o=jn(t)?t.includes(".")?H2(r,t):()=>r[t]:t.bind(r,r);let s;xt(e)?s=e:(s=e.handler,n=e);const i=nr;fc(this);const a=J0(o,s.bind(r),n);return i?fc(i):Ba(),a}function H2(t,e){const n=e.split(".");return()=>{let r=t;for(let o=0;o<n.length&&r;o++)r=r[n[o]];return r}}function Ra(t,e){if(!bn(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),$n(t))Ra(t.value,e);else if(pt(t))for(let n=0;n<t.length;n++)Ra(t[n],e);else if(p2(t)||Jl(t))t.forEach(n=>{Ra(n,e)});else if(b2(t))for(const n in t)Ra(t[n],e);return t}function G2(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return as(()=>{t.isMounted=!0}),Lo(()=>{t.isUnmounting=!0}),t}const Co=[Function,Array],W3={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Co,onEnter:Co,onAfterEnter:Co,onEnterCancelled:Co,onBeforeLeave:Co,onLeave:Co,onAfterLeave:Co,onLeaveCancelled:Co,onBeforeAppear:Co,onAppear:Co,onAfterAppear:Co,onAppearCancelled:Co},setup(t,{slots:e}){const n=Pc(),r=G2();let o;return()=>{const s=e.default&&Q0(e.default(),!0);if(!s||!s.length)return;let i=s[0];if(s.length>1){for(const m of s)if(m.type!==Fo){i=m;break}}const a=At(t),{mode:l}=a;if(r.isLeaving)return jb(i);const c=r$(i);if(!c)return jb(i);const u=nd(c,a,r,n);rd(c,u);const d=n.subTree,h=d&&r$(d);let f=!1;const{getTransitionKey:p}=c.type;if(p){const m=p();o===void 0?o=m:m!==o&&(o=m,f=!0)}if(h&&h.type!==Fo&&(!$a(c,h)||f)){const m=nd(h,a,r,n);if(rd(h,m),l==="out-in")return r.isLeaving=!0,m.afterLeave=()=>{r.isLeaving=!1,n.update.active!==!1&&n.update()},jb(i);l==="in-out"&&c.type!==Fo&&(m.delayLeave=(g,b,v)=>{const w=K2(r,h);w[String(h.key)]=h,g._leaveCb=()=>{b(),g._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=v})}return i}}},j2=W3;function K2(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function nd(t,e,n,r){const{appear:o,mode:s,persisted:i=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:d,onLeave:h,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:m,onAppear:g,onAfterAppear:b,onAppearCancelled:v}=e,w=String(t.key),y=K2(n,t),C=(I,R)=>{I&&Ao(I,r,9,R)},S=(I,R)=>{const T=R[1];C(I,R),pt(I)?I.every(N=>N.length<=1)&&T():I.length<=1&&T()},$={mode:s,persisted:i,beforeEnter(I){let R=a;if(!n.isMounted)if(o)R=m||a;else return;I._leaveCb&&I._leaveCb(!0);const T=y[w];T&&$a(t,T)&&T.el._leaveCb&&T.el._leaveCb(),C(R,[I])},enter(I){let R=l,T=c,N=u;if(!n.isMounted)if(o)R=g||l,T=b||c,N=v||u;else return;let _=!1;const P=I._enterCb=z=>{_||(_=!0,z?C(N,[I]):C(T,[I]),$.delayedLeave&&$.delayedLeave(),I._enterCb=void 0)};R?S(R,[I,P]):P()},leave(I,R){const T=String(t.key);if(I._enterCb&&I._enterCb(!0),n.isUnmounting)return R();C(d,[I]);let N=!1;const _=I._leaveCb=P=>{N||(N=!0,R(),P?C(p,[I]):C(f,[I]),I._leaveCb=void 0,y[T]===t&&delete y[T])};y[T]=t,h?S(h,[I,_]):_()},clone(I){return nd(I,e,n,r)}};return $}function jb(t){if(Em(t))return t=Os(t),t.children=null,t}function r$(t){return Em(t)?t.children?t.children[0]:void 0:t}function rd(t,e){t.shapeFlag&6&&t.component?rd(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Q0(t,e=!1,n){let r=[],o=0;for(let s=0;s<t.length;s++){let i=t[s];const a=n==null?i.key:String(n)+String(i.key!=null?i.key:s);i.type===fn?(i.patchFlag&128&&o++,r=r.concat(Q0(i.children,e,a))):(e||i.type!==Fo)&&r.push(a!=null?Os(i,{key:a}):i)}if(o>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}function lt(t){return xt(t)?{setup:t,name:t.name}:t}const Pu=t=>!!t.type.__asyncLoader,Em=t=>t.type.__isKeepAlive;function q2(t,e){Y2(t,"a",e)}function X2(t,e){Y2(t,"da",e)}function Y2(t,e,n=nr){const r=t.__wdc||(t.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return t()});if(Rm(e,r,n),n){let o=n.parent;for(;o&&o.parent;)Em(o.parent.vnode)&&V3(r,e,n,o),o=o.parent}}function V3(t,e,n,r){const o=Rm(e,t,r,!0);J2(()=>{L0(r[e],o)},n)}function Rm(t,e,n=nr,r=!1){if(n){const o=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...i)=>{if(n.isUnmounted)return;Dc(),fc(n);const a=Ao(e,n,t,i);return Ba(),Fc(),a});return r?o.unshift(s):o.push(s),s}}const si=t=>(e,n=nr)=>(!id||t==="sp")&&Rm(t,(...r)=>e(...r),n),ml=si("bm"),as=si("m"),U3=si("bu"),Z2=si("u"),Lo=si("bum"),J2=si("um"),H3=si("sp"),G3=si("rtg"),j3=si("rtc");function K3(t,e=nr){Rm("ec",t,e)}function Rp(t,e){const n=fr;if(n===null)return t;const r=Am(n)||n.proxy,o=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,a,l,c=hn]=e[s];i&&(xt(i)&&(i={mounted:i,updated:i}),i.deep&&Ra(a),o.push({dir:i,instance:r,value:a,oldValue:void 0,arg:l,modifiers:c}))}return t}function fa(t,e,n,r){const o=t.dirs,s=e&&e.dirs;for(let i=0;i<o.length;i++){const a=o[i];s&&(a.oldValue=s[i].value);let l=a.dir[r];l&&(Dc(),Ao(l,n,8,[t.el,a,t,e]),Fc())}}const Q2="components";function Hv(t,e){return X3(Q2,t,!0,e)||t}const q3=Symbol();function X3(t,e,n=!0,r=!1){const o=fr||nr;if(o){const s=o.type;if(t===Q2){const a=kM(s,!1);if(a&&(a===e||a===Fs(e)||a===Sm(Fs(e))))return s}const i=o$(o[t]||s[t],e)||o$(o.appContext[t],e);return!i&&r?s:i}}function o$(t,e){return t&&(t[e]||t[Fs(e)]||t[Sm(Fs(e))])}function eT(t,e,n,r){let o;const s=n&&n[r];if(pt(t)||jn(t)){o=new Array(t.length);for(let i=0,a=t.length;i<a;i++)o[i]=e(t[i],i,void 0,s&&s[i])}else if(typeof t=="number"){o=new Array(t);for(let i=0;i<t;i++)o[i]=e(i+1,i,void 0,s&&s[i])}else if(bn(t))if(t[Symbol.iterator])o=Array.from(t,(i,a)=>e(i,a,void 0,s&&s[a]));else{const i=Object.keys(t);o=new Array(i.length);for(let a=0,l=i.length;a<l;a++){const c=i[a];o[a]=e(t[c],c,a,s&&s[a])}}else o=[];return n&&(n[r]=o),o}function Y3(t,e,n={},r,o){if(fr.isCE||fr.parent&&Pu(fr.parent)&&fr.parent.isCE)return e!=="default"&&(n.name=e),Tt("slot",n,r&&r());let s=t[e];s&&s._c&&(s._d=!1),Zr();const i=s&&tT(s(n)),a=Oc(fn,{key:n.key||i&&i.key||`_${e}`},i||(r?r():[]),i&&t._===1?64:-2);return!o&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function tT(t){return t.some(e=>sd(e)?!(e.type===Fo||e.type===fn&&!tT(e.children)):!0)?t:null}const Gv=t=>t?fT(t)?Am(t)||t.proxy:Gv(t.parent):null,Mu=or(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Gv(t.parent),$root:t=>Gv(t.root),$emit:t=>t.emit,$options:t=>ey(t),$forceUpdate:t=>t.f||(t.f=()=>Z0(t.update)),$nextTick:t=>t.n||(t.n=Do.bind(t.proxy)),$watch:t=>z3.bind(t)}),Kb=(t,e)=>t!==hn&&!t.__isScriptSetup&&Ft(t,e),Z3={get({_:t},e){const{ctx:n,setupState:r,data:o,props:s,accessCache:i,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const f=i[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return o[e];case 4:return n[e];case 3:return s[e]}else{if(Kb(r,e))return i[e]=1,r[e];if(o!==hn&&Ft(o,e))return i[e]=2,o[e];if((c=t.propsOptions[0])&&Ft(c,e))return i[e]=3,s[e];if(n!==hn&&Ft(n,e))return i[e]=4,n[e];jv&&(i[e]=0)}}const u=Mu[e];let d,h;if(u)return e==="$attrs"&&fo(t,"get",e),u(t);if((d=a.__cssModules)&&(d=d[e]))return d;if(n!==hn&&Ft(n,e))return i[e]=4,n[e];if(h=l.config.globalProperties,Ft(h,e))return h[e]},set({_:t},e,n){const{data:r,setupState:o,ctx:s}=t;return Kb(o,e)?(o[e]=n,!0):r!==hn&&Ft(r,e)?(r[e]=n,!0):Ft(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:o,propsOptions:s}},i){let a;return!!n[i]||t!==hn&&Ft(t,i)||Kb(e,i)||(a=s[0])&&Ft(a,i)||Ft(r,i)||Ft(Mu,i)||Ft(o.config.globalProperties,i)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ft(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let jv=!0;function J3(t){const e=ey(t),n=t.proxy,r=t.ctx;jv=!1,e.beforeCreate&&s$(e.beforeCreate,t,"bc");const{data:o,computed:s,methods:i,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:h,beforeUpdate:f,updated:p,activated:m,deactivated:g,beforeDestroy:b,beforeUnmount:v,destroyed:w,unmounted:y,render:C,renderTracked:S,renderTriggered:$,errorCaptured:I,serverPrefetch:R,expose:T,inheritAttrs:N,components:_,directives:P,filters:z}=e;if(c&&Q3(c,r,null,t.appContext.config.unwrapInjectedRef),i)for(const B in i){const U=i[B];xt(U)&&(r[B]=U.bind(n))}if(o){const B=o.call(n,n);bn(B)&&(t.data=pl(B))}if(jv=!0,s)for(const B in s){const U=s[B],Q=xt(U)?U.bind(n,n):xt(U.get)?U.get.bind(n,n):Zo,se=!xt(U)&&xt(U.set)?U.set.bind(n):Zo,ce=Me({get:Q,set:se});Object.defineProperty(r,B,{enumerable:!0,configurable:!0,get:()=>ce.value,set:de=>ce.value=de})}if(a)for(const B in a)nT(a[B],r,n,B);if(l){const B=xt(l)?l.call(n):l;Reflect.ownKeys(B).forEach(U=>{Yr(U,B[U])})}u&&s$(u,t,"c");function O(B,U){pt(U)?U.forEach(Q=>B(Q.bind(n))):U&&B(U.bind(n))}if(O(ml,d),O(as,h),O(U3,f),O(Z2,p),O(q2,m),O(X2,g),O(K3,I),O(j3,S),O(G3,$),O(Lo,v),O(J2,y),O(H3,R),pt(T))if(T.length){const B=t.exposed||(t.exposed={});T.forEach(U=>{Object.defineProperty(B,U,{get:()=>n[U],set:Q=>n[U]=Q})})}else t.exposed||(t.exposed={});C&&t.render===Zo&&(t.render=C),N!=null&&(t.inheritAttrs=N),_&&(t.components=_),P&&(t.directives=P)}function Q3(t,e,n=Zo,r=!1){pt(t)&&(t=Kv(t));for(const o in t){const s=t[o];let i;bn(s)?"default"in s?i=Kt(s.from||o,s.default,!0):i=Kt(s.from||o):i=Kt(s),$n(i)&&r?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):e[o]=i}}function s$(t,e,n){Ao(pt(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function nT(t,e,n,r){const o=r.includes(".")?H2(n,r):()=>n[r];if(jn(t)){const s=e[t];xt(s)&&Fn(o,s)}else if(xt(t))Fn(o,t.bind(n));else if(bn(t))if(pt(t))t.forEach(s=>nT(s,e,n,r));else{const s=xt(t.handler)?t.handler.bind(n):e[t.handler];xt(s)&&Fn(o,s,t)}}function ey(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:o,optionsCache:s,config:{optionMergeStrategies:i}}=t.appContext,a=s.get(e);let l;return a?l=a:!o.length&&!n&&!r?l=e:(l={},o.length&&o.forEach(c=>Np(l,c,i,!0)),Np(l,e,i)),bn(e)&&s.set(e,l),l}function Np(t,e,n,r=!1){const{mixins:o,extends:s}=e;s&&Np(t,s,n,!0),o&&o.forEach(i=>Np(t,i,n,!0));for(const i in e)if(!(r&&i==="expose")){const a=eM[i]||n&&n[i];t[i]=a?a(t[i],e[i]):e[i]}return t}const eM={data:i$,props:ya,emits:ya,methods:ya,computed:ya,beforeCreate:Nr,created:Nr,beforeMount:Nr,mounted:Nr,beforeUpdate:Nr,updated:Nr,beforeDestroy:Nr,beforeUnmount:Nr,destroyed:Nr,unmounted:Nr,activated:Nr,deactivated:Nr,errorCaptured:Nr,serverPrefetch:Nr,components:ya,directives:ya,watch:nM,provide:i$,inject:tM};function i$(t,e){return e?t?function(){return or(xt(t)?t.call(this,this):t,xt(e)?e.call(this,this):e)}:e:t}function tM(t,e){return ya(Kv(t),Kv(e))}function Kv(t){if(pt(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Nr(t,e){return t?[...new Set([].concat(t,e))]:e}function ya(t,e){return t?or(or(Object.create(null),t),e):e}function nM(t,e){if(!t)return e;if(!e)return t;const n=or(Object.create(null),t);for(const r in e)n[r]=Nr(t[r],e[r]);return n}function rM(t,e,n,r=!1){const o={},s={};kp(s,_m,1),t.propsDefaults=Object.create(null),rT(t,e,o,s);for(const i in t.propsOptions[0])i in o||(o[i]=void 0);n?t.props=r?o:w3(o):t.type.props?t.props=o:t.props=s,t.attrs=s}function oM(t,e,n,r){const{props:o,attrs:s,vnode:{patchFlag:i}}=t,a=At(o),[l]=t.propsOptions;let c=!1;if((r||i>0)&&!(i&16)){if(i&8){const u=t.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if(Tm(t.emitsOptions,h))continue;const f=e[h];if(l)if(Ft(s,h))f!==s[h]&&(s[h]=f,c=!0);else{const p=Fs(h);o[p]=qv(l,a,p,f,t,!1)}else f!==s[h]&&(s[h]=f,c=!0)}}}else{rT(t,e,o,s)&&(c=!0);let u;for(const d in a)(!e||!Ft(e,d)&&((u=Ac(d))===d||!Ft(e,u)))&&(l?n&&(n[d]!==void 0||n[u]!==void 0)&&(o[d]=qv(l,a,d,void 0,t,!0)):delete o[d]);if(s!==a)for(const d in s)(!e||!Ft(e,d)&&!0)&&(delete s[d],c=!0)}c&&Qs(t,"set","$attrs")}function rT(t,e,n,r){const[o,s]=t.propsOptions;let i=!1,a;if(e)for(let l in e){if(fp(l))continue;const c=e[l];let u;o&&Ft(o,u=Fs(l))?!s||!s.includes(u)?n[u]=c:(a||(a={}))[u]=c:Tm(t.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,i=!0)}if(s){const l=At(n),c=a||hn;for(let u=0;u<s.length;u++){const d=s[u];n[d]=qv(o,l,d,c[d],t,!Ft(c,d))}}return i}function qv(t,e,n,r,o,s){const i=t[n];if(i!=null){const a=Ft(i,"default");if(a&&r===void 0){const l=i.default;if(i.type!==Function&&xt(l)){const{propsDefaults:c}=o;n in c?r=c[n]:(fc(o),r=c[n]=l.call(null,e),Ba())}else r=l}i[0]&&(s&&!a?r=!1:i[1]&&(r===""||r===Ac(n))&&(r=!0))}return r}function oT(t,e,n=!1){const r=e.propsCache,o=r.get(t);if(o)return o;const s=t.props,i={},a=[];let l=!1;if(!xt(t)){const u=d=>{l=!0;const[h,f]=oT(d,e,!0);or(i,h),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!s&&!l)return bn(t)&&r.set(t,Zl),Zl;if(pt(s))for(let u=0;u<s.length;u++){const d=Fs(s[u]);a$(d)&&(i[d]=hn)}else if(s)for(const u in s){const d=Fs(u);if(a$(d)){const h=s[u],f=i[d]=pt(h)||xt(h)?{type:h}:Object.assign({},h);if(f){const p=u$(Boolean,f.type),m=u$(String,f.type);f[0]=p>-1,f[1]=m<0||p<m,(p>-1||Ft(f,"default"))&&a.push(d)}}}const c=[i,a];return bn(t)&&r.set(t,c),c}function a$(t){return t[0]!=="$"}function l$(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function c$(t,e){return l$(t)===l$(e)}function u$(t,e){return pt(e)?e.findIndex(n=>c$(n,t)):xt(e)&&c$(e,t)?0:-1}const sT=t=>t[0]==="_"||t==="$stable",ty=t=>pt(t)?t.map(ys):[ys(t)],sM=(t,e,n)=>{if(e._n)return e;const r=Sn((...o)=>ty(e(...o)),n);return r._c=!1,r},iT=(t,e,n)=>{const r=t._ctx;for(const o in t){if(sT(o))continue;const s=t[o];if(xt(s))e[o]=sM(o,s,r);else if(s!=null){const i=ty(s);e[o]=()=>i}}},aT=(t,e)=>{const n=ty(e);t.slots.default=()=>n},iM=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=At(e),kp(e,"_",n)):iT(e,t.slots={})}else t.slots={},e&&aT(t,e);kp(t.slots,_m,1)},aM=(t,e,n)=>{const{vnode:r,slots:o}=t;let s=!0,i=hn;if(r.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:(or(o,e),!n&&a===1&&delete o._):(s=!e.$stable,iT(e,o)),i=e}else e&&(aT(t,e),i={default:1});if(s)for(const a in o)!sT(a)&&!(a in i)&&delete o[a]};function lT(){return{app:null,config:{isNativeTag:VP,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let lM=0;function cM(t,e){return function(r,o=null){xt(r)||(r=Object.assign({},r)),o!=null&&!bn(o)&&(o=null);const s=lT(),i=new Set;let a=!1;const l=s.app={_uid:lM++,_component:r,_props:o,_container:null,_context:s,_instance:null,version:NM,get config(){return s.config},set config(c){},use(c,...u){return i.has(c)||(c&&xt(c.install)?(i.add(c),c.install(l,...u)):xt(c)&&(i.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,d){if(!a){const h=Tt(r,o);return h.appContext=s,u&&e?e(h,c):t(h,c,d),a=!0,l._container=c,c.__vue_app__=l,Am(h.component)||h.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l}};return l}}function Xv(t,e,n,r,o=!1){if(pt(t)){t.forEach((h,f)=>Xv(h,e&&(pt(e)?e[f]:e),n,r,o));return}if(Pu(r)&&!o)return;const s=r.shapeFlag&4?Am(r.component)||r.component.proxy:r.el,i=o?null:s,{i:a,r:l}=t,c=e&&e.r,u=a.refs===hn?a.refs={}:a.refs,d=a.setupState;if(c!=null&&c!==l&&(jn(c)?(u[c]=null,Ft(d,c)&&(d[c]=null)):$n(c)&&(c.value=null)),xt(l))_i(l,a,12,[i,u]);else{const h=jn(l),f=$n(l);if(h||f){const p=()=>{if(t.f){const m=h?Ft(d,l)?d[l]:u[l]:l.value;o?pt(m)&&L0(m,s):pt(m)?m.includes(s)||m.push(s):h?(u[l]=[s],Ft(d,l)&&(d[l]=u[l])):(l.value=[s],t.k&&(u[t.k]=l.value))}else h?(u[l]=i,Ft(d,l)&&(d[l]=i)):f&&(l.value=i,t.k&&(u[t.k]=i))};i?(p.id=-1,Hr(p,n)):p()}}}const Hr=B3;function uM(t){return dM(t)}function dM(t,e){const n=qP();n.__VUE__=!0;const{insert:r,remove:o,patchProp:s,createElement:i,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:h,setScopeId:f=Zo,insertStaticContent:p}=t,m=(F,V,oe,G=null,Y=null,ae=null,pe=!1,ye=null,ge=!!V.dynamicChildren)=>{if(F===V)return;F&&!$a(F,V)&&(G=le(F),de(F,Y,ae,!0),F=null),V.patchFlag===-2&&(ge=!1,V.dynamicChildren=null);const{type:be,ref:De,shapeFlag:Oe}=V;switch(be){case Nm:g(F,V,oe,G);break;case Fo:b(F,V,oe,G);break;case qb:F==null&&v(V,oe,G,pe);break;case fn:_(F,V,oe,G,Y,ae,pe,ye,ge);break;default:Oe&1?C(F,V,oe,G,Y,ae,pe,ye,ge):Oe&6?P(F,V,oe,G,Y,ae,pe,ye,ge):(Oe&64||Oe&128)&&be.process(F,V,oe,G,Y,ae,pe,ye,ge,ve)}De!=null&&Y&&Xv(De,F&&F.ref,ae,V||F,!V)},g=(F,V,oe,G)=>{if(F==null)r(V.el=a(V.children),oe,G);else{const Y=V.el=F.el;V.children!==F.children&&c(Y,V.children)}},b=(F,V,oe,G)=>{F==null?r(V.el=l(V.children||""),oe,G):V.el=F.el},v=(F,V,oe,G)=>{[F.el,F.anchor]=p(F.children,V,oe,G,F.el,F.anchor)},w=({el:F,anchor:V},oe,G)=>{let Y;for(;F&&F!==V;)Y=h(F),r(F,oe,G),F=Y;r(V,oe,G)},y=({el:F,anchor:V})=>{let oe;for(;F&&F!==V;)oe=h(F),o(F),F=oe;o(V)},C=(F,V,oe,G,Y,ae,pe,ye,ge)=>{pe=pe||V.type==="svg",F==null?S(V,oe,G,Y,ae,pe,ye,ge):R(F,V,Y,ae,pe,ye,ge)},S=(F,V,oe,G,Y,ae,pe,ye)=>{let ge,be;const{type:De,props:Oe,shapeFlag:Pe,transition:qe,dirs:nt}=F;if(ge=F.el=i(F.type,ae,Oe&&Oe.is,Oe),Pe&8?u(ge,F.children):Pe&16&&I(F.children,ge,null,G,Y,ae&&De!=="foreignObject",pe,ye),nt&&fa(F,null,G,"created"),Oe){for(const ht in Oe)ht!=="value"&&!fp(ht)&&s(ge,ht,null,Oe[ht],ae,F.children,G,Y,re);"value"in Oe&&s(ge,"value",null,Oe.value),(be=Oe.onVnodeBeforeMount)&&ps(be,G,F)}$(ge,F,F.scopeId,pe,G),nt&&fa(F,null,G,"beforeMount");const dt=(!Y||Y&&!Y.pendingBranch)&&qe&&!qe.persisted;dt&&qe.beforeEnter(ge),r(ge,V,oe),((be=Oe&&Oe.onVnodeMounted)||dt||nt)&&Hr(()=>{be&&ps(be,G,F),dt&&qe.enter(ge),nt&&fa(F,null,G,"mounted")},Y)},$=(F,V,oe,G,Y)=>{if(oe&&f(F,oe),G)for(let ae=0;ae<G.length;ae++)f(F,G[ae]);if(Y){let ae=Y.subTree;if(V===ae){const pe=Y.vnode;$(F,pe,pe.scopeId,pe.slotScopeIds,Y.parent)}}},I=(F,V,oe,G,Y,ae,pe,ye,ge=0)=>{for(let be=ge;be<F.length;be++){const De=F[be]=ye?yi(F[be]):ys(F[be]);m(null,De,V,oe,G,Y,ae,pe,ye)}},R=(F,V,oe,G,Y,ae,pe)=>{const ye=V.el=F.el;let{patchFlag:ge,dynamicChildren:be,dirs:De}=V;ge|=F.patchFlag&16;const Oe=F.props||hn,Pe=V.props||hn;let qe;oe&&pa(oe,!1),(qe=Pe.onVnodeBeforeUpdate)&&ps(qe,oe,V,F),De&&fa(V,F,oe,"beforeUpdate"),oe&&pa(oe,!0);const nt=Y&&V.type!=="foreignObject";if(be?T(F.dynamicChildren,be,ye,oe,G,nt,ae):pe||U(F,V,ye,null,oe,G,nt,ae,!1),ge>0){if(ge&16)N(ye,V,Oe,Pe,oe,G,Y);else if(ge&2&&Oe.class!==Pe.class&&s(ye,"class",null,Pe.class,Y),ge&4&&s(ye,"style",Oe.style,Pe.style,Y),ge&8){const dt=V.dynamicProps;for(let ht=0;ht<dt.length;ht++){const $t=dt[ht],ln=Oe[$t],Cn=Pe[$t];(Cn!==ln||$t==="value")&&s(ye,$t,ln,Cn,Y,F.children,oe,G,re)}}ge&1&&F.children!==V.children&&u(ye,V.children)}else!pe&&be==null&&N(ye,V,Oe,Pe,oe,G,Y);((qe=Pe.onVnodeUpdated)||De)&&Hr(()=>{qe&&ps(qe,oe,V,F),De&&fa(V,F,oe,"updated")},G)},T=(F,V,oe,G,Y,ae,pe)=>{for(let ye=0;ye<V.length;ye++){const ge=F[ye],be=V[ye],De=ge.el&&(ge.type===fn||!$a(ge,be)||ge.shapeFlag&70)?d(ge.el):oe;m(ge,be,De,null,G,Y,ae,pe,!0)}},N=(F,V,oe,G,Y,ae,pe)=>{if(oe!==G){if(oe!==hn)for(const ye in oe)!fp(ye)&&!(ye in G)&&s(F,ye,oe[ye],null,pe,V.children,Y,ae,re);for(const ye in G){if(fp(ye))continue;const ge=G[ye],be=oe[ye];ge!==be&&ye!=="value"&&s(F,ye,be,ge,pe,V.children,Y,ae,re)}"value"in G&&s(F,"value",oe.value,G.value)}},_=(F,V,oe,G,Y,ae,pe,ye,ge)=>{const be=V.el=F?F.el:a(""),De=V.anchor=F?F.anchor:a("");let{patchFlag:Oe,dynamicChildren:Pe,slotScopeIds:qe}=V;qe&&(ye=ye?ye.concat(qe):qe),F==null?(r(be,oe,G),r(De,oe,G),I(V.children,oe,De,Y,ae,pe,ye,ge)):Oe>0&&Oe&64&&Pe&&F.dynamicChildren?(T(F.dynamicChildren,Pe,oe,Y,ae,pe,ye),(V.key!=null||Y&&V===Y.subTree)&&ny(F,V,!0)):U(F,V,oe,De,Y,ae,pe,ye,ge)},P=(F,V,oe,G,Y,ae,pe,ye,ge)=>{V.slotScopeIds=ye,F==null?V.shapeFlag&512?Y.ctx.activate(V,oe,G,pe,ge):z(V,oe,G,Y,ae,pe,ge):L(F,V,ge)},z=(F,V,oe,G,Y,ae,pe)=>{const ye=F.component=wM(F,G,Y);if(Em(F)&&(ye.ctx.renderer=ve),CM(ye),ye.asyncDep){if(Y&&Y.registerDep(ye,O),!F.el){const ge=ye.subTree=Tt(Fo);b(null,ge,V,oe)}return}O(ye,F,V,oe,Y,ae,pe)},L=(F,V,oe)=>{const G=V.component=F.component;if(P3(F,V,oe))if(G.asyncDep&&!G.asyncResolved){B(G,V,oe);return}else G.next=V,N3(G.update),G.update();else V.el=F.el,G.vnode=V},O=(F,V,oe,G,Y,ae,pe)=>{const ye=()=>{if(F.isMounted){let{next:De,bu:Oe,u:Pe,parent:qe,vnode:nt}=F,dt=De,ht;pa(F,!1),De?(De.el=nt.el,B(F,De,pe)):De=nt,Oe&&Hb(Oe),(ht=De.props&&De.props.onVnodeBeforeUpdate)&&ps(ht,qe,De,nt),pa(F,!0);const $t=Gb(F),ln=F.subTree;F.subTree=$t,m(ln,$t,d(ln.el),le(ln),F,Y,ae),De.el=$t.el,dt===null&&M3(F,$t.el),Pe&&Hr(Pe,Y),(ht=De.props&&De.props.onVnodeUpdated)&&Hr(()=>ps(ht,qe,De,nt),Y)}else{let De;const{el:Oe,props:Pe}=V,{bm:qe,m:nt,parent:dt}=F,ht=Pu(V);if(pa(F,!1),qe&&Hb(qe),!ht&&(De=Pe&&Pe.onVnodeBeforeMount)&&ps(De,dt,V),pa(F,!0),Oe&&_e){const $t=()=>{F.subTree=Gb(F),_e(Oe,F.subTree,F,Y,null)};ht?V.type.__asyncLoader().then(()=>!F.isUnmounted&&$t()):$t()}else{const $t=F.subTree=Gb(F);m(null,$t,oe,G,F,Y,ae),V.el=$t.el}if(nt&&Hr(nt,Y),!ht&&(De=Pe&&Pe.onVnodeMounted)){const $t=V;Hr(()=>ps(De,dt,$t),Y)}(V.shapeFlag&256||dt&&Pu(dt.vnode)&&dt.vnode.shapeFlag&256)&&F.a&&Hr(F.a,Y),F.isMounted=!0,V=oe=G=null}},ge=F.effect=new H0(ye,()=>Z0(be),F.scope),be=F.update=()=>ge.run();be.id=F.uid,pa(F,!0),be()},B=(F,V,oe)=>{V.component=F;const G=F.vnode.props;F.vnode=V,F.next=null,oM(F,V.props,G,oe),aM(F,V.children,oe),Dc(),t$(),Fc()},U=(F,V,oe,G,Y,ae,pe,ye,ge=!1)=>{const be=F&&F.children,De=F?F.shapeFlag:0,Oe=V.children,{patchFlag:Pe,shapeFlag:qe}=V;if(Pe>0){if(Pe&128){se(be,Oe,oe,G,Y,ae,pe,ye,ge);return}else if(Pe&256){Q(be,Oe,oe,G,Y,ae,pe,ye,ge);return}}qe&8?(De&16&&re(be,Y,ae),Oe!==be&&u(oe,Oe)):De&16?qe&16?se(be,Oe,oe,G,Y,ae,pe,ye,ge):re(be,Y,ae,!0):(De&8&&u(oe,""),qe&16&&I(Oe,oe,G,Y,ae,pe,ye,ge))},Q=(F,V,oe,G,Y,ae,pe,ye,ge)=>{F=F||Zl,V=V||Zl;const be=F.length,De=V.length,Oe=Math.min(be,De);let Pe;for(Pe=0;Pe<Oe;Pe++){const qe=V[Pe]=ge?yi(V[Pe]):ys(V[Pe]);m(F[Pe],qe,oe,null,Y,ae,pe,ye,ge)}be>De?re(F,Y,ae,!0,!1,Oe):I(V,oe,G,Y,ae,pe,ye,ge,Oe)},se=(F,V,oe,G,Y,ae,pe,ye,ge)=>{let be=0;const De=V.length;let Oe=F.length-1,Pe=De-1;for(;be<=Oe&&be<=Pe;){const qe=F[be],nt=V[be]=ge?yi(V[be]):ys(V[be]);if($a(qe,nt))m(qe,nt,oe,null,Y,ae,pe,ye,ge);else break;be++}for(;be<=Oe&&be<=Pe;){const qe=F[Oe],nt=V[Pe]=ge?yi(V[Pe]):ys(V[Pe]);if($a(qe,nt))m(qe,nt,oe,null,Y,ae,pe,ye,ge);else break;Oe--,Pe--}if(be>Oe){if(be<=Pe){const qe=Pe+1,nt=qe<De?V[qe].el:G;for(;be<=Pe;)m(null,V[be]=ge?yi(V[be]):ys(V[be]),oe,nt,Y,ae,pe,ye,ge),be++}}else if(be>Pe)for(;be<=Oe;)de(F[be],Y,ae,!0),be++;else{const qe=be,nt=be,dt=new Map;for(be=nt;be<=Pe;be++){const Ht=V[be]=ge?yi(V[be]):ys(V[be]);Ht.key!=null&&dt.set(Ht.key,be)}let ht,$t=0;const ln=Pe-nt+1;let Cn=!1,ro=0;const Pn=new Array(ln);for(be=0;be<ln;be++)Pn[be]=0;for(be=qe;be<=Oe;be++){const Ht=F[be];if($t>=ln){de(Ht,Y,ae,!0);continue}let Ee;if(Ht.key!=null)Ee=dt.get(Ht.key);else for(ht=nt;ht<=Pe;ht++)if(Pn[ht-nt]===0&&$a(Ht,V[ht])){Ee=ht;break}Ee===void 0?de(Ht,Y,ae,!0):(Pn[Ee-nt]=be+1,Ee>=ro?ro=Ee:Cn=!0,m(Ht,V[Ee],oe,null,Y,ae,pe,ye,ge),$t++)}const Nn=Cn?hM(Pn):Zl;for(ht=Nn.length-1,be=ln-1;be>=0;be--){const Ht=nt+be,Ee=V[Ht],He=Ht+1<De?V[Ht+1].el:G;Pn[be]===0?m(null,Ee,oe,He,Y,ae,pe,ye,ge):Cn&&(ht<0||be!==Nn[ht]?ce(Ee,oe,He,2):ht--)}}},ce=(F,V,oe,G,Y=null)=>{const{el:ae,type:pe,transition:ye,children:ge,shapeFlag:be}=F;if(be&6){ce(F.component.subTree,V,oe,G);return}if(be&128){F.suspense.move(V,oe,G);return}if(be&64){pe.move(F,V,oe,ve);return}if(pe===fn){r(ae,V,oe);for(let Oe=0;Oe<ge.length;Oe++)ce(ge[Oe],V,oe,G);r(F.anchor,V,oe);return}if(pe===qb){w(F,V,oe);return}if(G!==2&&be&1&&ye)if(G===0)ye.beforeEnter(ae),r(ae,V,oe),Hr(()=>ye.enter(ae),Y);else{const{leave:Oe,delayLeave:Pe,afterLeave:qe}=ye,nt=()=>r(ae,V,oe),dt=()=>{Oe(ae,()=>{nt(),qe&&qe()})};Pe?Pe(ae,nt,dt):dt()}else r(ae,V,oe)},de=(F,V,oe,G=!1,Y=!1)=>{const{type:ae,props:pe,ref:ye,children:ge,dynamicChildren:be,shapeFlag:De,patchFlag:Oe,dirs:Pe}=F;if(ye!=null&&Xv(ye,null,oe,F,!0),De&256){V.ctx.deactivate(F);return}const qe=De&1&&Pe,nt=!Pu(F);let dt;if(nt&&(dt=pe&&pe.onVnodeBeforeUnmount)&&ps(dt,V,F),De&6)j(F.component,oe,G);else{if(De&128){F.suspense.unmount(oe,G);return}qe&&fa(F,null,V,"beforeUnmount"),De&64?F.type.remove(F,V,oe,Y,ve,G):be&&(ae!==fn||Oe>0&&Oe&64)?re(be,V,oe,!1,!0):(ae===fn&&Oe&384||!Y&&De&16)&&re(ge,V,oe),G&&we(F)}(nt&&(dt=pe&&pe.onVnodeUnmounted)||qe)&&Hr(()=>{dt&&ps(dt,V,F),qe&&fa(F,null,V,"unmounted")},oe)},we=F=>{const{type:V,el:oe,anchor:G,transition:Y}=F;if(V===fn){Ie(oe,G);return}if(V===qb){y(F);return}const ae=()=>{o(oe),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(F.shapeFlag&1&&Y&&!Y.persisted){const{leave:pe,delayLeave:ye}=Y,ge=()=>pe(oe,ae);ye?ye(F.el,ae,ge):ge()}else ae()},Ie=(F,V)=>{let oe;for(;F!==V;)oe=h(F),o(F),F=oe;o(V)},j=(F,V,oe)=>{const{bum:G,scope:Y,update:ae,subTree:pe,um:ye}=F;G&&Hb(G),Y.stop(),ae&&(ae.active=!1,de(pe,F,V,oe)),ye&&Hr(ye,V),Hr(()=>{F.isUnmounted=!0},V),V&&V.pendingBranch&&!V.isUnmounted&&F.asyncDep&&!F.asyncResolved&&F.suspenseId===V.pendingId&&(V.deps--,V.deps===0&&V.resolve())},re=(F,V,oe,G=!1,Y=!1,ae=0)=>{for(let pe=ae;pe<F.length;pe++)de(F[pe],V,oe,G,Y)},le=F=>F.shapeFlag&6?le(F.component.subTree):F.shapeFlag&128?F.suspense.next():h(F.anchor||F.el),Ce=(F,V,oe)=>{F==null?V._vnode&&de(V._vnode,null,null,!0):m(V._vnode||null,F,V,null,null,null,oe),t$(),z2(),V._vnode=F},ve={p:m,um:de,m:ce,r:we,mt:z,mc:I,pc:U,pbc:T,n:le,o:t};let Le,_e;return e&&([Le,_e]=e(ve)),{render:Ce,hydrate:Le,createApp:cM(Ce,Le)}}function pa({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function ny(t,e,n=!1){const r=t.children,o=e.children;if(pt(r)&&pt(o))for(let s=0;s<r.length;s++){const i=r[s];let a=o[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=o[s]=yi(o[s]),a.el=i.el),n||ny(i,a)),a.type===Nm&&(a.el=i.el)}}function hM(t){const e=t.slice(),n=[0];let r,o,s,i,a;const l=t.length;for(r=0;r<l;r++){const c=t[r];if(c!==0){if(o=n[n.length-1],t[o]<c){e[r]=o,n.push(r);continue}for(s=0,i=n.length-1;s<i;)a=s+i>>1,t[n[a]]<c?s=a+1:i=a;c<t[n[s]]&&(s>0&&(e[r]=n[s-1]),n[s]=r)}}for(s=n.length,i=n[s-1];s-- >0;)n[s]=i,i=e[i];return n}const fM=t=>t.__isTeleport,Lu=t=>t&&(t.disabled||t.disabled===""),d$=t=>typeof SVGElement<"u"&&t instanceof SVGElement,Yv=(t,e)=>{const n=t&&t.to;return jn(n)?e?e(n):null:n},pM={__isTeleport:!0,process(t,e,n,r,o,s,i,a,l,c){const{mc:u,pc:d,pbc:h,o:{insert:f,querySelector:p,createText:m,createComment:g}}=c,b=Lu(e.props);let{shapeFlag:v,children:w,dynamicChildren:y}=e;if(t==null){const C=e.el=m(""),S=e.anchor=m("");f(C,n,r),f(S,n,r);const $=e.target=Yv(e.props,p),I=e.targetAnchor=m("");$&&(f(I,$),i=i||d$($));const R=(T,N)=>{v&16&&u(w,T,N,o,s,i,a,l)};b?R(n,S):$&&R($,I)}else{e.el=t.el;const C=e.anchor=t.anchor,S=e.target=t.target,$=e.targetAnchor=t.targetAnchor,I=Lu(t.props),R=I?n:S,T=I?C:$;if(i=i||d$(S),y?(h(t.dynamicChildren,y,R,o,s,i,a),ny(t,e,!0)):l||d(t,e,R,T,o,s,i,a,!1),b)I||Mf(e,n,C,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const N=e.target=Yv(e.props,p);N&&Mf(e,N,null,c,0)}else I&&Mf(e,S,$,c,1)}uT(e)},remove(t,e,n,r,{um:o,o:{remove:s}},i){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:d,props:h}=t;if(d&&s(u),(i||!Lu(h))&&(s(c),a&16))for(let f=0;f<l.length;f++){const p=l[f];o(p,e,n,!0,!!p.dynamicChildren)}},move:Mf,hydrate:mM};function Mf(t,e,n,{o:{insert:r},m:o},s=2){s===0&&r(t.targetAnchor,e,n);const{el:i,anchor:a,shapeFlag:l,children:c,props:u}=t,d=s===2;if(d&&r(i,e,n),(!d||Lu(u))&&l&16)for(let h=0;h<c.length;h++)o(c[h],e,n,2);d&&r(a,e,n)}function mM(t,e,n,r,o,s,{o:{nextSibling:i,parentNode:a,querySelector:l}},c){const u=e.target=Yv(e.props,l);if(u){const d=u._lpa||u.firstChild;if(e.shapeFlag&16)if(Lu(e.props))e.anchor=c(i(t),e,a(t),n,r,o,s),e.targetAnchor=d;else{e.anchor=i(t);let h=d;for(;h;)if(h=i(h),h&&h.nodeType===8&&h.data==="teleport anchor"){e.targetAnchor=h,u._lpa=e.targetAnchor&&i(e.targetAnchor);break}c(d,e,u,n,r,o,s)}uT(e)}return e.anchor&&i(e.anchor)}const cT=pM;function uT(t){const e=t.ctx;if(e&&e.ut){let n=t.children[0].el;for(;n!==t.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",e.uid),n=n.nextSibling;e.ut()}}const fn=Symbol(void 0),Nm=Symbol(void 0),Fo=Symbol(void 0),qb=Symbol(void 0),Bu=[];let Xo=null;function Zr(t=!1){Bu.push(Xo=t?null:[])}function gM(){Bu.pop(),Xo=Bu[Bu.length-1]||null}let od=1;function h$(t){od+=t}function dT(t){return t.dynamicChildren=od>0?Xo||Zl:null,gM(),od>0&&Xo&&Xo.push(t),t}function Mi(t,e,n,r,o,s){return dT(Is(t,e,n,r,o,s,!0))}function Oc(t,e,n,r,o){return dT(Tt(t,e,n,r,o,!0))}function sd(t){return t?t.__v_isVNode===!0:!1}function $a(t,e){return t.type===e.type&&t.key===e.key}const _m="__vInternal",hT=({key:t})=>t!=null?t:null,pp=({ref:t,ref_key:e,ref_for:n})=>t!=null?jn(t)||$n(t)||xt(t)?{i:fr,r:t,k:e,f:!!n}:t:null;function Is(t,e=null,n=null,r=0,o=null,s=t===fn?0:1,i=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&hT(e),ref:e&&pp(e),scopeId:U2,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:fr};return a?(ry(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=jn(n)?8:16),od>0&&!i&&Xo&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Xo.push(l),l}const Tt=bM;function bM(t,e=null,n=null,r=0,o=null,s=!1){if((!t||t===q3)&&(t=Fo),sd(t)){const a=Os(t,e,!0);return n&&ry(a,n),od>0&&!s&&Xo&&(a.shapeFlag&6?Xo[Xo.indexOf(t)]=a:Xo.push(a)),a.patchFlag|=-2,a}if(TM(t)&&(t=t.__vccOpts),e){e=vM(e);let{class:a,style:l}=e;a&&!jn(a)&&(e.class=P0(a)),bn(l)&&(_2(l)&&!pt(l)&&(l=or({},l)),e.style=O0(l))}const i=jn(t)?1:L3(t)?128:fM(t)?64:bn(t)?4:xt(t)?2:0;return Is(t,e,n,r,o,i,s,!0)}function vM(t){return t?_2(t)||_m in t?or({},t):t:null}function Os(t,e,n=!1){const{props:r,ref:o,patchFlag:s,children:i}=t,a=e?Ad(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&hT(a),ref:e&&e.ref?n&&o?pt(o)?o.concat(pp(e)):[o,pp(e)]:pp(e):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:i,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==fn?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Os(t.ssContent),ssFallback:t.ssFallback&&Os(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx}}function hr(t=" ",e=0){return Tt(Nm,null,t,e)}function ys(t){return t==null||typeof t=="boolean"?Tt(Fo):pt(t)?Tt(fn,null,t.slice()):typeof t=="object"?yi(t):Tt(Nm,null,String(t))}function yi(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Os(t)}function ry(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(pt(e))n=16;else if(typeof e=="object")if(r&65){const o=e.default;o&&(o._c&&(o._d=!1),ry(t,o()),o._c&&(o._d=!0));return}else{n=32;const o=e._;!o&&!(_m in e)?e._ctx=fr:o===3&&fr&&(fr.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else xt(e)?(e={default:e,_ctx:fr},n=32):(e=String(e),r&64?(n=16,e=[hr(e)]):n=8);t.children=e,t.shapeFlag|=n}function Ad(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const o in r)if(o==="class")e.class!==r.class&&(e.class=P0([e.class,r.class]));else if(o==="style")e.style=O0([e.style,r.style]);else if(wm(o)){const s=e[o],i=r[o];i&&s!==i&&!(pt(s)&&s.includes(i))&&(e[o]=s?[].concat(s,i):i)}else o!==""&&(e[o]=r[o])}return e}function ps(t,e,n,r=null){Ao(t,e,7,[n,r])}const xM=lT();let yM=0;function wM(t,e,n){const r=t.type,o=(e?e.appContext:t.appContext)||xM,s={uid:yM++,vnode:t,type:r,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new v2(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:oT(r,o),emitsOptions:V2(r,o),emit:null,emitted:null,propsDefaults:hn,inheritAttrs:r.inheritAttrs,ctx:hn,data:hn,props:hn,attrs:hn,slots:hn,refs:hn,setupState:hn,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=D3.bind(null,s),t.ce&&t.ce(s),s}let nr=null;const Pc=()=>nr||fr,fc=t=>{nr=t,t.scope.on()},Ba=()=>{nr&&nr.scope.off(),nr=null};function fT(t){return t.vnode.shapeFlag&4}let id=!1;function CM(t,e=!1){id=e;const{props:n,children:r}=t.vnode,o=fT(t);rM(t,n,o,e),iM(t,r);const s=o?$M(t,e):void 0;return id=!1,s}function $M(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=dc(new Proxy(t.ctx,Z3));const{setup:r}=n;if(r){const o=t.setupContext=r.length>1?IM(t):null;fc(t),Dc();const s=_i(r,t,0,[t.props,o]);if(Fc(),Ba(),m2(s)){if(s.then(Ba,Ba),e)return s.then(i=>{f$(t,i,e)}).catch(i=>{km(i,t,0)});t.asyncDep=s}else f$(t,s,e)}else pT(t,e)}function f$(t,e,n){xt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:bn(e)&&(t.setupState=P2(e)),pT(t,n)}let p$;function pT(t,e,n){const r=t.type;if(!t.render){if(!e&&p$&&!r.render){const o=r.template||ey(t).template;if(o){const{isCustomElement:s,compilerOptions:i}=t.appContext.config,{delimiters:a,compilerOptions:l}=r,c=or(or({isCustomElement:s,delimiters:a},i),l);r.render=p$(o,c)}}t.render=r.render||Zo}fc(t),Dc(),J3(t),Fc(),Ba()}function SM(t){return new Proxy(t.attrs,{get(e,n){return fo(t,"get","$attrs"),e[n]}})}function IM(t){const e=r=>{t.exposed=r||{}};let n;return{get attrs(){return n||(n=SM(t))},slots:t.slots,emit:t.emit,expose:e}}function Am(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(P2(dc(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Mu)return Mu[n](t)},has(e,n){return n in e||n in Mu}}))}function kM(t,e=!0){return xt(t)?t.displayName||t.name:t.name||e&&t.__name}function TM(t){return xt(t)&&"__vccOpts"in t}const Me=(t,e)=>T3(t,e,id);function W(t,e,n){const r=arguments.length;return r===2?bn(e)&&!pt(e)?sd(e)?Tt(t,null,[e]):Tt(t,e):Tt(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&sd(n)&&(n=[n]),Tt(t,e,n))}const EM=Symbol(""),RM=()=>Kt(EM),NM="3.2.45",_M="http://www.w3.org/2000/svg",Sa=typeof document<"u"?document:null,m$=Sa&&Sa.createElement("template"),AM={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const o=e?Sa.createElementNS(_M,t):Sa.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&o.setAttribute("multiple",r.multiple),o},createText:t=>Sa.createTextNode(t),createComment:t=>Sa.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Sa.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,o,s){const i=n?n.previousSibling:e.lastChild;if(o&&(o===s||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),n),!(o===s||!(o=o.nextSibling)););else{m$.innerHTML=r?`<svg>${t}</svg>`:t;const a=m$.content;if(r){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[i?i.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function DM(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function FM(t,e,n){const r=t.style,o=jn(n);if(n&&!o){for(const s in n)Zv(r,s,n[s]);if(e&&!jn(e))for(const s in e)n[s]==null&&Zv(r,s,"")}else{const s=r.display;o?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=s)}}const g$=/\s*!important$/;function Zv(t,e,n){if(pt(n))n.forEach(r=>Zv(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=OM(t,e);g$.test(n)?t.setProperty(Ac(r),n.replace(g$,""),"important"):t[r]=n}}const b$=["Webkit","Moz","ms"],Xb={};function OM(t,e){const n=Xb[e];if(n)return n;let r=Fs(e);if(r!=="filter"&&r in t)return Xb[e]=r;r=Sm(r);for(let o=0;o<b$.length;o++){const s=b$[o]+r;if(s in t)return Xb[e]=s}return e}const v$="http://www.w3.org/1999/xlink";function PM(t,e,n,r,o){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(v$,e.slice(6,e.length)):t.setAttributeNS(v$,e,n);else{const s=WP(e);n==null||s&&!h2(n)?t.removeAttribute(e):t.setAttribute(e,s?"":n)}}function MM(t,e,n,r,o,s,i){if(e==="innerHTML"||e==="textContent"){r&&i(r,o,s),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const l=n==null?"":n;(t.value!==l||t.tagName==="OPTION")&&(t.value=l),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=h2(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}function LM(t,e,n,r){t.addEventListener(e,n,r)}function BM(t,e,n,r){t.removeEventListener(e,n,r)}function zM(t,e,n,r,o=null){const s=t._vei||(t._vei={}),i=s[e];if(r&&i)i.value=r;else{const[a,l]=WM(e);if(r){const c=s[e]=HM(r,o);LM(t,a,c,l)}else i&&(BM(t,a,i,l),s[e]=void 0)}}const x$=/(?:Once|Passive|Capture)$/;function WM(t){let e;if(x$.test(t)){e={};let r;for(;r=t.match(x$);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ac(t.slice(2)),e]}let Yb=0;const VM=Promise.resolve(),UM=()=>Yb||(VM.then(()=>Yb=0),Yb=Date.now());function HM(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Ao(GM(r,n.value),e,5,[r])};return n.value=t,n.attached=UM(),n}function GM(t,e){if(pt(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>o=>!o._stopped&&r&&r(o))}else return e}const y$=/^on[a-z]/,jM=(t,e,n,r,o=!1,s,i,a,l)=>{e==="class"?DM(t,r,o):e==="style"?FM(t,n,r):wm(e)?M0(e)||zM(t,e,n,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):KM(t,e,r,o))?MM(t,e,r,s,i,a,l):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),PM(t,e,r,o))};function KM(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&y$.test(e)&&xt(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||y$.test(e)&&jn(n)?!1:e in t}const mi="transition",pu="animation",Li=(t,{slots:e})=>W(j2,gT(t),e);Li.displayName="Transition";const mT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},qM=Li.props=or({},j2.props,mT),ma=(t,e=[])=>{pt(t)?t.forEach(n=>n(...e)):t&&t(...e)},w$=t=>t?pt(t)?t.some(e=>e.length>1):t.length>1:!1;function gT(t){const e={};for(const _ in t)_ in mT||(e[_]=t[_]);if(t.css===!1)return e;const{name:n="v",type:r,duration:o,enterFromClass:s=`${n}-enter-from`,enterActiveClass:i=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=s,appearActiveClass:c=i,appearToClass:u=a,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:h=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,p=XM(o),m=p&&p[0],g=p&&p[1],{onBeforeEnter:b,onEnter:v,onEnterCancelled:w,onLeave:y,onLeaveCancelled:C,onBeforeAppear:S=b,onAppear:$=v,onAppearCancelled:I=w}=e,R=(_,P,z)=>{vi(_,P?u:a),vi(_,P?c:i),z&&z()},T=(_,P)=>{_._isLeaving=!1,vi(_,d),vi(_,f),vi(_,h),P&&P()},N=_=>(P,z)=>{const L=_?$:v,O=()=>R(P,_,z);ma(L,[P,O]),C$(()=>{vi(P,_?l:s),Us(P,_?u:a),w$(L)||$$(P,r,m,O)})};return or(e,{onBeforeEnter(_){ma(b,[_]),Us(_,s),Us(_,i)},onBeforeAppear(_){ma(S,[_]),Us(_,l),Us(_,c)},onEnter:N(!1),onAppear:N(!0),onLeave(_,P){_._isLeaving=!0;const z=()=>T(_,P);Us(_,d),vT(),Us(_,h),C$(()=>{!_._isLeaving||(vi(_,d),Us(_,f),w$(y)||$$(_,r,g,z))}),ma(y,[_,z])},onEnterCancelled(_){R(_,!1),ma(w,[_])},onAppearCancelled(_){R(_,!0),ma(I,[_])},onLeaveCancelled(_){T(_),ma(C,[_])}})}function XM(t){if(t==null)return null;if(bn(t))return[Zb(t.enter),Zb(t.leave)];{const e=Zb(t);return[e,e]}}function Zb(t){return W0(t)}function Us(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function vi(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function C$(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let YM=0;function $$(t,e,n,r){const o=t._endId=++YM,s=()=>{o===t._endId&&r()};if(n)return setTimeout(s,n);const{type:i,timeout:a,propCount:l}=bT(t,e);if(!i)return r();const c=i+"end";let u=0;const d=()=>{t.removeEventListener(c,h),s()},h=f=>{f.target===t&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),t.addEventListener(c,h)}function bT(t,e){const n=window.getComputedStyle(t),r=p=>(n[p]||"").split(", "),o=r(`${mi}Delay`),s=r(`${mi}Duration`),i=S$(o,s),a=r(`${pu}Delay`),l=r(`${pu}Duration`),c=S$(a,l);let u=null,d=0,h=0;e===mi?i>0&&(u=mi,d=i,h=s.length):e===pu?c>0&&(u=pu,d=c,h=l.length):(d=Math.max(i,c),u=d>0?i>c?mi:pu:null,h=u?u===mi?s.length:l.length:0);const f=u===mi&&/\b(transform|all)(,|$)/.test(r(`${mi}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:f}}function S$(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>I$(n)+I$(t[r])))}function I$(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function vT(){return document.body.offsetHeight}const xT=new WeakMap,yT=new WeakMap,ZM={name:"TransitionGroup",props:or({},qM,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=Pc(),r=G2();let o,s;return Z2(()=>{if(!o.length)return;const i=t.moveClass||`${t.name||"v"}-move`;if(!tL(o[0].el,n.vnode.el,i))return;o.forEach(JM),o.forEach(QM);const a=o.filter(eL);vT(),a.forEach(l=>{const c=l.el,u=c.style;Us(c,i),u.transform=u.webkitTransform=u.transitionDuration="";const d=c._moveCb=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",d),c._moveCb=null,vi(c,i))};c.addEventListener("transitionend",d)})}),()=>{const i=At(t),a=gT(i);let l=i.tag||fn;o=s,s=e.default?Q0(e.default()):[];for(let c=0;c<s.length;c++){const u=s[c];u.key!=null&&rd(u,nd(u,a,r,n))}if(o)for(let c=0;c<o.length;c++){const u=o[c];rd(u,nd(u,a,r,n)),xT.set(u,u.el.getBoundingClientRect())}return Tt(l,null,s)}}},wT=ZM;function JM(t){const e=t.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function QM(t){yT.set(t,t.el.getBoundingClientRect())}function eL(t){const e=xT.get(t),n=yT.get(t),r=e.left-n.left,o=e.top-n.top;if(r||o){const s=t.el.style;return s.transform=s.webkitTransform=`translate(${r}px,${o}px)`,s.transitionDuration="0s",t}}function tL(t,e,n){const r=t.cloneNode();t._vtc&&t._vtc.forEach(i=>{i.split(/\s+/).forEach(a=>a&&r.classList.remove(a))}),n.split(/\s+/).forEach(i=>i&&r.classList.add(i)),r.style.display="none";const o=e.nodeType===1?e:e.parentNode;o.appendChild(r);const{hasTransform:s}=bT(r);return o.removeChild(r),s}const Jv={beforeMount(t,{value:e},{transition:n}){t._vod=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):mu(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:r}){!e!=!n&&(r?e?(r.beforeEnter(t),mu(t,!0),r.enter(t)):r.leave(t,()=>{mu(t,!1)}):mu(t,e))},beforeUnmount(t,{value:e}){mu(t,e)}};function mu(t,e){t.style.display=e?t._vod:"none"}const nL=or({patchProp:jM},AM);let k$;function rL(){return k$||(k$=uM(nL))}const oL=(...t)=>{const e=rL().createApp(...t),{mount:n}=e;return e.mount=r=>{const o=sL(r);if(!o)return;const s=e._component;!xt(s)&&!s.render&&!s.template&&(s.template=o.innerHTML),o.innerHTML="";const i=n(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),i},e};function sL(t){return jn(t)?document.querySelector(t):t}function oy(t){return t.composedPath()[0]||null}function T$(t){return typeof t=="string"?t.endsWith("px")?Number(t.slice(0,t.length-2)):Number(t):t}function CT(t,e){const n=t.trim().split(/\s+/g),r={top:n[0]};switch(n.length){case 1:r.right=n[0],r.bottom=n[0],r.left=n[0];break;case 2:r.right=n[1],r.left=n[1],r.bottom=n[0];break;case 3:r.right=n[1],r.bottom=n[2],r.left=n[1];break;case 4:r.right=n[1],r.bottom=n[2],r.left=n[3];break;default:throw new Error("[seemly/getMargin]:"+t+" is not a valid value.")}return e===void 0?r:r[e]}function iL(t,e){const[n,r]=t.split(" ");return e?e==="row"?n:r:{row:n,col:r||n}}const E$={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"},Mc="^\\s*",Lc="\\s*$",Na="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",_a="([0-9A-Fa-f])",Aa="([0-9A-Fa-f]{2})",aL=new RegExp(`${Mc}rgb\\s*\\(${Na},${Na},${Na}\\)${Lc}`),lL=new RegExp(`${Mc}rgba\\s*\\(${Na},${Na},${Na},${Na}\\)${Lc}`),cL=new RegExp(`${Mc}#${_a}${_a}${_a}${Lc}`),uL=new RegExp(`${Mc}#${Aa}${Aa}${Aa}${Lc}`),dL=new RegExp(`${Mc}#${_a}${_a}${_a}${_a}${Lc}`),hL=new RegExp(`${Mc}#${Aa}${Aa}${Aa}${Aa}${Lc}`);function Vr(t){return parseInt(t,16)}function Ya(t){try{let e;if(e=uL.exec(t))return[Vr(e[1]),Vr(e[2]),Vr(e[3]),1];if(e=aL.exec(t))return[xr(e[1]),xr(e[5]),xr(e[9]),1];if(e=lL.exec(t))return[xr(e[1]),xr(e[5]),xr(e[9]),zu(e[13])];if(e=cL.exec(t))return[Vr(e[1]+e[1]),Vr(e[2]+e[2]),Vr(e[3]+e[3]),1];if(e=hL.exec(t))return[Vr(e[1]),Vr(e[2]),Vr(e[3]),zu(Vr(e[4])/255)];if(e=dL.exec(t))return[Vr(e[1]+e[1]),Vr(e[2]+e[2]),Vr(e[3]+e[3]),zu(Vr(e[4]+e[4])/255)];if(t in E$)return Ya(E$[t]);throw new Error(`[seemly/rgba]: Invalid color value ${t}.`)}catch(e){throw e}}function fL(t){return t>1?1:t<0?0:t}function Qv(t,e,n,r){return`rgba(${xr(t)}, ${xr(e)}, ${xr(n)}, ${fL(r)})`}function Jb(t,e,n,r,o){return xr((t*e*(1-r)+n*r)/o)}function ad(t,e){Array.isArray(t)||(t=Ya(t)),Array.isArray(e)||(e=Ya(e));const n=t[3],r=e[3],o=zu(n+r-n*r);return Qv(Jb(t[0],n,e[0],r,o),Jb(t[1],n,e[1],r,o),Jb(t[2],n,e[2],r,o),o)}function Da(t,e){const[n,r,o,s=1]=Array.isArray(t)?t:Ya(t);return e.alpha?Qv(n,r,o,e.alpha):Qv(n,r,o,s)}function Lf(t,e){const[n,r,o,s=1]=Array.isArray(t)?t:Ya(t),{lightness:i=1,alpha:a=1}=e;return pL([n*i,r*i,o*i,s*a])}function zu(t){const e=Math.round(Number(t)*100)/100;return e>1?1:e<0?0:e}function xr(t){const e=Math.round(Number(t));return e>255?255:e<0?0:e}function pL(t){const[e,n,r]=t;return 3 in t?`rgba(${xr(e)}, ${xr(n)}, ${xr(r)}, ${zu(t[3])})`:`rgba(${xr(e)}, ${xr(n)}, ${xr(r)}, 1)`}function $T(t=8){return Math.random().toString(16).slice(2,2+t)}function mL(t,e="default",n=[]){const o=t.$slots[e];return o===void 0?n:o()}function ex(t,e=[],n){const r={};return e.forEach(o=>{r[o]=t[o]}),Object.assign(r,n)}function ST(t,e=[],n){const r={};return Object.getOwnPropertyNames(t).forEach(s=>{e.includes(s)||(r[s]=t[s])}),Object.assign(r,n)}function za(t,e=!0,n=[]){return t.forEach(r=>{if(r!==null){if(typeof r!="object"){(typeof r=="string"||typeof r=="number")&&n.push(hr(String(r)));return}if(Array.isArray(r)){za(r,e,n);return}if(r.type===fn){if(r.children===null)return;Array.isArray(r.children)&&za(r.children,e,n)}else r.type!==Fo&&n.push(r)}}),n}function dn(t,...e){if(Array.isArray(t))t.forEach(n=>dn(n,...e));else return t(...e)}function sy(t){return Object.keys(t)}const wi=(t,...e)=>typeof t=="function"?t(...e):typeof t=="string"?hr(t):typeof t=="number"?hr(String(t)):null;function _p(t,e){console.error(`[naive/${t}]: ${e}`)}function iy(t,e){throw new Error(`[naive/${t}]: ${e}`)}function gL(t,e="default",n=void 0){const r=t[e];if(!r)return _p("getFirstSlotVNode",`slot[${e}] is empty`),null;const o=za(r(n));return o.length===1?o[0]:(_p("getFirstSlotVNode",`slot[${e}] should have exactly one child`),null)}function Dd(t){return t.some(e=>sd(e)?!(e.type===Fo||e.type===fn&&!Dd(e.children)):!0)?t:null}function Wa(t,e){return t&&Dd(t())||e()}function bL(t,e,n){return t&&Dd(t(e))||n(e)}function yr(t,e){const n=t&&Dd(t());return e(n||null)}function vL(t){return!(t&&Dd(t()))}const R$=lt({render(){var t,e;return(e=(t=this.$slots).default)===null||e===void 0?void 0:e.call(t)}}),xL=/^(\d|\.)+$/,N$=/(\d|\.)+/;function yL(t,{c:e=1,offset:n=0,attachPx:r=!0}={}){if(typeof t=="number"){const o=(t+n)*e;return o===0?"0":`${o}px`}else if(typeof t=="string")if(xL.test(t)){const o=(Number(t)+n)*e;return r?o===0?"0":`${o}px`:`${o}`}else{const o=N$.exec(t);return o?t.replace(N$,String((Number(o[0])+n)*e)):t}return t}function _$(t){return t.replace(/#|\(|\)|,|\s/g,"_")}function wL(t){let e=0;for(let n=0;n<t.length;++n)t[n]==="&"&&++e;return e}const IT=/\s*,(?![^(]*\))\s*/g,CL=/\s+/g;function $L(t,e){const n=[];return e.split(IT).forEach(r=>{let o=wL(r);if(o){if(o===1){t.forEach(i=>{n.push(r.replace("&",i))});return}}else{t.forEach(i=>{n.push((i&&i+" ")+r)});return}let s=[r];for(;o--;){const i=[];s.forEach(a=>{t.forEach(l=>{i.push(a.replace("&",l))})}),s=i}s.forEach(i=>n.push(i))}),n}function SL(t,e){const n=[];return e.split(IT).forEach(r=>{t.forEach(o=>{n.push((o&&o+" ")+r)})}),n}function IL(t){let e=[""];return t.forEach(n=>{n=n&&n.trim(),n&&(n.includes("&")?e=$L(e,n):e=SL(e,n))}),e.join(", ").replace(CL," ")}function A$(t){if(!t)return;const e=t.parentElement;e&&e.removeChild(t)}function Dm(t){return document.head.querySelector(`style[cssr-id="${t}"]`)}function kL(t){const e=document.createElement("style");return e.setAttribute("cssr-id",t),e}function Bf(t){return t?/^\s*@(s|m)/.test(t):!1}const TL=/[A-Z]/g;function kT(t){return t.replace(TL,e=>"-"+e.toLowerCase())}function EL(t,e="  "){return typeof t=="object"&&t!==null?` {
`+Object.entries(t).map(n=>e+`  ${kT(n[0])}: ${n[1]};`).join(`
`)+`
`+e+"}":`: ${t};`}function RL(t,e,n){return typeof t=="function"?t({context:e.context,props:n}):t}function D$(t,e,n,r){if(!e)return"";const o=RL(e,n,r);if(!o)return"";if(typeof o=="string")return`${t} {
${o}
}`;const s=Object.keys(o);if(s.length===0)return n.config.keepEmptyBlock?t+` {
}`:"";const i=t?[t+" {"]:[];return s.forEach(a=>{const l=o[a];if(a==="raw"){i.push(`
`+l+`
`);return}a=kT(a),l!=null&&i.push(`  ${a}${EL(l)}`)}),t&&i.push("}"),i.join(`
`)}function tx(t,e,n){!t||t.forEach(r=>{if(Array.isArray(r))tx(r,e,n);else if(typeof r=="function"){const o=r(e);Array.isArray(o)?tx(o,e,n):o&&n(o)}else r&&n(r)})}function TT(t,e,n,r,o,s){const i=t.$;let a="";if(!i||typeof i=="string")Bf(i)?a=i:e.push(i);else if(typeof i=="function"){const u=i({context:r.context,props:o});Bf(u)?a=u:e.push(u)}else if(i.before&&i.before(r.context),!i.$||typeof i.$=="string")Bf(i.$)?a=i.$:e.push(i.$);else if(i.$){const u=i.$({context:r.context,props:o});Bf(u)?a=u:e.push(u)}const l=IL(e),c=D$(l,t.props,r,o);a?(n.push(`${a} {`),s&&c&&s.insertRule(`${a} {
${c}
}
`)):(s&&c&&s.insertRule(c),!s&&c.length&&n.push(c)),t.children&&tx(t.children,{context:r.context,props:o},u=>{if(typeof u=="string"){const d=D$(l,{raw:u},r,o);s?s.insertRule(d):n.push(d)}else TT(u,e,n,r,o,s)}),e.pop(),a&&n.push("}"),i&&i.after&&i.after(r.context)}function ET(t,e,n,r=!1){const o=[];return TT(t,[],o,e,n,r?t.instance.__styleSheet:void 0),r?"":o.join(`

`)}function nx(t){for(var e=0,n,r=0,o=t.length;o>=4;++r,o-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(o){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}typeof window<"u"&&(window.__cssrContext={});function NL(t,e,n){const{els:r}=e;if(n===void 0)r.forEach(A$),e.els=[];else{const o=Dm(n);o&&r.includes(o)&&(A$(o),e.els=r.filter(s=>s!==o))}}function F$(t,e){t.push(e)}function _L(t,e,n,r,o,s,i,a,l){if(s&&!l){if(n===void 0){console.error("[css-render/mount]: `id` is required in `silent` mode.");return}const h=window.__cssrContext;h[n]||(h[n]=!0,ET(e,t,r,s));return}let c;if(n===void 0&&(c=e.render(r),n=nx(c)),l){l.adapter(n,c!=null?c:e.render(r));return}const u=Dm(n);if(u!==null&&!i)return u;const d=u!=null?u:kL(n);if(c===void 0&&(c=e.render(r)),d.textContent=c,u!==null)return u;if(a){const h=document.head.querySelector(`meta[name="${a}"]`);if(h)return document.head.insertBefore(d,h),F$(e.els,d),d}return o?document.head.insertBefore(d,document.head.querySelector("style, link")):document.head.appendChild(d),F$(e.els,d),d}function AL(t){return ET(this,this.instance,t)}function DL(t={}){const{id:e,ssr:n,props:r,head:o=!1,silent:s=!1,force:i=!1,anchorMetaName:a}=t;return _L(this.instance,this,e,r,o,s,i,a,n)}function FL(t={}){const{id:e}=t;NL(this.instance,this,e)}const zf=function(t,e,n,r){return{instance:t,$:e,props:n,children:r,els:[],render:AL,mount:DL,unmount:FL}},OL=function(t,e,n,r){return Array.isArray(e)?zf(t,{$:null},null,e):Array.isArray(n)?zf(t,e,null,n):Array.isArray(r)?zf(t,e,n,r):zf(t,e,n,null)};function RT(t={}){let e=null;const n={c:(...r)=>OL(n,...r),use:(r,...o)=>r.install(n,...o),find:Dm,context:{},config:t,get __styleSheet(){if(!e){const r=document.createElement("style");return document.head.appendChild(r),e=document.styleSheets[document.styleSheets.length-1],e}return e}};return n}function PL(t,e){if(t===void 0)return!1;if(e){const{context:{ids:n}}=e;return n.has(t)}return Dm(t)!==null}function ML(t){let e=".",n="__",r="--",o;if(t){let p=t.blockPrefix;p&&(e=p),p=t.elementPrefix,p&&(n=p),p=t.modifierPrefix,p&&(r=p)}const s={install(p){o=p.c;const m=p.context;m.bem={},m.bem.b=null,m.bem.els=null}};function i(p){let m,g;return{before(b){m=b.bem.b,g=b.bem.els,b.bem.els=null},after(b){b.bem.b=m,b.bem.els=g},$({context:b,props:v}){return p=typeof p=="string"?p:p({context:b,props:v}),b.bem.b=p,`${(v==null?void 0:v.bPrefix)||e}${b.bem.b}`}}}function a(p){let m;return{before(g){m=g.bem.els},after(g){g.bem.els=m},$({context:g,props:b}){return p=typeof p=="string"?p:p({context:g,props:b}),g.bem.els=p.split(",").map(v=>v.trim()),g.bem.els.map(v=>`${(b==null?void 0:b.bPrefix)||e}${g.bem.b}${n}${v}`).join(", ")}}}function l(p){return{$({context:m,props:g}){p=typeof p=="string"?p:p({context:m,props:g});const b=p.split(",").map(y=>y.trim());function v(y){return b.map(C=>`&${(g==null?void 0:g.bPrefix)||e}${m.bem.b}${y!==void 0?`${n}${y}`:""}${r}${C}`).join(", ")}const w=m.bem.els;return w!==null?v(w[0]):v()}}}function c(p){return{$({context:m,props:g}){p=typeof p=="string"?p:p({context:m,props:g});const b=m.bem.els;return`&:not(${(g==null?void 0:g.bPrefix)||e}${m.bem.b}${b!==null&&b.length>0?`${n}${b[0]}`:""}${r}${p})`}}}return Object.assign(s,{cB:(...p)=>o(i(p[0]),p[1],p[2]),cE:(...p)=>o(a(p[0]),p[1],p[2]),cM:(...p)=>o(l(p[0]),p[1],p[2]),cNotM:(...p)=>o(c(p[0]),p[1],p[2])}),s}function Ge(t,e){return t+(e==="default"?"":e.replace(/^[a-z]/,n=>n.toUpperCase()))}Ge("abc","def");const LL="n",ld=`.${LL}-`,BL="__",zL="--",NT=RT(),_T=ML({blockPrefix:ld,elementPrefix:BL,modifierPrefix:zL});NT.use(_T);const{c:$e,find:fye}=NT,{cB:Ae,cE:Se,cM:We,cNotM:Ks}=_T;function AT(t){return $e(({props:{bPrefix:e}})=>`${e||ld}modal, ${e||ld}drawer`,[t])}function WL(t){return $e(({props:{bPrefix:e}})=>`${e||ld}popover`,[t])}function DT(t){return $e(({props:{bPrefix:e}})=>`&${e||ld}modal`,t)}const Bc=typeof document<"u"&&typeof window<"u",VL=new WeakSet;function UL(t){return!VL.has(t)}function HL(t){const e=Ne(!!t.value);if(e.value)return ei(e);const n=Fn(t,r=>{r&&(e.value=!0,n())});return ei(e)}function rx(t){const e=Me(t),n=Ne(e.value);return Fn(e,r=>{n.value=r}),typeof t=="function"?n:{__v_isRef:!0,get value(){return n.value},set value(r){t.set(r)}}}function FT(){return Pc()!==null}const ay=typeof window<"u";let ec,Wu;const GL=()=>{var t,e;ec=ay?(e=(t=document)===null||t===void 0?void 0:t.fonts)===null||e===void 0?void 0:e.ready:void 0,Wu=!1,ec!==void 0?ec.then(()=>{Wu=!0}):Wu=!0};GL();function jL(t){if(Wu)return;let e=!1;as(()=>{Wu||ec==null||ec.then(()=>{e||t()})}),Lo(()=>{e=!0})}function mp(t){return t.composedPath()[0]}const KL={mousemoveoutside:new WeakMap,clickoutside:new WeakMap};function qL(t,e,n){if(t==="mousemoveoutside"){const r=o=>{e.contains(mp(o))||n(o)};return{mousemove:r,touchstart:r}}else if(t==="clickoutside"){let r=!1;const o=i=>{r=!e.contains(mp(i))},s=i=>{!r||e.contains(mp(i))||n(i)};return{mousedown:o,mouseup:s,touchstart:o,touchend:s}}return console.error(`[evtd/create-trap-handler]: name \`${t}\` is invalid. This could be a bug of evtd.`),{}}function OT(t,e,n){const r=KL[t];let o=r.get(e);o===void 0&&r.set(e,o=new WeakMap);let s=o.get(n);return s===void 0&&o.set(n,s=qL(t,e,n)),s}function XL(t,e,n,r){if(t==="mousemoveoutside"||t==="clickoutside"){const o=OT(t,e,n);return Object.keys(o).forEach(s=>{Kr(s,document,o[s],r)}),!0}return!1}function YL(t,e,n,r){if(t==="mousemoveoutside"||t==="clickoutside"){const o=OT(t,e,n);return Object.keys(o).forEach(s=>{dr(s,document,o[s],r)}),!0}return!1}function ZL(){if(typeof window>"u")return{on:()=>{},off:()=>{}};const t=new WeakMap,e=new WeakMap;function n(){t.set(this,!0)}function r(){t.set(this,!0),e.set(this,!0)}function o($,I,R){const T=$[I];return $[I]=function(){return R.apply($,arguments),T.apply($,arguments)},$}function s($,I){$[I]=Event.prototype[I]}const i=new WeakMap,a=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function l(){var $;return($=i.get(this))!==null&&$!==void 0?$:null}function c($,I){a!==void 0&&Object.defineProperty($,"currentTarget",{configurable:!0,enumerable:!0,get:I!=null?I:a.get})}const u={bubble:{},capture:{}},d={};function h(){const $=function(I){const{type:R,eventPhase:T,bubbles:N}=I,_=mp(I);if(T===2)return;const P=T===1?"capture":"bubble";let z=_;const L=[];for(;z===null&&(z=window),L.push(z),z!==window;)z=z.parentNode||null;const O=u.capture[R],B=u.bubble[R];if(o(I,"stopPropagation",n),o(I,"stopImmediatePropagation",r),c(I,l),P==="capture"){if(O===void 0)return;for(let U=L.length-1;U>=0&&!t.has(I);--U){const Q=L[U],se=O.get(Q);if(se!==void 0){i.set(I,Q);for(const ce of se){if(e.has(I))break;ce(I)}}if(U===0&&!N&&B!==void 0){const ce=B.get(Q);if(ce!==void 0)for(const de of ce){if(e.has(I))break;de(I)}}}}else if(P==="bubble"){if(B===void 0)return;for(let U=0;U<L.length&&!t.has(I);++U){const Q=L[U],se=B.get(Q);if(se!==void 0){i.set(I,Q);for(const ce of se){if(e.has(I))break;ce(I)}}}}s(I,"stopPropagation"),s(I,"stopImmediatePropagation"),c(I)};return $.displayName="evtdUnifiedHandler",$}function f(){const $=function(I){const{type:R,eventPhase:T}=I;if(T!==2)return;const N=d[R];N!==void 0&&N.forEach(_=>_(I))};return $.displayName="evtdUnifiedWindowEventHandler",$}const p=h(),m=f();function g($,I){const R=u[$];return R[I]===void 0&&(R[I]=new Map,window.addEventListener(I,p,$==="capture")),R[I]}function b($){return d[$]===void 0&&(d[$]=new Set,window.addEventListener($,m)),d[$]}function v($,I){let R=$.get(I);return R===void 0&&$.set(I,R=new Set),R}function w($,I,R,T){const N=u[I][R];if(N!==void 0){const _=N.get($);if(_!==void 0&&_.has(T))return!0}return!1}function y($,I){const R=d[$];return!!(R!==void 0&&R.has(I))}function C($,I,R,T){let N;if(typeof T=="object"&&T.once===!0?N=O=>{S($,I,N,T),R(O)}:N=R,XL($,I,N,T))return;const P=T===!0||typeof T=="object"&&T.capture===!0?"capture":"bubble",z=g(P,$),L=v(z,I);if(L.has(N)||L.add(N),I===window){const O=b($);O.has(N)||O.add(N)}}function S($,I,R,T){if(YL($,I,R,T))return;const _=T===!0||typeof T=="object"&&T.capture===!0,P=_?"capture":"bubble",z=g(P,$),L=v(z,I);if(I===window&&!w(I,_?"bubble":"capture",$,R)&&y($,R)){const B=d[$];B.delete(R),B.size===0&&(window.removeEventListener($,m),d[$]=void 0)}L.has(R)&&L.delete(R),L.size===0&&z.delete(I),z.size===0&&(window.removeEventListener($,p,P==="capture"),u[P][$]=void 0)}return{on:C,off:S}}const{on:Kr,off:dr}=ZL(),Tu=Ne(null);function O$(t){if(t.clientX>0||t.clientY>0)Tu.value={x:t.clientX,y:t.clientY};else{const{target:e}=t;if(e instanceof Element){const{left:n,top:r,width:o,height:s}=e.getBoundingClientRect();n>0||r>0?Tu.value={x:n+o/2,y:r+s/2}:Tu.value={x:0,y:0}}else Tu.value=null}}let Wf=0,P$=!0;function JL(){if(!ay)return ei(Ne(null));Wf===0&&Kr("click",document,O$,!0);const t=()=>{Wf+=1};return P$&&(P$=FT())?(ml(t),Lo(()=>{Wf-=1,Wf===0&&dr("click",document,O$,!0)})):t(),ei(Tu)}const QL=Ne(void 0);let Vf=0;function M$(){QL.value=Date.now()}let L$=!0;function eB(t){if(!ay)return ei(Ne(!1));const e=Ne(!1);let n=null;function r(){n!==null&&window.clearTimeout(n)}function o(){r(),e.value=!0,n=window.setTimeout(()=>{e.value=!1},t)}Vf===0&&Kr("click",window,M$,!0);const s=()=>{Vf+=1,Kr("click",window,o,!0)};return L$&&(L$=FT())?(ml(s),Lo(()=>{Vf-=1,Vf===0&&dr("click",window,M$,!0),dr("click",window,o,!0),r()})):s(),ei(e)}function PT(t,e){return Fn(t,n=>{n!==void 0&&(e.value=n)}),Me(()=>t.value===void 0?e.value:t.value)}function MT(){const t=Ne(!1);return as(()=>{t.value=!0}),ei(t)}function ox(t,e){return Me(()=>{for(const n of e)if(t[n]!==void 0)return t[n];return t[e[e.length-1]]})}const tB=(typeof window>"u"?!1:/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!window.MSStream;function nB(){return tB}const rB="n-modal-body",LT="n-modal",oB="n-drawer-body",sB="n-popover-body";function B$(t,e,n="default"){const r=e[n];if(r===void 0)throw new Error(`[vueuc/${t}]: slot[${n}] is empty.`);return r()}const Al="@@coContext",iB={mounted(t,{value:e,modifiers:n}){t[Al]={handler:void 0},typeof e=="function"&&(t[Al].handler=e,Kr("clickoutside",t,e,{capture:n.capture}))},updated(t,{value:e,modifiers:n}){const r=t[Al];typeof e=="function"?r.handler?r.handler!==e&&(dr("clickoutside",t,r.handler,{capture:n.capture}),r.handler=e,Kr("clickoutside",t,e,{capture:n.capture})):(t[Al].handler=e,Kr("clickoutside",t,e,{capture:n.capture})):r.handler&&(dr("clickoutside",t,r.handler,{capture:n.capture}),r.handler=void 0)},unmounted(t,{modifiers:e}){const{handler:n}=t[Al];n&&dr("clickoutside",t,n,{capture:e.capture}),t[Al].handler=void 0}},aB=iB;function lB(t,e){console.error(`[vdirs/${t}]: ${e}`)}class cB{constructor(){this.elementZIndex=new Map,this.nextZIndex=2e3}get elementCount(){return this.elementZIndex.size}ensureZIndex(e,n){const{elementZIndex:r}=this;if(n!==void 0){e.style.zIndex=`${n}`,r.delete(e);return}const{nextZIndex:o}=this;r.has(e)&&r.get(e)+1===this.nextZIndex||(e.style.zIndex=`${o}`,r.set(e,o),this.nextZIndex=o+1,this.squashState())}unregister(e,n){const{elementZIndex:r}=this;r.has(e)?r.delete(e):n===void 0&&lB("z-index-manager/unregister-element","Element not found when unregistering."),this.squashState()}squashState(){const{elementCount:e}=this;e||(this.nextZIndex=2e3),this.nextZIndex-e>2500&&this.rearrange()}rearrange(){const e=Array.from(this.elementZIndex.entries());e.sort((n,r)=>n[1]-r[1]),this.nextZIndex=2e3,e.forEach(n=>{const r=n[0],o=this.nextZIndex++;`${o}`!==r.style.zIndex&&(r.style.zIndex=`${o}`)})}}const Qb=new cB,Dl="@@ziContext",uB={mounted(t,e){const{value:n={}}=e,{zIndex:r,enabled:o}=n;t[Dl]={enabled:!!o,initialized:!1},o&&(Qb.ensureZIndex(t,r),t[Dl].initialized=!0)},updated(t,e){const{value:n={}}=e,{zIndex:r,enabled:o}=n,s=t[Dl].enabled;o&&!s&&(Qb.ensureZIndex(t,r),t[Dl].initialized=!0),t[Dl].enabled=!!o},unmounted(t,e){if(!t[Dl].initialized)return;const{value:n={}}=e,{zIndex:r}=n;Qb.unregister(t,r)}},dB=uB,BT=Symbol("@css-render/vue3-ssr");function hB(t,e){return`<style cssr-id="${t}">
${e}
</style>`}function fB(t,e){const n=Kt(BT,null);if(n===null){console.error("[css-render/vue3-ssr]: no ssr context found.");return}const{styles:r,ids:o}=n;o.has(t)||r!==null&&(o.add(t),r.push(hB(t,e)))}const pB=typeof document<"u";function Fd(){if(pB)return;const t=Kt(BT,null);if(t!==null)return{adapter:fB,context:t}}function z$(t,e){console.error(`[vueuc/${t}]: ${e}`)}const{c:W$}=RT(),mB="vueuc-style";function V$(t){return typeof t=="string"?document.querySelector(t):t()}const gB=lt({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(t){return{showTeleport:HL(Bn(t,"show")),mergedTo:Me(()=>{const{to:e}=t;return e!=null?e:"body"})}},render(){return this.showTeleport?this.disabled?B$("lazy-teleport",this.$slots):W(cT,{disabled:this.disabled,to:this.mergedTo},B$("lazy-teleport",this.$slots)):null}});var Va=[],bB=function(){return Va.some(function(t){return t.activeTargets.length>0})},vB=function(){return Va.some(function(t){return t.skippedTargets.length>0})},U$="ResizeObserver loop completed with undelivered notifications.",xB=function(){var t;typeof ErrorEvent=="function"?t=new ErrorEvent("error",{message:U$}):(t=document.createEvent("Event"),t.initEvent("error",!1,!1),t.message=U$),window.dispatchEvent(t)},cd;(function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(cd||(cd={}));var Ua=function(t){return Object.freeze(t)},yB=function(){function t(e,n){this.inlineSize=e,this.blockSize=n,Ua(this)}return t}(),zT=function(){function t(e,n,r,o){return this.x=e,this.y=n,this.width=r,this.height=o,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Ua(this)}return t.prototype.toJSON=function(){var e=this,n=e.x,r=e.y,o=e.top,s=e.right,i=e.bottom,a=e.left,l=e.width,c=e.height;return{x:n,y:r,top:o,right:s,bottom:i,left:a,width:l,height:c}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),ly=function(t){return t instanceof SVGElement&&"getBBox"in t},WT=function(t){if(ly(t)){var e=t.getBBox(),n=e.width,r=e.height;return!n&&!r}var o=t,s=o.offsetWidth,i=o.offsetHeight;return!(s||i||t.getClientRects().length)},H$=function(t){var e;if(t instanceof Element)return!0;var n=(e=t==null?void 0:t.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(n&&t instanceof n.Element)},wB=function(t){switch(t.tagName){case"INPUT":if(t.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},Vu=typeof window<"u"?window:{},Uf=new WeakMap,G$=/auto|scroll/,CB=/^tb|vertical/,$B=/msie|trident/i.test(Vu.navigator&&Vu.navigator.userAgent),ms=function(t){return parseFloat(t||"0")},tc=function(t,e,n){return t===void 0&&(t=0),e===void 0&&(e=0),n===void 0&&(n=!1),new yB((n?e:t)||0,(n?t:e)||0)},j$=Ua({devicePixelContentBoxSize:tc(),borderBoxSize:tc(),contentBoxSize:tc(),contentRect:new zT(0,0,0,0)}),VT=function(t,e){if(e===void 0&&(e=!1),Uf.has(t)&&!e)return Uf.get(t);if(WT(t))return Uf.set(t,j$),j$;var n=getComputedStyle(t),r=ly(t)&&t.ownerSVGElement&&t.getBBox(),o=!$B&&n.boxSizing==="border-box",s=CB.test(n.writingMode||""),i=!r&&G$.test(n.overflowY||""),a=!r&&G$.test(n.overflowX||""),l=r?0:ms(n.paddingTop),c=r?0:ms(n.paddingRight),u=r?0:ms(n.paddingBottom),d=r?0:ms(n.paddingLeft),h=r?0:ms(n.borderTopWidth),f=r?0:ms(n.borderRightWidth),p=r?0:ms(n.borderBottomWidth),m=r?0:ms(n.borderLeftWidth),g=d+c,b=l+u,v=m+f,w=h+p,y=a?t.offsetHeight-w-t.clientHeight:0,C=i?t.offsetWidth-v-t.clientWidth:0,S=o?g+v:0,$=o?b+w:0,I=r?r.width:ms(n.width)-S-C,R=r?r.height:ms(n.height)-$-y,T=I+g+C+v,N=R+b+y+w,_=Ua({devicePixelContentBoxSize:tc(Math.round(I*devicePixelRatio),Math.round(R*devicePixelRatio),s),borderBoxSize:tc(T,N,s),contentBoxSize:tc(I,R,s),contentRect:new zT(d,l,I,R)});return Uf.set(t,_),_},UT=function(t,e,n){var r=VT(t,n),o=r.borderBoxSize,s=r.contentBoxSize,i=r.devicePixelContentBoxSize;switch(e){case cd.DEVICE_PIXEL_CONTENT_BOX:return i;case cd.BORDER_BOX:return o;default:return s}},SB=function(){function t(e){var n=VT(e);this.target=e,this.contentRect=n.contentRect,this.borderBoxSize=Ua([n.borderBoxSize]),this.contentBoxSize=Ua([n.contentBoxSize]),this.devicePixelContentBoxSize=Ua([n.devicePixelContentBoxSize])}return t}(),HT=function(t){if(WT(t))return 1/0;for(var e=0,n=t.parentNode;n;)e+=1,n=n.parentNode;return e},IB=function(){var t=1/0,e=[];Va.forEach(function(i){if(i.activeTargets.length!==0){var a=[];i.activeTargets.forEach(function(c){var u=new SB(c.target),d=HT(c.target);a.push(u),c.lastReportedSize=UT(c.target,c.observedBox),d<t&&(t=d)}),e.push(function(){i.callback.call(i.observer,a,i.observer)}),i.activeTargets.splice(0,i.activeTargets.length)}});for(var n=0,r=e;n<r.length;n++){var o=r[n];o()}return t},K$=function(t){Va.forEach(function(n){n.activeTargets.splice(0,n.activeTargets.length),n.skippedTargets.splice(0,n.skippedTargets.length),n.observationTargets.forEach(function(o){o.isActive()&&(HT(o.target)>t?n.activeTargets.push(o):n.skippedTargets.push(o))})})},kB=function(){var t=0;for(K$(t);bB();)t=IB(),K$(t);return vB()&&xB(),t>0},ev,GT=[],TB=function(){return GT.splice(0).forEach(function(t){return t()})},EB=function(t){if(!ev){var e=0,n=document.createTextNode(""),r={characterData:!0};new MutationObserver(function(){return TB()}).observe(n,r),ev=function(){n.textContent="".concat(e?e--:e++)}}GT.push(t),ev()},RB=function(t){EB(function(){requestAnimationFrame(t)})},gp=0,NB=function(){return!!gp},_B=250,AB={attributes:!0,characterData:!0,childList:!0,subtree:!0},q$=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],X$=function(t){return t===void 0&&(t=0),Date.now()+t},tv=!1,DB=function(){function t(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return t.prototype.run=function(e){var n=this;if(e===void 0&&(e=_B),!tv){tv=!0;var r=X$(e);RB(function(){var o=!1;try{o=kB()}finally{if(tv=!1,e=r-X$(),!NB())return;o?n.run(1e3):e>0?n.run(e):n.start()}})}},t.prototype.schedule=function(){this.stop(),this.run()},t.prototype.observe=function(){var e=this,n=function(){return e.observer&&e.observer.observe(document.body,AB)};document.body?n():Vu.addEventListener("DOMContentLoaded",n)},t.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),q$.forEach(function(n){return Vu.addEventListener(n,e.listener,!0)}))},t.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),q$.forEach(function(n){return Vu.removeEventListener(n,e.listener,!0)}),this.stopped=!0)},t}(),sx=new DB,Y$=function(t){!gp&&t>0&&sx.start(),gp+=t,!gp&&sx.stop()},FB=function(t){return!ly(t)&&!wB(t)&&getComputedStyle(t).display==="inline"},OB=function(){function t(e,n){this.target=e,this.observedBox=n||cd.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){var e=UT(this.target,this.observedBox,!0);return FB(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},t}(),PB=function(){function t(e,n){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=n}return t}(),Hf=new WeakMap,Z$=function(t,e){for(var n=0;n<t.length;n+=1)if(t[n].target===e)return n;return-1},Gf=function(){function t(){}return t.connect=function(e,n){var r=new PB(e,n);Hf.set(e,r)},t.observe=function(e,n,r){var o=Hf.get(e),s=o.observationTargets.length===0;Z$(o.observationTargets,n)<0&&(s&&Va.push(o),o.observationTargets.push(new OB(n,r&&r.box)),Y$(1),sx.schedule())},t.unobserve=function(e,n){var r=Hf.get(e),o=Z$(r.observationTargets,n),s=r.observationTargets.length===1;o>=0&&(s&&Va.splice(Va.indexOf(r),1),r.observationTargets.splice(o,1),Y$(-1))},t.disconnect=function(e){var n=this,r=Hf.get(e);r.observationTargets.slice().forEach(function(o){return n.unobserve(e,o.target)}),r.activeTargets.splice(0,r.activeTargets.length)},t}(),MB=function(){function t(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Gf.connect(this,e)}return t.prototype.observe=function(e,n){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!H$(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Gf.observe(this,e,n)},t.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!H$(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Gf.unobserve(this,e)},t.prototype.disconnect=function(){Gf.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}();class LB{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new MB(this.handleResize),this.elHandlersMap=new Map}handleResize(e){for(const n of e){const r=this.elHandlersMap.get(n.target);r!==void 0&&r(n)}}registerHandler(e,n){this.elHandlersMap.set(e,n),this.observer.observe(e)}unregisterHandler(e){!this.elHandlersMap.has(e)||(this.elHandlersMap.delete(e),this.observer.unobserve(e))}}const J$=new LB,ud=lt({name:"ResizeObserver",props:{onResize:Function},setup(t){let e=!1;const n=Pc().proxy;function r(o){const{onResize:s}=t;s!==void 0&&s(o)}as(()=>{const o=n.$el;if(o===void 0){z$("resize-observer","$el does not exist.");return}if(o.nextElementSibling!==o.nextSibling&&o.nodeType===3&&o.nodeValue!==""){z$("resize-observer","$el can not be observed (it may be a text node).");return}o.nextElementSibling!==null&&(J$.registerHandler(o.nextElementSibling,r),e=!0)}),Lo(()=>{e&&J$.unregisterHandler(n.$el.nextElementSibling)})},render(){return Y3(this.$slots,"default")}}),BB=W$(".v-x-scroll",{overflow:"auto",scrollbarWidth:"none"},[W$("&::-webkit-scrollbar",{width:0,height:0})]),zB=lt({name:"XScroll",props:{disabled:Boolean,onScroll:Function},setup(){const t=Ne(null);function e(o){!(o.currentTarget.offsetWidth<o.currentTarget.scrollWidth)||o.deltaY===0||(o.currentTarget.scrollLeft+=o.deltaY+o.deltaX,o.preventDefault())}const n=Fd();return BB.mount({id:"vueuc/x-scroll",head:!0,anchorMetaName:mB,ssr:n}),Object.assign({selfRef:t,handleWheel:e},{scrollTo(...o){var s;(s=t.value)===null||s===void 0||s.scrollTo(...o)}})},render(){return W("div",{ref:"selfRef",onScroll:this.onScroll,onWheel:this.disabled?void 0:this.handleWheel,class:"v-x-scroll"},this.$slots)}});function jT(t){return t instanceof HTMLElement}function KT(t){for(let e=0;e<t.childNodes.length;e++){const n=t.childNodes[e];if(jT(n)&&(XT(n)||KT(n)))return!0}return!1}function qT(t){for(let e=t.childNodes.length-1;e>=0;e--){const n=t.childNodes[e];if(jT(n)&&(XT(n)||qT(n)))return!0}return!1}function XT(t){if(!WB(t))return!1;try{t.focus({preventScroll:!0})}catch{}return document.activeElement===t}function WB(t){if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.getAttribute("disabled"))return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return t.type!=="hidden"&&t.type!=="file";case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}let gu=[];const VB=lt({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(t){const e=$T(),n=Ne(null),r=Ne(null);let o=!1,s=!1;const i=typeof document>"u"?null:document.activeElement;function a(){return gu[gu.length-1]===e}function l(g){var b;g.code==="Escape"&&a()&&((b=t.onEsc)===null||b===void 0||b.call(t,g))}as(()=>{Fn(()=>t.active,g=>{g?(d(),Kr("keydown",document,l)):(dr("keydown",document,l),o&&h())},{immediate:!0})}),Lo(()=>{dr("keydown",document,l),o&&h()});function c(g){if(!s&&a()){const b=u();if(b===null||b.contains(oy(g)))return;f("first")}}function u(){const g=n.value;if(g===null)return null;let b=g;for(;b=b.nextSibling,!(b===null||b instanceof Element&&b.tagName==="DIV"););return b}function d(){var g;if(!t.disabled){if(gu.push(e),t.autoFocus){const{initialFocusTo:b}=t;b===void 0?f("first"):(g=V$(b))===null||g===void 0||g.focus({preventScroll:!0})}o=!0,document.addEventListener("focus",c,!0)}}function h(){var g;if(t.disabled||(document.removeEventListener("focus",c,!0),gu=gu.filter(v=>v!==e),a()))return;const{finalFocusTo:b}=t;b!==void 0?(g=V$(b))===null||g===void 0||g.focus({preventScroll:!0}):t.returnFocusOnDeactivated&&i instanceof HTMLElement&&(s=!0,i.focus({preventScroll:!0}),s=!1)}function f(g){if(!!a()&&t.active){const b=n.value,v=r.value;if(b!==null&&v!==null){const w=u();if(w==null||w===v){s=!0,b.focus({preventScroll:!0}),s=!1;return}s=!0;const y=g==="first"?KT(w):qT(w);s=!1,y||(s=!0,b.focus({preventScroll:!0}),s=!1)}}}function p(g){if(s)return;const b=u();b!==null&&(g.relatedTarget!==null&&b.contains(g.relatedTarget)?f("last"):f("first"))}function m(g){s||(g.relatedTarget!==null&&g.relatedTarget===n.value?f("last"):f("first"))}return{focusableStartRef:n,focusableEndRef:r,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:p,handleEndFocus:m}},render(){const{default:t}=this.$slots;if(t===void 0)return null;if(this.disabled)return t();const{active:e,focusableStyle:n}=this;return W(fn,null,[W("div",{"aria-hidden":"true",tabindex:e?"0":"-1",ref:"focusableStartRef",style:n,onFocus:this.handleStartFocus}),t(),W("div",{"aria-hidden":"true",style:n,ref:"focusableEndRef",tabindex:e?"0":"-1",onFocus:this.handleEndFocus})])}});let Fl=0,Q$="",eS="",tS="",nS="";const rS=Ne("0px");function UB(t){if(typeof document>"u")return;const e=document.documentElement;let n,r=!1;const o=()=>{e.style.marginRight=Q$,e.style.overflow=eS,e.style.overflowX=tS,e.style.overflowY=nS,rS.value="0px"};as(()=>{n=Fn(t,s=>{if(s){if(!Fl){const i=window.innerWidth-e.offsetWidth;i>0&&(Q$=e.style.marginRight,e.style.marginRight=`${i}px`,rS.value=`${i}px`),eS=e.style.overflow,tS=e.style.overflowX,nS=e.style.overflowY,e.style.overflow="hidden",e.style.overflowX="hidden",e.style.overflowY="hidden"}r=!0,Fl++}else Fl--,Fl||o(),r=!1},{immediate:!0})}),Lo(()=>{n==null||n(),r&&(Fl--,Fl||o(),r=!1)})}const cy=Ne(!1),oS=()=>{cy.value=!0},sS=()=>{cy.value=!1};let bu=0;const HB=()=>(Bc&&(ml(()=>{bu||(window.addEventListener("compositionstart",oS),window.addEventListener("compositionend",sS)),bu++}),Lo(()=>{bu<=1?(window.removeEventListener("compositionstart",oS),window.removeEventListener("compositionend",sS),bu=0):bu--})),cy);function YT(t){const e={isDeactivated:!1};let n=!1;return q2(()=>{if(e.isDeactivated=!1,!n){n=!0;return}t()}),X2(()=>{e.isDeactivated=!0,n||(n=!0)}),e}const iS="n-form-item";function ZT(t,{defaultSize:e="medium",mergedSize:n,mergedDisabled:r}={}){const o=Kt(iS,null);Yr(iS,null);const s=Me(n?()=>n(o):()=>{const{size:l}=t;if(l)return l;if(o){const{mergedSize:c}=o;if(c.value!==void 0)return c.value}return e}),i=Me(r?()=>r(o):()=>{const{disabled:l}=t;return l!==void 0?l:o?o.disabled.value:!1}),a=Me(()=>{const{status:l}=t;return l||(o==null?void 0:o.mergedValidationStatus.value)});return Lo(()=>{o&&o.restoreValidation()}),{mergedSizeRef:s,mergedDisabledRef:i,mergedStatusRef:a,nTriggerFormBlur(){o&&o.handleContentBlur()},nTriggerFormChange(){o&&o.handleContentChange()},nTriggerFormFocus(){o&&o.handleContentFocus()},nTriggerFormInput(){o&&o.handleContentInput()}}}var GB=typeof global=="object"&&global&&global.Object===Object&&global;const JT=GB;var jB=typeof self=="object"&&self&&self.Object===Object&&self,KB=JT||jB||Function("return this")();const gl=KB;var qB=gl.Symbol;const pc=qB;var QT=Object.prototype,XB=QT.hasOwnProperty,YB=QT.toString,vu=pc?pc.toStringTag:void 0;function ZB(t){var e=XB.call(t,vu),n=t[vu];try{t[vu]=void 0;var r=!0}catch{}var o=YB.call(t);return r&&(e?t[vu]=n:delete t[vu]),o}var JB=Object.prototype,QB=JB.toString;function ez(t){return QB.call(t)}var tz="[object Null]",nz="[object Undefined]",aS=pc?pc.toStringTag:void 0;function Od(t){return t==null?t===void 0?nz:tz:aS&&aS in Object(t)?ZB(t):ez(t)}function zc(t){return t!=null&&typeof t=="object"}var rz="[object Symbol]";function eE(t){return typeof t=="symbol"||zc(t)&&Od(t)==rz}function oz(t,e){for(var n=-1,r=t==null?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}var sz=Array.isArray;const Ap=sz;var iz=1/0,lS=pc?pc.prototype:void 0,cS=lS?lS.toString:void 0;function tE(t){if(typeof t=="string")return t;if(Ap(t))return oz(t,tE)+"";if(eE(t))return cS?cS.call(t):"";var e=t+"";return e=="0"&&1/t==-iz?"-0":e}var az=/\s/;function lz(t){for(var e=t.length;e--&&az.test(t.charAt(e)););return e}var cz=/^\s+/;function uz(t){return t&&t.slice(0,lz(t)+1).replace(cz,"")}function ns(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var uS=0/0,dz=/^[-+]0x[0-9a-f]+$/i,hz=/^0b[01]+$/i,fz=/^0o[0-7]+$/i,pz=parseInt;function dS(t){if(typeof t=="number")return t;if(eE(t))return uS;if(ns(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ns(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=uz(t);var n=hz.test(t);return n||fz.test(t)?pz(t.slice(2),n?2:8):dz.test(t)?uS:+t}function nE(t){return t}var mz="[object AsyncFunction]",gz="[object Function]",bz="[object GeneratorFunction]",vz="[object Proxy]";function uy(t){if(!ns(t))return!1;var e=Od(t);return e==gz||e==bz||e==mz||e==vz}var xz=gl["__core-js_shared__"];const nv=xz;var hS=function(){var t=/[^.]+$/.exec(nv&&nv.keys&&nv.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function yz(t){return!!hS&&hS in t}var wz=Function.prototype,Cz=wz.toString;function $z(t){if(t!=null){try{return Cz.call(t)}catch{}try{return t+""}catch{}}return""}var Sz=/[\\^$.*+?()[\]{}|]/g,Iz=/^\[object .+?Constructor\]$/,kz=Function.prototype,Tz=Object.prototype,Ez=kz.toString,Rz=Tz.hasOwnProperty,Nz=RegExp("^"+Ez.call(Rz).replace(Sz,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _z(t){if(!ns(t)||yz(t))return!1;var e=uy(t)?Nz:Iz;return e.test($z(t))}function Az(t,e){return t==null?void 0:t[e]}function dy(t,e){var n=Az(t,e);return _z(n)?n:void 0}var fS=Object.create,Dz=function(){function t(){}return function(e){if(!ns(e))return{};if(fS)return fS(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();const Fz=Dz;function Oz(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Pz(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var Mz=800,Lz=16,Bz=Date.now;function zz(t){var e=0,n=0;return function(){var r=Bz(),o=Lz-(r-n);if(n=r,o>0){if(++e>=Mz)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Wz(t){return function(){return t}}var Vz=function(){try{var t=dy(Object,"defineProperty");return t({},"",{}),t}catch{}}();const Dp=Vz;var Uz=Dp?function(t,e){return Dp(t,"toString",{configurable:!0,enumerable:!1,value:Wz(e),writable:!0})}:nE;const Hz=Uz;var Gz=zz(Hz);const jz=Gz;var Kz=9007199254740991,qz=/^(?:0|[1-9]\d*)$/;function rE(t,e){var n=typeof t;return e=e==null?Kz:e,!!e&&(n=="number"||n!="symbol"&&qz.test(t))&&t>-1&&t%1==0&&t<e}function hy(t,e,n){e=="__proto__"&&Dp?Dp(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Fm(t,e){return t===e||t!==t&&e!==e}var Xz=Object.prototype,Yz=Xz.hasOwnProperty;function Zz(t,e,n){var r=t[e];(!(Yz.call(t,e)&&Fm(r,n))||n===void 0&&!(e in t))&&hy(t,e,n)}function Jz(t,e,n,r){var o=!n;n||(n={});for(var s=-1,i=e.length;++s<i;){var a=e[s],l=r?r(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),o?hy(n,a,l):Zz(n,a,l)}return n}var pS=Math.max;function Qz(t,e,n){return e=pS(e===void 0?t.length-1:e,0),function(){for(var r=arguments,o=-1,s=pS(r.length-e,0),i=Array(s);++o<s;)i[o]=r[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=r[o];return a[e]=n(i),Oz(t,this,a)}}function e4(t,e){return jz(Qz(t,e,nE),t+"")}var t4=9007199254740991;function oE(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=t4}function fy(t){return t!=null&&oE(t.length)&&!uy(t)}function n4(t,e,n){if(!ns(n))return!1;var r=typeof e;return(r=="number"?fy(n)&&rE(e,n.length):r=="string"&&e in n)?Fm(n[e],t):!1}function r4(t){return e4(function(e,n){var r=-1,o=n.length,s=o>1?n[o-1]:void 0,i=o>2?n[2]:void 0;for(s=t.length>3&&typeof s=="function"?(o--,s):void 0,i&&n4(n[0],n[1],i)&&(s=o<3?void 0:s,o=1),e=Object(e);++r<o;){var a=n[r];a&&t(e,a,r,s)}return e})}var o4=Object.prototype;function sE(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||o4;return t===n}function s4(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var i4="[object Arguments]";function mS(t){return zc(t)&&Od(t)==i4}var iE=Object.prototype,a4=iE.hasOwnProperty,l4=iE.propertyIsEnumerable,c4=mS(function(){return arguments}())?mS:function(t){return zc(t)&&a4.call(t,"callee")&&!l4.call(t,"callee")};const ix=c4;function u4(){return!1}var aE=typeof co=="object"&&co&&!co.nodeType&&co,gS=aE&&typeof uo=="object"&&uo&&!uo.nodeType&&uo,d4=gS&&gS.exports===aE,bS=d4?gl.Buffer:void 0,h4=bS?bS.isBuffer:void 0,f4=h4||u4;const lE=f4;var p4="[object Arguments]",m4="[object Array]",g4="[object Boolean]",b4="[object Date]",v4="[object Error]",x4="[object Function]",y4="[object Map]",w4="[object Number]",C4="[object Object]",$4="[object RegExp]",S4="[object Set]",I4="[object String]",k4="[object WeakMap]",T4="[object ArrayBuffer]",E4="[object DataView]",R4="[object Float32Array]",N4="[object Float64Array]",_4="[object Int8Array]",A4="[object Int16Array]",D4="[object Int32Array]",F4="[object Uint8Array]",O4="[object Uint8ClampedArray]",P4="[object Uint16Array]",M4="[object Uint32Array]",un={};un[R4]=un[N4]=un[_4]=un[A4]=un[D4]=un[F4]=un[O4]=un[P4]=un[M4]=!0;un[p4]=un[m4]=un[T4]=un[g4]=un[E4]=un[b4]=un[v4]=un[x4]=un[y4]=un[w4]=un[C4]=un[$4]=un[S4]=un[I4]=un[k4]=!1;function L4(t){return zc(t)&&oE(t.length)&&!!un[Od(t)]}function B4(t){return function(e){return t(e)}}var cE=typeof co=="object"&&co&&!co.nodeType&&co,Uu=cE&&typeof uo=="object"&&uo&&!uo.nodeType&&uo,z4=Uu&&Uu.exports===cE,rv=z4&&JT.process,W4=function(){try{var t=Uu&&Uu.require&&Uu.require("util").types;return t||rv&&rv.binding&&rv.binding("util")}catch{}}();const vS=W4;var xS=vS&&vS.isTypedArray,V4=xS?B4(xS):L4;const uE=V4;var U4=Object.prototype,H4=U4.hasOwnProperty;function G4(t,e){var n=Ap(t),r=!n&&ix(t),o=!n&&!r&&lE(t),s=!n&&!r&&!o&&uE(t),i=n||r||o||s,a=i?s4(t.length,String):[],l=a.length;for(var c in t)(e||H4.call(t,c))&&!(i&&(c=="length"||o&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||rE(c,l)))&&a.push(c);return a}function j4(t,e){return function(n){return t(e(n))}}function K4(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var q4=Object.prototype,X4=q4.hasOwnProperty;function Y4(t){if(!ns(t))return K4(t);var e=sE(t),n=[];for(var r in t)r=="constructor"&&(e||!X4.call(t,r))||n.push(r);return n}function dE(t){return fy(t)?G4(t,!0):Y4(t)}var Z4=dy(Object,"create");const dd=Z4;function J4(){this.__data__=dd?dd(null):{},this.size=0}function Q4(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var eW="__lodash_hash_undefined__",tW=Object.prototype,nW=tW.hasOwnProperty;function rW(t){var e=this.__data__;if(dd){var n=e[t];return n===eW?void 0:n}return nW.call(e,t)?e[t]:void 0}var oW=Object.prototype,sW=oW.hasOwnProperty;function iW(t){var e=this.__data__;return dd?e[t]!==void 0:sW.call(e,t)}var aW="__lodash_hash_undefined__";function lW(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=dd&&e===void 0?aW:e,this}function Za(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Za.prototype.clear=J4;Za.prototype.delete=Q4;Za.prototype.get=rW;Za.prototype.has=iW;Za.prototype.set=lW;function cW(){this.__data__=[],this.size=0}function Om(t,e){for(var n=t.length;n--;)if(Fm(t[n][0],e))return n;return-1}var uW=Array.prototype,dW=uW.splice;function hW(t){var e=this.__data__,n=Om(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():dW.call(e,n,1),--this.size,!0}function fW(t){var e=this.__data__,n=Om(e,t);return n<0?void 0:e[n][1]}function pW(t){return Om(this.__data__,t)>-1}function mW(t,e){var n=this.__data__,r=Om(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function ii(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ii.prototype.clear=cW;ii.prototype.delete=hW;ii.prototype.get=fW;ii.prototype.has=pW;ii.prototype.set=mW;var gW=dy(gl,"Map");const hE=gW;function bW(){this.size=0,this.__data__={hash:new Za,map:new(hE||ii),string:new Za}}function vW(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Pm(t,e){var n=t.__data__;return vW(e)?n[typeof e=="string"?"string":"hash"]:n.map}function xW(t){var e=Pm(this,t).delete(t);return this.size-=e?1:0,e}function yW(t){return Pm(this,t).get(t)}function wW(t){return Pm(this,t).has(t)}function CW(t,e){var n=Pm(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Wc(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Wc.prototype.clear=bW;Wc.prototype.delete=xW;Wc.prototype.get=yW;Wc.prototype.has=wW;Wc.prototype.set=CW;function $W(t){return t==null?"":tE(t)}var SW=j4(Object.getPrototypeOf,Object);const fE=SW;var IW="[object Object]",kW=Function.prototype,TW=Object.prototype,pE=kW.toString,EW=TW.hasOwnProperty,RW=pE.call(Object);function NW(t){if(!zc(t)||Od(t)!=IW)return!1;var e=fE(t);if(e===null)return!0;var n=EW.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&pE.call(n)==RW}function _W(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),n=n>o?o:n,n<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(o);++r<o;)s[r]=t[r+e];return s}function AW(t,e,n){var r=t.length;return n=n===void 0?r:n,!e&&n>=r?t:_W(t,e,n)}var DW="\\ud800-\\udfff",FW="\\u0300-\\u036f",OW="\\ufe20-\\ufe2f",PW="\\u20d0-\\u20ff",MW=FW+OW+PW,LW="\\ufe0e\\ufe0f",BW="\\u200d",zW=RegExp("["+BW+DW+MW+LW+"]");function mE(t){return zW.test(t)}function WW(t){return t.split("")}var gE="\\ud800-\\udfff",VW="\\u0300-\\u036f",UW="\\ufe20-\\ufe2f",HW="\\u20d0-\\u20ff",GW=VW+UW+HW,jW="\\ufe0e\\ufe0f",KW="["+gE+"]",ax="["+GW+"]",lx="\\ud83c[\\udffb-\\udfff]",qW="(?:"+ax+"|"+lx+")",bE="[^"+gE+"]",vE="(?:\\ud83c[\\udde6-\\uddff]){2}",xE="[\\ud800-\\udbff][\\udc00-\\udfff]",XW="\\u200d",yE=qW+"?",wE="["+jW+"]?",YW="(?:"+XW+"(?:"+[bE,vE,xE].join("|")+")"+wE+yE+")*",ZW=wE+yE+YW,JW="(?:"+[bE+ax+"?",ax,vE,xE,KW].join("|")+")",QW=RegExp(lx+"(?="+lx+")|"+JW+ZW,"g");function eV(t){return t.match(QW)||[]}function tV(t){return mE(t)?eV(t):WW(t)}function nV(t){return function(e){e=$W(e);var n=mE(e)?tV(e):void 0,r=n?n[0]:e.charAt(0),o=n?AW(n,1).join(""):e.slice(1);return r[t]()+o}}var rV=nV("toUpperCase");const oV=rV;function sV(){this.__data__=new ii,this.size=0}function iV(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function aV(t){return this.__data__.get(t)}function lV(t){return this.__data__.has(t)}var cV=200;function uV(t,e){var n=this.__data__;if(n instanceof ii){var r=n.__data__;if(!hE||r.length<cV-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Wc(r)}return n.set(t,e),this.size=n.size,this}function Vc(t){var e=this.__data__=new ii(t);this.size=e.size}Vc.prototype.clear=sV;Vc.prototype.delete=iV;Vc.prototype.get=aV;Vc.prototype.has=lV;Vc.prototype.set=uV;var CE=typeof co=="object"&&co&&!co.nodeType&&co,yS=CE&&typeof uo=="object"&&uo&&!uo.nodeType&&uo,dV=yS&&yS.exports===CE,wS=dV?gl.Buffer:void 0,CS=wS?wS.allocUnsafe:void 0;function hV(t,e){if(e)return t.slice();var n=t.length,r=CS?CS(n):new t.constructor(n);return t.copy(r),r}var fV=gl.Uint8Array;const $S=fV;function pV(t){var e=new t.constructor(t.byteLength);return new $S(e).set(new $S(t)),e}function mV(t,e){var n=e?pV(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function gV(t){return typeof t.constructor=="function"&&!sE(t)?Fz(fE(t)):{}}function bV(t){return function(e,n,r){for(var o=-1,s=Object(e),i=r(e),a=i.length;a--;){var l=i[t?a:++o];if(n(s[l],l,s)===!1)break}return e}}var vV=bV();const xV=vV;var yV=function(){return gl.Date.now()};const ov=yV;var wV="Expected a function",CV=Math.max,$V=Math.min;function SV(t,e,n){var r,o,s,i,a,l,c=0,u=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(wV);e=dS(e)||0,ns(n)&&(u=!!n.leading,d="maxWait"in n,s=d?CV(dS(n.maxWait)||0,e):s,h="trailing"in n?!!n.trailing:h);function f(S){var $=r,I=o;return r=o=void 0,c=S,i=t.apply(I,$),i}function p(S){return c=S,a=setTimeout(b,e),u?f(S):i}function m(S){var $=S-l,I=S-c,R=e-$;return d?$V(R,s-I):R}function g(S){var $=S-l,I=S-c;return l===void 0||$>=e||$<0||d&&I>=s}function b(){var S=ov();if(g(S))return v(S);a=setTimeout(b,m(S))}function v(S){return a=void 0,h&&r?f(S):(r=o=void 0,i)}function w(){a!==void 0&&clearTimeout(a),c=0,r=l=o=a=void 0}function y(){return a===void 0?i:v(ov())}function C(){var S=ov(),$=g(S);if(r=arguments,o=this,l=S,$){if(a===void 0)return p(l);if(d)return clearTimeout(a),a=setTimeout(b,e),f(l)}return a===void 0&&(a=setTimeout(b,e)),i}return C.cancel=w,C.flush=y,C}function cx(t,e,n){(n!==void 0&&!Fm(t[e],n)||n===void 0&&!(e in t))&&hy(t,e,n)}function IV(t){return zc(t)&&fy(t)}function ux(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function kV(t){return Jz(t,dE(t))}function TV(t,e,n,r,o,s,i){var a=ux(t,n),l=ux(e,n),c=i.get(l);if(c){cx(t,n,c);return}var u=s?s(a,l,n+"",t,e,i):void 0,d=u===void 0;if(d){var h=Ap(l),f=!h&&lE(l),p=!h&&!f&&uE(l);u=l,h||f||p?Ap(a)?u=a:IV(a)?u=Pz(a):f?(d=!1,u=hV(l,!0)):p?(d=!1,u=mV(l,!0)):u=[]:NW(l)||ix(l)?(u=a,ix(a)?u=kV(a):(!ns(a)||uy(a))&&(u=gV(l))):d=!1}d&&(i.set(l,u),o(u,l,r,s,i),i.delete(l)),cx(t,n,u)}function $E(t,e,n,r,o){t!==e&&xV(e,function(s,i){if(o||(o=new Vc),ns(s))TV(t,e,i,n,$E,r,o);else{var a=r?r(ux(t,i),s,i+"",t,e,o):void 0;a===void 0&&(a=s),cx(t,i,a)}},dE)}var EV=r4(function(t,e,n){$E(t,e,n)});const jf=EV;var RV="Expected a function";function sv(t,e,n){var r=!0,o=!0;if(typeof t!="function")throw new TypeError(RV);return ns(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),SV(t,e,{leading:r,maxWait:e,trailing:o})}const bl={fontFamily:'v-sans, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontFamilyMono:"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace",fontWeight:"400",fontWeightStrong:"500",cubicBezierEaseInOut:"cubic-bezier(.4, 0, .2, 1)",cubicBezierEaseOut:"cubic-bezier(0, 0, .2, 1)",cubicBezierEaseIn:"cubic-bezier(.4, 0, 1, 1)",borderRadius:"3px",borderRadiusSmall:"2px",fontSize:"14px",fontSizeMini:"12px",fontSizeTiny:"12px",fontSizeSmall:"14px",fontSizeMedium:"14px",fontSizeLarge:"15px",fontSizeHuge:"16px",lineHeight:"1.6",heightMini:"16px",heightTiny:"22px",heightSmall:"28px",heightMedium:"34px",heightLarge:"40px",heightHuge:"46px"},{fontSize:NV,fontFamily:_V,lineHeight:AV}=bl,SE=$e("body",`
 margin: 0;
 font-size: ${NV};
 font-family: ${_V};
 line-height: ${AV};
 -webkit-text-size-adjust: 100%;
 -webkit-tap-highlight-color: transparent;
`,[$e("input",`
 font-family: inherit;
 font-size: inherit;
 `)]),Uc="n-config-provider",hd="naive-ui-style";function Ut(t,e,n,r,o,s){const i=Fd(),a=Kt(Uc,null);if(n){const c=()=>{const u=s==null?void 0:s.value;n.mount({id:u===void 0?e:u+e,head:!0,props:{bPrefix:u?`.${u}-`:void 0},anchorMetaName:hd,ssr:i}),a!=null&&a.preflightStyleDisabled||SE.mount({id:"n-global",head:!0,anchorMetaName:hd,ssr:i})};i?c():ml(c)}return Me(()=>{var c;const{theme:{common:u,self:d,peers:h={}}={},themeOverrides:f={},builtinThemeOverrides:p={}}=o,{common:m,peers:g}=f,{common:b=void 0,[t]:{common:v=void 0,self:w=void 0,peers:y={}}={}}=(a==null?void 0:a.mergedThemeRef.value)||{},{common:C=void 0,[t]:S={}}=(a==null?void 0:a.mergedThemeOverridesRef.value)||{},{common:$,peers:I={}}=S,R=jf({},u||v||b||r.common,C,$,m),T=jf((c=d||w||r.self)===null||c===void 0?void 0:c(R),p,S,f);return{common:R,self:T,peers:jf({},r.peers,y,h),peerOverrides:jf({},p.peers,I,g)}})}Ut.props={theme:Object,themeOverrides:Object,builtinThemeOverrides:Object};const DV="n";function Mr(t={},e={defaultBordered:!0}){const n=Kt(Uc,null);return{inlineThemeDisabled:n==null?void 0:n.inlineThemeDisabled,mergedRtlRef:n==null?void 0:n.mergedRtlRef,mergedComponentPropsRef:n==null?void 0:n.mergedComponentPropsRef,mergedBreakpointsRef:n==null?void 0:n.mergedBreakpointsRef,mergedBorderedRef:Me(()=>{var r,o;const{bordered:s}=t;return s!==void 0?s:(o=(r=n==null?void 0:n.mergedBorderedRef.value)!==null&&r!==void 0?r:e.defaultBordered)!==null&&o!==void 0?o:!0}),mergedClsPrefixRef:Me(()=>(n==null?void 0:n.mergedClsPrefixRef.value)||DV),namespaceRef:Me(()=>n==null?void 0:n.mergedNamespaceRef.value)}}const FV={name:"en-US",global:{undo:"Undo",redo:"Redo",confirm:"Confirm",clear:"Clear"},Popconfirm:{positiveText:"Confirm",negativeText:"Cancel"},Cascader:{placeholder:"Please Select",loading:"Loading",loadingRequiredMessage:t=>`Please load all ${t}'s descendants before checking it.`},Time:{dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss"},DatePicker:{yearFormat:"yyyy",monthFormat:"MMM",dayFormat:"eeeeee",yearTypeFormat:"yyyy",monthTypeFormat:"yyyy-MM",dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss",quarterFormat:"yyyy-qqq",clear:"Clear",now:"Now",confirm:"Confirm",selectTime:"Select Time",selectDate:"Select Date",datePlaceholder:"Select Date",datetimePlaceholder:"Select Date and Time",monthPlaceholder:"Select Month",yearPlaceholder:"Select Year",quarterPlaceholder:"Select Quarter",startDatePlaceholder:"Start Date",endDatePlaceholder:"End Date",startDatetimePlaceholder:"Start Date and Time",endDatetimePlaceholder:"End Date and Time",startMonthPlaceholder:"Start Month",endMonthPlaceholder:"End Month",monthBeforeYear:!0,firstDayOfWeek:6,today:"Today"},DataTable:{checkTableAll:"Select all in the table",uncheckTableAll:"Unselect all in the table",confirm:"Confirm",clear:"Clear"},LegacyTransfer:{sourceTitle:"Source",targetTitle:"Target"},Transfer:{selectAll:"Select all",unselectAll:"Unselect all",clearAll:"Clear",total:t=>`Total ${t} items`,selected:t=>`${t} items selected`},Empty:{description:"No Data"},Select:{placeholder:"Please Select"},TimePicker:{placeholder:"Select Time",positiveText:"OK",negativeText:"Cancel",now:"Now"},Pagination:{goto:"Goto",selectionSuffix:"page"},DynamicTags:{add:"Add"},Log:{loading:"Loading"},Input:{placeholder:"Please Input"},InputNumber:{placeholder:"Please Input"},DynamicInput:{create:"Create"},ThemeEditor:{title:"Theme Editor",clearAllVars:"Clear All Variables",clearSearch:"Clear Search",filterCompName:"Filter Component Name",filterVarName:"Filter Variable Name",import:"Import",export:"Export",restore:"Reset to Default"},Image:{tipPrevious:"Previous picture (\u2190)",tipNext:"Next picture (\u2192)",tipCounterclockwise:"Counterclockwise",tipClockwise:"Clockwise",tipZoomOut:"Zoom out",tipZoomIn:"Zoom in",tipClose:"Close (Esc)",tipOriginalSize:"Zoom to original size"}},OV=FV;function iv(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.width?String(e.width):t.defaultWidth,r=t.formats[n]||t.formats[t.defaultWidth];return r}}function xu(t){return function(e,n){var r=n!=null&&n.context?String(n.context):"standalone",o;if(r==="formatting"&&t.formattingValues){var s=t.defaultFormattingWidth||t.defaultWidth,i=n!=null&&n.width?String(n.width):s;o=t.formattingValues[i]||t.formattingValues[s]}else{var a=t.defaultWidth,l=n!=null&&n.width?String(n.width):t.defaultWidth;o=t.values[l]||t.values[a]}var c=t.argumentCallback?t.argumentCallback(e):e;return o[c]}}function yu(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.width,o=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],s=e.match(o);if(!s)return null;var i=s[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?MV(a,function(d){return d.test(i)}):PV(a,function(d){return d.test(i)}),c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;var u=e.slice(i.length);return{value:c,rest:u}}}function PV(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e(t[n]))return n}function MV(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n}function LV(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.match(t.matchPattern);if(!r)return null;var o=r[0],s=e.match(t.parsePattern);if(!s)return null;var i=t.valueCallback?t.valueCallback(s[0]):s[0];i=n.valueCallback?n.valueCallback(i):i;var a=e.slice(o.length);return{value:i,rest:a}}}var BV={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},zV=function(e,n,r){var o,s=BV[e];return typeof s=="string"?o=s:n===1?o=s.one:o=s.other.replace("{{count}}",n.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+o:o+" ago":o};const WV=zV;var VV={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},UV={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},HV={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},GV={date:iv({formats:VV,defaultWidth:"full"}),time:iv({formats:UV,defaultWidth:"full"}),dateTime:iv({formats:HV,defaultWidth:"full"})};const jV=GV;var KV={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},qV=function(e,n,r,o){return KV[e]};const XV=qV;var YV={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ZV={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},JV={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},QV={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},nU=function(e,n){var r=Number(e),o=r%100;if(o>20||o<10)switch(o%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},rU={ordinalNumber:nU,era:xu({values:YV,defaultWidth:"wide"}),quarter:xu({values:ZV,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:xu({values:JV,defaultWidth:"wide"}),day:xu({values:QV,defaultWidth:"wide"}),dayPeriod:xu({values:eU,defaultWidth:"wide",formattingValues:tU,defaultFormattingWidth:"wide"})};const oU=rU;var sU=/^(\d+)(th|st|nd|rd)?/i,iU=/\d+/i,aU={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},lU={any:[/^b/i,/^(a|c)/i]},cU={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},uU={any:[/1/i,/2/i,/3/i,/4/i]},dU={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},hU={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},fU={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pU={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},mU={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},gU={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},bU={ordinalNumber:LV({matchPattern:sU,parsePattern:iU,valueCallback:function(e){return parseInt(e,10)}}),era:yu({matchPatterns:aU,defaultMatchWidth:"wide",parsePatterns:lU,defaultParseWidth:"any"}),quarter:yu({matchPatterns:cU,defaultMatchWidth:"wide",parsePatterns:uU,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:yu({matchPatterns:dU,defaultMatchWidth:"wide",parsePatterns:hU,defaultParseWidth:"any"}),day:yu({matchPatterns:fU,defaultMatchWidth:"wide",parsePatterns:pU,defaultParseWidth:"any"}),dayPeriod:yu({matchPatterns:mU,defaultMatchWidth:"any",parsePatterns:gU,defaultParseWidth:"any"})};const vU=bU;var xU={code:"en-US",formatDistance:WV,formatLong:jV,formatRelative:XV,localize:oU,match:vU,options:{weekStartsOn:0,firstWeekContainsDate:1}};const yU=xU,wU={name:"en-US",locale:yU},CU=wU;function $U(t){const{mergedLocaleRef:e,mergedDateLocaleRef:n}=Kt(Uc,null)||{},r=Me(()=>{var s,i;return(i=(s=e==null?void 0:e.value)===null||s===void 0?void 0:s[t])!==null&&i!==void 0?i:OV[t]});return{dateLocaleRef:Me(()=>{var s;return(s=n==null?void 0:n.value)!==null&&s!==void 0?s:CU}),localeRef:r}}function Hc(t,e,n){if(!e)return;const r=Fd(),o=Kt(Uc,null),s=()=>{const i=n==null?void 0:n.value;e.mount({id:i===void 0?t:i+t,head:!0,anchorMetaName:hd,props:{bPrefix:i?`.${i}-`:void 0},ssr:r}),o!=null&&o.preflightStyleDisabled||SE.mount({id:"n-global",head:!0,anchorMetaName:hd,ssr:r})};r?s():ml(s)}function bo(t,e,n,r){var o;n||iy("useThemeClass","cssVarsRef is not passed");const s=(o=Kt(Uc,null))===null||o===void 0?void 0:o.mergedThemeHashRef,i=Ne(""),a=Fd();let l;const c=`__${t}`,u=()=>{let d=c;const h=e?e.value:void 0,f=s==null?void 0:s.value;f&&(d+="-"+f),h&&(d+="-"+h);const{themeOverrides:p,builtinThemeOverrides:m}=r;p&&(d+="-"+nx(JSON.stringify(p))),m&&(d+="-"+nx(JSON.stringify(m))),i.value=d,l=()=>{const g=n.value;let b="";for(const v in g)b+=`${v}: ${g[v]};`;$e(`.${d}`,b).mount({id:d,ssr:a}),l=void 0}};return hc(()=>{u()}),{themeClass:i,onRender:()=>{l==null||l()}}}function vl(t,e,n){if(!e)return;const r=Fd(),o=Me(()=>{const{value:i}=e;if(!i)return;const a=i[t];if(!!a)return a}),s=()=>{hc(()=>{const{value:i}=n,a=`${i}${t}Rtl`;if(PL(a,r))return;const{value:l}=o;!l||l.style.mount({id:a,head:!0,anchorMetaName:hd,props:{bPrefix:i?`.${i}-`:void 0},ssr:r})})};return r?s():ml(s),o}const SU=lt({name:"Add",render(){return W("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},W("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}});function Gc(t,e){return lt({name:oV(t),setup(){var n;const r=(n=Kt(Uc,null))===null||n===void 0?void 0:n.mergedIconsRef;return()=>{var o;const s=(o=r==null?void 0:r.value)===null||o===void 0?void 0:o[t];return s?s():e}}})}const IU=Gc("close",W("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0},W("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},W("g",{fill:"currentColor","fill-rule":"nonzero"},W("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"}))))),kU=lt({name:"Eye",render(){return W("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},W("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"}),W("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"}))}}),TU=lt({name:"EyeOff",render(){return W("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},W("path",{d:"M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448z",fill:"currentColor"}),W("path",{d:"M255.66 384c-41.49 0-81.5-12.28-118.92-36.5c-34.07-22-64.74-53.51-88.7-91v-.08c19.94-28.57 41.78-52.73 65.24-72.21a2 2 0 0 0 .14-2.94L93.5 161.38a2 2 0 0 0-2.71-.12c-24.92 21-48.05 46.76-69.08 76.92a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416a239.13 239.13 0 0 0 75.8-12.58a2 2 0 0 0 .77-3.31l-21.58-21.58a4 4 0 0 0-3.83-1a204.8 204.8 0 0 1-51.16 6.47z",fill:"currentColor"}),W("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96a227.34 227.34 0 0 0-74.89 12.83a2 2 0 0 0-.75 3.31l21.55 21.55a4 4 0 0 0 3.88 1a192.82 192.82 0 0 1 50.21-6.69c40.69 0 80.58 12.43 118.55 37c34.71 22.4 65.74 53.88 89.76 91a.13.13 0 0 1 0 .16a310.72 310.72 0 0 1-64.12 72.73a2 2 0 0 0-.15 2.95l19.9 19.89a2 2 0 0 0 2.7.13a343.49 343.49 0 0 0 68.64-78.48a32.2 32.2 0 0 0-.1-34.78z",fill:"currentColor"}),W("path",{d:"M256 160a95.88 95.88 0 0 0-21.37 2.4a2 2 0 0 0-1 3.38l112.59 112.56a2 2 0 0 0 3.38-1A96 96 0 0 0 256 160z",fill:"currentColor"}),W("path",{d:"M165.78 233.66a2 2 0 0 0-3.38 1a96 96 0 0 0 115 115a2 2 0 0 0 1-3.38z",fill:"currentColor"}))}}),IE=Gc("error",W("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},W("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},W("g",{"fill-rule":"nonzero"},W("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),dx=Gc("info",W("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},W("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},W("g",{"fill-rule":"nonzero"},W("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),kE=Gc("success",W("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},W("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},W("g",{"fill-rule":"nonzero"},W("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),TE=Gc("warning",W("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},W("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},W("g",{"fill-rule":"nonzero"},W("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),EU=lt({name:"ChevronDown",render(){return W("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},W("path",{d:"M3.14645 5.64645C3.34171 5.45118 3.65829 5.45118 3.85355 5.64645L8 9.79289L12.1464 5.64645C12.3417 5.45118 12.6583 5.45118 12.8536 5.64645C13.0488 5.84171 13.0488 6.15829 12.8536 6.35355L8.35355 10.8536C8.15829 11.0488 7.84171 11.0488 7.64645 10.8536L3.14645 6.35355C2.95118 6.15829 2.95118 5.84171 3.14645 5.64645Z",fill:"currentColor"}))}}),RU=Gc("clear",W("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},W("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},W("g",{fill:"currentColor","fill-rule":"nonzero"},W("path",{d:"M8,2 C11.3137085,2 14,4.6862915 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 C2,4.6862915 4.6862915,2 8,2 Z M6.5343055,5.83859116 C6.33943736,5.70359511 6.07001296,5.72288026 5.89644661,5.89644661 L5.89644661,5.89644661 L5.83859116,5.9656945 C5.70359511,6.16056264 5.72288026,6.42998704 5.89644661,6.60355339 L5.89644661,6.60355339 L7.293,8 L5.89644661,9.39644661 L5.83859116,9.4656945 C5.70359511,9.66056264 5.72288026,9.92998704 5.89644661,10.1035534 L5.89644661,10.1035534 L5.9656945,10.1614088 C6.16056264,10.2964049 6.42998704,10.2771197 6.60355339,10.1035534 L6.60355339,10.1035534 L8,8.707 L9.39644661,10.1035534 L9.4656945,10.1614088 C9.66056264,10.2964049 9.92998704,10.2771197 10.1035534,10.1035534 L10.1035534,10.1035534 L10.1614088,10.0343055 C10.2964049,9.83943736 10.2771197,9.57001296 10.1035534,9.39644661 L10.1035534,9.39644661 L8.707,8 L10.1035534,6.60355339 L10.1614088,6.5343055 C10.2964049,6.33943736 10.2771197,6.07001296 10.1035534,5.89644661 L10.1035534,5.89644661 L10.0343055,5.83859116 C9.83943736,5.70359511 9.57001296,5.72288026 9.39644661,5.89644661 L9.39644661,5.89644661 L8,7.293 L6.60355339,5.89644661 Z"}))))),Mm=lt({name:"BaseIconSwitchTransition",setup(t,{slots:e}){const n=MT();return()=>W(Li,{name:"icon-switch-transition",appear:n.value},e)}}),EE=lt({name:"FadeInExpandTransition",props:{appear:Boolean,group:Boolean,mode:String,onLeave:Function,onAfterLeave:Function,onAfterEnter:Function,width:Boolean,reverse:Boolean},setup(t,{slots:e}){function n(a){t.width?a.style.maxWidth=`${a.offsetWidth}px`:a.style.maxHeight=`${a.offsetHeight}px`,a.offsetWidth}function r(a){t.width?a.style.maxWidth="0":a.style.maxHeight="0",a.offsetWidth;const{onLeave:l}=t;l&&l()}function o(a){t.width?a.style.maxWidth="":a.style.maxHeight="";const{onAfterLeave:l}=t;l&&l()}function s(a){if(a.style.transition="none",t.width){const l=a.offsetWidth;a.style.maxWidth="0",a.offsetWidth,a.style.transition="",a.style.maxWidth=`${l}px`}else if(t.reverse)a.style.maxHeight=`${a.offsetHeight}px`,a.offsetHeight,a.style.transition="",a.style.maxHeight="0";else{const l=a.offsetHeight;a.style.maxHeight="0",a.offsetWidth,a.style.transition="",a.style.maxHeight=`${l}px`}a.offsetWidth}function i(a){var l;t.width?a.style.maxWidth="":t.reverse||(a.style.maxHeight=""),(l=t.onAfterEnter)===null||l===void 0||l.call(t)}return()=>{const a=t.group?wT:Li;return W(a,{name:t.width?"fade-in-width-expand-transition":"fade-in-height-expand-transition",mode:t.mode,appear:t.appear,onEnter:s,onAfterEnter:i,onBeforeLeave:n,onLeave:r,onAfterLeave:o},e)}}}),NU=Ae("base-icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[$e("svg",`
 height: 1em;
 width: 1em;
 `)]),Bi=lt({name:"BaseIcon",props:{role:String,ariaLabel:String,ariaDisabled:{type:Boolean,default:void 0},ariaHidden:{type:Boolean,default:void 0},clsPrefix:{type:String,required:!0},onClick:Function,onMousedown:Function,onMouseup:Function},setup(t){Hc("-base-icon",NU,Bn(t,"clsPrefix"))},render(){return W("i",{class:`${this.clsPrefix}-base-icon`,onClick:this.onClick,onMousedown:this.onMousedown,onMouseup:this.onMouseup,role:this.role,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,"aria-disabled":this.ariaDisabled},this.$slots)}}),_U=Ae("base-close",`
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: pointer;
 background-color: transparent;
 color: var(--n-close-icon-color);
 border-radius: var(--n-close-border-radius);
 height: var(--n-close-size);
 width: var(--n-close-size);
 font-size: var(--n-close-icon-size);
 outline: none;
 border: none;
 position: relative;
 padding: 0;
`,[We("absolute",`
 height: var(--n-close-icon-size);
 width: var(--n-close-icon-size);
 `),$e("&::before",`
 content: "";
 position: absolute;
 width: var(--n-close-size);
 height: var(--n-close-size);
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 transition: inherit;
 border-radius: inherit;
 `),Ks("disabled",[$e("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),$e("&:hover::before",`
 background-color: var(--n-close-color-hover);
 `),$e("&:focus::before",`
 background-color: var(--n-close-color-hover);
 `),$e("&:active",`
 color: var(--n-close-icon-color-pressed);
 `),$e("&:active::before",`
 background-color: var(--n-close-color-pressed);
 `)]),We("disabled",`
 cursor: not-allowed;
 color: var(--n-close-icon-color-disabled);
 background-color: transparent;
 `),We("round",[$e("&::before",`
 border-radius: 50%;
 `)])]),Lm=lt({name:"BaseClose",props:{isButtonTag:{type:Boolean,default:!0},clsPrefix:{type:String,required:!0},disabled:{type:Boolean,default:void 0},focusable:{type:Boolean,default:!0},round:Boolean,onClick:Function,absolute:Boolean},setup(t){return Hc("-base-close",_U,Bn(t,"clsPrefix")),()=>{const{clsPrefix:e,disabled:n,absolute:r,round:o,isButtonTag:s}=t;return W(s?"button":"div",{type:s?"button":void 0,tabindex:n||!t.focusable?-1:0,"aria-disabled":n,"aria-label":"close",role:s?void 0:"button",disabled:n,class:[`${e}-base-close`,r&&`${e}-base-close--absolute`,n&&`${e}-base-close--disabled`,o&&`${e}-base-close--round`],onMousedown:a=>{t.focusable||a.preventDefault()},onClick:t.onClick},W(Bi,{clsPrefix:e},{default:()=>W(IU,null)}))}}}),{cubicBezierEaseInOut:AU}=bl;function fd({originalTransform:t="",left:e=0,top:n=0,transition:r=`all .3s ${AU} !important`}={}){return[$e("&.icon-switch-transition-enter-from, &.icon-switch-transition-leave-to",{transform:t+" scale(0.75)",left:e,top:n,opacity:0}),$e("&.icon-switch-transition-enter-to, &.icon-switch-transition-leave-from",{transform:`scale(1) ${t}`,left:e,top:n,opacity:1}),$e("&.icon-switch-transition-enter-active, &.icon-switch-transition-leave-active",{transformOrigin:"center",position:"absolute",left:e,top:n,transition:r})]}const DU=$e([$e("@keyframes loading-container-rotate",`
 to {
 -webkit-transform: rotate(360deg);
 transform: rotate(360deg);
 }
 `),$e("@keyframes loading-layer-rotate",`
 12.5% {
 -webkit-transform: rotate(135deg);
 transform: rotate(135deg);
 }
 25% {
 -webkit-transform: rotate(270deg);
 transform: rotate(270deg);
 }
 37.5% {
 -webkit-transform: rotate(405deg);
 transform: rotate(405deg);
 }
 50% {
 -webkit-transform: rotate(540deg);
 transform: rotate(540deg);
 }
 62.5% {
 -webkit-transform: rotate(675deg);
 transform: rotate(675deg);
 }
 75% {
 -webkit-transform: rotate(810deg);
 transform: rotate(810deg);
 }
 87.5% {
 -webkit-transform: rotate(945deg);
 transform: rotate(945deg);
 }
 100% {
 -webkit-transform: rotate(1080deg);
 transform: rotate(1080deg);
 } 
 `),$e("@keyframes loading-left-spin",`
 from {
 -webkit-transform: rotate(265deg);
 transform: rotate(265deg);
 }
 50% {
 -webkit-transform: rotate(130deg);
 transform: rotate(130deg);
 }
 to {
 -webkit-transform: rotate(265deg);
 transform: rotate(265deg);
 }
 `),$e("@keyframes loading-right-spin",`
 from {
 -webkit-transform: rotate(-265deg);
 transform: rotate(-265deg);
 }
 50% {
 -webkit-transform: rotate(-130deg);
 transform: rotate(-130deg);
 }
 to {
 -webkit-transform: rotate(-265deg);
 transform: rotate(-265deg);
 }
 `),Ae("base-loading",`
 position: relative;
 line-height: 0;
 width: 1em;
 height: 1em;
 `,[Se("transition-wrapper",`
 position: absolute;
 width: 100%;
 height: 100%;
 `,[fd()]),Se("container",`
 display: inline-flex;
 position: relative;
 direction: ltr;
 line-height: 0;
 animation: loading-container-rotate 1568.2352941176ms linear infinite;
 font-size: 0;
 letter-spacing: 0;
 white-space: nowrap;
 opacity: 1;
 width: 100%;
 height: 100%;
 `,[Se("svg",`
 stroke: var(--n-text-color);
 fill: transparent;
 position: absolute;
 height: 100%;
 overflow: hidden;
 `),Se("container-layer",`
 position: absolute;
 width: 100%;
 height: 100%;
 animation: loading-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
 `,[Se("container-layer-left",`
 display: inline-flex;
 position: relative;
 width: 50%;
 height: 100%;
 overflow: hidden;
 `,[Se("svg",`
 animation: loading-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
 width: 200%;
 `)]),Se("container-layer-patch",`
 position: absolute;
 top: 0;
 left: 47.5%;
 box-sizing: border-box;
 width: 5%;
 height: 100%;
 overflow: hidden;
 `,[Se("svg",`
 left: -900%;
 width: 2000%;
 transform: rotate(180deg);
 `)]),Se("container-layer-right",`
 display: inline-flex;
 position: relative;
 width: 50%;
 height: 100%;
 overflow: hidden;
 `,[Se("svg",`
 animation: loading-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both;
 left: -100%;
 width: 200%;
 `)])])]),Se("placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[fd({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})])])]),FU={strokeWidth:{type:Number,default:28},stroke:{type:String,default:void 0}},py=lt({name:"BaseLoading",props:Object.assign({clsPrefix:{type:String,required:!0},show:{type:Boolean,default:!0},scale:{type:Number,default:1},radius:{type:Number,default:100}},FU),setup(t){Hc("-base-loading",DU,Bn(t,"clsPrefix"))},render(){const{clsPrefix:t,radius:e,strokeWidth:n,stroke:r,scale:o}=this,s=e/o;return W("div",{class:`${t}-base-loading`,role:"img","aria-label":"loading"},W(Mm,null,{default:()=>this.show?W("div",{key:"icon",class:`${t}-base-loading__transition-wrapper`},W("div",{class:`${t}-base-loading__container`},W("div",{class:`${t}-base-loading__container-layer`},W("div",{class:`${t}-base-loading__container-layer-left`},W("svg",{class:`${t}-base-loading__svg`,viewBox:`0 0 ${2*s} ${2*s}`,xmlns:"http://www.w3.org/2000/svg",style:{color:r}},W("circle",{fill:"none",stroke:"currentColor","stroke-width":n,"stroke-linecap":"round",cx:s,cy:s,r:e-n/2,"stroke-dasharray":4.91*e,"stroke-dashoffset":2.46*e}))),W("div",{class:`${t}-base-loading__container-layer-patch`},W("svg",{class:`${t}-base-loading__svg`,viewBox:`0 0 ${2*s} ${2*s}`,xmlns:"http://www.w3.org/2000/svg",style:{color:r}},W("circle",{fill:"none",stroke:"currentColor","stroke-width":n,"stroke-linecap":"round",cx:s,cy:s,r:e-n/2,"stroke-dasharray":4.91*e,"stroke-dashoffset":2.46*e}))),W("div",{class:`${t}-base-loading__container-layer-right`},W("svg",{class:`${t}-base-loading__svg`,viewBox:`0 0 ${2*s} ${2*s}`,xmlns:"http://www.w3.org/2000/svg",style:{color:r}},W("circle",{fill:"none",stroke:"currentColor","stroke-width":n,"stroke-linecap":"round",cx:s,cy:s,r:e-n/2,"stroke-dasharray":4.91*e,"stroke-dashoffset":2.46*e})))))):W("div",{key:"placeholder",class:`${t}-base-loading__placeholder`},this.$slots)}))}}),ot={neutralBase:"#FFF",neutralInvertBase:"#000",neutralTextBase:"#000",neutralPopover:"#fff",neutralCard:"#fff",neutralModal:"#fff",neutralBody:"#fff",alpha1:"0.82",alpha2:"0.72",alpha3:"0.38",alpha4:"0.24",alpha5:"0.18",alphaClose:"0.6",alphaDisabled:"0.5",alphaDisabledInput:"0.02",alphaPending:"0.05",alphaTablePending:"0.02",alphaPressed:"0.07",alphaAvatar:"0.2",alphaRail:"0.14",alphaProgressRail:".08",alphaBorder:"0.12",alphaDivider:"0.06",alphaInput:"0",alphaAction:"0.02",alphaTab:"0.04",alphaScrollbar:"0.25",alphaScrollbarHover:"0.4",alphaCode:"0.05",alphaTag:"0.02",primaryHover:"#36ad6a",primaryDefault:"#18a058",primaryActive:"#0c7a43",primarySuppl:"#36ad6a",infoHover:"#4098fc",infoDefault:"#2080f0",infoActive:"#1060c9",infoSuppl:"#4098fc",errorHover:"#de576d",errorDefault:"#d03050",errorActive:"#ab1f3f",errorSuppl:"#de576d",warningHover:"#fcb040",warningDefault:"#f0a020",warningActive:"#c97c10",warningSuppl:"#fcb040",successHover:"#36ad6a",successDefault:"#18a058",successActive:"#0c7a43",successSuppl:"#36ad6a"},OU=Ya(ot.neutralBase),RE=Ya(ot.neutralInvertBase),PU="rgba("+RE.slice(0,3).join(", ")+", ";function SS(t){return PU+String(t)+")"}function vr(t){const e=Array.from(RE);return e[3]=Number(t),ad(OU,e)}const MU=Object.assign(Object.assign({name:"common"},bl),{baseColor:ot.neutralBase,primaryColor:ot.primaryDefault,primaryColorHover:ot.primaryHover,primaryColorPressed:ot.primaryActive,primaryColorSuppl:ot.primarySuppl,infoColor:ot.infoDefault,infoColorHover:ot.infoHover,infoColorPressed:ot.infoActive,infoColorSuppl:ot.infoSuppl,successColor:ot.successDefault,successColorHover:ot.successHover,successColorPressed:ot.successActive,successColorSuppl:ot.successSuppl,warningColor:ot.warningDefault,warningColorHover:ot.warningHover,warningColorPressed:ot.warningActive,warningColorSuppl:ot.warningSuppl,errorColor:ot.errorDefault,errorColorHover:ot.errorHover,errorColorPressed:ot.errorActive,errorColorSuppl:ot.errorSuppl,textColorBase:ot.neutralTextBase,textColor1:"rgb(31, 34, 37)",textColor2:"rgb(51, 54, 57)",textColor3:"rgb(118, 124, 130)",textColorDisabled:vr(ot.alpha4),placeholderColor:vr(ot.alpha4),placeholderColorDisabled:vr(ot.alpha5),iconColor:vr(ot.alpha4),iconColorHover:Lf(vr(ot.alpha4),{lightness:.75}),iconColorPressed:Lf(vr(ot.alpha4),{lightness:.9}),iconColorDisabled:vr(ot.alpha5),opacity1:ot.alpha1,opacity2:ot.alpha2,opacity3:ot.alpha3,opacity4:ot.alpha4,opacity5:ot.alpha5,dividerColor:"rgb(239, 239, 245)",borderColor:"rgb(224, 224, 230)",closeIconColor:vr(Number(ot.alphaClose)),closeIconColorHover:vr(Number(ot.alphaClose)),closeIconColorPressed:vr(Number(ot.alphaClose)),closeColorHover:"rgba(0, 0, 0, .09)",closeColorPressed:"rgba(0, 0, 0, .13)",clearColor:vr(ot.alpha4),clearColorHover:Lf(vr(ot.alpha4),{lightness:.75}),clearColorPressed:Lf(vr(ot.alpha4),{lightness:.9}),scrollbarColor:SS(ot.alphaScrollbar),scrollbarColorHover:SS(ot.alphaScrollbarHover),scrollbarWidth:"5px",scrollbarHeight:"5px",scrollbarBorderRadius:"5px",progressRailColor:vr(ot.alphaProgressRail),railColor:"rgb(219, 219, 223)",popoverColor:ot.neutralPopover,tableColor:ot.neutralCard,cardColor:ot.neutralCard,modalColor:ot.neutralModal,bodyColor:ot.neutralBody,tagColor:"#eee",avatarColor:vr(ot.alphaAvatar),invertedColor:"rgb(0, 20, 40)",inputColor:vr(ot.alphaInput),codeColor:"rgb(244, 244, 248)",tabColor:"rgb(247, 247, 250)",actionColor:"rgb(250, 250, 252)",tableHeaderColor:"rgb(250, 250, 252)",hoverColor:"rgb(243, 243, 245)",tableColorHover:"rgba(0, 0, 100, 0.03)",tableColorStriped:"rgba(0, 0, 100, 0.02)",pressedColor:"rgb(237, 237, 239)",opacityDisabled:ot.alphaDisabled,inputColorDisabled:"rgb(250, 250, 252)",buttonColor2:"rgba(46, 51, 56, .05)",buttonColor2Hover:"rgba(46, 51, 56, .09)",buttonColor2Pressed:"rgba(46, 51, 56, .13)",boxShadow1:"0 1px 2px -2px rgba(0, 0, 0, .08), 0 3px 6px 0 rgba(0, 0, 0, .06), 0 5px 12px 4px rgba(0, 0, 0, .04)",boxShadow2:"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05)",boxShadow3:"0 6px 16px -9px rgba(0, 0, 0, .08), 0 9px 28px 0 rgba(0, 0, 0, .05), 0 12px 48px 16px rgba(0, 0, 0, .03)"}),Bo=MU,LU=t=>{const{scrollbarColor:e,scrollbarColorHover:n}=t;return{color:e,colorHover:n}},BU={name:"Scrollbar",common:Bo,self:LU},my=BU,{cubicBezierEaseInOut:IS}=bl;function NE({name:t="fade-in",enterDuration:e="0.2s",leaveDuration:n="0.2s",enterCubicBezier:r=IS,leaveCubicBezier:o=IS}={}){return[$e(`&.${t}-transition-enter-active`,{transition:`all ${e} ${r}!important`}),$e(`&.${t}-transition-leave-active`,{transition:`all ${n} ${o}!important`}),$e(`&.${t}-transition-enter-from, &.${t}-transition-leave-to`,{opacity:0}),$e(`&.${t}-transition-leave-from, &.${t}-transition-enter-to`,{opacity:1})]}const zU=Ae("scrollbar",`
 overflow: hidden;
 position: relative;
 z-index: auto;
 height: 100%;
 width: 100%;
`,[$e(">",[Ae("scrollbar-container",`
 width: 100%;
 overflow: scroll;
 height: 100%;
 max-height: inherit;
 scrollbar-width: none;
 `,[$e("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),$e(">",[Ae("scrollbar-content",`
 box-sizing: border-box;
 min-width: 100%;
 `)])])]),$e(">, +",[Ae("scrollbar-rail",`
 position: absolute;
 pointer-events: none;
 user-select: none;
 -webkit-user-select: none;
 `,[We("horizontal",`
 left: 2px;
 right: 2px;
 bottom: 4px;
 height: var(--n-scrollbar-height);
 `,[$e(">",[Se("scrollbar",`
 height: var(--n-scrollbar-height);
 border-radius: var(--n-scrollbar-border-radius);
 right: 0;
 `)])]),We("vertical",`
 right: 4px;
 top: 2px;
 bottom: 2px;
 width: var(--n-scrollbar-width);
 `,[$e(">",[Se("scrollbar",`
 width: var(--n-scrollbar-width);
 border-radius: var(--n-scrollbar-border-radius);
 bottom: 0;
 `)])]),We("disabled",[$e(">",[Se("scrollbar",{pointerEvents:"none"})])]),$e(">",[Se("scrollbar",`
 position: absolute;
 cursor: pointer;
 pointer-events: all;
 background-color: var(--n-scrollbar-color);
 transition: background-color .2s var(--n-scrollbar-bezier);
 `,[NE(),$e("&:hover",{backgroundColor:"var(--n-scrollbar-color-hover)"})])])])])]),WU=Object.assign(Object.assign({},Ut.props),{size:{type:Number,default:5},duration:{type:Number,default:0},scrollable:{type:Boolean,default:!0},xScrollable:Boolean,trigger:{type:String,default:"hover"},useUnifiedContainer:Boolean,triggerDisplayManually:Boolean,container:Function,content:Function,containerClass:String,containerStyle:[String,Object],contentClass:String,contentStyle:[String,Object],horizontalRailStyle:[String,Object],verticalRailStyle:[String,Object],onScroll:Function,onWheel:Function,onResize:Function,internalOnUpdateScrollLeft:Function,internalHoistYRail:Boolean}),VU=lt({name:"Scrollbar",props:WU,inheritAttrs:!1,setup(t){const{mergedClsPrefixRef:e,inlineThemeDisabled:n,mergedRtlRef:r}=Mr(t),o=vl("Scrollbar",r,e),s=Ne(null),i=Ne(null),a=Ne(null),l=Ne(null),c=Ne(null),u=Ne(null),d=Ne(null),h=Ne(null),f=Ne(null),p=Ne(null),m=Ne(null),g=Ne(0),b=Ne(0),v=Ne(!1),w=Ne(!1);let y=!1,C=!1,S,$,I=0,R=0,T=0,N=0;const _=nB(),P=Me(()=>{const{value:Ee}=h,{value:He}=u,{value:rt}=p;return Ee===null||He===null||rt===null?0:Math.min(Ee,rt*Ee/He+t.size*1.5)}),z=Me(()=>`${P.value}px`),L=Me(()=>{const{value:Ee}=f,{value:He}=d,{value:rt}=m;return Ee===null||He===null||rt===null?0:rt*Ee/He+t.size*1.5}),O=Me(()=>`${L.value}px`),B=Me(()=>{const{value:Ee}=h,{value:He}=g,{value:rt}=u,{value:Pt}=p;if(Ee===null||rt===null||Pt===null)return 0;{const en=rt-Ee;return en?He/en*(Pt-P.value):0}}),U=Me(()=>`${B.value}px`),Q=Me(()=>{const{value:Ee}=f,{value:He}=b,{value:rt}=d,{value:Pt}=m;if(Ee===null||rt===null||Pt===null)return 0;{const en=rt-Ee;return en?He/en*(Pt-L.value):0}}),se=Me(()=>`${Q.value}px`),ce=Me(()=>{const{value:Ee}=h,{value:He}=u;return Ee!==null&&He!==null&&He>Ee}),de=Me(()=>{const{value:Ee}=f,{value:He}=d;return Ee!==null&&He!==null&&He>Ee}),we=Me(()=>{const{trigger:Ee}=t;return Ee==="none"||v.value}),Ie=Me(()=>{const{trigger:Ee}=t;return Ee==="none"||w.value}),j=Me(()=>{const{container:Ee}=t;return Ee?Ee():i.value}),re=Me(()=>{const{content:Ee}=t;return Ee?Ee():a.value}),le=YT(()=>{t.container||Le({top:g.value,left:b.value})}),Ce=()=>{le.isDeactivated||Pe()},ve=Ee=>{if(le.isDeactivated)return;const{onResize:He}=t;He&&He(Ee),Pe()},Le=(Ee,He)=>{if(!t.scrollable)return;if(typeof Ee=="number"){F(He!=null?He:0,Ee,0,!1,"auto");return}const{left:rt,top:Pt,index:en,elSize:_n,position:qt,behavior:mt,el:cr,debounce:Mn=!0}=Ee;(rt!==void 0||Pt!==void 0)&&F(rt!=null?rt:0,Pt!=null?Pt:0,0,!1,mt),cr!==void 0?F(0,cr.offsetTop,cr.offsetHeight,Mn,mt):en!==void 0&&_n!==void 0?F(0,en*_n,_n,Mn,mt):qt==="bottom"?F(0,Number.MAX_SAFE_INTEGER,0,!1,mt):qt==="top"&&F(0,0,0,!1,mt)},_e=(Ee,He)=>{if(!t.scrollable)return;const{value:rt}=j;!rt||(typeof Ee=="object"?rt.scrollBy(Ee):rt.scrollBy(Ee,He||0))};function F(Ee,He,rt,Pt,en){const{value:_n}=j;if(!!_n){if(Pt){const{scrollTop:qt,offsetHeight:mt}=_n;if(He>qt){He+rt<=qt+mt||_n.scrollTo({left:Ee,top:He+rt-mt,behavior:en});return}}_n.scrollTo({left:Ee,top:He,behavior:en})}}function V(){pe(),ye(),Pe()}function oe(){G()}function G(){Y(),ae()}function Y(){$!==void 0&&window.clearTimeout($),$=window.setTimeout(()=>{w.value=!1},t.duration)}function ae(){S!==void 0&&window.clearTimeout(S),S=window.setTimeout(()=>{v.value=!1},t.duration)}function pe(){S!==void 0&&window.clearTimeout(S),v.value=!0}function ye(){$!==void 0&&window.clearTimeout($),w.value=!0}function ge(Ee){const{onScroll:He}=t;He&&He(Ee),be()}function be(){const{value:Ee}=j;Ee&&(g.value=Ee.scrollTop,b.value=Ee.scrollLeft*(o!=null&&o.value?-1:1))}function De(){const{value:Ee}=re;Ee&&(u.value=Ee.offsetHeight,d.value=Ee.offsetWidth);const{value:He}=j;He&&(h.value=He.offsetHeight,f.value=He.offsetWidth);const{value:rt}=c,{value:Pt}=l;rt&&(m.value=rt.offsetWidth),Pt&&(p.value=Pt.offsetHeight)}function Oe(){const{value:Ee}=j;Ee&&(g.value=Ee.scrollTop,b.value=Ee.scrollLeft*(o!=null&&o.value?-1:1),h.value=Ee.offsetHeight,f.value=Ee.offsetWidth,u.value=Ee.scrollHeight,d.value=Ee.scrollWidth);const{value:He}=c,{value:rt}=l;He&&(m.value=He.offsetWidth),rt&&(p.value=rt.offsetHeight)}function Pe(){!t.scrollable||(t.useUnifiedContainer?Oe():(De(),be()))}function qe(Ee){var He;return!(!((He=s.value)===null||He===void 0)&&He.contains(oy(Ee)))}function nt(Ee){Ee.preventDefault(),Ee.stopPropagation(),C=!0,Kr("mousemove",window,dt,!0),Kr("mouseup",window,ht,!0),R=b.value,T=o!=null&&o.value?window.innerWidth-Ee.clientX:Ee.clientX}function dt(Ee){if(!C)return;S!==void 0&&window.clearTimeout(S),$!==void 0&&window.clearTimeout($);const{value:He}=f,{value:rt}=d,{value:Pt}=L;if(He===null||rt===null)return;const _n=(o!=null&&o.value?window.innerWidth-Ee.clientX-T:Ee.clientX-T)*(rt-He)/(He-Pt),qt=rt-He;let mt=R+_n;mt=Math.min(qt,mt),mt=Math.max(mt,0);const{value:cr}=j;if(cr){cr.scrollLeft=mt*(o!=null&&o.value?-1:1);const{internalOnUpdateScrollLeft:Mn}=t;Mn&&Mn(mt)}}function ht(Ee){Ee.preventDefault(),Ee.stopPropagation(),dr("mousemove",window,dt,!0),dr("mouseup",window,ht,!0),C=!1,Pe(),qe(Ee)&&G()}function $t(Ee){Ee.preventDefault(),Ee.stopPropagation(),y=!0,Kr("mousemove",window,ln,!0),Kr("mouseup",window,Cn,!0),I=g.value,N=Ee.clientY}function ln(Ee){if(!y)return;S!==void 0&&window.clearTimeout(S),$!==void 0&&window.clearTimeout($);const{value:He}=h,{value:rt}=u,{value:Pt}=P;if(He===null||rt===null)return;const _n=(Ee.clientY-N)*(rt-He)/(He-Pt),qt=rt-He;let mt=I+_n;mt=Math.min(qt,mt),mt=Math.max(mt,0);const{value:cr}=j;cr&&(cr.scrollTop=mt)}function Cn(Ee){Ee.preventDefault(),Ee.stopPropagation(),dr("mousemove",window,ln,!0),dr("mouseup",window,Cn,!0),y=!1,Pe(),qe(Ee)&&G()}hc(()=>{const{value:Ee}=de,{value:He}=ce,{value:rt}=e,{value:Pt}=c,{value:en}=l;Pt&&(Ee?Pt.classList.remove(`${rt}-scrollbar-rail--disabled`):Pt.classList.add(`${rt}-scrollbar-rail--disabled`)),en&&(He?en.classList.remove(`${rt}-scrollbar-rail--disabled`):en.classList.add(`${rt}-scrollbar-rail--disabled`))}),as(()=>{t.container||Pe()}),Lo(()=>{S!==void 0&&window.clearTimeout(S),$!==void 0&&window.clearTimeout($),dr("mousemove",window,ln,!0),dr("mouseup",window,Cn,!0)});const ro=Ut("Scrollbar","-scrollbar",zU,my,t,e),Pn=Me(()=>{const{common:{cubicBezierEaseInOut:Ee,scrollbarBorderRadius:He,scrollbarHeight:rt,scrollbarWidth:Pt},self:{color:en,colorHover:_n}}=ro.value;return{"--n-scrollbar-bezier":Ee,"--n-scrollbar-color":en,"--n-scrollbar-color-hover":_n,"--n-scrollbar-border-radius":He,"--n-scrollbar-width":Pt,"--n-scrollbar-height":rt}}),Nn=n?bo("scrollbar",void 0,Pn,t):void 0;return Object.assign(Object.assign({},{scrollTo:Le,scrollBy:_e,sync:Pe,syncUnifiedContainer:Oe,handleMouseEnterWrapper:V,handleMouseLeaveWrapper:oe}),{mergedClsPrefix:e,rtlEnabled:o,containerScrollTop:g,wrapperRef:s,containerRef:i,contentRef:a,yRailRef:l,xRailRef:c,needYBar:ce,needXBar:de,yBarSizePx:z,xBarSizePx:O,yBarTopPx:U,xBarLeftPx:se,isShowXBar:we,isShowYBar:Ie,isIos:_,handleScroll:ge,handleContentResize:Ce,handleContainerResize:ve,handleYScrollMouseDown:$t,handleXScrollMouseDown:nt,cssVars:n?void 0:Pn,themeClass:Nn==null?void 0:Nn.themeClass,onRender:Nn==null?void 0:Nn.onRender})},render(){var t;const{$slots:e,mergedClsPrefix:n,triggerDisplayManually:r,rtlEnabled:o,internalHoistYRail:s}=this;if(!this.scrollable)return(t=e.default)===null||t===void 0?void 0:t.call(e);const i=this.trigger==="none",a=()=>W("div",{ref:"yRailRef",class:[`${n}-scrollbar-rail`,`${n}-scrollbar-rail--vertical`],"data-scrollbar-rail":!0,style:this.verticalRailStyle,"aria-hidden":!0},W(i?R$:Li,i?null:{name:"fade-in-transition"},{default:()=>this.needYBar&&this.isShowYBar&&!this.isIos?W("div",{class:`${n}-scrollbar-rail__scrollbar`,style:{height:this.yBarSizePx,top:this.yBarTopPx},onMousedown:this.handleYScrollMouseDown}):null})),l=()=>{var u,d;return(u=this.onRender)===null||u===void 0||u.call(this),W("div",Ad(this.$attrs,{role:"none",ref:"wrapperRef",class:[`${n}-scrollbar`,this.themeClass,o&&`${n}-scrollbar--rtl`],style:this.cssVars,onMouseenter:r?void 0:this.handleMouseEnterWrapper,onMouseleave:r?void 0:this.handleMouseLeaveWrapper}),[this.container?(d=e.default)===null||d===void 0?void 0:d.call(e):W("div",{role:"none",ref:"containerRef",class:[`${n}-scrollbar-container`,this.containerClass],style:this.containerStyle,onScroll:this.handleScroll,onWheel:this.onWheel},W(ud,{onResize:this.handleContentResize},{default:()=>W("div",{ref:"contentRef",role:"none",style:[{width:this.xScrollable?"fit-content":null},this.contentStyle],class:[`${n}-scrollbar-content`,this.contentClass]},e)})),s?null:a(),this.xScrollable&&W("div",{ref:"xRailRef",class:[`${n}-scrollbar-rail`,`${n}-scrollbar-rail--horizontal`],style:this.horizontalRailStyle,"data-scrollbar-rail":!0,"aria-hidden":!0},W(i?R$:Li,i?null:{name:"fade-in-transition"},{default:()=>this.needXBar&&this.isShowXBar&&!this.isIos?W("div",{class:`${n}-scrollbar-rail__scrollbar`,style:{width:this.xBarSizePx,right:o?this.xBarLeftPx:void 0,left:o?void 0:this.xBarLeftPx},onMousedown:this.handleXScrollMouseDown}):null}))])},c=this.container?l():W(ud,{onResize:this.handleContainerResize},{default:l});return s?W(fn,null,c,a()):c}}),gy=VU,{cubicBezierEaseIn:kS,cubicBezierEaseOut:TS}=bl;function UU({transformOrigin:t="inherit",duration:e=".2s",enterScale:n=".9",originalTransform:r="",originalTransition:o=""}={}){return[$e("&.fade-in-scale-up-transition-leave-active",{transformOrigin:t,transition:`opacity ${e} ${kS}, transform ${e} ${kS} ${o&&","+o}`}),$e("&.fade-in-scale-up-transition-enter-active",{transformOrigin:t,transition:`opacity ${e} ${TS}, transform ${e} ${TS} ${o&&","+o}`}),$e("&.fade-in-scale-up-transition-enter-from, &.fade-in-scale-up-transition-leave-to",{opacity:0,transform:`${r} scale(${n})`}),$e("&.fade-in-scale-up-transition-leave-from, &.fade-in-scale-up-transition-enter-to",{opacity:1,transform:`${r} scale(1)`})]}const HU=Ae("base-wave",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
`),GU=lt({name:"BaseWave",props:{clsPrefix:{type:String,required:!0}},setup(t){Hc("-base-wave",HU,Bn(t,"clsPrefix"));const e=Ne(null),n=Ne(!1);let r=null;return Lo(()=>{r!==null&&window.clearTimeout(r)}),{active:n,selfRef:e,play(){r!==null&&(window.clearTimeout(r),n.value=!1,r=null),Do(()=>{var o;(o=e.value)===null||o===void 0||o.offsetHeight,n.value=!0,r=window.setTimeout(()=>{n.value=!1,r=null},1e3)})}}},render(){const{clsPrefix:t}=this;return W("div",{ref:"selfRef","aria-hidden":!0,class:[`${t}-base-wave`,this.active&&`${t}-base-wave--active`]})}}),jU=Ae("base-clear",`
 flex-shrink: 0;
 height: 1em;
 width: 1em;
 position: relative;
`,[$e(">",[Se("clear",`
 font-size: var(--n-clear-size);
 height: 1em;
 width: 1em;
 cursor: pointer;
 color: var(--n-clear-color);
 transition: color .3s var(--n-bezier);
 display: flex;
 `,[$e("&:hover",`
 color: var(--n-clear-color-hover)!important;
 `),$e("&:active",`
 color: var(--n-clear-color-pressed)!important;
 `)]),Se("placeholder",`
 display: flex;
 `),Se("clear, placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[fd({originalTransform:"translateX(-50%) translateY(-50%)",left:"50%",top:"50%"})])])]),hx=lt({name:"BaseClear",props:{clsPrefix:{type:String,required:!0},show:Boolean,onClear:Function},setup(t){return Hc("-base-clear",jU,Bn(t,"clsPrefix")),{handleMouseDown(e){e.preventDefault()}}},render(){const{clsPrefix:t}=this;return W("div",{class:`${t}-base-clear`},W(Mm,null,{default:()=>{var e,n;return this.show?W("div",{key:"dismiss",class:`${t}-base-clear__clear`,onClick:this.onClear,onMousedown:this.handleMouseDown,"data-clear":!0},Wa(this.$slots.icon,()=>[W(Bi,{clsPrefix:t},{default:()=>W(RU,null)})])):W("div",{key:"icon",class:`${t}-base-clear__placeholder`},(n=(e=this.$slots).placeholder)===null||n===void 0?void 0:n.call(e))}}))}}),KU=lt({name:"InternalSelectionSuffix",props:{clsPrefix:{type:String,required:!0},showArrow:{type:Boolean,default:void 0},showClear:{type:Boolean,default:void 0},loading:{type:Boolean,default:!1},onClear:Function},setup(t,{slots:e}){return()=>{const{clsPrefix:n}=t;return W(py,{clsPrefix:n,class:`${n}-base-suffix`,strokeWidth:24,scale:.85,show:t.loading},{default:()=>t.showArrow?W(hx,{clsPrefix:n,show:t.showClear,onClear:t.onClear},{placeholder:()=>W(Bi,{clsPrefix:n,class:`${n}-base-suffix__arrow`},{default:()=>Wa(e.default,()=>[W(EU,null)])})}):null})}}}),{cubicBezierEaseInOut:gi}=bl;function qU({duration:t=".2s",delay:e=".1s"}={}){return[$e("&.fade-in-width-expand-transition-leave-from, &.fade-in-width-expand-transition-enter-to",{opacity:1}),$e("&.fade-in-width-expand-transition-leave-to, &.fade-in-width-expand-transition-enter-from",`
 opacity: 0!important;
 margin-left: 0!important;
 margin-right: 0!important;
 `),$e("&.fade-in-width-expand-transition-leave-active",`
 overflow: hidden;
 transition:
 opacity ${t} ${gi},
 max-width ${t} ${gi} ${e},
 margin-left ${t} ${gi} ${e},
 margin-right ${t} ${gi} ${e};
 `),$e("&.fade-in-width-expand-transition-enter-active",`
 overflow: hidden;
 transition:
 opacity ${t} ${gi} ${e},
 max-width ${t} ${gi},
 margin-left ${t} ${gi},
 margin-right ${t} ${gi};
 `)]}const{cubicBezierEaseInOut:gs,cubicBezierEaseOut:XU,cubicBezierEaseIn:YU}=bl;function ZU({overflow:t="hidden",duration:e=".3s",originalTransition:n="",leavingDelay:r="0s",foldPadding:o=!1,enterToProps:s=void 0,leaveToProps:i=void 0,reverse:a=!1}={}){const l=a?"leave":"enter",c=a?"enter":"leave";return[$e(`&.fade-in-height-expand-transition-${c}-from,
 &.fade-in-height-expand-transition-${l}-to`,Object.assign(Object.assign({},s),{opacity:1})),$e(`&.fade-in-height-expand-transition-${c}-to,
 &.fade-in-height-expand-transition-${l}-from`,Object.assign(Object.assign({},i),{opacity:0,marginTop:"0 !important",marginBottom:"0 !important",paddingTop:o?"0 !important":void 0,paddingBottom:o?"0 !important":void 0})),$e(`&.fade-in-height-expand-transition-${c}-active`,`
 overflow: ${t};
 transition:
 max-height ${e} ${gs} ${r},
 opacity ${e} ${XU} ${r},
 margin-top ${e} ${gs} ${r},
 margin-bottom ${e} ${gs} ${r},
 padding-top ${e} ${gs} ${r},
 padding-bottom ${e} ${gs} ${r}
 ${n?","+n:""}
 `),$e(`&.fade-in-height-expand-transition-${l}-active`,`
 overflow: ${t};
 transition:
 max-height ${e} ${gs},
 opacity ${e} ${YU},
 margin-top ${e} ${gs},
 margin-bottom ${e} ${gs},
 padding-top ${e} ${gs},
 padding-bottom ${e} ${gs}
 ${n?","+n:""}
 `)]}const JU=Bc&&"chrome"in window;Bc&&navigator.userAgent.includes("Firefox");const _E=Bc&&navigator.userAgent.includes("Safari")&&!JU,QU={paddingTiny:"0 8px",paddingSmall:"0 10px",paddingMedium:"0 12px",paddingLarge:"0 14px",clearSize:"16px"},e6=t=>{const{textColor2:e,textColor3:n,textColorDisabled:r,primaryColor:o,primaryColorHover:s,inputColor:i,inputColorDisabled:a,borderColor:l,warningColor:c,warningColorHover:u,errorColor:d,errorColorHover:h,borderRadius:f,lineHeight:p,fontSizeTiny:m,fontSizeSmall:g,fontSizeMedium:b,fontSizeLarge:v,heightTiny:w,heightSmall:y,heightMedium:C,heightLarge:S,actionColor:$,clearColor:I,clearColorHover:R,clearColorPressed:T,placeholderColor:N,placeholderColorDisabled:_,iconColor:P,iconColorDisabled:z,iconColorHover:L,iconColorPressed:O}=t;return Object.assign(Object.assign({},QU),{countTextColorDisabled:r,countTextColor:n,heightTiny:w,heightSmall:y,heightMedium:C,heightLarge:S,fontSizeTiny:m,fontSizeSmall:g,fontSizeMedium:b,fontSizeLarge:v,lineHeight:p,lineHeightTextarea:p,borderRadius:f,iconSize:"16px",groupLabelColor:$,groupLabelTextColor:e,textColor:e,textColorDisabled:r,textDecorationColor:e,caretColor:o,placeholderColor:N,placeholderColorDisabled:_,color:i,colorDisabled:a,colorFocus:i,groupLabelBorder:`1px solid ${l}`,border:`1px solid ${l}`,borderHover:`1px solid ${s}`,borderDisabled:`1px solid ${l}`,borderFocus:`1px solid ${s}`,boxShadowFocus:`0 0 0 2px ${Da(o,{alpha:.2})}`,loadingColor:o,loadingColorWarning:c,borderWarning:`1px solid ${c}`,borderHoverWarning:`1px solid ${u}`,colorFocusWarning:i,borderFocusWarning:`1px solid ${u}`,boxShadowFocusWarning:`0 0 0 2px ${Da(c,{alpha:.2})}`,caretColorWarning:c,loadingColorError:d,borderError:`1px solid ${d}`,borderHoverError:`1px solid ${h}`,colorFocusError:i,borderFocusError:`1px solid ${h}`,boxShadowFocusError:`0 0 0 2px ${Da(d,{alpha:.2})}`,caretColorError:d,clearColor:I,clearColorHover:R,clearColorPressed:T,iconColor:P,iconColorDisabled:z,iconColorHover:L,iconColorPressed:O,suffixTextColor:e})},t6={name:"Input",common:Bo,self:e6},n6=t6,AE="n-input";function r6(t){let e=0;for(const n of t)e++;return e}function Kf(t){return t===""||t==null}function o6(t){const e=Ne(null);function n(){const{value:s}=t;if(!(s!=null&&s.focus)){o();return}const{selectionStart:i,selectionEnd:a,value:l}=s;if(i==null||a==null){o();return}e.value={start:i,end:a,beforeText:l.slice(0,i),afterText:l.slice(a)}}function r(){var s;const{value:i}=e,{value:a}=t;if(!i||!a)return;const{value:l}=a,{start:c,beforeText:u,afterText:d}=i;let h=l.length;if(l.endsWith(d))h=l.length-d.length;else if(l.startsWith(u))h=u.length;else{const f=u[c-1],p=l.indexOf(f,c-1);p!==-1&&(h=p+1)}(s=a.setSelectionRange)===null||s===void 0||s.call(a,h,h)}function o(){e.value=null}return Fn(t,o),{recordCursor:n,restoreCursor:r}}const ES=lt({name:"InputWordCount",setup(t,{slots:e}){const{mergedValueRef:n,maxlengthRef:r,mergedClsPrefixRef:o,countGraphemesRef:s}=Kt(AE),i=Me(()=>{const{value:a}=n;return a===null||Array.isArray(a)?0:(s.value||r6)(a)});return()=>{const{value:a}=r,{value:l}=n;return W("span",{class:`${o.value}-input-word-count`},bL(e.default,{value:l===null||Array.isArray(l)?"":l},()=>[a===void 0?i.value:`${i.value} / ${a}`]))}}}),s6=Ae("input",`
 max-width: 100%;
 cursor: text;
 line-height: 1.5;
 z-index: auto;
 outline: none;
 box-sizing: border-box;
 position: relative;
 display: inline-flex;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color .3s var(--n-bezier);
 font-size: var(--n-font-size);
 --n-padding-vertical: calc((var(--n-height) - 1.5 * var(--n-font-size)) / 2);
`,[Se("input, textarea",`
 overflow: hidden;
 flex-grow: 1;
 position: relative;
 `),Se("input-el, textarea-el, input-mirror, textarea-mirror, separator, placeholder",`
 box-sizing: border-box;
 font-size: inherit;
 line-height: 1.5;
 font-family: inherit;
 border: none;
 outline: none;
 background-color: #0000;
 text-align: inherit;
 transition:
 -webkit-text-fill-color .3s var(--n-bezier),
 caret-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 `),Se("input-el, textarea-el",`
 -webkit-appearance: none;
 scrollbar-width: none;
 width: 100%;
 min-width: 0;
 text-decoration-color: var(--n-text-decoration-color);
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 background-color: transparent;
 `,[$e("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),$e("&::placeholder",`
 color: #0000;
 -webkit-text-fill-color: transparent !important;
 `),$e("&:-webkit-autofill ~",[Se("placeholder","display: none;")])]),We("round",[Ks("textarea","border-radius: calc(var(--n-height) / 2);")]),Se("placeholder",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: hidden;
 color: var(--n-placeholder-color);
 `,[$e("span",`
 width: 100%;
 display: inline-block;
 `)]),We("textarea",[Se("placeholder","overflow: visible;")]),Ks("autosize","width: 100%;"),We("autosize",[Se("textarea-el, input-el",`
 position: absolute;
 top: 0;
 left: 0;
 height: 100%;
 `)]),Ae("input-wrapper",`
 overflow: hidden;
 display: inline-flex;
 flex-grow: 1;
 position: relative;
 padding-left: var(--n-padding-left);
 padding-right: var(--n-padding-right);
 `),Se("input-mirror",`
 padding: 0;
 height: var(--n-height);
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre;
 pointer-events: none;
 `),Se("input-el",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 `,[$e("+",[Se("placeholder",`
 display: flex;
 align-items: center; 
 `)])]),Ks("textarea",[Se("placeholder","white-space: nowrap;")]),Se("eye",`
 transition: color .3s var(--n-bezier);
 `),We("textarea","width: 100%;",[Ae("input-word-count",`
 position: absolute;
 right: var(--n-padding-right);
 bottom: var(--n-padding-vertical);
 `),We("resizable",[Ae("input-wrapper",`
 resize: vertical;
 min-height: var(--n-height);
 `)]),Se("textarea-el, textarea-mirror, placeholder",`
 height: 100%;
 padding-left: 0;
 padding-right: 0;
 padding-top: var(--n-padding-vertical);
 padding-bottom: var(--n-padding-vertical);
 word-break: break-word;
 display: inline-block;
 vertical-align: bottom;
 box-sizing: border-box;
 line-height: var(--n-line-height-textarea);
 margin: 0;
 resize: none;
 white-space: pre-wrap;
 `),Se("textarea-mirror",`
 width: 100%;
 pointer-events: none;
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre-wrap;
 overflow-wrap: break-word;
 `)]),We("pair",[Se("input-el, placeholder","text-align: center;"),Se("separator",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 white-space: nowrap;
 `,[Ae("icon",`
 color: var(--n-icon-color);
 `),Ae("base-icon",`
 color: var(--n-icon-color);
 `)])]),We("disabled",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[Se("border","border: var(--n-border-disabled);"),Se("input-el, textarea-el",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 text-decoration-color: var(--n-text-color-disabled);
 `),Se("placeholder","color: var(--n-placeholder-color-disabled);"),Se("separator","color: var(--n-text-color-disabled);",[Ae("icon",`
 color: var(--n-icon-color-disabled);
 `),Ae("base-icon",`
 color: var(--n-icon-color-disabled);
 `)]),Ae("input-word-count",`
 color: var(--n-count-text-color-disabled);
 `),Se("suffix, prefix","color: var(--n-text-color-disabled);",[Ae("icon",`
 color: var(--n-icon-color-disabled);
 `),Ae("internal-icon",`
 color: var(--n-icon-color-disabled);
 `)])]),Ks("disabled",[Se("eye",`
 display: flex;
 align-items: center;
 justify-content: center;
 color: var(--n-icon-color);
 cursor: pointer;
 `,[$e("&:hover",`
 color: var(--n-icon-color-hover);
 `),$e("&:active",`
 color: var(--n-icon-color-pressed);
 `)]),$e("&:hover",[Se("state-border","border: var(--n-border-hover);")]),We("focus","background-color: var(--n-color-focus);",[Se("state-border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),Se("border, state-border",`
 box-sizing: border-box;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border-radius: inherit;
 border: var(--n-border);
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),Se("state-border",`
 border-color: #0000;
 z-index: 1;
 `),Se("prefix","margin-right: 4px;"),Se("suffix",`
 margin-left: 4px;
 `),Se("suffix, prefix",`
 transition: color .3s var(--n-bezier);
 flex-wrap: nowrap;
 flex-shrink: 0;
 line-height: var(--n-height);
 white-space: nowrap;
 display: inline-flex;
 align-items: center;
 justify-content: center;
 color: var(--n-suffix-text-color);
 `,[Ae("base-loading",`
 font-size: var(--n-icon-size);
 margin: 0 2px;
 color: var(--n-loading-color);
 `),Ae("base-clear",`
 font-size: var(--n-icon-size);
 `,[Se("placeholder",[Ae("base-icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)])]),$e(">",[Ae("icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)]),Ae("base-icon",`
 font-size: var(--n-icon-size);
 `)]),Ae("input-word-count",`
 pointer-events: none;
 line-height: 1.5;
 font-size: .85em;
 color: var(--n-count-text-color);
 transition: color .3s var(--n-bezier);
 margin-left: 4px;
 font-variant: tabular-nums;
 `),["warning","error"].map(t=>We(`${t}-status`,[Ks("disabled",[Ae("base-loading",`
 color: var(--n-loading-color-${t})
 `),Se("input-el, textarea-el",`
 caret-color: var(--n-caret-color-${t});
 `),Se("state-border",`
 border: var(--n-border-${t});
 `),$e("&:hover",[Se("state-border",`
 border: var(--n-border-hover-${t});
 `)]),$e("&:focus",`
 background-color: var(--n-color-focus-${t});
 `,[Se("state-border",`
 box-shadow: var(--n-box-shadow-focus-${t});
 border: var(--n-border-focus-${t});
 `)]),We("focus",`
 background-color: var(--n-color-focus-${t});
 `,[Se("state-border",`
 box-shadow: var(--n-box-shadow-focus-${t});
 border: var(--n-border-focus-${t});
 `)])])]))]),i6=Ae("input",[We("disabled",[Se("input-el, textarea-el",`
 -webkit-text-fill-color: var(--n-text-color-disabled);
 `)])]),a6=Object.assign(Object.assign({},Ut.props),{bordered:{type:Boolean,default:void 0},type:{type:String,default:"text"},placeholder:[Array,String],defaultValue:{type:[String,Array],default:null},value:[String,Array],disabled:{type:Boolean,default:void 0},size:String,rows:{type:[Number,String],default:3},round:Boolean,minlength:[String,Number],maxlength:[String,Number],clearable:Boolean,autosize:{type:[Boolean,Object],default:!1},pair:Boolean,separator:String,readonly:{type:[String,Boolean],default:!1},passivelyActivated:Boolean,showPasswordOn:String,stateful:{type:Boolean,default:!0},autofocus:Boolean,inputProps:Object,resizable:{type:Boolean,default:!0},showCount:Boolean,loading:{type:Boolean,default:void 0},allowInput:Function,renderCount:Function,onMousedown:Function,onKeydown:Function,onKeyup:Function,onInput:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClick:[Function,Array],onChange:[Function,Array],onClear:[Function,Array],countGraphemes:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],textDecoration:[String,Array],attrSize:{type:Number,default:20},onInputBlur:[Function,Array],onInputFocus:[Function,Array],onDeactivate:[Function,Array],onActivate:[Function,Array],onWrapperFocus:[Function,Array],onWrapperBlur:[Function,Array],internalDeactivateOnEnter:Boolean,internalForceFocus:Boolean,internalLoadingBeforeSuffix:Boolean,showPasswordToggle:Boolean}),l6=lt({name:"Input",props:a6,setup(t){const{mergedClsPrefixRef:e,mergedBorderedRef:n,inlineThemeDisabled:r,mergedRtlRef:o}=Mr(t),s=Ut("Input","-input",s6,n6,t,e);_E&&Hc("-input-safari",i6,e);const i=Ne(null),a=Ne(null),l=Ne(null),c=Ne(null),u=Ne(null),d=Ne(null),h=Ne(null),f=o6(h),p=Ne(null),{localeRef:m}=$U("Input"),g=Ne(t.defaultValue),b=Bn(t,"value"),v=PT(b,g),w=ZT(t),{mergedSizeRef:y,mergedDisabledRef:C,mergedStatusRef:S}=w,$=Ne(!1),I=Ne(!1),R=Ne(!1),T=Ne(!1);let N=null;const _=Me(()=>{const{placeholder:ne,pair:ke}=t;return ke?Array.isArray(ne)?ne:ne===void 0?["",""]:[ne,ne]:ne===void 0?[m.value.placeholder]:[ne]}),P=Me(()=>{const{value:ne}=R,{value:ke}=v,{value:it}=_;return!ne&&(Kf(ke)||Array.isArray(ke)&&Kf(ke[0]))&&it[0]}),z=Me(()=>{const{value:ne}=R,{value:ke}=v,{value:it}=_;return!ne&&it[1]&&(Kf(ke)||Array.isArray(ke)&&Kf(ke[1]))}),L=rx(()=>t.internalForceFocus||$.value),O=rx(()=>{if(C.value||t.readonly||!t.clearable||!L.value&&!I.value)return!1;const{value:ne}=v,{value:ke}=L;return t.pair?!!(Array.isArray(ne)&&(ne[0]||ne[1]))&&(I.value||ke):!!ne&&(I.value||ke)}),B=Me(()=>{const{showPasswordOn:ne}=t;if(ne)return ne;if(t.showPasswordToggle)return"click"}),U=Ne(!1),Q=Me(()=>{const{textDecoration:ne}=t;return ne?Array.isArray(ne)?ne.map(ke=>({textDecoration:ke})):[{textDecoration:ne}]:["",""]}),se=Ne(void 0),ce=()=>{var ne,ke;if(t.type==="textarea"){const{autosize:it}=t;if(it&&(se.value=(ke=(ne=p.value)===null||ne===void 0?void 0:ne.$el)===null||ke===void 0?void 0:ke.offsetWidth),!a.value||typeof it=="boolean")return;const{paddingTop:tn,paddingBottom:nn,lineHeight:Gt}=window.getComputedStyle(a.value),yo=Number(tn.slice(0,-2)),ds=Number(nn.slice(0,-2)),hs=Number(Gt.slice(0,-2)),{value:fs}=l;if(!fs)return;if(it.minRows){const hi=Math.max(it.minRows,1),Rl=`${yo+ds+hs*hi}px`;fs.style.minHeight=Rl}if(it.maxRows){const hi=`${yo+ds+hs*it.maxRows}px`;fs.style.maxHeight=hi}}},de=Me(()=>{const{maxlength:ne}=t;return ne===void 0?void 0:Number(ne)});as(()=>{const{value:ne}=v;Array.isArray(ne)||qt(ne)});const we=Pc().proxy;function Ie(ne){const{onUpdateValue:ke,"onUpdate:value":it,onInput:tn}=t,{nTriggerFormInput:nn}=w;ke&&dn(ke,ne),it&&dn(it,ne),tn&&dn(tn,ne),g.value=ne,nn()}function j(ne){const{onChange:ke}=t,{nTriggerFormChange:it}=w;ke&&dn(ke,ne),g.value=ne,it()}function re(ne){const{onBlur:ke}=t,{nTriggerFormBlur:it}=w;ke&&dn(ke,ne),it()}function le(ne){const{onFocus:ke}=t,{nTriggerFormFocus:it}=w;ke&&dn(ke,ne),it()}function Ce(ne){const{onClear:ke}=t;ke&&dn(ke,ne)}function ve(ne){const{onInputBlur:ke}=t;ke&&dn(ke,ne)}function Le(ne){const{onInputFocus:ke}=t;ke&&dn(ke,ne)}function _e(){const{onDeactivate:ne}=t;ne&&dn(ne)}function F(){const{onActivate:ne}=t;ne&&dn(ne)}function V(ne){const{onClick:ke}=t;ke&&dn(ke,ne)}function oe(ne){const{onWrapperFocus:ke}=t;ke&&dn(ke,ne)}function G(ne){const{onWrapperBlur:ke}=t;ke&&dn(ke,ne)}function Y(){R.value=!0}function ae(ne){R.value=!1,ne.target===d.value?pe(ne,1):pe(ne,0)}function pe(ne,ke=0,it="input"){const tn=ne.target.value;if(qt(tn),ne instanceof InputEvent&&!ne.isComposing&&(R.value=!1),t.type==="textarea"){const{value:Gt}=p;Gt&&Gt.syncUnifiedContainer()}if(N=tn,R.value)return;f.recordCursor();const nn=ye(tn);if(nn)if(!t.pair)it==="input"?Ie(tn):j(tn);else{let{value:Gt}=v;Array.isArray(Gt)?Gt=[Gt[0],Gt[1]]:Gt=["",""],Gt[ke]=tn,it==="input"?Ie(Gt):j(Gt)}we.$forceUpdate(),nn||Do(f.restoreCursor)}function ye(ne){const{countGraphemes:ke,maxlength:it,minlength:tn}=t;if(ke){let Gt;if(it!==void 0&&(Gt===void 0&&(Gt=ke(ne)),Gt>Number(it))||tn!==void 0&&(Gt===void 0&&(Gt=ke(ne)),Gt<Number(it)))return!1}const{allowInput:nn}=t;return typeof nn=="function"?nn(ne):!0}function ge(ne){ve(ne),ne.relatedTarget===i.value&&_e(),ne.relatedTarget!==null&&(ne.relatedTarget===u.value||ne.relatedTarget===d.value||ne.relatedTarget===a.value)||(T.value=!1),Pe(ne,"blur"),h.value=null}function be(ne,ke){Le(ne),$.value=!0,T.value=!0,F(),Pe(ne,"focus"),ke===0?h.value=u.value:ke===1?h.value=d.value:ke===2&&(h.value=a.value)}function De(ne){t.passivelyActivated&&(G(ne),Pe(ne,"blur"))}function Oe(ne){t.passivelyActivated&&($.value=!0,oe(ne),Pe(ne,"focus"))}function Pe(ne,ke){ne.relatedTarget!==null&&(ne.relatedTarget===u.value||ne.relatedTarget===d.value||ne.relatedTarget===a.value||ne.relatedTarget===i.value)||(ke==="focus"?(le(ne),$.value=!0):ke==="blur"&&(re(ne),$.value=!1))}function qe(ne,ke){pe(ne,ke,"change")}function nt(ne){V(ne)}function dt(ne){Ce(ne),t.pair?(Ie(["",""]),j(["",""])):(Ie(""),j(""))}function ht(ne){const{onMousedown:ke}=t;ke&&ke(ne);const{tagName:it}=ne.target;if(it!=="INPUT"&&it!=="TEXTAREA"){if(t.resizable){const{value:tn}=i;if(tn){const{left:nn,top:Gt,width:yo,height:ds}=tn.getBoundingClientRect(),hs=14;if(nn+yo-hs<ne.clientX&&ne.clientX<nn+yo&&Gt+ds-hs<ne.clientY&&ne.clientY<Gt+ds)return}}ne.preventDefault(),$.value||Ee()}}function $t(){var ne;I.value=!0,t.type==="textarea"&&((ne=p.value)===null||ne===void 0||ne.handleMouseEnterWrapper())}function ln(){var ne;I.value=!1,t.type==="textarea"&&((ne=p.value)===null||ne===void 0||ne.handleMouseLeaveWrapper())}function Cn(){C.value||B.value==="click"&&(U.value=!U.value)}function ro(ne){if(C.value)return;ne.preventDefault();const ke=tn=>{tn.preventDefault(),dr("mouseup",document,ke)};if(Kr("mouseup",document,ke),B.value!=="mousedown")return;U.value=!0;const it=()=>{U.value=!1,dr("mouseup",document,it)};Kr("mouseup",document,it)}function Pn(ne){var ke;switch((ke=t.onKeydown)===null||ke===void 0||ke.call(t,ne),ne.key){case"Escape":Ht();break;case"Enter":Nn(ne);break}}function Nn(ne){var ke,it;if(t.passivelyActivated){const{value:tn}=T;if(tn){t.internalDeactivateOnEnter&&Ht();return}ne.preventDefault(),t.type==="textarea"?(ke=a.value)===null||ke===void 0||ke.focus():(it=u.value)===null||it===void 0||it.focus()}}function Ht(){t.passivelyActivated&&(T.value=!1,Do(()=>{var ne;(ne=i.value)===null||ne===void 0||ne.focus()}))}function Ee(){var ne,ke,it;C.value||(t.passivelyActivated?(ne=i.value)===null||ne===void 0||ne.focus():((ke=a.value)===null||ke===void 0||ke.focus(),(it=u.value)===null||it===void 0||it.focus()))}function He(){var ne;!((ne=i.value)===null||ne===void 0)&&ne.contains(document.activeElement)&&document.activeElement.blur()}function rt(){var ne,ke;(ne=a.value)===null||ne===void 0||ne.select(),(ke=u.value)===null||ke===void 0||ke.select()}function Pt(){C.value||(a.value?a.value.focus():u.value&&u.value.focus())}function en(){const{value:ne}=i;(ne==null?void 0:ne.contains(document.activeElement))&&ne!==document.activeElement&&Ht()}function _n(ne){if(t.type==="textarea"){const{value:ke}=a;ke==null||ke.scrollTo(ne)}else{const{value:ke}=u;ke==null||ke.scrollTo(ne)}}function qt(ne){const{type:ke,pair:it,autosize:tn}=t;if(!it&&tn)if(ke==="textarea"){const{value:nn}=l;nn&&(nn.textContent=(ne!=null?ne:"")+`\r
`)}else{const{value:nn}=c;nn&&(ne?nn.textContent=ne:nn.innerHTML="&nbsp;")}}function mt(){ce()}const cr=Ne({top:"0"});function Mn(ne){var ke;const{scrollTop:it}=ne.target;cr.value.top=`${-it}px`,(ke=p.value)===null||ke===void 0||ke.syncUnifiedContainer()}let us=null;hc(()=>{const{autosize:ne,type:ke}=t;ne&&ke==="textarea"?us=Fn(v,it=>{!Array.isArray(it)&&it!==N&&qt(it)}):us==null||us()});let la=null;hc(()=>{t.type==="textarea"?la=Fn(v,ne=>{var ke;!Array.isArray(ne)&&ne!==N&&((ke=p.value)===null||ke===void 0||ke.syncUnifiedContainer())}):la==null||la()}),Yr(AE,{mergedValueRef:v,maxlengthRef:de,mergedClsPrefixRef:e,countGraphemesRef:Bn(t,"countGraphemes")});const hf={wrapperElRef:i,inputElRef:u,textareaElRef:a,isCompositing:R,focus:Ee,blur:He,select:rt,deactivate:en,activate:Pt,scrollTo:_n},ff=vl("Input",o,e),pf=Me(()=>{const{value:ne}=y,{common:{cubicBezierEaseInOut:ke},self:{color:it,borderRadius:tn,textColor:nn,caretColor:Gt,caretColorError:yo,caretColorWarning:ds,textDecorationColor:hs,border:fs,borderDisabled:hi,borderHover:Rl,borderFocus:Tb,placeholderColor:Eb,placeholderColorDisabled:mf,lineHeightTextarea:Nl,colorDisabled:gf,colorFocus:bf,textColorDisabled:vf,boxShadowFocus:Rb,iconSize:Nb,colorFocusWarning:_b,boxShadowFocusWarning:Ab,borderWarning:xf,borderFocusWarning:yf,borderHoverWarning:Db,colorFocusError:Fb,boxShadowFocusError:Ob,borderError:Pb,borderFocusError:wf,borderHoverError:Cf,clearSize:ca,clearColor:$f,clearColorHover:hu,clearColorPressed:ua,iconColor:oo,iconColorDisabled:Mb,suffixTextColor:Lb,countTextColor:Sf,countTextColorDisabled:If,iconColorHover:zr,iconColorPressed:kf,loadingColor:da,loadingColorError:Tf,loadingColorWarning:_l,[Ge("padding",ne)]:Ef,[Ge("fontSize",ne)]:Bb,[Ge("height",ne)]:ha}}=s.value,{left:Rf,right:fu}=CT(Ef);return{"--n-bezier":ke,"--n-count-text-color":Sf,"--n-count-text-color-disabled":If,"--n-color":it,"--n-font-size":Bb,"--n-border-radius":tn,"--n-height":ha,"--n-padding-left":Rf,"--n-padding-right":fu,"--n-text-color":nn,"--n-caret-color":Gt,"--n-text-decoration-color":hs,"--n-border":fs,"--n-border-disabled":hi,"--n-border-hover":Rl,"--n-border-focus":Tb,"--n-placeholder-color":Eb,"--n-placeholder-color-disabled":mf,"--n-icon-size":Nb,"--n-line-height-textarea":Nl,"--n-color-disabled":gf,"--n-color-focus":bf,"--n-text-color-disabled":vf,"--n-box-shadow-focus":Rb,"--n-loading-color":da,"--n-caret-color-warning":ds,"--n-color-focus-warning":_b,"--n-box-shadow-focus-warning":Ab,"--n-border-warning":xf,"--n-border-focus-warning":yf,"--n-border-hover-warning":Db,"--n-loading-color-warning":_l,"--n-caret-color-error":yo,"--n-color-focus-error":Fb,"--n-box-shadow-focus-error":Ob,"--n-border-error":Pb,"--n-border-focus-error":wf,"--n-border-hover-error":Cf,"--n-loading-color-error":Tf,"--n-clear-color":$f,"--n-clear-size":ca,"--n-clear-color-hover":hu,"--n-clear-color-pressed":ua,"--n-icon-color":oo,"--n-icon-color-hover":zr,"--n-icon-color-pressed":kf,"--n-icon-color-disabled":Mb,"--n-suffix-text-color":Lb}}),zs=r?bo("input",Me(()=>{const{value:ne}=y;return ne[0]}),pf,t):void 0;return Object.assign(Object.assign({},hf),{wrapperElRef:i,inputElRef:u,inputMirrorElRef:c,inputEl2Ref:d,textareaElRef:a,textareaMirrorElRef:l,textareaScrollbarInstRef:p,rtlEnabled:ff,uncontrolledValue:g,mergedValue:v,passwordVisible:U,mergedPlaceholder:_,showPlaceholder1:P,showPlaceholder2:z,mergedFocus:L,isComposing:R,activated:T,showClearButton:O,mergedSize:y,mergedDisabled:C,textDecorationStyle:Q,mergedClsPrefix:e,mergedBordered:n,mergedShowPasswordOn:B,placeholderStyle:cr,mergedStatus:S,textAreaScrollContainerWidth:se,handleTextAreaScroll:Mn,handleCompositionStart:Y,handleCompositionEnd:ae,handleInput:pe,handleInputBlur:ge,handleInputFocus:be,handleWrapperBlur:De,handleWrapperFocus:Oe,handleMouseEnter:$t,handleMouseLeave:ln,handleMouseDown:ht,handleChange:qe,handleClick:nt,handleClear:dt,handlePasswordToggleClick:Cn,handlePasswordToggleMousedown:ro,handleWrapperKeydown:Pn,handleTextAreaMirrorResize:mt,getTextareaScrollContainer:()=>a.value,mergedTheme:s,cssVars:r?void 0:pf,themeClass:zs==null?void 0:zs.themeClass,onRender:zs==null?void 0:zs.onRender})},render(){var t,e;const{mergedClsPrefix:n,mergedStatus:r,themeClass:o,type:s,countGraphemes:i,onRender:a}=this,l=this.$slots;return a==null||a(),W("div",{ref:"wrapperElRef",class:[`${n}-input`,o,r&&`${n}-input--${r}-status`,{[`${n}-input--rtl`]:this.rtlEnabled,[`${n}-input--disabled`]:this.mergedDisabled,[`${n}-input--textarea`]:s==="textarea",[`${n}-input--resizable`]:this.resizable&&!this.autosize,[`${n}-input--autosize`]:this.autosize,[`${n}-input--round`]:this.round&&s!=="textarea",[`${n}-input--pair`]:this.pair,[`${n}-input--focus`]:this.mergedFocus,[`${n}-input--stateful`]:this.stateful}],style:this.cssVars,tabindex:!this.mergedDisabled&&this.passivelyActivated&&!this.activated?0:void 0,onFocus:this.handleWrapperFocus,onBlur:this.handleWrapperBlur,onClick:this.handleClick,onMousedown:this.handleMouseDown,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd,onKeyup:this.onKeyup,onKeydown:this.handleWrapperKeydown},W("div",{class:`${n}-input-wrapper`},yr(l.prefix,c=>c&&W("div",{class:`${n}-input__prefix`},c)),s==="textarea"?W(gy,{ref:"textareaScrollbarInstRef",class:`${n}-input__textarea`,container:this.getTextareaScrollContainer,triggerDisplayManually:!0,useUnifiedContainer:!0,internalHoistYRail:!0},{default:()=>{var c,u;const{textAreaScrollContainerWidth:d}=this,h={width:this.autosize&&d&&`${d}px`};return W(fn,null,W("textarea",Object.assign({},this.inputProps,{ref:"textareaElRef",class:[`${n}-input__textarea-el`,(c=this.inputProps)===null||c===void 0?void 0:c.class],autofocus:this.autofocus,rows:Number(this.rows),placeholder:this.placeholder,value:this.mergedValue,disabled:this.mergedDisabled,maxlength:i?void 0:this.maxlength,minlength:i?void 0:this.minlength,readonly:this.readonly,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,style:[this.textDecorationStyle[0],(u=this.inputProps)===null||u===void 0?void 0:u.style,h],onBlur:this.handleInputBlur,onFocus:f=>this.handleInputFocus(f,2),onInput:this.handleInput,onChange:this.handleChange,onScroll:this.handleTextAreaScroll})),this.showPlaceholder1?W("div",{class:`${n}-input__placeholder`,style:[this.placeholderStyle,h],key:"placeholder"},this.mergedPlaceholder[0]):null,this.autosize?W(ud,{onResize:this.handleTextAreaMirrorResize},{default:()=>W("div",{ref:"textareaMirrorElRef",class:`${n}-input__textarea-mirror`,key:"mirror"})}):null)}}):W("div",{class:`${n}-input__input`},W("input",Object.assign({type:s==="password"&&this.mergedShowPasswordOn&&this.passwordVisible?"text":s},this.inputProps,{ref:"inputElRef",class:[`${n}-input__input-el`,(t=this.inputProps)===null||t===void 0?void 0:t.class],style:[this.textDecorationStyle[0],(e=this.inputProps)===null||e===void 0?void 0:e.style],tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[0],disabled:this.mergedDisabled,maxlength:i?void 0:this.maxlength,minlength:i?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[0]:this.mergedValue,readonly:this.readonly,autofocus:this.autofocus,size:this.attrSize,onBlur:this.handleInputBlur,onFocus:c=>this.handleInputFocus(c,0),onInput:c=>this.handleInput(c,0),onChange:c=>this.handleChange(c,0)})),this.showPlaceholder1?W("div",{class:`${n}-input__placeholder`},W("span",null,this.mergedPlaceholder[0])):null,this.autosize?W("div",{class:`${n}-input__input-mirror`,key:"mirror",ref:"inputMirrorElRef"},"\xA0"):null),!this.pair&&yr(l.suffix,c=>c||this.clearable||this.showCount||this.mergedShowPasswordOn||this.loading!==void 0?W("div",{class:`${n}-input__suffix`},[yr(l["clear-icon-placeholder"],u=>(this.clearable||u)&&W(hx,{clsPrefix:n,show:this.showClearButton,onClear:this.handleClear},{placeholder:()=>u,icon:()=>{var d,h;return(h=(d=this.$slots)["clear-icon"])===null||h===void 0?void 0:h.call(d)}})),this.internalLoadingBeforeSuffix?null:c,this.loading!==void 0?W(KU,{clsPrefix:n,loading:this.loading,showArrow:!1,showClear:!1,style:this.cssVars}):null,this.internalLoadingBeforeSuffix?c:null,this.showCount&&this.type!=="textarea"?W(ES,null,{default:u=>{var d;return(d=l.count)===null||d===void 0?void 0:d.call(l,u)}}):null,this.mergedShowPasswordOn&&this.type==="password"?W("div",{class:`${n}-input__eye`,onMousedown:this.handlePasswordToggleMousedown,onClick:this.handlePasswordToggleClick},this.passwordVisible?Wa(l["password-visible-icon"],()=>[W(Bi,{clsPrefix:n},{default:()=>W(kU,null)})]):Wa(l["password-invisible-icon"],()=>[W(Bi,{clsPrefix:n},{default:()=>W(TU,null)})])):null]):null)),this.pair?W("span",{class:`${n}-input__separator`},Wa(l.separator,()=>[this.separator])):null,this.pair?W("div",{class:`${n}-input-wrapper`},W("div",{class:`${n}-input__input`},W("input",{ref:"inputEl2Ref",type:this.type,class:`${n}-input__input-el`,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[1],disabled:this.mergedDisabled,maxlength:i?void 0:this.maxlength,minlength:i?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[1]:void 0,readonly:this.readonly,style:this.textDecorationStyle[1],onBlur:this.handleInputBlur,onFocus:c=>this.handleInputFocus(c,1),onInput:c=>this.handleInput(c,1),onChange:c=>this.handleChange(c,1)}),this.showPlaceholder2?W("div",{class:`${n}-input__placeholder`},W("span",null,this.mergedPlaceholder[1])):null),yr(l.suffix,c=>(this.clearable||c)&&W("div",{class:`${n}-input__suffix`},[this.clearable&&W(hx,{clsPrefix:n,show:this.showClearButton,onClear:this.handleClear},{icon:()=>{var u;return(u=l["clear-icon"])===null||u===void 0?void 0:u.call(l)},placeholder:()=>{var u;return(u=l["clear-icon-placeholder"])===null||u===void 0?void 0:u.call(l)}}),c]))):null,this.mergedBordered?W("div",{class:`${n}-input__border`}):null,this.mergedBordered?W("div",{class:`${n}-input__state-border`}):null,this.showCount&&s==="textarea"?W(ES,null,{default:c=>{var u;const{renderCount:d}=this;return d?d(c):(u=l.count)===null||u===void 0?void 0:u.call(l,c)}}):null)}});function ga(t){return ad(t,[255,255,255,.16])}function qf(t){return ad(t,[0,0,0,.12])}const c6="n-button-group",u6={paddingTiny:"0 6px",paddingSmall:"0 10px",paddingMedium:"0 14px",paddingLarge:"0 18px",paddingRoundTiny:"0 10px",paddingRoundSmall:"0 14px",paddingRoundMedium:"0 18px",paddingRoundLarge:"0 22px",iconMarginTiny:"6px",iconMarginSmall:"6px",iconMarginMedium:"6px",iconMarginLarge:"6px",iconSizeTiny:"14px",iconSizeSmall:"18px",iconSizeMedium:"18px",iconSizeLarge:"20px",rippleDuration:".6s"},d6=t=>{const{heightTiny:e,heightSmall:n,heightMedium:r,heightLarge:o,borderRadius:s,fontSizeTiny:i,fontSizeSmall:a,fontSizeMedium:l,fontSizeLarge:c,opacityDisabled:u,textColor2:d,textColor3:h,primaryColorHover:f,primaryColorPressed:p,borderColor:m,primaryColor:g,baseColor:b,infoColor:v,infoColorHover:w,infoColorPressed:y,successColor:C,successColorHover:S,successColorPressed:$,warningColor:I,warningColorHover:R,warningColorPressed:T,errorColor:N,errorColorHover:_,errorColorPressed:P,fontWeight:z,buttonColor2:L,buttonColor2Hover:O,buttonColor2Pressed:B,fontWeightStrong:U}=t;return Object.assign(Object.assign({},u6),{heightTiny:e,heightSmall:n,heightMedium:r,heightLarge:o,borderRadiusTiny:s,borderRadiusSmall:s,borderRadiusMedium:s,borderRadiusLarge:s,fontSizeTiny:i,fontSizeSmall:a,fontSizeMedium:l,fontSizeLarge:c,opacityDisabled:u,colorOpacitySecondary:"0.16",colorOpacitySecondaryHover:"0.22",colorOpacitySecondaryPressed:"0.28",colorSecondary:L,colorSecondaryHover:O,colorSecondaryPressed:B,colorTertiary:L,colorTertiaryHover:O,colorTertiaryPressed:B,colorQuaternary:"#0000",colorQuaternaryHover:O,colorQuaternaryPressed:B,color:"#0000",colorHover:"#0000",colorPressed:"#0000",colorFocus:"#0000",colorDisabled:"#0000",textColor:d,textColorTertiary:h,textColorHover:f,textColorPressed:p,textColorFocus:f,textColorDisabled:d,textColorText:d,textColorTextHover:f,textColorTextPressed:p,textColorTextFocus:f,textColorTextDisabled:d,textColorGhost:d,textColorGhostHover:f,textColorGhostPressed:p,textColorGhostFocus:f,textColorGhostDisabled:d,border:`1px solid ${m}`,borderHover:`1px solid ${f}`,borderPressed:`1px solid ${p}`,borderFocus:`1px solid ${f}`,borderDisabled:`1px solid ${m}`,rippleColor:g,colorPrimary:g,colorHoverPrimary:f,colorPressedPrimary:p,colorFocusPrimary:f,colorDisabledPrimary:g,textColorPrimary:b,textColorHoverPrimary:b,textColorPressedPrimary:b,textColorFocusPrimary:b,textColorDisabledPrimary:b,textColorTextPrimary:g,textColorTextHoverPrimary:f,textColorTextPressedPrimary:p,textColorTextFocusPrimary:f,textColorTextDisabledPrimary:d,textColorGhostPrimary:g,textColorGhostHoverPrimary:f,textColorGhostPressedPrimary:p,textColorGhostFocusPrimary:f,textColorGhostDisabledPrimary:g,borderPrimary:`1px solid ${g}`,borderHoverPrimary:`1px solid ${f}`,borderPressedPrimary:`1px solid ${p}`,borderFocusPrimary:`1px solid ${f}`,borderDisabledPrimary:`1px solid ${g}`,rippleColorPrimary:g,colorInfo:v,colorHoverInfo:w,colorPressedInfo:y,colorFocusInfo:w,colorDisabledInfo:v,textColorInfo:b,textColorHoverInfo:b,textColorPressedInfo:b,textColorFocusInfo:b,textColorDisabledInfo:b,textColorTextInfo:v,textColorTextHoverInfo:w,textColorTextPressedInfo:y,textColorTextFocusInfo:w,textColorTextDisabledInfo:d,textColorGhostInfo:v,textColorGhostHoverInfo:w,textColorGhostPressedInfo:y,textColorGhostFocusInfo:w,textColorGhostDisabledInfo:v,borderInfo:`1px solid ${v}`,borderHoverInfo:`1px solid ${w}`,borderPressedInfo:`1px solid ${y}`,borderFocusInfo:`1px solid ${w}`,borderDisabledInfo:`1px solid ${v}`,rippleColorInfo:v,colorSuccess:C,colorHoverSuccess:S,colorPressedSuccess:$,colorFocusSuccess:S,colorDisabledSuccess:C,textColorSuccess:b,textColorHoverSuccess:b,textColorPressedSuccess:b,textColorFocusSuccess:b,textColorDisabledSuccess:b,textColorTextSuccess:C,textColorTextHoverSuccess:S,textColorTextPressedSuccess:$,textColorTextFocusSuccess:S,textColorTextDisabledSuccess:d,textColorGhostSuccess:C,textColorGhostHoverSuccess:S,textColorGhostPressedSuccess:$,textColorGhostFocusSuccess:S,textColorGhostDisabledSuccess:C,borderSuccess:`1px solid ${C}`,borderHoverSuccess:`1px solid ${S}`,borderPressedSuccess:`1px solid ${$}`,borderFocusSuccess:`1px solid ${S}`,borderDisabledSuccess:`1px solid ${C}`,rippleColorSuccess:C,colorWarning:I,colorHoverWarning:R,colorPressedWarning:T,colorFocusWarning:R,colorDisabledWarning:I,textColorWarning:b,textColorHoverWarning:b,textColorPressedWarning:b,textColorFocusWarning:b,textColorDisabledWarning:b,textColorTextWarning:I,textColorTextHoverWarning:R,textColorTextPressedWarning:T,textColorTextFocusWarning:R,textColorTextDisabledWarning:d,textColorGhostWarning:I,textColorGhostHoverWarning:R,textColorGhostPressedWarning:T,textColorGhostFocusWarning:R,textColorGhostDisabledWarning:I,borderWarning:`1px solid ${I}`,borderHoverWarning:`1px solid ${R}`,borderPressedWarning:`1px solid ${T}`,borderFocusWarning:`1px solid ${R}`,borderDisabledWarning:`1px solid ${I}`,rippleColorWarning:I,colorError:N,colorHoverError:_,colorPressedError:P,colorFocusError:_,colorDisabledError:N,textColorError:b,textColorHoverError:b,textColorPressedError:b,textColorFocusError:b,textColorDisabledError:b,textColorTextError:N,textColorTextHoverError:_,textColorTextPressedError:P,textColorTextFocusError:_,textColorTextDisabledError:d,textColorGhostError:N,textColorGhostHoverError:_,textColorGhostPressedError:P,textColorGhostFocusError:_,textColorGhostDisabledError:N,borderError:`1px solid ${N}`,borderHoverError:`1px solid ${_}`,borderPressedError:`1px solid ${P}`,borderFocusError:`1px solid ${_}`,borderDisabledError:`1px solid ${N}`,rippleColorError:N,waveOpacity:"0.6",fontWeight:z,fontWeightStrong:U})},h6={name:"Button",common:Bo,self:d6},DE=h6,f6=$e([Ae("button",`
 margin: 0;
 font-weight: var(--n-font-weight);
 line-height: 1;
 font-family: inherit;
 padding: var(--n-padding);
 height: var(--n-height);
 font-size: var(--n-font-size);
 border-radius: var(--n-border-radius);
 color: var(--n-text-color);
 background-color: var(--n-color);
 width: var(--n-width);
 white-space: nowrap;
 outline: none;
 position: relative;
 z-index: auto;
 border: none;
 display: inline-flex;
 flex-wrap: nowrap;
 flex-shrink: 0;
 align-items: center;
 justify-content: center;
 user-select: none;
 -webkit-user-select: none;
 text-align: center;
 cursor: pointer;
 text-decoration: none;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[We("color",[Se("border",{borderColor:"var(--n-border-color)"}),We("disabled",[Se("border",{borderColor:"var(--n-border-color-disabled)"})]),Ks("disabled",[$e("&:focus",[Se("state-border",{borderColor:"var(--n-border-color-focus)"})]),$e("&:hover",[Se("state-border",{borderColor:"var(--n-border-color-hover)"})]),$e("&:active",[Se("state-border",{borderColor:"var(--n-border-color-pressed)"})]),We("pressed",[Se("state-border",{borderColor:"var(--n-border-color-pressed)"})])])]),We("disabled",{backgroundColor:"var(--n-color-disabled)",color:"var(--n-text-color-disabled)"},[Se("border",{border:"var(--n-border-disabled)"})]),Ks("disabled",[$e("&:focus",{backgroundColor:"var(--n-color-focus)",color:"var(--n-text-color-focus)"},[Se("state-border",{border:"var(--n-border-focus)"})]),$e("&:hover",{backgroundColor:"var(--n-color-hover)",color:"var(--n-text-color-hover)"},[Se("state-border",{border:"var(--n-border-hover)"})]),$e("&:active",{backgroundColor:"var(--n-color-pressed)",color:"var(--n-text-color-pressed)"},[Se("state-border",{border:"var(--n-border-pressed)"})]),We("pressed",{backgroundColor:"var(--n-color-pressed)",color:"var(--n-text-color-pressed)"},[Se("state-border",{border:"var(--n-border-pressed)"})])]),We("loading","cursor: wait;"),Ae("base-wave",`
 pointer-events: none;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 animation-iteration-count: 1;
 animation-duration: var(--n-ripple-duration);
 animation-timing-function: var(--n-bezier-ease-out), var(--n-bezier-ease-out);
 `,[We("active",{zIndex:1,animationName:"button-wave-spread, button-wave-opacity"})]),Bc&&"MozBoxSizing"in document.createElement("div").style?$e("&::moz-focus-inner",{border:0}):null,Se("border, state-border",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 border-radius: inherit;
 transition: border-color .3s var(--n-bezier);
 pointer-events: none;
 `),Se("border",{border:"var(--n-border)"}),Se("state-border",{border:"var(--n-border)",borderColor:"#0000",zIndex:1}),Se("icon",`
 margin: var(--n-icon-margin);
 margin-left: 0;
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 max-width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 position: relative;
 flex-shrink: 0;
 `,[Ae("icon-slot",`
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 position: absolute;
 left: 0;
 top: 50%;
 transform: translateY(-50%);
 display: flex;
 align-items: center;
 justify-content: center;
 `,[fd({top:"50%",originalTransform:"translateY(-50%)"})]),qU()]),Se("content",`
 display: flex;
 align-items: center;
 flex-wrap: nowrap;
 min-width: 0;
 `,[$e("~",[Se("icon",{margin:"var(--n-icon-margin)",marginRight:0})])]),We("block",`
 display: flex;
 width: 100%;
 `),We("dashed",[Se("border, state-border",{borderStyle:"dashed !important"})]),We("disabled",{cursor:"not-allowed",opacity:"var(--n-opacity-disabled)"})]),$e("@keyframes button-wave-spread",{from:{boxShadow:"0 0 0.5px 0 var(--n-ripple-color)"},to:{boxShadow:"0 0 0.5px 4.5px var(--n-ripple-color)"}}),$e("@keyframes button-wave-opacity",{from:{opacity:"var(--n-wave-opacity)"},to:{opacity:0}})]),p6=Object.assign(Object.assign({},Ut.props),{color:String,textColor:String,text:Boolean,block:Boolean,loading:Boolean,disabled:Boolean,circle:Boolean,size:String,ghost:Boolean,round:Boolean,secondary:Boolean,tertiary:Boolean,quaternary:Boolean,strong:Boolean,focusable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},tag:{type:String,default:"button"},type:{type:String,default:"default"},dashed:Boolean,renderIcon:Function,iconPlacement:{type:String,default:"left"},attrType:{type:String,default:"button"},bordered:{type:Boolean,default:!0},onClick:[Function,Array],nativeFocusBehavior:{type:Boolean,default:!_E}}),m6=lt({name:"Button",props:p6,setup(t){const e=Ne(null),n=Ne(null),r=Ne(!1),o=rx(()=>!t.quaternary&&!t.tertiary&&!t.secondary&&!t.text&&(!t.color||t.ghost||t.dashed)&&t.bordered),s=Kt(c6,{}),{mergedSizeRef:i}=ZT({},{defaultSize:"medium",mergedSize:y=>{const{size:C}=t;if(C)return C;const{size:S}=s;if(S)return S;const{mergedSize:$}=y||{};return $?$.value:"medium"}}),a=Me(()=>t.focusable&&!t.disabled),l=y=>{var C;a.value||y.preventDefault(),!t.nativeFocusBehavior&&(y.preventDefault(),!t.disabled&&a.value&&((C=e.value)===null||C===void 0||C.focus({preventScroll:!0})))},c=y=>{var C;if(!t.disabled&&!t.loading){const{onClick:S}=t;S&&dn(S,y),t.text||(C=n.value)===null||C===void 0||C.play()}},u=y=>{switch(y.key){case"Enter":if(!t.keyboard)return;r.value=!1}},d=y=>{switch(y.key){case"Enter":if(!t.keyboard||t.loading){y.preventDefault();return}r.value=!0}},h=()=>{r.value=!1},{inlineThemeDisabled:f,mergedClsPrefixRef:p,mergedRtlRef:m}=Mr(t),g=Ut("Button","-button",f6,DE,t,p),b=vl("Button",m,p),v=Me(()=>{const y=g.value,{common:{cubicBezierEaseInOut:C,cubicBezierEaseOut:S},self:$}=y,{rippleDuration:I,opacityDisabled:R,fontWeight:T,fontWeightStrong:N}=$,_=i.value,{dashed:P,type:z,ghost:L,text:O,color:B,round:U,circle:Q,textColor:se,secondary:ce,tertiary:de,quaternary:we,strong:Ie}=t,j={"font-weight":Ie?N:T};let re={"--n-color":"initial","--n-color-hover":"initial","--n-color-pressed":"initial","--n-color-focus":"initial","--n-color-disabled":"initial","--n-ripple-color":"initial","--n-text-color":"initial","--n-text-color-hover":"initial","--n-text-color-pressed":"initial","--n-text-color-focus":"initial","--n-text-color-disabled":"initial"};const le=z==="tertiary",Ce=z==="default",ve=le?"default":z;if(O){const ge=se||B;re={"--n-color":"#0000","--n-color-hover":"#0000","--n-color-pressed":"#0000","--n-color-focus":"#0000","--n-color-disabled":"#0000","--n-ripple-color":"#0000","--n-text-color":ge||$[Ge("textColorText",ve)],"--n-text-color-hover":ge?ga(ge):$[Ge("textColorTextHover",ve)],"--n-text-color-pressed":ge?qf(ge):$[Ge("textColorTextPressed",ve)],"--n-text-color-focus":ge?ga(ge):$[Ge("textColorTextHover",ve)],"--n-text-color-disabled":ge||$[Ge("textColorTextDisabled",ve)]}}else if(L||P){const ge=se||B;re={"--n-color":"#0000","--n-color-hover":"#0000","--n-color-pressed":"#0000","--n-color-focus":"#0000","--n-color-disabled":"#0000","--n-ripple-color":B||$[Ge("rippleColor",ve)],"--n-text-color":ge||$[Ge("textColorGhost",ve)],"--n-text-color-hover":ge?ga(ge):$[Ge("textColorGhostHover",ve)],"--n-text-color-pressed":ge?qf(ge):$[Ge("textColorGhostPressed",ve)],"--n-text-color-focus":ge?ga(ge):$[Ge("textColorGhostHover",ve)],"--n-text-color-disabled":ge||$[Ge("textColorGhostDisabled",ve)]}}else if(ce){const ge=Ce?$.textColor:le?$.textColorTertiary:$[Ge("color",ve)],be=B||ge,De=z!=="default"&&z!=="tertiary";re={"--n-color":De?Da(be,{alpha:Number($.colorOpacitySecondary)}):$.colorSecondary,"--n-color-hover":De?Da(be,{alpha:Number($.colorOpacitySecondaryHover)}):$.colorSecondaryHover,"--n-color-pressed":De?Da(be,{alpha:Number($.colorOpacitySecondaryPressed)}):$.colorSecondaryPressed,"--n-color-focus":De?Da(be,{alpha:Number($.colorOpacitySecondaryHover)}):$.colorSecondaryHover,"--n-color-disabled":$.colorSecondary,"--n-ripple-color":"#0000","--n-text-color":be,"--n-text-color-hover":be,"--n-text-color-pressed":be,"--n-text-color-focus":be,"--n-text-color-disabled":be}}else if(de||we){const ge=Ce?$.textColor:le?$.textColorTertiary:$[Ge("color",ve)],be=B||ge;de?(re["--n-color"]=$.colorTertiary,re["--n-color-hover"]=$.colorTertiaryHover,re["--n-color-pressed"]=$.colorTertiaryPressed,re["--n-color-focus"]=$.colorSecondaryHover,re["--n-color-disabled"]=$.colorTertiary):(re["--n-color"]=$.colorQuaternary,re["--n-color-hover"]=$.colorQuaternaryHover,re["--n-color-pressed"]=$.colorQuaternaryPressed,re["--n-color-focus"]=$.colorQuaternaryHover,re["--n-color-disabled"]=$.colorQuaternary),re["--n-ripple-color"]="#0000",re["--n-text-color"]=be,re["--n-text-color-hover"]=be,re["--n-text-color-pressed"]=be,re["--n-text-color-focus"]=be,re["--n-text-color-disabled"]=be}else re={"--n-color":B||$[Ge("color",ve)],"--n-color-hover":B?ga(B):$[Ge("colorHover",ve)],"--n-color-pressed":B?qf(B):$[Ge("colorPressed",ve)],"--n-color-focus":B?ga(B):$[Ge("colorFocus",ve)],"--n-color-disabled":B||$[Ge("colorDisabled",ve)],"--n-ripple-color":B||$[Ge("rippleColor",ve)],"--n-text-color":se||(B?$.textColorPrimary:le?$.textColorTertiary:$[Ge("textColor",ve)]),"--n-text-color-hover":se||(B?$.textColorHoverPrimary:$[Ge("textColorHover",ve)]),"--n-text-color-pressed":se||(B?$.textColorPressedPrimary:$[Ge("textColorPressed",ve)]),"--n-text-color-focus":se||(B?$.textColorFocusPrimary:$[Ge("textColorFocus",ve)]),"--n-text-color-disabled":se||(B?$.textColorDisabledPrimary:$[Ge("textColorDisabled",ve)])};let Le={"--n-border":"initial","--n-border-hover":"initial","--n-border-pressed":"initial","--n-border-focus":"initial","--n-border-disabled":"initial"};O?Le={"--n-border":"none","--n-border-hover":"none","--n-border-pressed":"none","--n-border-focus":"none","--n-border-disabled":"none"}:Le={"--n-border":$[Ge("border",ve)],"--n-border-hover":$[Ge("borderHover",ve)],"--n-border-pressed":$[Ge("borderPressed",ve)],"--n-border-focus":$[Ge("borderFocus",ve)],"--n-border-disabled":$[Ge("borderDisabled",ve)]};const{[Ge("height",_)]:_e,[Ge("fontSize",_)]:F,[Ge("padding",_)]:V,[Ge("paddingRound",_)]:oe,[Ge("iconSize",_)]:G,[Ge("borderRadius",_)]:Y,[Ge("iconMargin",_)]:ae,waveOpacity:pe}=$,ye={"--n-width":Q&&!O?_e:"initial","--n-height":O?"initial":_e,"--n-font-size":F,"--n-padding":Q||O?"initial":U?oe:V,"--n-icon-size":G,"--n-icon-margin":ae,"--n-border-radius":O?"initial":Q||U?_e:Y};return Object.assign(Object.assign(Object.assign(Object.assign({"--n-bezier":C,"--n-bezier-ease-out":S,"--n-ripple-duration":I,"--n-opacity-disabled":R,"--n-wave-opacity":pe},j),re),Le),ye)}),w=f?bo("button",Me(()=>{let y="";const{dashed:C,type:S,ghost:$,text:I,color:R,round:T,circle:N,textColor:_,secondary:P,tertiary:z,quaternary:L,strong:O}=t;C&&(y+="a"),$&&(y+="b"),I&&(y+="c"),T&&(y+="d"),N&&(y+="e"),P&&(y+="f"),z&&(y+="g"),L&&(y+="h"),O&&(y+="i"),R&&(y+="j"+_$(R)),_&&(y+="k"+_$(_));const{value:B}=i;return y+="l"+B[0],y+="m"+S[0],y}),v,t):void 0;return{selfElRef:e,waveElRef:n,mergedClsPrefix:p,mergedFocusable:a,mergedSize:i,showBorder:o,enterPressed:r,rtlEnabled:b,handleMousedown:l,handleKeydown:d,handleBlur:h,handleKeyup:u,handleClick:c,customColorCssVars:Me(()=>{const{color:y}=t;if(!y)return null;const C=ga(y);return{"--n-border-color":y,"--n-border-color-hover":C,"--n-border-color-pressed":qf(y),"--n-border-color-focus":C,"--n-border-color-disabled":y}}),cssVars:f?void 0:v,themeClass:w==null?void 0:w.themeClass,onRender:w==null?void 0:w.onRender}},render(){const{mergedClsPrefix:t,tag:e,onRender:n}=this;n==null||n();const r=yr(this.$slots.default,o=>o&&W("span",{class:`${t}-button__content`},o));return W(e,{ref:"selfElRef",class:[this.themeClass,`${t}-button`,`${t}-button--${this.type}-type`,`${t}-button--${this.mergedSize}-type`,this.rtlEnabled&&`${t}-button--rtl`,this.disabled&&`${t}-button--disabled`,this.block&&`${t}-button--block`,this.enterPressed&&`${t}-button--pressed`,!this.text&&this.dashed&&`${t}-button--dashed`,this.color&&`${t}-button--color`,this.secondary&&`${t}-button--secondary`,this.loading&&`${t}-button--loading`,this.ghost&&`${t}-button--ghost`],tabindex:this.mergedFocusable?0:-1,type:this.attrType,style:this.cssVars,disabled:this.disabled,onClick:this.handleClick,onBlur:this.handleBlur,onMousedown:this.handleMousedown,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},this.iconPlacement==="right"&&r,W(EE,{width:!0},{default:()=>yr(this.$slots.icon,o=>(this.loading||this.renderIcon||o)&&W("span",{class:`${t}-button__icon`,style:{margin:vL(this.$slots.default)?"0":""}},W(Mm,null,{default:()=>this.loading?W(py,{clsPrefix:t,key:"loading",class:`${t}-icon-slot`,strokeWidth:20}):W("div",{key:"icon",class:`${t}-icon-slot`,role:"none"},this.renderIcon?this.renderIcon():o)})))}),this.iconPlacement==="left"&&r,this.text?null:W(GU,{ref:"waveElRef",clsPrefix:t}),this.showBorder?W("div",{"aria-hidden":!0,class:`${t}-button__border`,style:this.customColorCssVars}):null,this.showBorder?W("div",{"aria-hidden":!0,class:`${t}-button__state-border`,style:this.customColorCssVars}):null)}}),zi=m6,g6={paddingSmall:"12px 16px 12px",paddingMedium:"19px 24px 20px",paddingLarge:"23px 32px 24px",paddingHuge:"27px 40px 28px",titleFontSizeSmall:"16px",titleFontSizeMedium:"18px",titleFontSizeLarge:"18px",titleFontSizeHuge:"18px",closeIconSize:"18px",closeSize:"22px"},b6=t=>{const{primaryColor:e,borderRadius:n,lineHeight:r,fontSize:o,cardColor:s,textColor2:i,textColor1:a,dividerColor:l,fontWeightStrong:c,closeIconColor:u,closeIconColorHover:d,closeIconColorPressed:h,closeColorHover:f,closeColorPressed:p,modalColor:m,boxShadow1:g,popoverColor:b,actionColor:v}=t;return Object.assign(Object.assign({},g6),{lineHeight:r,color:s,colorModal:m,colorPopover:b,colorTarget:e,colorEmbedded:v,colorEmbeddedModal:v,colorEmbeddedPopover:v,textColor:i,titleTextColor:a,borderColor:l,actionColor:v,titleFontWeight:c,closeColorHover:f,closeColorPressed:p,closeBorderRadius:n,closeIconColor:u,closeIconColorHover:d,closeIconColorPressed:h,fontSizeSmall:o,fontSizeMedium:o,fontSizeLarge:o,fontSizeHuge:o,boxShadow:g,borderRadius:n})},v6={name:"Card",common:Bo,self:b6},FE=v6,x6=$e([Ae("card",`
 font-size: var(--n-font-size);
 line-height: var(--n-line-height);
 display: flex;
 flex-direction: column;
 width: 100%;
 box-sizing: border-box;
 position: relative;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 color: var(--n-text-color);
 word-break: break-word;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[DT({background:"var(--n-color-modal)"}),We("hoverable",[$e("&:hover","box-shadow: var(--n-box-shadow);")]),We("content-segmented",[$e(">",[Se("content",{paddingTop:"var(--n-padding-bottom)"})])]),We("content-soft-segmented",[$e(">",[Se("content",`
 margin: 0 var(--n-padding-left);
 padding: var(--n-padding-bottom) 0;
 `)])]),We("footer-segmented",[$e(">",[Se("footer",{paddingTop:"var(--n-padding-bottom)"})])]),We("footer-soft-segmented",[$e(">",[Se("footer",`
 padding: var(--n-padding-bottom) 0;
 margin: 0 var(--n-padding-left);
 `)])]),$e(">",[Ae("card-header",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 font-size: var(--n-title-font-size);
 padding:
 var(--n-padding-top)
 var(--n-padding-left)
 var(--n-padding-bottom)
 var(--n-padding-left);
 `,[Se("main",`
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 min-width: 0;
 color: var(--n-title-text-color);
 `),Se("extra",`
 display: flex;
 align-items: center;
 font-size: var(--n-font-size);
 font-weight: 400;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),Se("close",`
 margin: 0 0 0 8px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)]),Se("action",`
 box-sizing: border-box;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 background-clip: padding-box;
 background-color: var(--n-action-color);
 `),Se("content","flex: 1; min-width: 0;"),Se("content, footer",`
 box-sizing: border-box;
 padding: 0 var(--n-padding-left) var(--n-padding-bottom) var(--n-padding-left);
 font-size: var(--n-font-size);
 `,[$e("&:first-child",{paddingTop:"var(--n-padding-bottom)"})]),Se("action",`
 background-color: var(--n-action-color);
 padding: var(--n-padding-bottom) var(--n-padding-left);
 border-bottom-left-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `)]),Ae("card-cover",`
 overflow: hidden;
 width: 100%;
 border-radius: var(--n-border-radius) var(--n-border-radius) 0 0;
 `,[$e("img",`
 display: block;
 width: 100%;
 `)]),We("bordered",`
 border: 1px solid var(--n-border-color);
 `,[$e("&:target","border-color: var(--n-color-target);")]),We("action-segmented",[$e(">",[Se("action",[$e("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),We("content-segmented, content-soft-segmented",[$e(">",[Se("content",{transition:"border-color 0.3s var(--n-bezier)"},[$e("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),We("footer-segmented, footer-soft-segmented",[$e(">",[Se("footer",{transition:"border-color 0.3s var(--n-bezier)"},[$e("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),We("embedded",`
 background-color: var(--n-color-embedded);
 `)]),AT(Ae("card",`
 background: var(--n-color-modal);
 `,[We("embedded",`
 background-color: var(--n-color-embedded-modal);
 `)])),WL(Ae("card",`
 background: var(--n-color-popover);
 `,[We("embedded",`
 background-color: var(--n-color-embedded-popover);
 `)]))]),by={title:String,contentStyle:[Object,String],headerStyle:[Object,String],headerExtraStyle:[Object,String],footerStyle:[Object,String],embedded:Boolean,segmented:{type:[Boolean,Object],default:!1},size:{type:String,default:"medium"},bordered:{type:Boolean,default:!0},closable:{type:Boolean,default:!1},hoverable:Boolean,role:String,onClose:[Function,Array]},y6=sy(by),w6=Object.assign(Object.assign({},Ut.props),by),fx=lt({name:"Card",props:w6,setup(t){const e=()=>{const{onClose:c}=t;c&&dn(c)},{inlineThemeDisabled:n,mergedClsPrefixRef:r,mergedRtlRef:o}=Mr(t),s=Ut("Card","-card",x6,FE,t,r),i=vl("Card",o,r),a=Me(()=>{const{size:c}=t,{self:{color:u,colorModal:d,colorTarget:h,textColor:f,titleTextColor:p,titleFontWeight:m,borderColor:g,actionColor:b,borderRadius:v,lineHeight:w,closeIconColor:y,closeIconColorHover:C,closeIconColorPressed:S,closeColorHover:$,closeColorPressed:I,closeBorderRadius:R,closeIconSize:T,closeSize:N,boxShadow:_,colorPopover:P,colorEmbedded:z,colorEmbeddedModal:L,colorEmbeddedPopover:O,[Ge("padding",c)]:B,[Ge("fontSize",c)]:U,[Ge("titleFontSize",c)]:Q},common:{cubicBezierEaseInOut:se}}=s.value,{top:ce,left:de,bottom:we}=CT(B);return{"--n-bezier":se,"--n-border-radius":v,"--n-color":u,"--n-color-modal":d,"--n-color-popover":P,"--n-color-embedded":z,"--n-color-embedded-modal":L,"--n-color-embedded-popover":O,"--n-color-target":h,"--n-text-color":f,"--n-line-height":w,"--n-action-color":b,"--n-title-text-color":p,"--n-title-font-weight":m,"--n-close-icon-color":y,"--n-close-icon-color-hover":C,"--n-close-icon-color-pressed":S,"--n-close-color-hover":$,"--n-close-color-pressed":I,"--n-border-color":g,"--n-box-shadow":_,"--n-padding-top":ce,"--n-padding-bottom":we,"--n-padding-left":de,"--n-font-size":U,"--n-title-font-size":Q,"--n-close-size":N,"--n-close-icon-size":T,"--n-close-border-radius":R}}),l=n?bo("card",Me(()=>t.size[0]),a,t):void 0;return{rtlEnabled:i,mergedClsPrefix:r,mergedTheme:s,handleCloseClick:e,cssVars:n?void 0:a,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender}},render(){const{segmented:t,bordered:e,hoverable:n,mergedClsPrefix:r,rtlEnabled:o,onRender:s,embedded:i,$slots:a}=this;return s==null||s(),W("div",{class:[`${r}-card`,this.themeClass,i&&`${r}-card--embedded`,{[`${r}-card--rtl`]:o,[`${r}-card--content${typeof t!="boolean"&&t.content==="soft"?"-soft":""}-segmented`]:t===!0||t!==!1&&t.content,[`${r}-card--footer${typeof t!="boolean"&&t.footer==="soft"?"-soft":""}-segmented`]:t===!0||t!==!1&&t.footer,[`${r}-card--action-segmented`]:t===!0||t!==!1&&t.action,[`${r}-card--bordered`]:e,[`${r}-card--hoverable`]:n}],style:this.cssVars,role:this.role},yr(a.cover,l=>l&&W("div",{class:`${r}-card-cover`,role:"none"},l)),yr(a.header,l=>l||this.title||this.closable?W("div",{class:`${r}-card-header`,style:this.headerStyle},W("div",{class:`${r}-card-header__main`,role:"heading"},l||this.title),yr(a["header-extra"],c=>c&&W("div",{class:`${r}-card-header__extra`,style:this.headerExtraStyle},c)),this.closable?W(Lm,{clsPrefix:r,class:`${r}-card-header__close`,onClick:this.handleCloseClick,absolute:!0}):null):null),yr(a.default,l=>l&&W("div",{class:`${r}-card__content`,style:this.contentStyle,role:"none"},l)),yr(a.footer,l=>l&&[W("div",{class:`${r}-card__footer`,style:this.footerStyle,role:"none"},l)]),yr(a.action,l=>l&&W("div",{class:`${r}-card__action`,role:"none"},l)))}}),C6=t=>{const{textColorBase:e,opacity1:n,opacity2:r,opacity3:o,opacity4:s,opacity5:i}=t;return{color:e,opacity1Depth:n,opacity2Depth:r,opacity3Depth:o,opacity4Depth:s,opacity5Depth:i}},$6={name:"Icon",common:Bo,self:C6},S6=$6,I6=Ae("icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[We("color-transition",{transition:"color .3s var(--n-bezier)"}),We("depth",{color:"var(--n-color)"},[$e("svg",{opacity:"var(--n-opacity)",transition:"opacity .3s var(--n-bezier)"})]),$e("svg",{height:"1em",width:"1em"})]),k6=Object.assign(Object.assign({},Ut.props),{depth:[String,Number],size:[Number,String],color:String,component:Object}),T6=lt({_n_icon__:!0,name:"Icon",inheritAttrs:!1,props:k6,setup(t){const{mergedClsPrefixRef:e,inlineThemeDisabled:n}=Mr(t),r=Ut("Icon","-icon",I6,S6,t,e),o=Me(()=>{const{depth:i}=t,{common:{cubicBezierEaseInOut:a},self:l}=r.value;if(i!==void 0){const{color:c,[`opacity${i}Depth`]:u}=l;return{"--n-bezier":a,"--n-color":c,"--n-opacity":u}}return{"--n-bezier":a,"--n-color":"","--n-opacity":""}}),s=n?bo("icon",Me(()=>`${t.depth||"d"}`),o,t):void 0;return{mergedClsPrefix:e,mergedStyle:Me(()=>{const{size:i,color:a}=t;return{fontSize:yL(i),color:a}}),cssVars:n?void 0:o,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var t;const{$parent:e,depth:n,mergedClsPrefix:r,component:o,onRender:s,themeClass:i}=this;return!((t=e==null?void 0:e.$options)===null||t===void 0)&&t._n_icon__&&_p("icon","don't wrap `n-icon` inside `n-icon`"),s==null||s(),W("i",Ad(this.$attrs,{role:"img",class:[`${r}-icon`,i,{[`${r}-icon--depth`]:n,[`${r}-icon--color-transition`]:n!==void 0}],style:[this.cssVars,this.mergedStyle]}),o?W(o):this.$slots)}});var zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function E6(t){var e=t.default;if(typeof e=="function"){var n=function(){return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}const R6={titleFontSize:"18px",padding:"16px 28px 20px 28px",iconSize:"28px",actionSpace:"12px",contentMargin:"8px 0 16px 0",iconMargin:"0 4px 0 0",iconMarginIconTop:"4px 0 8px 0",closeSize:"22px",closeIconSize:"18px",closeMargin:"20px 26px 0 0",closeMarginIconTop:"10px 16px 0 0"},N6=t=>{const{textColor1:e,textColor2:n,modalColor:r,closeIconColor:o,closeIconColorHover:s,closeIconColorPressed:i,closeColorHover:a,closeColorPressed:l,infoColor:c,successColor:u,warningColor:d,errorColor:h,primaryColor:f,dividerColor:p,borderRadius:m,fontWeightStrong:g,lineHeight:b,fontSize:v}=t;return Object.assign(Object.assign({},R6),{fontSize:v,lineHeight:b,border:`1px solid ${p}`,titleTextColor:e,textColor:n,color:r,closeColorHover:a,closeColorPressed:l,closeIconColor:o,closeIconColorHover:s,closeIconColorPressed:i,closeBorderRadius:m,iconColor:f,iconColorInfo:c,iconColorSuccess:u,iconColorWarning:d,iconColorError:h,borderRadius:m,titleFontWeight:g})},_6={name:"Dialog",common:Bo,peers:{Button:DE},self:N6},OE=_6,vy={icon:Function,type:{type:String,default:"default"},title:[String,Function],closable:{type:Boolean,default:!0},negativeText:String,positiveText:String,positiveButtonProps:Object,negativeButtonProps:Object,content:[String,Function],action:Function,showIcon:{type:Boolean,default:!0},loading:Boolean,bordered:Boolean,iconPlacement:String,onPositiveClick:Function,onNegativeClick:Function,onClose:Function},A6=sy(vy),D6=$e([Ae("dialog",`
 word-break: break-word;
 line-height: var(--n-line-height);
 position: relative;
 background: var(--n-color);
 color: var(--n-text-color);
 box-sizing: border-box;
 margin: auto;
 border-radius: var(--n-border-radius);
 padding: var(--n-padding);
 transition: 
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `,[Se("icon",{color:"var(--n-icon-color)"}),We("bordered",{border:"var(--n-border)"}),We("icon-top",[Se("close",{margin:"var(--n-close-margin)"}),Se("icon",{margin:"var(--n-icon-margin)"}),Se("content",{textAlign:"center"}),Se("title",{justifyContent:"center"}),Se("action",{justifyContent:"center"})]),We("icon-left",[Se("icon",{margin:"var(--n-icon-margin)"}),We("closable",[Se("title",`
 padding-right: calc(var(--n-close-size) + 6px);
 `)])]),Se("close",`
 position: absolute;
 right: 0;
 top: 0;
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 z-index: 1;
 `),Se("content",`
 font-size: var(--n-font-size);
 margin: var(--n-content-margin);
 position: relative;
 word-break: break-word;
 `,[We("last","margin-bottom: 0;")]),Se("action",`
 display: flex;
 justify-content: flex-end;
 `,[$e("> *:not(:last-child)",{marginRight:"var(--n-action-space)"})]),Se("icon",{fontSize:"var(--n-icon-size)",transition:"color .3s var(--n-bezier)"}),Se("title",`
 transition: color .3s var(--n-bezier);
 display: flex;
 align-items: center;
 font-size: var(--n-title-font-size);
 font-weight: var(--n-title-font-weight);
 color: var(--n-title-text-color);
 `),Ae("dialog-icon-container",{display:"flex",justifyContent:"center"})]),AT(Ae("dialog",`
 width: 446px;
 max-width: calc(100vw - 32px);
 `)),Ae("dialog",[DT(`
 width: 446px;
 max-width: calc(100vw - 32px);
 `)])]),F6={default:()=>W(dx,null),info:()=>W(dx,null),success:()=>W(kE,null),warning:()=>W(TE,null),error:()=>W(IE,null)},O6=lt({name:"Dialog",alias:["NimbusConfirmCard","Confirm"],props:Object.assign(Object.assign({},Ut.props),vy),setup(t){const{mergedComponentPropsRef:e,mergedClsPrefixRef:n,inlineThemeDisabled:r}=Mr(t),o=Me(()=>{var d,h;const{iconPlacement:f}=t;return f||((h=(d=e==null?void 0:e.value)===null||d===void 0?void 0:d.Dialog)===null||h===void 0?void 0:h.iconPlacement)||"left"});function s(d){const{onPositiveClick:h}=t;h&&h(d)}function i(d){const{onNegativeClick:h}=t;h&&h(d)}function a(){const{onClose:d}=t;d&&d()}const l=Ut("Dialog","-dialog",D6,OE,t,n),c=Me(()=>{const{type:d}=t,h=o.value,{common:{cubicBezierEaseInOut:f},self:{fontSize:p,lineHeight:m,border:g,titleTextColor:b,textColor:v,color:w,closeBorderRadius:y,closeColorHover:C,closeColorPressed:S,closeIconColor:$,closeIconColorHover:I,closeIconColorPressed:R,closeIconSize:T,borderRadius:N,titleFontWeight:_,titleFontSize:P,padding:z,iconSize:L,actionSpace:O,contentMargin:B,closeSize:U,[h==="top"?"iconMarginIconTop":"iconMargin"]:Q,[h==="top"?"closeMarginIconTop":"closeMargin"]:se,[Ge("iconColor",d)]:ce}}=l.value;return{"--n-font-size":p,"--n-icon-color":ce,"--n-bezier":f,"--n-close-margin":se,"--n-icon-margin":Q,"--n-icon-size":L,"--n-close-size":U,"--n-close-icon-size":T,"--n-close-border-radius":y,"--n-close-color-hover":C,"--n-close-color-pressed":S,"--n-close-icon-color":$,"--n-close-icon-color-hover":I,"--n-close-icon-color-pressed":R,"--n-color":w,"--n-text-color":v,"--n-border-radius":N,"--n-padding":z,"--n-line-height":m,"--n-border":g,"--n-content-margin":B,"--n-title-font-size":P,"--n-title-font-weight":_,"--n-title-text-color":b,"--n-action-space":O}}),u=r?bo("dialog",Me(()=>`${t.type[0]}${o.value[0]}`),c,t):void 0;return{mergedClsPrefix:n,mergedIconPlacement:o,mergedTheme:l,handlePositiveClick:s,handleNegativeClick:i,handleCloseClick:a,cssVars:r?void 0:c,themeClass:u==null?void 0:u.themeClass,onRender:u==null?void 0:u.onRender}},render(){var t;const{bordered:e,mergedIconPlacement:n,cssVars:r,closable:o,showIcon:s,title:i,content:a,action:l,negativeText:c,positiveText:u,positiveButtonProps:d,negativeButtonProps:h,handlePositiveClick:f,handleNegativeClick:p,mergedTheme:m,loading:g,type:b,mergedClsPrefix:v}=this;(t=this.onRender)===null||t===void 0||t.call(this);const w=s?W(Bi,{clsPrefix:v,class:`${v}-dialog__icon`},{default:()=>yr(this.$slots.icon,C=>C||(this.icon?wi(this.icon):F6[this.type]()))}):null,y=yr(this.$slots.action,C=>C||u||c||l?W("div",{class:`${v}-dialog__action`},C||(l?[wi(l)]:[this.negativeText&&W(zi,Object.assign({theme:m.peers.Button,themeOverrides:m.peerOverrides.Button,ghost:!0,size:"small",onClick:p},h),{default:()=>wi(this.negativeText)}),this.positiveText&&W(zi,Object.assign({theme:m.peers.Button,themeOverrides:m.peerOverrides.Button,size:"small",type:b==="default"?"primary":b,disabled:g,loading:g,onClick:f},d),{default:()=>wi(this.positiveText)})])):null);return W("div",{class:[`${v}-dialog`,this.themeClass,this.closable&&`${v}-dialog--closable`,`${v}-dialog--icon-${n}`,e&&`${v}-dialog--bordered`],style:r,role:"dialog"},o?W(Lm,{clsPrefix:v,class:`${v}-dialog__close`,onClick:this.handleCloseClick}):null,s&&n==="top"?W("div",{class:`${v}-dialog-icon-container`},w):null,W("div",{class:`${v}-dialog__title`},s&&n==="left"?w:null,Wa(this.$slots.header,()=>[wi(i)])),W("div",{class:[`${v}-dialog__content`,y?"":`${v}-dialog__content--last`]},Wa(this.$slots.default,()=>[wi(a)])),y)}}),P6="n-dialog-provider",M6=t=>{const{modalColor:e,textColor2:n,boxShadow3:r}=t;return{color:e,textColor:n,boxShadow:r}},L6={name:"Modal",common:Bo,peers:{Scrollbar:my,Dialog:OE,Card:FE},self:M6},B6=L6,xy=Object.assign(Object.assign({},by),vy),z6=sy(xy),W6=lt({name:"ModalBody",inheritAttrs:!1,props:Object.assign(Object.assign({show:{type:Boolean,required:!0},preset:String,displayDirective:{type:String,required:!0},trapFocus:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0},blockScroll:Boolean},xy),{renderMask:Function,onClickoutside:Function,onBeforeLeave:{type:Function,required:!0},onAfterLeave:{type:Function,required:!0},onPositiveClick:{type:Function,required:!0},onNegativeClick:{type:Function,required:!0},onClose:{type:Function,required:!0},onAfterEnter:Function,onEsc:Function}),setup(t){const e=Ne(null),n=Ne(null),r=Ne(t.show),o=Ne(null),s=Ne(null);Fn(Bn(t,"show"),g=>{g&&(r.value=!0)}),UB(Me(()=>t.blockScroll&&r.value));const i=Kt(LT);function a(){if(i.transformOriginRef.value==="center")return"";const{value:g}=o,{value:b}=s;if(g===null||b===null)return"";if(n.value){const v=n.value.containerScrollTop;return`${g}px ${b+v}px`}return""}function l(g){if(i.transformOriginRef.value==="center")return;const b=i.getMousePosition();if(!b||!n.value)return;const v=n.value.containerScrollTop,{offsetLeft:w,offsetTop:y}=g;if(b){const C=b.y,S=b.x;o.value=-(w-S),s.value=-(y-C-v)}g.style.transformOrigin=a()}function c(g){Do(()=>{l(g)})}function u(g){g.style.transformOrigin=a(),t.onBeforeLeave()}function d(){r.value=!1,o.value=null,s.value=null,t.onAfterLeave()}function h(){const{onClose:g}=t;g&&g()}function f(){t.onNegativeClick()}function p(){t.onPositiveClick()}const m=Ne(null);return Fn(m,g=>{g&&Do(()=>{const b=g.el;b&&e.value!==b&&(e.value=b)})}),Yr(rB,e),Yr(oB,null),Yr(sB,null),{mergedTheme:i.mergedThemeRef,appear:i.appearRef,isMounted:i.isMountedRef,mergedClsPrefix:i.mergedClsPrefixRef,bodyRef:e,scrollbarRef:n,displayed:r,childNodeRef:m,handlePositiveClick:p,handleNegativeClick:f,handleCloseClick:h,handleAfterLeave:d,handleBeforeLeave:u,handleEnter:c}},render(){const{$slots:t,$attrs:e,handleEnter:n,handleAfterLeave:r,handleBeforeLeave:o,preset:s,mergedClsPrefix:i}=this;let a=null;if(!s){if(a=gL(t),!a){_p("modal","default slot is empty");return}a=Os(a),a.props=Ad({class:`${i}-modal`},e,a.props||{})}return this.displayDirective==="show"||this.displayed||this.show?Rp(W("div",{role:"none",class:`${i}-modal-body-wrapper`},W(gy,{ref:"scrollbarRef",theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,contentClass:`${i}-modal-scroll-content`},{default:()=>{var l;return[(l=this.renderMask)===null||l===void 0?void 0:l.call(this),W(VB,{disabled:!this.trapFocus,active:this.show,onEsc:this.onEsc,autoFocus:this.autoFocus},{default:()=>{var c;return W(Li,{name:"fade-in-scale-up-transition",appear:(c=this.appear)!==null&&c!==void 0?c:this.isMounted,onEnter:n,onAfterEnter:this.onAfterEnter,onAfterLeave:r,onBeforeLeave:o},{default:()=>{const u=[[Jv,this.show]],{onClickoutside:d}=this;return d&&u.push([aB,this.onClickoutside,void 0,{capture:!0}]),Rp(this.preset==="confirm"||this.preset==="dialog"?W(O6,Object.assign({},this.$attrs,{class:[`${i}-modal`,this.$attrs.class],ref:"bodyRef",theme:this.mergedTheme.peers.Dialog,themeOverrides:this.mergedTheme.peerOverrides.Dialog},ex(this.$props,A6),{"aria-modal":"true"}),t):this.preset==="card"?W(fx,Object.assign({},this.$attrs,{ref:"bodyRef",class:[`${i}-modal`,this.$attrs.class],theme:this.mergedTheme.peers.Card,themeOverrides:this.mergedTheme.peerOverrides.Card},ex(this.$props,y6),{"aria-modal":"true",role:"dialog"}),t):this.childNodeRef=a,u)}})}})]}})),[[Jv,this.displayDirective==="if"||this.displayed||this.show]]):null}}),V6=$e([Ae("modal-container",`
 position: fixed;
 left: 0;
 top: 0;
 height: 0;
 width: 0;
 display: flex;
 `),Ae("modal-mask",`
 position: fixed;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 background-color: rgba(0, 0, 0, .4);
 `,[NE({enterDuration:".25s",leaveDuration:".25s",enterCubicBezier:"var(--n-bezier-ease-out)",leaveCubicBezier:"var(--n-bezier-ease-out)"})]),Ae("modal-body-wrapper",`
 position: fixed;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: visible;
 `,[Ae("modal-scroll-content",`
 min-height: 100%;
 display: flex;
 position: relative;
 `)]),Ae("modal",`
 position: relative;
 align-self: center;
 color: var(--n-text-color);
 margin: auto;
 box-shadow: var(--n-box-shadow);
 `,[UU({duration:".25s",enterScale:".5"})])]),U6=Object.assign(Object.assign(Object.assign(Object.assign({},Ut.props),{show:Boolean,unstableShowMask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},preset:String,to:[String,Object],displayDirective:{type:String,default:"if"},transformOrigin:{type:String,default:"mouse"},zIndex:Number,autoFocus:{type:Boolean,default:!0},trapFocus:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!0}}),xy),{onEsc:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onAfterEnter:Function,onBeforeLeave:Function,onAfterLeave:Function,onClose:Function,onPositiveClick:Function,onNegativeClick:Function,onMaskClick:Function,internalDialog:Boolean,internalAppear:{type:Boolean,default:void 0},overlayStyle:[String,Object],onBeforeHide:Function,onAfterHide:Function,onHide:Function}),H6=lt({name:"Modal",inheritAttrs:!1,props:U6,setup(t){const e=Ne(null),{mergedClsPrefixRef:n,namespaceRef:r,inlineThemeDisabled:o}=Mr(t),s=Ut("Modal","-modal",V6,B6,t,n),i=eB(64),a=JL(),l=MT(),c=t.internalDialog?Kt(P6,null):null,u=HB();function d(C){const{onUpdateShow:S,"onUpdate:show":$,onHide:I}=t;S&&dn(S,C),$&&dn($,C),I&&!C&&I(C)}function h(){const{onClose:C}=t;C?Promise.resolve(C()).then(S=>{S!==!1&&d(!1)}):d(!1)}function f(){const{onPositiveClick:C}=t;C?Promise.resolve(C()).then(S=>{S!==!1&&d(!1)}):d(!1)}function p(){const{onNegativeClick:C}=t;C?Promise.resolve(C()).then(S=>{S!==!1&&d(!1)}):d(!1)}function m(){const{onBeforeLeave:C,onBeforeHide:S}=t;C&&dn(C),S&&S()}function g(){const{onAfterLeave:C,onAfterHide:S}=t;C&&dn(C),S&&S()}function b(C){var S;const{onMaskClick:$}=t;$&&$(C),t.maskClosable&&!((S=e.value)===null||S===void 0)&&S.contains(oy(C))&&d(!1)}function v(C){var S;(S=t.onEsc)===null||S===void 0||S.call(t),t.show&&t.closeOnEsc&&UL(C)&&!u.value&&d(!1)}Yr(LT,{getMousePosition:()=>{if(c){const{clickedRef:C,clickPositionRef:S}=c;if(C.value&&S.value)return S.value}return i.value?a.value:null},mergedClsPrefixRef:n,mergedThemeRef:s,isMountedRef:l,appearRef:Bn(t,"internalAppear"),transformOriginRef:Bn(t,"transformOrigin")});const w=Me(()=>{const{common:{cubicBezierEaseOut:C},self:{boxShadow:S,color:$,textColor:I}}=s.value;return{"--n-bezier-ease-out":C,"--n-box-shadow":S,"--n-color":$,"--n-text-color":I}}),y=o?bo("theme-class",void 0,w,t):void 0;return{mergedClsPrefix:n,namespace:r,isMounted:l,containerRef:e,presetProps:Me(()=>ex(t,z6)),handleEsc:v,handleAfterLeave:g,handleClickoutside:b,handleBeforeLeave:m,doUpdateShow:d,handleNegativeClick:p,handlePositiveClick:f,handleCloseClick:h,cssVars:o?void 0:w,themeClass:y==null?void 0:y.themeClass,onRender:y==null?void 0:y.onRender}},render(){const{mergedClsPrefix:t}=this;return W(gB,{to:this.to,show:this.show},{default:()=>{var e;(e=this.onRender)===null||e===void 0||e.call(this);const{unstableShowMask:n}=this;return Rp(W("div",{role:"none",ref:"containerRef",class:[`${t}-modal-container`,this.themeClass,this.namespace],style:this.cssVars},W(W6,Object.assign({style:this.overlayStyle},this.$attrs,{ref:"bodyWrapper",displayDirective:this.displayDirective,show:this.show,preset:this.preset,autoFocus:this.autoFocus,trapFocus:this.trapFocus,blockScroll:this.blockScroll},this.presetProps,{onEsc:this.handleEsc,onClose:this.handleCloseClick,onNegativeClick:this.handleNegativeClick,onPositiveClick:this.handlePositiveClick,onBeforeLeave:this.handleBeforeLeave,onAfterEnter:this.onAfterEnter,onAfterLeave:this.handleAfterLeave,onClickoutside:n?void 0:this.handleClickoutside,renderMask:n?()=>{var r;return W(Li,{name:"fade-in-transition",key:"mask",appear:(r=this.internalAppear)!==null&&r!==void 0?r:this.isMounted},{default:()=>this.show?W("div",{"aria-hidden":!0,ref:"containerRef",class:`${t}-modal-mask`,onClick:this.handleClickoutside}):null})}:void 0}),this.$slots)),[[dB,{zIndex:this.zIndex,enabled:this.show}]])}})}}),G6={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},j6=()=>G6,K6={name:"Space",self:j6},q6=K6;let av;const X6=()=>{if(!Bc)return!0;if(av===void 0){const t=document.createElement("div");t.style.display="flex",t.style.flexDirection="column",t.style.rowGap="1px",t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div")),document.body.appendChild(t);const e=t.scrollHeight===1;return document.body.removeChild(t),av=e}return av},Y6=Object.assign(Object.assign({},Ut.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,size:{type:[String,Number,Array],default:"medium"},wrapItem:{type:Boolean,default:!0},itemStyle:[String,Object],wrap:{type:Boolean,default:!0},internalUseGap:{type:Boolean,default:void 0}}),Z6=lt({name:"Space",props:Y6,setup(t){const{mergedClsPrefixRef:e,mergedRtlRef:n}=Mr(t),r=Ut("Space","-space",void 0,q6,t,e),o=vl("Space",n,e);return{useGap:X6(),rtlEnabled:o,mergedClsPrefix:e,margin:Me(()=>{const{size:s}=t;if(Array.isArray(s))return{horizontal:s[0],vertical:s[1]};if(typeof s=="number")return{horizontal:s,vertical:s};const{self:{[Ge("gap",s)]:i}}=r.value,{row:a,col:l}=iL(i);return{horizontal:T$(l),vertical:T$(a)}})}},render(){const{vertical:t,align:e,inline:n,justify:r,itemStyle:o,margin:s,wrap:i,mergedClsPrefix:a,rtlEnabled:l,useGap:c,wrapItem:u,internalUseGap:d}=this,h=za(mL(this));if(!h.length)return null;const f=`${s.horizontal}px`,p=`${s.horizontal/2}px`,m=`${s.vertical}px`,g=`${s.vertical/2}px`,b=h.length-1,v=r.startsWith("space-");return W("div",{role:"none",class:[`${a}-space`,l&&`${a}-space--rtl`],style:{display:n?"inline-flex":"flex",flexDirection:t?"column":"row",justifyContent:["start","end"].includes(r)?"flex-"+r:r,flexWrap:!i||t?"nowrap":"wrap",marginTop:c||t?"":`-${g}`,marginBottom:c||t?"":`-${g}`,alignItems:e,gap:c?`${s.vertical}px ${s.horizontal}px`:""}},!u&&(c||d)?h:h.map((w,y)=>W("div",{role:"none",style:[o,{maxWidth:"100%"},c?"":t?{marginBottom:y!==b?m:""}:l?{marginLeft:v?r==="space-between"&&y===b?"":p:y!==b?f:"",marginRight:v?r==="space-between"&&y===0?"":p:"",paddingTop:g,paddingBottom:g}:{marginRight:v?r==="space-between"&&y===b?"":p:y!==b?f:"",marginLeft:v?r==="space-between"&&y===0?"":p:"",paddingTop:g,paddingBottom:g}]},w)))}}),J6={margin:"0 0 8px 0",padding:"10px 20px",maxWidth:"720px",minWidth:"420px",iconMargin:"0 10px 0 0",closeMargin:"0 0 0 10px",closeSize:"20px",closeIconSize:"16px",iconSize:"20px",fontSize:"14px"},Q6=t=>{const{textColor2:e,closeIconColor:n,closeIconColorHover:r,closeIconColorPressed:o,infoColor:s,successColor:i,errorColor:a,warningColor:l,popoverColor:c,boxShadow2:u,primaryColor:d,lineHeight:h,borderRadius:f,closeColorHover:p,closeColorPressed:m}=t;return Object.assign(Object.assign({},J6),{closeBorderRadius:f,textColor:e,textColorInfo:e,textColorSuccess:e,textColorError:e,textColorWarning:e,textColorLoading:e,color:c,colorInfo:c,colorSuccess:c,colorError:c,colorWarning:c,colorLoading:c,boxShadow:u,boxShadowInfo:u,boxShadowSuccess:u,boxShadowError:u,boxShadowWarning:u,boxShadowLoading:u,iconColor:e,iconColorInfo:s,iconColorSuccess:i,iconColorWarning:l,iconColorError:a,iconColorLoading:d,closeColorHover:p,closeColorPressed:m,closeIconColor:n,closeIconColorHover:r,closeIconColorPressed:o,closeColorHoverInfo:p,closeColorPressedInfo:m,closeIconColorInfo:n,closeIconColorHoverInfo:r,closeIconColorPressedInfo:o,closeColorHoverSuccess:p,closeColorPressedSuccess:m,closeIconColorSuccess:n,closeIconColorHoverSuccess:r,closeIconColorPressedSuccess:o,closeColorHoverError:p,closeColorPressedError:m,closeIconColorError:n,closeIconColorHoverError:r,closeIconColorPressedError:o,closeColorHoverWarning:p,closeColorPressedWarning:m,closeIconColorWarning:n,closeIconColorHoverWarning:r,closeIconColorPressedWarning:o,closeColorHoverLoading:p,closeColorPressedLoading:m,closeIconColorLoading:n,closeIconColorHoverLoading:r,closeIconColorPressedLoading:o,loadingColor:d,lineHeight:h,borderRadius:f})},e5={name:"Message",common:Bo,self:Q6},t5=e5,n5=t=>{const{baseColor:e,textColor2:n,bodyColor:r,cardColor:o,dividerColor:s,actionColor:i,scrollbarColor:a,scrollbarColorHover:l,invertedColor:c}=t;return{textColor:n,textColorInverted:"#FFF",color:r,colorEmbedded:i,headerColor:o,headerColorInverted:c,footerColor:i,footerColorInverted:c,headerBorderColor:s,headerBorderColorInverted:c,footerBorderColor:s,footerBorderColorInverted:c,siderBorderColor:s,siderBorderColorInverted:c,siderColor:o,siderColorInverted:c,siderToggleButtonBorder:`1px solid ${s}`,siderToggleButtonColor:e,siderToggleButtonIconColor:n,siderToggleButtonIconColorInverted:n,siderToggleBarColor:ad(r,a),siderToggleBarColorHover:ad(r,l),__invertScrollbar:"true"}},r5={name:"Layout",common:Bo,peers:{Scrollbar:my},self:n5},o5=r5,s5={tabFontSizeSmall:"14px",tabFontSizeMedium:"14px",tabFontSizeLarge:"16px",tabGapSmallLine:"36px",tabGapMediumLine:"36px",tabGapLargeLine:"36px",tabPaddingSmallLine:"6px 0",tabPaddingMediumLine:"10px 0",tabPaddingLargeLine:"14px 0",tabGapSmallBar:"36px",tabGapMediumBar:"36px",tabGapLargeBar:"36px",tabPaddingSmallBar:"4px 0",tabPaddingMediumBar:"6px 0",tabPaddingLargeBar:"10px 0",tabGapSmallCard:"4px",tabGapMediumCard:"4px",tabGapLargeCard:"4px",tabPaddingSmallCard:"6px 10px",tabPaddingMediumCard:"8px 12px",tabPaddingLargeCard:"8px 16px",tabPaddingSmallSegment:"4px 0",tabPaddingMediumSegment:"6px 0",tabPaddingLargeSegment:"8px 0",tabGapSmallSegment:"0",tabGapMediumSegment:"0",tabGapLargeSegment:"0",panePaddingSmall:"8px 0 0 0",panePaddingMedium:"12px 0 0 0",panePaddingLarge:"16px 0 0 0",closeSize:"18px",closeIconSize:"14px"},i5=t=>{const{textColor2:e,primaryColor:n,textColorDisabled:r,closeIconColor:o,closeIconColorHover:s,closeIconColorPressed:i,closeColorHover:a,closeColorPressed:l,tabColor:c,baseColor:u,dividerColor:d,fontWeight:h,textColor1:f,borderRadius:p,fontSize:m,fontWeightStrong:g}=t;return Object.assign(Object.assign({},s5),{colorSegment:c,tabFontSizeCard:m,tabTextColorLine:f,tabTextColorActiveLine:n,tabTextColorHoverLine:n,tabTextColorDisabledLine:r,tabTextColorSegment:f,tabTextColorActiveSegment:e,tabTextColorHoverSegment:e,tabTextColorDisabledSegment:r,tabTextColorBar:f,tabTextColorActiveBar:n,tabTextColorHoverBar:n,tabTextColorDisabledBar:r,tabTextColorCard:f,tabTextColorHoverCard:f,tabTextColorActiveCard:n,tabTextColorDisabledCard:r,barColor:n,closeIconColor:o,closeIconColorHover:s,closeIconColorPressed:i,closeColorHover:a,closeColorPressed:l,closeBorderRadius:p,tabColor:c,tabColorSegment:u,tabBorderColor:d,tabFontWeightActive:h,tabFontWeight:h,tabBorderRadius:p,paneTextColor:e,fontWeightStrong:g})},a5={name:"Tabs",common:Bo,self:i5},l5=a5,c5=t=>{const{textColor1:e,textColor2:n,fontWeightStrong:r,fontSize:o}=t;return{fontSize:o,titleTextColor:e,textColor:n,titleFontWeight:r}},u5={name:"Thing",common:Bo,self:c5},d5=u5,h5={headerFontSize1:"30px",headerFontSize2:"22px",headerFontSize3:"18px",headerFontSize4:"16px",headerFontSize5:"16px",headerFontSize6:"16px",headerMargin1:"28px 0 20px 0",headerMargin2:"28px 0 20px 0",headerMargin3:"28px 0 20px 0",headerMargin4:"28px 0 18px 0",headerMargin5:"28px 0 18px 0",headerMargin6:"28px 0 18px 0",headerPrefixWidth1:"16px",headerPrefixWidth2:"16px",headerPrefixWidth3:"12px",headerPrefixWidth4:"12px",headerPrefixWidth5:"12px",headerPrefixWidth6:"12px",headerBarWidth1:"4px",headerBarWidth2:"4px",headerBarWidth3:"3px",headerBarWidth4:"3px",headerBarWidth5:"3px",headerBarWidth6:"3px",pMargin:"16px 0 16px 0",liMargin:".25em 0 0 0",olPadding:"0 0 0 2em",ulPadding:"0 0 0 2em"},f5=t=>{const{primaryColor:e,textColor2:n,borderColor:r,lineHeight:o,fontSize:s,borderRadiusSmall:i,dividerColor:a,fontWeightStrong:l,textColor1:c,textColor3:u,infoColor:d,warningColor:h,errorColor:f,successColor:p,codeColor:m}=t;return Object.assign(Object.assign({},h5),{aTextColor:e,blockquoteTextColor:n,blockquotePrefixColor:r,blockquoteLineHeight:o,blockquoteFontSize:s,codeBorderRadius:i,liTextColor:n,liLineHeight:o,liFontSize:s,hrColor:a,headerFontWeight:l,headerTextColor:c,pTextColor:n,pTextColor1Depth:c,pTextColor2Depth:n,pTextColor3Depth:u,pLineHeight:o,pFontSize:s,headerBarColor:e,headerBarColorPrimary:e,headerBarColorInfo:d,headerBarColorError:f,headerBarColorWarning:h,headerBarColorSuccess:p,textColor:n,textColor1Depth:c,textColor2Depth:n,textColor3Depth:u,textColorPrimary:e,textColorInfo:d,textColorSuccess:p,textColorWarning:h,textColorError:f,codeTextColor:n,codeColor:m,codeBorder:"1px solid #0000"})},p5={name:"Typography",common:Bo,self:f5},PE=p5,m5={type:String,default:"static"},g5=Ae("layout",`
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-sizing: border-box;
 position: relative;
 z-index: auto;
 flex: auto;
 overflow: hidden;
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[Ae("layout-scroll-container",`
 overflow-x: hidden;
 box-sizing: border-box;
 height: 100%;
 `),We("absolute-positioned",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),b5={embedded:Boolean,position:m5,nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,onScroll:Function,contentStyle:{type:[String,Object],default:""},hasSider:Boolean,siderPlacement:{type:String,default:"left"}},v5="n-layout";function x5(t){return lt({name:t?"LayoutContent":"Layout",props:Object.assign(Object.assign({},Ut.props),b5),setup(e){const n=Ne(null),r=Ne(null),{mergedClsPrefixRef:o,inlineThemeDisabled:s}=Mr(e),i=Ut("Layout","-layout",g5,o5,e,o);function a(m,g){if(e.nativeScrollbar){const{value:b}=n;b&&(g===void 0?b.scrollTo(m):b.scrollTo(m,g))}else{const{value:b}=r;b&&b.scrollTo(m,g)}}Yr(v5,e);let l=0,c=0;const u=m=>{var g;const b=m.target;l=b.scrollLeft,c=b.scrollTop,(g=e.onScroll)===null||g===void 0||g.call(e,m)};YT(()=>{if(e.nativeScrollbar){const m=n.value;m&&(m.scrollTop=c,m.scrollLeft=l)}});const d={display:"flex",flexWrap:"nowrap",width:"100%",flexDirection:"row"},h={scrollTo:a},f=Me(()=>{const{common:{cubicBezierEaseInOut:m},self:g}=i.value;return{"--n-bezier":m,"--n-color":e.embedded?g.colorEmbedded:g.color,"--n-text-color":g.textColor}}),p=s?bo("layout",Me(()=>e.embedded?"e":""),f,e):void 0;return Object.assign({mergedClsPrefix:o,scrollableElRef:n,scrollbarInstRef:r,hasSiderStyle:d,mergedTheme:i,handleNativeElScroll:u,cssVars:s?void 0:f,themeClass:p==null?void 0:p.themeClass,onRender:p==null?void 0:p.onRender},h)},render(){var e;const{mergedClsPrefix:n,hasSider:r}=this;(e=this.onRender)===null||e===void 0||e.call(this);const o=r?this.hasSiderStyle:void 0,s=[this.themeClass,t&&`${n}-layout-content`,`${n}-layout`,`${n}-layout--${this.position}-positioned`];return W("div",{class:s,style:this.cssVars},this.nativeScrollbar?W("div",{ref:"scrollableElRef",class:`${n}-layout-scroll-container`,style:[this.contentStyle,o],onScroll:this.handleNativeElScroll},this.$slots):W(gy,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,contentStyle:[this.contentStyle,o]}),this.$slots))}})}const y5=x5(!1),ME={icon:Function,type:{type:String,default:"info"},content:[String,Number,Function],showIcon:{type:Boolean,default:!0},closable:Boolean,keepAliveOnHover:Boolean,onClose:Function,onMouseenter:Function,onMouseleave:Function},LE="n-message-api",BE="n-message-provider",w5=$e([Ae("message-wrapper",`
 margin: var(--n-margin);
 z-index: 0;
 transform-origin: top center;
 display: flex;
 `,[ZU({overflow:"visible",originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.85)"}})]),Ae("message",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 margin-bottom .3s var(--n-bezier);
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 flex-wrap: nowrap;
 overflow: hidden;
 max-width: var(--n-max-width);
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-shadow: var(--n-box-shadow);
 `,[Se("content",`
 display: inline-block;
 line-height: var(--n-line-height);
 font-size: var(--n-font-size);
 `),Se("icon",`
 position: relative;
 margin: var(--n-icon-margin);
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 flex-shrink: 0;
 `,[["default","info","success","warning","error","loading"].map(t=>We(`${t}-type`,[$e("> *",`
 color: var(--n-icon-color-${t});
 transition: color .3s var(--n-bezier);
 `)])),$e("> *",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[fd()])]),Se("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 flex-shrink: 0;
 `,[$e("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),$e("&:active",`
 color: var(--n-close-icon-color-pressed);
 `)])]),Ae("message-container",`
 z-index: 6000;
 position: fixed;
 height: 0;
 overflow: visible;
 display: flex;
 flex-direction: column;
 align-items: center;
 `,[We("top",`
 top: 12px;
 left: 0;
 right: 0;
 `),We("top-left",`
 top: 12px;
 left: 12px;
 right: 0;
 align-items: flex-start;
 `),We("top-right",`
 top: 12px;
 left: 0;
 right: 12px;
 align-items: flex-end;
 `),We("bottom",`
 bottom: 4px;
 left: 0;
 right: 0;
 justify-content: flex-end;
 `),We("bottom-left",`
 bottom: 4px;
 left: 12px;
 right: 0;
 justify-content: flex-end;
 align-items: flex-start;
 `),We("bottom-right",`
 bottom: 4px;
 left: 0;
 right: 12px;
 justify-content: flex-end;
 align-items: flex-end;
 `)])]),C5={info:()=>W(dx,null),success:()=>W(kE,null),warning:()=>W(TE,null),error:()=>W(IE,null),default:()=>null},$5=lt({name:"Message",props:Object.assign(Object.assign({},ME),{render:Function}),setup(t){const{inlineThemeDisabled:e,mergedRtlRef:n}=Mr(t),{props:r,mergedClsPrefixRef:o}=Kt(BE),s=vl("Message",n,o),i=Ut("Message","-message",w5,t5,r,o),a=Me(()=>{const{type:c}=t,{common:{cubicBezierEaseInOut:u},self:{padding:d,margin:h,maxWidth:f,iconMargin:p,closeMargin:m,closeSize:g,iconSize:b,fontSize:v,lineHeight:w,borderRadius:y,iconColorInfo:C,iconColorSuccess:S,iconColorWarning:$,iconColorError:I,iconColorLoading:R,closeIconSize:T,closeBorderRadius:N,[Ge("textColor",c)]:_,[Ge("boxShadow",c)]:P,[Ge("color",c)]:z,[Ge("closeColorHover",c)]:L,[Ge("closeColorPressed",c)]:O,[Ge("closeIconColor",c)]:B,[Ge("closeIconColorPressed",c)]:U,[Ge("closeIconColorHover",c)]:Q}}=i.value;return{"--n-bezier":u,"--n-margin":h,"--n-padding":d,"--n-max-width":f,"--n-font-size":v,"--n-icon-margin":p,"--n-icon-size":b,"--n-close-icon-size":T,"--n-close-border-radius":N,"--n-close-size":g,"--n-close-margin":m,"--n-text-color":_,"--n-color":z,"--n-box-shadow":P,"--n-icon-color-info":C,"--n-icon-color-success":S,"--n-icon-color-warning":$,"--n-icon-color-error":I,"--n-icon-color-loading":R,"--n-close-color-hover":L,"--n-close-color-pressed":O,"--n-close-icon-color":B,"--n-close-icon-color-pressed":U,"--n-close-icon-color-hover":Q,"--n-line-height":w,"--n-border-radius":y}}),l=e?bo("message",Me(()=>t.type[0]),a,{}):void 0;return{mergedClsPrefix:o,rtlEnabled:s,messageProviderProps:r,handleClose(){var c;(c=t.onClose)===null||c===void 0||c.call(t)},cssVars:e?void 0:a,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender,placement:r.placement}},render(){const{render:t,type:e,closable:n,content:r,mergedClsPrefix:o,cssVars:s,themeClass:i,onRender:a,icon:l,handleClose:c,showIcon:u}=this;a==null||a();let d;return W("div",{class:[`${o}-message-wrapper`,i],onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave,style:[{alignItems:this.placement.startsWith("top")?"flex-start":"flex-end"},s]},t?t(this.$props):W("div",{class:[`${o}-message ${o}-message--${e}-type`,this.rtlEnabled&&`${o}-message--rtl`]},(d=S5(l,e,o))&&u?W("div",{class:`${o}-message__icon ${o}-message__icon--${e}-type`},W(Mm,null,{default:()=>d})):null,W("div",{class:`${o}-message__content`},wi(r)),n?W(Lm,{clsPrefix:o,class:`${o}-message__close`,onClick:c,absolute:!0}):null))}});function S5(t,e,n){if(typeof t=="function")return t();{const r=e==="loading"?W(py,{clsPrefix:n,strokeWidth:24,scale:.85}):C5[e]();return r?W(Bi,{clsPrefix:n,key:e},{default:()=>r}):null}}const I5=lt({name:"MessageEnvironment",props:Object.assign(Object.assign({},ME),{duration:{type:Number,default:3e3},onAfterLeave:Function,onLeave:Function,internalKey:{type:String,required:!0},onInternalAfterLeave:Function,onHide:Function,onAfterHide:Function}),setup(t){let e=null;const n=Ne(!0);as(()=>{r()});function r(){const{duration:u}=t;u&&(e=window.setTimeout(i,u))}function o(u){u.currentTarget===u.target&&e!==null&&(window.clearTimeout(e),e=null)}function s(u){u.currentTarget===u.target&&r()}function i(){const{onHide:u}=t;n.value=!1,e&&(window.clearTimeout(e),e=null),u&&u()}function a(){const{onClose:u}=t;u&&u(),i()}function l(){const{onAfterLeave:u,onInternalAfterLeave:d,onAfterHide:h,internalKey:f}=t;u&&u(),d&&d(f),h&&h()}function c(){i()}return{show:n,hide:i,handleClose:a,handleAfterLeave:l,handleMouseleave:s,handleMouseenter:o,deactivate:c}},render(){return W(EE,{appear:!0,onAfterLeave:this.handleAfterLeave,onLeave:this.onLeave},{default:()=>[this.show?W($5,{content:this.content,type:this.type,icon:this.icon,showIcon:this.showIcon,closable:this.closable,onClose:this.handleClose,onMouseenter:this.keepAliveOnHover?this.handleMouseenter:void 0,onMouseleave:this.keepAliveOnHover?this.handleMouseleave:void 0}):null]})}}),k5=Object.assign(Object.assign({},Ut.props),{to:[String,Object],duration:{type:Number,default:3e3},keepAliveOnHover:Boolean,max:Number,placement:{type:String,default:"top"},closable:Boolean,containerStyle:[String,Object]}),T5=lt({name:"MessageProvider",props:k5,setup(t){const{mergedClsPrefixRef:e}=Mr(t),n=Ne([]),r=Ne({}),o={create(l,c){return s(l,Object.assign({type:"default"},c))},info(l,c){return s(l,Object.assign(Object.assign({},c),{type:"info"}))},success(l,c){return s(l,Object.assign(Object.assign({},c),{type:"success"}))},warning(l,c){return s(l,Object.assign(Object.assign({},c),{type:"warning"}))},error(l,c){return s(l,Object.assign(Object.assign({},c),{type:"error"}))},loading(l,c){return s(l,Object.assign(Object.assign({},c),{type:"loading"}))},destroyAll:a};Yr(BE,{props:t,mergedClsPrefixRef:e}),Yr(LE,o);function s(l,c){const u=$T(),d=pl(Object.assign(Object.assign({},c),{content:l,key:u,destroy:()=>{var f;(f=r.value[u])===null||f===void 0||f.hide()}})),{max:h}=t;return h&&n.value.length>=h&&n.value.shift(),n.value.push(d),d}function i(l){n.value.splice(n.value.findIndex(c=>c.key===l),1),delete r.value[l]}function a(){Object.values(r.value).forEach(l=>{l.hide()})}return Object.assign({mergedClsPrefix:e,messageRefs:r,messageList:n,handleAfterLeave:i},o)},render(){var t,e,n;return W(fn,null,(e=(t=this.$slots).default)===null||e===void 0?void 0:e.call(t),this.messageList.length?W(cT,{to:(n=this.to)!==null&&n!==void 0?n:"body"},W("div",{class:[`${this.mergedClsPrefix}-message-container`,`${this.mergedClsPrefix}-message-container--${this.placement}`],key:"message-container",style:this.containerStyle},this.messageList.map(r=>W(I5,Object.assign({ref:o=>{o&&(this.messageRefs[r.key]=o)},internalKey:r.key,onInternalAfterLeave:this.handleAfterLeave},ST(r,["destroy"],void 0),{duration:r.duration===void 0?this.duration:r.duration,keepAliveOnHover:r.keepAliveOnHover===void 0?this.keepAliveOnHover:r.keepAliveOnHover,closable:r.closable===void 0?this.closable:r.closable}))))):null)}});function E5(){const t=Kt(LE,null);return t===null&&iy("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),t}const yy="n-tabs",zE={tab:[String,Number,Object,Function],name:{type:[String,Number],required:!0},disabled:Boolean,displayDirective:{type:String,default:"if"},closable:{type:Boolean,default:void 0},tabProps:Object,label:[String,Number,Object,Function]};lt({__TAB_PANE__:!0,name:"TabPane",alias:["TabPanel"],props:zE,setup(t){const e=Kt(yy,null);return e||iy("tab-pane","`n-tab-pane` must be placed inside `n-tabs`."),{style:e.paneStyleRef,class:e.paneClassRef,mergedClsPrefix:e.mergedClsPrefixRef}},render(){return W("div",{class:[`${this.mergedClsPrefix}-tab-pane`,this.class],style:this.style},this.$slots)}});const R5=Object.assign({internalLeftPadded:Boolean,internalAddable:Boolean,internalCreatedByPane:Boolean},ST(zE,["displayDirective"])),Fp=lt({__TAB__:!0,inheritAttrs:!1,name:"Tab",props:R5,setup(t){const{mergedClsPrefixRef:e,valueRef:n,typeRef:r,closableRef:o,tabStyleRef:s,tabChangeIdRef:i,onBeforeLeaveRef:a,triggerRef:l,handleAdd:c,activateTab:u,handleClose:d}=Kt(yy);return{trigger:l,mergedClosable:Me(()=>{if(t.internalAddable)return!1;const{closable:h}=t;return h===void 0?o.value:h}),style:s,clsPrefix:e,value:n,type:r,handleClose(h){h.stopPropagation(),!t.disabled&&d(t.name)},activateTab(){if(t.disabled)return;if(t.internalAddable){c();return}const{name:h}=t,f=++i.id;if(h!==n.value){const{value:p}=a;p?Promise.resolve(p(t.name,n.value)).then(m=>{m&&i.id===f&&u(h)}):u(h)}}}},render(){const{internalAddable:t,clsPrefix:e,name:n,disabled:r,label:o,tab:s,value:i,mergedClosable:a,style:l,trigger:c,$slots:{default:u}}=this,d=o!=null?o:s;return W("div",{class:`${e}-tabs-tab-wrapper`},this.internalLeftPadded?W("div",{class:`${e}-tabs-tab-pad`}):null,W("div",Object.assign({key:n,"data-name":n,"data-disabled":r?!0:void 0},Ad({class:[`${e}-tabs-tab`,i===n&&`${e}-tabs-tab--active`,r&&`${e}-tabs-tab--disabled`,a&&`${e}-tabs-tab--closable`,t&&`${e}-tabs-tab--addable`],onClick:c==="click"?this.activateTab:void 0,onMouseenter:c==="hover"?this.activateTab:void 0,style:t?void 0:l},this.internalCreatedByPane?this.tabProps||{}:this.$attrs)),W("span",{class:`${e}-tabs-tab__label`},t?W(fn,null,W("div",{class:`${e}-tabs-tab__height-placeholder`},"\xA0"),W(Bi,{clsPrefix:e},{default:()=>W(SU,null)})):u?u():typeof d=="object"?d:wi(d!=null?d:n)),a&&this.type==="card"?W(Lm,{clsPrefix:e,class:`${e}-tabs-tab__close`,onClick:this.handleClose,disabled:r}):null))}}),N5=Ae("tabs",`
 box-sizing: border-box;
 width: 100%;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
`,[We("segment-type",[Ae("tabs-rail",[$e("&.transition-disabled","color: red;",[Ae("tabs-tab",`
 transition: none;
 `)])])]),Ae("tabs-rail",`
 padding: 3px;
 border-radius: var(--n-tab-border-radius);
 width: 100%;
 background-color: var(--n-color-segment);
 transition: background-color .3s var(--n-bezier);
 display: flex;
 align-items: center;
 `,[Ae("tabs-tab-wrapper",`
 flex-basis: 0;
 flex-grow: 1;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[Ae("tabs-tab",`
 overflow: hidden;
 border-radius: var(--n-tab-border-radius);
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[We("active",`
 font-weight: var(--n-font-weight-strong);
 color: var(--n-tab-text-color-active);
 background-color: var(--n-tab-color-segment);
 box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .08);
 `),$e("&:hover",`
 color: var(--n-tab-text-color-hover);
 `)])])]),We("flex",[Ae("tabs-nav",{width:"100%"},[Ae("tabs-wrapper",{width:"100%"},[Ae("tabs-tab",{marginRight:0})])])]),Ae("tabs-nav",`
 box-sizing: border-box;
 line-height: 1.5;
 display: flex;
 transition: border-color .3s var(--n-bezier);
 `,[Se("prefix, suffix",`
 display: flex;
 align-items: center;
 `),Se("prefix","padding-right: 16px;"),Se("suffix","padding-left: 16px;")]),Ae("tabs-nav-scroll-wrapper",`
 flex: 1;
 position: relative;
 overflow: hidden;
 `,[We("shadow-before",[$e("&::before",`
 box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, .12);
 `)]),We("shadow-after",[$e("&::after",`
 box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, .12);
 `)]),$e("&::before, &::after",`
 transition: box-shadow .3s var(--n-bezier);
 pointer-events: none;
 content: "";
 position: absolute;
 top: 0;
 bottom: 0;
 width: 20px;
 z-index: 1;
 `),$e("&::before",`
 left: 0;
 `),$e("&::after",`
 right: 0;
 `)]),Ae("tabs-nav-scroll-content",`
 display: flex;
 position: relative;
 min-width: 100%;
 width: fit-content;
 `),Ae("tabs-wrapper",`
 display: inline-flex;
 flex-wrap: nowrap;
 position: relative;
 `),Ae("tabs-tab-wrapper",`
 display: flex;
 flex-wrap: nowrap;
 flex-shrink: 0;
 flex-grow: 0;
 `),Ae("tabs-tab",`
 cursor: pointer;
 white-space: nowrap;
 flex-wrap: nowrap;
 display: inline-flex;
 align-items: center;
 color: var(--n-tab-text-color);
 font-size: var(--n-tab-font-size);
 background-clip: padding-box;
 padding: var(--n-tab-padding);
 transition:
 box-shadow .3s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[We("disabled",{cursor:"not-allowed"}),Se("close",`
 margin-left: 6px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),Se("label",`
 display: flex;
 align-items: center;
 `)]),Ae("tabs-bar",`
 position: absolute;
 bottom: 0;
 height: 2px;
 border-radius: 1px;
 background-color: var(--n-bar-color);
 transition:
 left .2s var(--n-bezier),
 max-width .2s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[$e("&.transition-disabled",`
 transition: none;
 `),We("disabled",`
 background-color: var(--n-tab-text-color-disabled)
 `)]),Ae("tabs-pane-wrapper",`
 position: relative;
 overflow: hidden;
 transition: max-height .2s var(--n-bezier);
 `),Ae("tab-pane",`
 color: var(--n-pane-text-color);
 width: 100%;
 padding: var(--n-pane-padding);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .2s var(--n-bezier);
 left: 0;
 right: 0;
 top: 0;
 `,[$e("&.next-transition-leave-active, &.prev-transition-leave-active, &.next-transition-enter-active, &.prev-transition-enter-active",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 transform .2s var(--n-bezier),
 opacity .2s var(--n-bezier);
 `),$e("&.next-transition-leave-active, &.prev-transition-leave-active",`
 position: absolute;
 `),$e("&.next-transition-enter-from, &.prev-transition-leave-to",`
 transform: translateX(32px);
 opacity: 0;
 `),$e("&.next-transition-leave-to, &.prev-transition-enter-from",`
 transform: translateX(-32px);
 opacity: 0;
 `),$e("&.next-transition-leave-from, &.next-transition-enter-to, &.prev-transition-leave-from, &.prev-transition-enter-to",`
 transform: translateX(0);
 opacity: 1;
 `)]),Ae("tabs-tab-pad",`
 width: var(--n-tab-gap);
 flex-grow: 0;
 flex-shrink: 0;
 `),We("line-type, bar-type",[Ae("tabs-tab",`
 font-weight: var(--n-tab-font-weight);
 box-sizing: border-box;
 vertical-align: bottom;
 `,[$e("&:hover",{color:"var(--n-tab-text-color-hover)"}),We("active",`
 color: var(--n-tab-text-color-active);
 font-weight: var(--n-tab-font-weight-active);
 `),We("disabled",{color:"var(--n-tab-text-color-disabled)"})])]),Ae("tabs-nav",[We("line-type",[Se("prefix, suffix",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),Ae("tabs-nav-scroll-content",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),Ae("tabs-bar",`
 border-radius: 0;
 bottom: -1px;
 `)]),We("card-type",[Se("prefix, suffix",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),Ae("tabs-pad",`
 flex-grow: 1;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),Ae("tabs-tab-pad",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),Ae("tabs-tab",`
 font-weight: var(--n-tab-font-weight);
 border: 1px solid var(--n-tab-border-color);
 border-top-left-radius: var(--n-tab-border-radius);
 border-top-right-radius: var(--n-tab-border-radius);
 background-color: var(--n-tab-color);
 box-sizing: border-box;
 position: relative;
 vertical-align: bottom;
 display: flex;
 justify-content: space-between;
 font-size: var(--n-tab-font-size);
 color: var(--n-tab-text-color);
 `,[We("addable",`
 padding-left: 8px;
 padding-right: 8px;
 font-size: 16px;
 `,[Se("height-placeholder",`
 width: 0;
 font-size: var(--n-tab-font-size);
 `),Ks("disabled",[$e("&:hover",`
 color: var(--n-tab-text-color-hover);
 `)])]),We("closable","padding-right: 6px;"),We("active",`
 border-bottom: 1px solid #0000;
 background-color: #0000;
 font-weight: var(--n-tab-font-weight-active);
 color: var(--n-tab-text-color-active);
 `),We("disabled","color: var(--n-tab-text-color-disabled);")]),Ae("tabs-scroll-padding","border-bottom: 1px solid var(--n-tab-border-color);")])])]),_5=Object.assign(Object.assign({},Ut.props),{value:[String,Number],defaultValue:[String,Number],trigger:{type:String,default:"click"},type:{type:String,default:"bar"},closable:Boolean,justifyContent:String,size:{type:String,default:"medium"},tabStyle:[String,Object],barWidth:Number,paneClass:String,paneStyle:[String,Object],addable:[Boolean,Object],tabsPadding:{type:Number,default:0},animated:Boolean,onBeforeLeave:Function,onAdd:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onClose:[Function,Array],labelSize:String,activeName:[String,Number],onActiveNameChange:[Function,Array]}),A5=lt({name:"Tabs",props:_5,setup(t,{slots:e}){var n,r,o,s;const{mergedClsPrefixRef:i,inlineThemeDisabled:a}=Mr(t),l=Ut("Tabs","-tabs",N5,l5,t,i),c=Ne(null),u=Ne(null),d=Ne(null),h=Ne(null),f=Ne(null),p=Ne(!0),m=Ne(!0),g=ox(t,["labelSize","size"]),b=ox(t,["activeName","value"]),v=Ne((r=(n=b.value)!==null&&n!==void 0?n:t.defaultValue)!==null&&r!==void 0?r:e.default?(s=(o=za(e.default())[0])===null||o===void 0?void 0:o.props)===null||s===void 0?void 0:s.name:null),w=PT(b,v),y={id:0},C=Me(()=>{if(!(!t.justifyContent||t.type==="card"))return{display:"flex",justifyContent:t.justifyContent}});Fn(w,()=>{y.id=0,I(),R()});function S(){var G;const{value:Y}=w;return Y===null?null:(G=c.value)===null||G===void 0?void 0:G.querySelector(`[data-name="${Y}"]`)}function $(G){if(t.type==="card")return;const{value:Y}=u;if(!!Y&&G){const ae=`${i.value}-tabs-bar--disabled`,{barWidth:pe}=t;if(G.dataset.disabled==="true"?Y.classList.add(ae):Y.classList.remove(ae),typeof pe=="number"&&G.offsetWidth>=pe){const ye=Math.floor((G.offsetWidth-pe)/2)+G.offsetLeft;Y.style.left=`${ye}px`,Y.style.maxWidth=`${pe}px`}else Y.style.left=`${G.offsetLeft}px`,Y.style.maxWidth=`${G.offsetWidth}px`;Y.style.width="8192px",Y.offsetWidth}}function I(){if(t.type==="card")return;const G=S();G&&$(G)}function R(G){var Y;const ae=(Y=f.value)===null||Y===void 0?void 0:Y.$el;if(!ae)return;const pe=S();if(!pe)return;const{scrollLeft:ye,offsetWidth:ge}=ae,{offsetLeft:be,offsetWidth:De}=pe;ye>be?ae.scrollTo({top:0,left:be,behavior:"smooth"}):be+De>ye+ge&&ae.scrollTo({top:0,left:be+De-ge,behavior:"smooth"})}const T=Ne(null);let N=0,_=null;function P(G){const Y=T.value;if(Y){N=G.getBoundingClientRect().height;const ae=`${N}px`,pe=()=>{Y.style.height=ae,Y.style.maxHeight=ae};_?(pe(),_(),_=null):_=pe}}function z(G){const Y=T.value;if(Y){const ae=G.getBoundingClientRect().height,pe=()=>{document.body.offsetHeight,Y.style.maxHeight=`${ae}px`,Y.style.height=`${Math.max(N,ae)}px`};_?(_(),_=null,pe()):_=pe}}function L(){const G=T.value;G&&(G.style.maxHeight="",G.style.height="")}const O={value:[]},B=Ne("next");function U(G){const Y=w.value;let ae="next";for(const pe of O.value){if(pe===Y)break;if(pe===G){ae="prev";break}}B.value=ae,Q(G)}function Q(G){const{onActiveNameChange:Y,onUpdateValue:ae,"onUpdate:value":pe}=t;Y&&dn(Y,G),ae&&dn(ae,G),pe&&dn(pe,G),v.value=G}function se(G){const{onClose:Y}=t;Y&&dn(Y,G)}function ce(){const{value:G}=u;if(!G)return;const Y="transition-disabled";G.classList.add(Y),I(),G.classList.remove(Y)}let de=0;function we(G){var Y;if(G.contentRect.width===0&&G.contentRect.height===0||de===G.contentRect.width)return;de=G.contentRect.width;const{type:ae}=t;(ae==="line"||ae==="bar")&&ce(),ae!=="segment"&&ve((Y=f.value)===null||Y===void 0?void 0:Y.$el)}const Ie=sv(we,64);Fn([()=>t.justifyContent,()=>t.size],()=>{Do(()=>{const{type:G}=t;(G==="line"||G==="bar")&&ce()})});const j=Ne(!1);function re(G){var Y;const{target:ae,contentRect:{width:pe}}=G,ye=ae.parentElement.offsetWidth;if(!j.value)ye<pe&&(j.value=!0);else{const{value:ge}=h;if(!ge)return;ye-pe>ge.$el.offsetWidth&&(j.value=!1)}ve((Y=f.value)===null||Y===void 0?void 0:Y.$el)}const le=sv(re,64);function Ce(){const{onAdd:G}=t;G&&G(),Do(()=>{const Y=S(),{value:ae}=f;!Y||!ae||ae.scrollTo({left:Y.offsetLeft,top:0,behavior:"smooth"})})}function ve(G){if(!G)return;const{scrollLeft:Y,scrollWidth:ae,offsetWidth:pe}=G;p.value=Y<=0,m.value=Y+pe>=ae}const Le=sv(G=>{ve(G.target)},64);Yr(yy,{triggerRef:Bn(t,"trigger"),tabStyleRef:Bn(t,"tabStyle"),paneClassRef:Bn(t,"paneClass"),paneStyleRef:Bn(t,"paneStyle"),mergedClsPrefixRef:i,typeRef:Bn(t,"type"),closableRef:Bn(t,"closable"),valueRef:w,tabChangeIdRef:y,onBeforeLeaveRef:Bn(t,"onBeforeLeave"),activateTab:U,handleClose:se,handleAdd:Ce}),jL(()=>{I(),R()}),hc(()=>{const{value:G}=d;if(!G)return;const{value:Y}=i,ae=`${Y}-tabs-nav-scroll-wrapper--shadow-before`,pe=`${Y}-tabs-nav-scroll-wrapper--shadow-after`;p.value?G.classList.remove(ae):G.classList.add(ae),m.value?G.classList.remove(pe):G.classList.add(pe)});const _e=Ne(null);Fn(w,()=>{if(t.type==="segment"){const G=_e.value;G&&Do(()=>{G.classList.add("transition-disabled"),G.offsetWidth,G.classList.remove("transition-disabled")})}});const F={syncBarPosition:()=>{I()}},V=Me(()=>{const{value:G}=g,{type:Y}=t,ae={card:"Card",bar:"Bar",line:"Line",segment:"Segment"}[Y],pe=`${G}${ae}`,{self:{barColor:ye,closeIconColor:ge,closeIconColorHover:be,closeIconColorPressed:De,tabColor:Oe,tabBorderColor:Pe,paneTextColor:qe,tabFontWeight:nt,tabBorderRadius:dt,tabFontWeightActive:ht,colorSegment:$t,fontWeightStrong:ln,tabColorSegment:Cn,closeSize:ro,closeIconSize:Pn,closeColorHover:Nn,closeColorPressed:Ht,closeBorderRadius:Ee,[Ge("panePadding",G)]:He,[Ge("tabPadding",pe)]:rt,[Ge("tabGap",pe)]:Pt,[Ge("tabTextColor",Y)]:en,[Ge("tabTextColorActive",Y)]:_n,[Ge("tabTextColorHover",Y)]:qt,[Ge("tabTextColorDisabled",Y)]:mt,[Ge("tabFontSize",G)]:cr},common:{cubicBezierEaseInOut:Mn}}=l.value;return{"--n-bezier":Mn,"--n-color-segment":$t,"--n-bar-color":ye,"--n-tab-font-size":cr,"--n-tab-text-color":en,"--n-tab-text-color-active":_n,"--n-tab-text-color-disabled":mt,"--n-tab-text-color-hover":qt,"--n-pane-text-color":qe,"--n-tab-border-color":Pe,"--n-tab-border-radius":dt,"--n-close-size":ro,"--n-close-icon-size":Pn,"--n-close-color-hover":Nn,"--n-close-color-pressed":Ht,"--n-close-border-radius":Ee,"--n-close-icon-color":ge,"--n-close-icon-color-hover":be,"--n-close-icon-color-pressed":De,"--n-tab-color":Oe,"--n-tab-font-weight":nt,"--n-tab-font-weight-active":ht,"--n-tab-padding":rt,"--n-tab-gap":Pt,"--n-pane-padding":He,"--n-font-weight-strong":ln,"--n-tab-color-segment":Cn}}),oe=a?bo("tabs",Me(()=>`${g.value[0]}${t.type[0]}`),V,t):void 0;return Object.assign({mergedClsPrefix:i,mergedValue:w,renderedNames:new Set,tabsRailElRef:_e,tabsPaneWrapperRef:T,tabsElRef:c,barElRef:u,addTabInstRef:h,xScrollInstRef:f,scrollWrapperElRef:d,addTabFixed:j,tabWrapperStyle:C,handleNavResize:Ie,mergedSize:g,handleScroll:Le,handleTabsResize:le,cssVars:a?void 0:V,themeClass:oe==null?void 0:oe.themeClass,animationDirection:B,renderNameListRef:O,onAnimationBeforeLeave:P,onAnimationEnter:z,onAnimationAfterEnter:L,onRender:oe==null?void 0:oe.onRender},F)},render(){const{mergedClsPrefix:t,type:e,addTabFixed:n,addable:r,mergedSize:o,renderNameListRef:s,onRender:i,$slots:{default:a,prefix:l,suffix:c}}=this;i==null||i();const u=a?za(a()).filter(g=>g.type.__TAB_PANE__===!0):[],d=a?za(a()).filter(g=>g.type.__TAB__===!0):[],h=!d.length,f=e==="card",p=e==="segment",m=!f&&!p&&this.justifyContent;return s.value=[],W("div",{class:[`${t}-tabs`,this.themeClass,`${t}-tabs--${e}-type`,`${t}-tabs--${o}-size`,m&&`${t}-tabs--flex`],style:this.cssVars},W("div",{class:[`${t}-tabs-nav--${e}-type`,`${t}-tabs-nav`]},yr(l,g=>g&&W("div",{class:`${t}-tabs-nav__prefix`},g)),p?W("div",{class:`${t}-tabs-rail`,ref:"tabsRailElRef"},h?u.map((g,b)=>(s.value.push(g.props.name),W(Fp,Object.assign({},g.props,{internalCreatedByPane:!0,internalLeftPadded:b!==0}),g.children?{default:g.children.tab}:void 0))):d.map((g,b)=>(s.value.push(g.props.name),b===0?g:_S(g)))):W(ud,{onResize:this.handleNavResize},{default:()=>W("div",{class:`${t}-tabs-nav-scroll-wrapper`,ref:"scrollWrapperElRef"},W(zB,{ref:"xScrollInstRef",onScroll:this.handleScroll},{default:()=>{const g=W("div",{style:this.tabWrapperStyle,class:`${t}-tabs-wrapper`},m?null:W("div",{class:`${t}-tabs-scroll-padding`,style:{width:`${this.tabsPadding}px`}}),h?u.map((v,w)=>(s.value.push(v.props.name),lv(W(Fp,Object.assign({},v.props,{internalCreatedByPane:!0,internalLeftPadded:w!==0&&(!m||m==="center"||m==="start"||m==="end")}),v.children?{default:v.children.tab}:void 0)))):d.map((v,w)=>(s.value.push(v.props.name),lv(w!==0&&!m?_S(v):v))),!n&&r&&f?NS(r,(h?u.length:d.length)!==0):null,m?null:W("div",{class:`${t}-tabs-scroll-padding`,style:{width:`${this.tabsPadding}px`}}));let b=g;return f&&r&&(b=W(ud,{onResize:this.handleTabsResize},{default:()=>g})),W("div",{ref:"tabsElRef",class:`${t}-tabs-nav-scroll-content`},b,f?W("div",{class:`${t}-tabs-pad`}):null,f?null:W("div",{ref:"barElRef",class:`${t}-tabs-bar`}))}}))}),n&&r&&f?NS(r,!0):null,yr(c,g=>g&&W("div",{class:`${t}-tabs-nav__suffix`},g))),h&&(this.animated?W("div",{ref:"tabsPaneWrapperRef",class:`${t}-tabs-pane-wrapper`},RS(u,this.mergedValue,this.renderedNames,this.onAnimationBeforeLeave,this.onAnimationEnter,this.onAnimationAfterEnter,this.animationDirection)):RS(u,this.mergedValue,this.renderedNames)))}});function RS(t,e,n,r,o,s,i){const a=[];return t.forEach(l=>{const{name:c,displayDirective:u,"display-directive":d}=l.props,h=p=>u===p||d===p,f=e===c;if(l.key!==void 0&&(l.key=c),f||h("show")||h("show:lazy")&&n.has(c)){n.has(c)||n.add(c);const p=!h("if");a.push(p?Rp(l,[[Jv,f]]):l)}}),i?W(wT,{name:`${i}-transition`,onBeforeLeave:r,onEnter:o,onAfterEnter:s},{default:()=>a}):a}function NS(t,e){return W(Fp,{ref:"addTabInstRef",key:"__addable",name:"__addable",internalCreatedByPane:!0,internalAddable:!0,internalLeftPadded:e,disabled:typeof t=="object"&&t.disabled})}function _S(t){const e=Os(t);return e.props?e.props.internalLeftPadded=!0:e.props={internalLeftPadded:!0},e}function lv(t){return Array.isArray(t.dynamicProps)?t.dynamicProps.includes("internalLeftPadded")||t.dynamicProps.push("internalLeftPadded"):t.dynamicProps=["internalLeftPadded"],t}const D5=Ae("thing",`
 display: flex;
 transition: color .3s var(--n-bezier);
 font-size: var(--n-font-size);
 color: var(--n-text-color);
`,[Ae("thing-avatar",`
 margin-right: 12px;
 margin-top: 2px;
 `),Ae("thing-avatar-header-wrapper",`
 display: flex;
 flex-wrap: nowrap;
 `,[Ae("thing-header-wrapper",`
 flex: 1;
 `)]),Ae("thing-main",`
 flex-grow: 1;
 `,[Ae("thing-header",`
 display: flex;
 margin-bottom: 4px;
 justify-content: space-between;
 align-items: center;
 `,[Se("title",`
 font-size: 16px;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 color: var(--n-title-text-color);
 `)]),Se("description",[$e("&:not(:last-child)",`
 margin-bottom: 4px;
 `)]),Se("content",[$e("&:not(:first-child)",`
 margin-top: 12px;
 `)]),Se("footer",[$e("&:not(:first-child)",`
 margin-top: 12px;
 `)]),Se("action",[$e("&:not(:first-child)",`
 margin-top: 12px;
 `)])])]),F5=Object.assign(Object.assign({},Ut.props),{title:String,titleExtra:String,description:String,descriptionStyle:[String,Object],content:String,contentStyle:[String,Object],contentIndented:Boolean}),O5=lt({name:"Thing",props:F5,setup(t,{slots:e}){const{mergedClsPrefixRef:n,inlineThemeDisabled:r,mergedRtlRef:o}=Mr(t),s=Ut("Thing","-thing",D5,d5,t,n),i=vl("Thing",o,n),a=Me(()=>{const{self:{titleTextColor:c,textColor:u,titleFontWeight:d,fontSize:h},common:{cubicBezierEaseInOut:f}}=s.value;return{"--n-bezier":f,"--n-font-size":h,"--n-text-color":u,"--n-title-font-weight":d,"--n-title-text-color":c}}),l=r?bo("thing",void 0,a,t):void 0;return()=>{var c;const{value:u}=n,d=i?i.value:!1;return(c=l==null?void 0:l.onRender)===null||c===void 0||c.call(l),W("div",{class:[`${u}-thing`,l==null?void 0:l.themeClass,d&&`${u}-thing--rtl`],style:r?void 0:a.value},e.avatar&&t.contentIndented?W("div",{class:`${u}-thing-avatar`},e.avatar()):null,W("div",{class:`${u}-thing-main`},!t.contentIndented&&(e.header||t.title||e["header-extra"]||t.titleExtra||e.avatar)?W("div",{class:`${u}-thing-avatar-header-wrapper`},e.avatar?W("div",{class:`${u}-thing-avatar`},e.avatar()):null,e.header||t.title||e["header-extra"]||t.titleExtra?W("div",{class:`${u}-thing-header-wrapper`},W("div",{class:`${u}-thing-header`},e.header||t.title?W("div",{class:`${u}-thing-header__title`},e.header?e.header():t.title):null,e["header-extra"]||t.titleExtra?W("div",{class:`${u}-thing-header__extra`},e["header-extra"]?e["header-extra"]():t.titleExtra):null),e.description||t.description?W("div",{class:`${u}-thing-main__description`,style:t.descriptionStyle},e.description?e.description():t.description):null):null):W(fn,null,e.header||t.title||e["header-extra"]||t.titleExtra?W("div",{class:`${u}-thing-header`},e.header||t.title?W("div",{class:`${u}-thing-header__title`},e.header?e.header():t.title):null,e["header-extra"]||t.titleExtra?W("div",{class:`${u}-thing-header__extra`},e["header-extra"]?e["header-extra"]():t.titleExtra):null):null,e.description||t.description?W("div",{class:`${u}-thing-main__description`,style:t.descriptionStyle},e.description?e.description():t.description):null),e.default||t.content?W("div",{class:`${u}-thing-main__content`,style:t.contentStyle},e.default?e.default():t.content):null,e.footer?W("div",{class:`${u}-thing-main__footer`},e.footer()):null,e.action?W("div",{class:`${u}-thing-main__action`},e.action()):null))}}}),P5=Ae("h",`
 font-size: var(--n-font-size);
 font-weight: var(--n-font-weight);
 margin: var(--n-margin);
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[$e("&:first-child",{marginTop:0}),We("prefix-bar",{position:"relative",paddingLeft:"var(--n-prefix-width)"},[We("align-text",{paddingLeft:0},[$e("&::before",{left:"calc(-1 * var(--n-prefix-width))"})]),$e("&::before",`
 content: "";
 width: var(--n-bar-width);
 border-radius: calc(var(--n-bar-width) / 2);
 transition: background-color .3s var(--n-bezier);
 left: 0;
 top: 0;
 bottom: 0;
 position: absolute;
 `),$e("&::before",{backgroundColor:"var(--n-bar-color)"})])]),M5=Object.assign(Object.assign({},Ut.props),{type:{type:String,default:"default"},prefix:String,alignText:Boolean}),jc=t=>lt({name:`H${t}`,props:M5,setup(e){const{mergedClsPrefixRef:n,inlineThemeDisabled:r}=Mr(e),o=Ut("Typography","-h",P5,PE,e,n),s=Me(()=>{const{type:a}=e,{common:{cubicBezierEaseInOut:l},self:{headerFontWeight:c,headerTextColor:u,[Ge("headerPrefixWidth",t)]:d,[Ge("headerFontSize",t)]:h,[Ge("headerMargin",t)]:f,[Ge("headerBarWidth",t)]:p,[Ge("headerBarColor",a)]:m}}=o.value;return{"--n-bezier":l,"--n-font-size":h,"--n-margin":f,"--n-bar-color":m,"--n-bar-width":p,"--n-font-weight":c,"--n-text-color":u,"--n-prefix-width":d}}),i=r?bo(`h${t}`,Me(()=>e.type[0]),s,e):void 0;return{mergedClsPrefix:n,cssVars:r?void 0:s,themeClass:i==null?void 0:i.themeClass,onRender:i==null?void 0:i.onRender}},render(){var e;const{prefix:n,alignText:r,mergedClsPrefix:o,cssVars:s,$slots:i}=this;return(e=this.onRender)===null||e===void 0||e.call(this),W(`h${t}`,{class:[`${o}-h`,`${o}-h${t}`,this.themeClass,{[`${o}-h--prefix-bar`]:n,[`${o}-h--align-text`]:r}],style:s},i)}});jc("1");jc("2");jc("3");jc("4");const px=jc("5");jc("6");const L5=Ae("text",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[We("strong",`
 font-weight: var(--n-font-weight-strong);
 `),We("italic",{fontStyle:"italic"}),We("underline",{textDecoration:"underline"}),We("code",`
 line-height: 1.4;
 display: inline-block;
 font-family: var(--n-font-famliy-mono);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 box-sizing: border-box;
 padding: .05em .35em 0 .35em;
 border-radius: var(--n-code-border-radius);
 font-size: .9em;
 color: var(--n-code-text-color);
 background-color: var(--n-code-color);
 border: var(--n-code-border);
 `)]),B5=Object.assign(Object.assign({},Ut.props),{code:Boolean,type:{type:String,default:"default"},delete:Boolean,strong:Boolean,italic:Boolean,underline:Boolean,depth:[String,Number],tag:String,as:{type:String,validator:()=>!0,default:void 0}}),WE=lt({name:"Text",props:B5,setup(t){const{mergedClsPrefixRef:e,inlineThemeDisabled:n}=Mr(t),r=Ut("Typography","-text",L5,PE,t,e),o=Me(()=>{const{depth:i,type:a}=t,l=a==="default"?i===void 0?"textColor":`textColor${i}Depth`:Ge("textColor",a),{common:{fontWeightStrong:c,fontFamilyMono:u,cubicBezierEaseInOut:d},self:{codeTextColor:h,codeBorderRadius:f,codeColor:p,codeBorder:m,[l]:g}}=r.value;return{"--n-bezier":d,"--n-text-color":g,"--n-font-weight-strong":c,"--n-font-famliy-mono":u,"--n-code-border-radius":f,"--n-code-text-color":h,"--n-code-color":p,"--n-code-border":m}}),s=n?bo("text",Me(()=>`${t.type[0]}${t.depth||""}`),o,t):void 0;return{mergedClsPrefix:e,compitableTag:ox(t,["as","tag"]),cssVars:n?void 0:o,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var t,e,n;const{mergedClsPrefix:r}=this;(t=this.onRender)===null||t===void 0||t.call(this);const o=[`${r}-text`,this.themeClass,{[`${r}-text--code`]:this.code,[`${r}-text--delete`]:this.delete,[`${r}-text--strong`]:this.strong,[`${r}-text--italic`]:this.italic,[`${r}-text--underline`]:this.underline}],s=(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e);return this.code?W("code",{class:o,style:this.cssVars},this.delete?W("del",null,s):s):this.delete?W("del",{class:o,style:this.cssVars},s):W(this.compitableTag||"span",{class:o,style:this.cssVars},s)}}),z5=lt({__name:"App",setup(t){return(e,n)=>{const r=Hv("RouterView");return Zr(),Oc(kt(T5),null,{default:Sn(()=>[Tt(r)]),_:1})}}});/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Hl=typeof window<"u";function W5(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const Wt=Object.assign;function cv(t,e){const n={};for(const r in e){const o=e[r];n[r]=rs(o)?o.map(t):t(o)}return n}const Hu=()=>{},rs=Array.isArray,V5=/\/$/,U5=t=>t.replace(V5,"");function uv(t,e,n="/"){let r,o={},s="",i="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),o=t(s)),a>-1&&(r=r||e.slice(0,a),i=e.slice(a,e.length)),r=K5(r!=null?r:e,n),{fullPath:r+(s&&"?")+s+i,path:r,query:o,hash:i}}function H5(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function AS(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function G5(t,e,n){const r=e.matched.length-1,o=n.matched.length-1;return r>-1&&r===o&&mc(e.matched[r],n.matched[o])&&VE(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function mc(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function VE(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!j5(t[n],e[n]))return!1;return!0}function j5(t,e){return rs(t)?DS(t,e):rs(e)?DS(e,t):t===e}function DS(t,e){return rs(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function K5(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/");let o=n.length-1,s,i;for(s=0;s<r.length;s++)if(i=r[s],i!==".")if(i==="..")o>1&&o--;else break;return n.slice(0,o).join("/")+"/"+r.slice(s-(s===r.length?1:0)).join("/")}var pd;(function(t){t.pop="pop",t.push="push"})(pd||(pd={}));var Gu;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Gu||(Gu={}));function q5(t){if(!t)if(Hl){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),U5(t)}const X5=/^[^#]+#/;function Y5(t,e){return t.replace(X5,"#")+e}function Z5(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const Bm=()=>({left:window.pageXOffset,top:window.pageYOffset});function J5(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;e=Z5(o,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function FS(t,e){return(history.state?history.state.position-e:-1)+t}const mx=new Map;function Q5(t,e){mx.set(t,e)}function eH(t){const e=mx.get(t);return mx.delete(t),e}let tH=()=>location.protocol+"//"+location.host;function UE(t,e){const{pathname:n,search:r,hash:o}=e,s=t.indexOf("#");if(s>-1){let a=o.includes(t.slice(s))?t.slice(s).length:1,l=o.slice(a);return l[0]!=="/"&&(l="/"+l),AS(l,"")}return AS(n,t)+r+o}function nH(t,e,n,r){let o=[],s=[],i=null;const a=({state:h})=>{const f=UE(t,location),p=n.value,m=e.value;let g=0;if(h){if(n.value=f,e.value=h,i&&i===p){i=null;return}g=m?h.position-m.position:0}else r(f);o.forEach(b=>{b(n.value,p,{delta:g,type:pd.pop,direction:g?g>0?Gu.forward:Gu.back:Gu.unknown})})};function l(){i=n.value}function c(h){o.push(h);const f=()=>{const p=o.indexOf(h);p>-1&&o.splice(p,1)};return s.push(f),f}function u(){const{history:h}=window;!h.state||h.replaceState(Wt({},h.state,{scroll:Bm()}),"")}function d(){for(const h of s)h();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:l,listen:c,destroy:d}}function OS(t,e,n,r=!1,o=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:o?Bm():null}}function rH(t){const{history:e,location:n}=window,r={value:UE(t,n)},o={value:e.state};o.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const d=t.indexOf("#"),h=d>-1?(n.host&&document.querySelector("base")?t:t.slice(d))+l:tH()+t+l;try{e[u?"replaceState":"pushState"](c,"",h),o.value=c}catch(f){console.error(f),n[u?"replace":"assign"](h)}}function i(l,c){const u=Wt({},e.state,OS(o.value.back,l,o.value.forward,!0),c,{position:o.value.position});s(l,u,!0),r.value=l}function a(l,c){const u=Wt({},o.value,e.state,{forward:l,scroll:Bm()});s(u.current,u,!0);const d=Wt({},OS(r.value,l,null),{position:u.position+1},c);s(l,d,!1),r.value=l}return{location:r,state:o,push:a,replace:i}}function oH(t){t=q5(t);const e=rH(t),n=nH(t,e.state,e.location,e.replace);function r(s,i=!0){i||n.pauseListeners(),history.go(s)}const o=Wt({location:"",base:t,go:r,createHref:Y5.bind(null,t)},e,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>e.state.value}),o}function sH(t){return typeof t=="string"||t&&typeof t=="object"}function HE(t){return typeof t=="string"||typeof t=="symbol"}const bi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},GE=Symbol("");var PS;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(PS||(PS={}));function gc(t,e){return Wt(new Error,{type:t,[GE]:!0},e)}function Ws(t,e){return t instanceof Error&&GE in t&&(e==null||!!(t.type&e))}const MS="[^/]+?",iH={sensitive:!1,strict:!1,start:!0,end:!0},aH=/[.+*?^${}()[\]/\\]/g;function lH(t,e){const n=Wt({},iH,e),r=[];let o=n.start?"^":"";const s=[];for(const c of t){const u=c.length?[]:[90];n.strict&&!c.length&&(o+="/");for(let d=0;d<c.length;d++){const h=c[d];let f=40+(n.sensitive?.25:0);if(h.type===0)d||(o+="/"),o+=h.value.replace(aH,"\\$&"),f+=40;else if(h.type===1){const{value:p,repeatable:m,optional:g,regexp:b}=h;s.push({name:p,repeatable:m,optional:g});const v=b||MS;if(v!==MS){f+=10;try{new RegExp(`(${v})`)}catch(y){throw new Error(`Invalid custom RegExp for param "${p}" (${v}): `+y.message)}}let w=m?`((?:${v})(?:/(?:${v}))*)`:`(${v})`;d||(w=g&&c.length<2?`(?:/${w})`:"/"+w),g&&(w+="?"),o+=w,f+=20,g&&(f+=-8),m&&(f+=-20),v===".*"&&(f+=-50)}u.push(f)}r.push(u)}if(n.strict&&n.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}n.strict||(o+="/?"),n.end?o+="$":n.strict&&(o+="(?:/|$)");const i=new RegExp(o,n.sensitive?"":"i");function a(c){const u=c.match(i),d={};if(!u)return null;for(let h=1;h<u.length;h++){const f=u[h]||"",p=s[h-1];d[p.name]=f&&p.repeatable?f.split("/"):f}return d}function l(c){let u="",d=!1;for(const h of t){(!d||!u.endsWith("/"))&&(u+="/"),d=!1;for(const f of h)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:m,optional:g}=f,b=p in c?c[p]:"";if(rs(b)&&!m)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const v=rs(b)?b.join("/"):b;if(!v)if(g)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):d=!0);else throw new Error(`Missing required param "${p}"`);u+=v}}return u||"/"}return{re:i,score:r,keys:s,parse:a,stringify:l}}function cH(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function uH(t,e){let n=0;const r=t.score,o=e.score;for(;n<r.length&&n<o.length;){const s=cH(r[n],o[n]);if(s)return s;n++}if(Math.abs(o.length-r.length)===1){if(LS(r))return 1;if(LS(o))return-1}return o.length-r.length}function LS(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const dH={type:0,value:""},hH=/[a-zA-Z0-9_]/;function fH(t){if(!t)return[[]];if(t==="/")return[[dH]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${c}": ${f}`)}let n=0,r=n;const o=[];let s;function i(){s&&o.push(s),s=[]}let a=0,l,c="",u="";function d(){!c||(n===0?s.push({type:0,value:c}):n===1||n===2||n===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:l==="/"?(c&&d(),i()):l===":"?(d(),n=1):h();break;case 4:h(),n=r;break;case 1:l==="("?n=2:hH.test(l)?h():(d(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:n=3:u+=l;break;case 3:d(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${c}"`),d(),i(),o}function pH(t,e,n){const r=lH(fH(t.path),n),o=Wt(r,{record:t,parent:e,children:[],alias:[]});return e&&!o.record.aliasOf==!e.record.aliasOf&&e.children.push(o),o}function mH(t,e){const n=[],r=new Map;e=WS({strict:!1,end:!0,sensitive:!1},e);function o(u){return r.get(u)}function s(u,d,h){const f=!h,p=gH(u);p.aliasOf=h&&h.record;const m=WS(e,u),g=[p];if("alias"in u){const w=typeof u.alias=="string"?[u.alias]:u.alias;for(const y of w)g.push(Wt({},p,{components:h?h.record.components:p.components,path:y,aliasOf:h?h.record:p}))}let b,v;for(const w of g){const{path:y}=w;if(d&&y[0]!=="/"){const C=d.record.path,S=C[C.length-1]==="/"?"":"/";w.path=d.record.path+(y&&S+y)}if(b=pH(w,d,m),h?h.alias.push(b):(v=v||b,v!==b&&v.alias.push(b),f&&u.name&&!zS(b)&&i(u.name)),p.children){const C=p.children;for(let S=0;S<C.length;S++)s(C[S],b,h&&h.children[S])}h=h||b,(b.record.components&&Object.keys(b.record.components).length||b.record.name||b.record.redirect)&&l(b)}return v?()=>{i(v)}:Hu}function i(u){if(HE(u)){const d=r.get(u);d&&(r.delete(u),n.splice(n.indexOf(d),1),d.children.forEach(i),d.alias.forEach(i))}else{const d=n.indexOf(u);d>-1&&(n.splice(d,1),u.record.name&&r.delete(u.record.name),u.children.forEach(i),u.alias.forEach(i))}}function a(){return n}function l(u){let d=0;for(;d<n.length&&uH(u,n[d])>=0&&(u.record.path!==n[d].record.path||!jE(u,n[d]));)d++;n.splice(d,0,u),u.record.name&&!zS(u)&&r.set(u.record.name,u)}function c(u,d){let h,f={},p,m;if("name"in u&&u.name){if(h=r.get(u.name),!h)throw gc(1,{location:u});m=h.record.name,f=Wt(BS(d.params,h.keys.filter(v=>!v.optional).map(v=>v.name)),u.params&&BS(u.params,h.keys.map(v=>v.name))),p=h.stringify(f)}else if("path"in u)p=u.path,h=n.find(v=>v.re.test(p)),h&&(f=h.parse(p),m=h.record.name);else{if(h=d.name?r.get(d.name):n.find(v=>v.re.test(d.path)),!h)throw gc(1,{location:u,currentLocation:d});m=h.record.name,f=Wt({},d.params,u.params),p=h.stringify(f)}const g=[];let b=h;for(;b;)g.unshift(b.record),b=b.parent;return{name:m,path:p,params:f,matched:g,meta:vH(g)}}return t.forEach(u=>s(u)),{addRoute:s,resolve:c,removeRoute:i,getRoutes:a,getRecordMatcher:o}}function BS(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function gH(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:bH(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function bH(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="boolean"?n:n[r];return e}function zS(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function vH(t){return t.reduce((e,n)=>Wt(e,n.meta),{})}function WS(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function jE(t,e){return e.children.some(n=>n===t||jE(t,n))}const KE=/#/g,xH=/&/g,yH=/\//g,wH=/=/g,CH=/\?/g,qE=/\+/g,$H=/%5B/g,SH=/%5D/g,XE=/%5E/g,IH=/%60/g,YE=/%7B/g,kH=/%7C/g,ZE=/%7D/g,TH=/%20/g;function wy(t){return encodeURI(""+t).replace(kH,"|").replace($H,"[").replace(SH,"]")}function EH(t){return wy(t).replace(YE,"{").replace(ZE,"}").replace(XE,"^")}function gx(t){return wy(t).replace(qE,"%2B").replace(TH,"+").replace(KE,"%23").replace(xH,"%26").replace(IH,"`").replace(YE,"{").replace(ZE,"}").replace(XE,"^")}function RH(t){return gx(t).replace(wH,"%3D")}function NH(t){return wy(t).replace(KE,"%23").replace(CH,"%3F")}function _H(t){return t==null?"":NH(t).replace(yH,"%2F")}function Op(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function AH(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let o=0;o<r.length;++o){const s=r[o].replace(qE," "),i=s.indexOf("="),a=Op(i<0?s:s.slice(0,i)),l=i<0?null:Op(s.slice(i+1));if(a in e){let c=e[a];rs(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function VS(t){let e="";for(let n in t){const r=t[n];if(n=RH(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(rs(r)?r.map(s=>s&&gx(s)):[r&&gx(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+n,s!=null&&(e+="="+s))})}return e}function DH(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=rs(r)?r.map(o=>o==null?null:""+o):r==null?r:""+r)}return e}const FH=Symbol(""),US=Symbol(""),zm=Symbol(""),JE=Symbol(""),bx=Symbol("");function wu(){let t=[];function e(r){return t.push(r),()=>{const o=t.indexOf(r);o>-1&&t.splice(o,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Ci(t,e,n,r,o){const s=r&&(r.enterCallbacks[o]=r.enterCallbacks[o]||[]);return()=>new Promise((i,a)=>{const l=d=>{d===!1?a(gc(4,{from:n,to:e})):d instanceof Error?a(d):sH(d)?a(gc(2,{from:e,to:d})):(s&&r.enterCallbacks[o]===s&&typeof d=="function"&&s.push(d),i())},c=t.call(r&&r.instances[o],e,n,l);let u=Promise.resolve(c);t.length<3&&(u=u.then(l)),u.catch(d=>a(d))})}function dv(t,e,n,r){const o=[];for(const s of t)for(const i in s.components){let a=s.components[i];if(!(e!=="beforeRouteEnter"&&!s.instances[i]))if(OH(a)){const c=(a.__vccOpts||a)[e];c&&o.push(Ci(c,n,r,s,i))}else{let l=a();o.push(()=>l.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${i}" at "${s.path}"`));const u=W5(c)?c.default:c;s.components[i]=u;const h=(u.__vccOpts||u)[e];return h&&Ci(h,n,r,s,i)()}))}}return o}function OH(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function HS(t){const e=Kt(zm),n=Kt(JE),r=Me(()=>e.resolve(kt(t.to))),o=Me(()=>{const{matched:l}=r.value,{length:c}=l,u=l[c-1],d=n.matched;if(!u||!d.length)return-1;const h=d.findIndex(mc.bind(null,u));if(h>-1)return h;const f=GS(l[c-2]);return c>1&&GS(u)===f&&d[d.length-1].path!==f?d.findIndex(mc.bind(null,l[c-2])):h}),s=Me(()=>o.value>-1&&BH(n.params,r.value.params)),i=Me(()=>o.value>-1&&o.value===n.matched.length-1&&VE(n.params,r.value.params));function a(l={}){return LH(l)?e[kt(t.replace)?"replace":"push"](kt(t.to)).catch(Hu):Promise.resolve()}return{route:r,href:Me(()=>r.value.href),isActive:s,isExactActive:i,navigate:a}}const PH=lt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:HS,setup(t,{slots:e}){const n=pl(HS(t)),{options:r}=Kt(zm),o=Me(()=>({[jS(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[jS(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=e.default&&e.default(n);return t.custom?s:W("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},s)}}}),MH=PH;function LH(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function BH(t,e){for(const n in e){const r=e[n],o=t[n];if(typeof r=="string"){if(r!==o)return!1}else if(!rs(o)||o.length!==r.length||r.some((s,i)=>s!==o[i]))return!1}return!0}function GS(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const jS=(t,e,n)=>t!=null?t:e!=null?e:n,zH=lt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=Kt(bx),o=Me(()=>t.route||r.value),s=Kt(US,0),i=Me(()=>{let c=kt(s);const{matched:u}=o.value;let d;for(;(d=u[c])&&!d.components;)c++;return c}),a=Me(()=>o.value.matched[i.value]);Yr(US,Me(()=>i.value+1)),Yr(FH,a),Yr(bx,o);const l=Ne();return Fn(()=>[l.value,a.value,t.name],([c,u,d],[h,f,p])=>{u&&(u.instances[d]=c,f&&f!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=f.leaveGuards),u.updateGuards.size||(u.updateGuards=f.updateGuards))),c&&u&&(!f||!mc(u,f)||!h)&&(u.enterCallbacks[d]||[]).forEach(m=>m(c))},{flush:"post"}),()=>{const c=o.value,u=t.name,d=a.value,h=d&&d.components[u];if(!h)return KS(n.default,{Component:h,route:c});const f=d.props[u],p=f?f===!0?c.params:typeof f=="function"?f(c):f:null,g=W(h,Wt({},p,e,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(d.instances[u]=null)},ref:l}));return KS(n.default,{Component:g,route:c})||g}}});function KS(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const WH=zH;function VH(t){const e=mH(t.routes,t),n=t.parseQuery||AH,r=t.stringifyQuery||VS,o=t.history,s=wu(),i=wu(),a=wu(),l=F2(bi);let c=bi;Hl&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=cv.bind(null,j=>""+j),d=cv.bind(null,_H),h=cv.bind(null,Op);function f(j,re){let le,Ce;return HE(j)?(le=e.getRecordMatcher(j),Ce=re):Ce=j,e.addRoute(Ce,le)}function p(j){const re=e.getRecordMatcher(j);re&&e.removeRoute(re)}function m(){return e.getRoutes().map(j=>j.record)}function g(j){return!!e.getRecordMatcher(j)}function b(j,re){if(re=Wt({},re||l.value),typeof j=="string"){const F=uv(n,j,re.path),V=e.resolve({path:F.path},re),oe=o.createHref(F.fullPath);return Wt(F,V,{params:h(V.params),hash:Op(F.hash),redirectedFrom:void 0,href:oe})}let le;if("path"in j)le=Wt({},j,{path:uv(n,j.path,re.path).path});else{const F=Wt({},j.params);for(const V in F)F[V]==null&&delete F[V];le=Wt({},j,{params:d(j.params)}),re.params=d(re.params)}const Ce=e.resolve(le,re),ve=j.hash||"";Ce.params=u(h(Ce.params));const Le=H5(r,Wt({},j,{hash:EH(ve),path:Ce.path})),_e=o.createHref(Le);return Wt({fullPath:Le,hash:ve,query:r===VS?DH(j.query):j.query||{}},Ce,{redirectedFrom:void 0,href:_e})}function v(j){return typeof j=="string"?uv(n,j,l.value.path):Wt({},j)}function w(j,re){if(c!==j)return gc(8,{from:re,to:j})}function y(j){return $(j)}function C(j){return y(Wt(v(j),{replace:!0}))}function S(j){const re=j.matched[j.matched.length-1];if(re&&re.redirect){const{redirect:le}=re;let Ce=typeof le=="function"?le(j):le;return typeof Ce=="string"&&(Ce=Ce.includes("?")||Ce.includes("#")?Ce=v(Ce):{path:Ce},Ce.params={}),Wt({query:j.query,hash:j.hash,params:"path"in Ce?{}:j.params},Ce)}}function $(j,re){const le=c=b(j),Ce=l.value,ve=j.state,Le=j.force,_e=j.replace===!0,F=S(le);if(F)return $(Wt(v(F),{state:typeof F=="object"?Wt({},ve,F.state):ve,force:Le,replace:_e}),re||le);const V=le;V.redirectedFrom=re;let oe;return!Le&&G5(r,Ce,le)&&(oe=gc(16,{to:V,from:Ce}),se(Ce,Ce,!0,!1)),(oe?Promise.resolve(oe):R(V,Ce)).catch(G=>Ws(G)?Ws(G,2)?G:Q(G):B(G,V,Ce)).then(G=>{if(G){if(Ws(G,2))return $(Wt({replace:_e},v(G.to),{state:typeof G.to=="object"?Wt({},ve,G.to.state):ve,force:Le}),re||V)}else G=N(V,Ce,!0,_e,ve);return T(V,Ce,G),G})}function I(j,re){const le=w(j,re);return le?Promise.reject(le):Promise.resolve()}function R(j,re){let le;const[Ce,ve,Le]=UH(j,re);le=dv(Ce.reverse(),"beforeRouteLeave",j,re);for(const F of Ce)F.leaveGuards.forEach(V=>{le.push(Ci(V,j,re))});const _e=I.bind(null,j,re);return le.push(_e),Ol(le).then(()=>{le=[];for(const F of s.list())le.push(Ci(F,j,re));return le.push(_e),Ol(le)}).then(()=>{le=dv(ve,"beforeRouteUpdate",j,re);for(const F of ve)F.updateGuards.forEach(V=>{le.push(Ci(V,j,re))});return le.push(_e),Ol(le)}).then(()=>{le=[];for(const F of j.matched)if(F.beforeEnter&&!re.matched.includes(F))if(rs(F.beforeEnter))for(const V of F.beforeEnter)le.push(Ci(V,j,re));else le.push(Ci(F.beforeEnter,j,re));return le.push(_e),Ol(le)}).then(()=>(j.matched.forEach(F=>F.enterCallbacks={}),le=dv(Le,"beforeRouteEnter",j,re),le.push(_e),Ol(le))).then(()=>{le=[];for(const F of i.list())le.push(Ci(F,j,re));return le.push(_e),Ol(le)}).catch(F=>Ws(F,8)?F:Promise.reject(F))}function T(j,re,le){for(const Ce of a.list())Ce(j,re,le)}function N(j,re,le,Ce,ve){const Le=w(j,re);if(Le)return Le;const _e=re===bi,F=Hl?history.state:{};le&&(Ce||_e?o.replace(j.fullPath,Wt({scroll:_e&&F&&F.scroll},ve)):o.push(j.fullPath,ve)),l.value=j,se(j,re,le,_e),Q()}let _;function P(){_||(_=o.listen((j,re,le)=>{if(!Ie.listening)return;const Ce=b(j),ve=S(Ce);if(ve){$(Wt(ve,{replace:!0}),Ce).catch(Hu);return}c=Ce;const Le=l.value;Hl&&Q5(FS(Le.fullPath,le.delta),Bm()),R(Ce,Le).catch(_e=>Ws(_e,12)?_e:Ws(_e,2)?($(_e.to,Ce).then(F=>{Ws(F,20)&&!le.delta&&le.type===pd.pop&&o.go(-1,!1)}).catch(Hu),Promise.reject()):(le.delta&&o.go(-le.delta,!1),B(_e,Ce,Le))).then(_e=>{_e=_e||N(Ce,Le,!1),_e&&(le.delta&&!Ws(_e,8)?o.go(-le.delta,!1):le.type===pd.pop&&Ws(_e,20)&&o.go(-1,!1)),T(Ce,Le,_e)}).catch(Hu)}))}let z=wu(),L=wu(),O;function B(j,re,le){Q(j);const Ce=L.list();return Ce.length?Ce.forEach(ve=>ve(j,re,le)):console.error(j),Promise.reject(j)}function U(){return O&&l.value!==bi?Promise.resolve():new Promise((j,re)=>{z.add([j,re])})}function Q(j){return O||(O=!j,P(),z.list().forEach(([re,le])=>j?le(j):re()),z.reset()),j}function se(j,re,le,Ce){const{scrollBehavior:ve}=t;if(!Hl||!ve)return Promise.resolve();const Le=!le&&eH(FS(j.fullPath,0))||(Ce||!le)&&history.state&&history.state.scroll||null;return Do().then(()=>ve(j,re,Le)).then(_e=>_e&&J5(_e)).catch(_e=>B(_e,j,re))}const ce=j=>o.go(j);let de;const we=new Set,Ie={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,hasRoute:g,getRoutes:m,resolve:b,options:t,push:y,replace:C,go:ce,back:()=>ce(-1),forward:()=>ce(1),beforeEach:s.add,beforeResolve:i.add,afterEach:a.add,onError:L.add,isReady:U,install(j){const re=this;j.component("RouterLink",MH),j.component("RouterView",WH),j.config.globalProperties.$router=re,Object.defineProperty(j.config.globalProperties,"$route",{enumerable:!0,get:()=>kt(l)}),Hl&&!de&&l.value===bi&&(de=!0,y(o.location).catch(ve=>{}));const le={};for(const ve in bi)le[ve]=Me(()=>l.value[ve]);j.provide(zm,re),j.provide(JE,pl(le)),j.provide(bx,l);const Ce=j.unmount;we.add(j),j.unmount=function(){we.delete(j),we.size<1&&(c=bi,_&&_(),_=null,l.value=bi,de=!1,O=!1),Ce()}}};return Ie}function Ol(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function UH(t,e){const n=[],r=[],o=[],s=Math.max(e.matched.length,t.matched.length);for(let i=0;i<s;i++){const a=e.matched[i];a&&(t.matched.find(c=>mc(c,a))?r.push(a):n.push(a));const l=t.matched[i];l&&(e.matched.find(c=>mc(c,l))||o.push(l))}return[n,r,o]}function HH(){return Kt(zm)}(function(){var t;function e(x){var k=0;return function(){return k<x.length?{done:!1,value:x[k++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(x,k,E){return x==Array.prototype||x==Object.prototype||(x[k]=E.value),x};function r(x){x=[typeof globalThis=="object"&&globalThis,x,typeof window=="object"&&window,typeof self=="object"&&self,typeof zn=="object"&&zn];for(var k=0;k<x.length;++k){var E=x[k];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var o=r(this);function s(x,k){if(k)e:{var E=o;x=x.split(".");for(var A=0;A<x.length-1;A++){var H=x[A];if(!(H in E))break e;E=E[H]}x=x[x.length-1],A=E[x],k=k(A),k!=A&&k!=null&&n(E,x,{configurable:!0,writable:!0,value:k})}}s("Symbol",function(x){function k(te){if(this instanceof k)throw new TypeError("Symbol is not a constructor");return new E(A+(te||"")+"_"+H++,te)}function E(te,K){this.g=te,n(this,"description",{configurable:!0,writable:!0,value:K})}if(x)return x;E.prototype.toString=function(){return this.g};var A="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",H=0;return k}),s("Symbol.iterator",function(x){if(x)return x;x=Symbol("Symbol.iterator");for(var k="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),E=0;E<k.length;E++){var A=o[k[E]];typeof A=="function"&&typeof A.prototype[x]!="function"&&n(A.prototype,x,{configurable:!0,writable:!0,value:function(){return i(e(this))}})}return x});function i(x){return x={next:x},x[Symbol.iterator]=function(){return this},x}function a(x){var k=typeof Symbol<"u"&&Symbol.iterator&&x[Symbol.iterator];return k?k.call(x):{next:e(x)}}function l(x){if(!(x instanceof Array)){x=a(x);for(var k,E=[];!(k=x.next()).done;)E.push(k.value);x=E}return x}var c=typeof Object.create=="function"?Object.create:function(x){function k(){}return k.prototype=x,new k},u;if(typeof Object.setPrototypeOf=="function")u=Object.setPrototypeOf;else{var d;e:{var h={a:!0},f={};try{f.__proto__=h,d=f.a;break e}catch{}d=!1}u=d?function(x,k){if(x.__proto__=k,x.__proto__!==k)throw new TypeError(x+" is not extensible");return x}:null}var p=u;function m(x,k){if(x.prototype=c(k.prototype),x.prototype.constructor=x,p)p(x,k);else for(var E in k)if(E!="prototype")if(Object.defineProperties){var A=Object.getOwnPropertyDescriptor(k,E);A&&Object.defineProperty(x,E,A)}else x[E]=k[E];x.ra=k.prototype}function g(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function b(x){if(x.l)throw new TypeError("Generator is already running");x.l=!0}g.prototype.s=function(x){this.h=x};function v(x,k){x.j={fa:k,ga:!0},x.g=x.o||x.u}g.prototype.return=function(x){this.j={return:x},this.g=this.u};function w(x,k,E){return x.g=E,{value:k}}function y(x){this.g=new g,this.h=x}function C(x,k){b(x.g);var E=x.g.i;return E?S(x,"return"in E?E.return:function(A){return{value:A,done:!0}},k,x.g.return):(x.g.return(k),$(x))}function S(x,k,E,A){try{var H=k.call(x.g.i,E);if(!(H instanceof Object))throw new TypeError("Iterator result "+H+" is not an object");if(!H.done)return x.g.l=!1,H;var te=H.value}catch(K){return x.g.i=null,v(x.g,K),$(x)}return x.g.i=null,A.call(x.g,te),$(x)}function $(x){for(;x.g.g;)try{var k=x.h(x.g);if(k)return x.g.l=!1,{value:k.value,done:!1}}catch(E){x.g.h=void 0,v(x.g,E)}if(x.g.l=!1,x.g.j){if(k=x.g.j,x.g.j=null,k.ga)throw k.fa;return{value:k.return,done:!0}}return{value:void 0,done:!0}}function I(x){this.next=function(k){return b(x.g),x.g.i?k=S(x,x.g.i.next,k,x.g.s):(x.g.s(k),k=$(x)),k},this.throw=function(k){return b(x.g),x.g.i?k=S(x,x.g.i.throw,k,x.g.s):(v(x.g,k),k=$(x)),k},this.return=function(k){return C(x,k)},this[Symbol.iterator]=function(){return this}}function R(x){function k(A){return x.next(A)}function E(A){return x.throw(A)}return new Promise(function(A,H){function te(K){K.done?A(K.value):Promise.resolve(K.value).then(k,E).then(te,H)}te(x.next())})}function T(x){return R(new I(new y(x)))}s("Promise",function(x){function k(K){this.h=0,this.i=void 0,this.g=[],this.s=!1;var he=this.j();try{K(he.resolve,he.reject)}catch(xe){he.reject(xe)}}function E(){this.g=null}function A(K){return K instanceof k?K:new k(function(he){he(K)})}if(x)return x;E.prototype.h=function(K){if(this.g==null){this.g=[];var he=this;this.i(function(){he.l()})}this.g.push(K)};var H=o.setTimeout;E.prototype.i=function(K){H(K,0)},E.prototype.l=function(){for(;this.g&&this.g.length;){var K=this.g;this.g=[];for(var he=0;he<K.length;++he){var xe=K[he];K[he]=null;try{xe()}catch(Fe){this.j(Fe)}}}this.g=null},E.prototype.j=function(K){this.i(function(){throw K})},k.prototype.j=function(){function K(Fe){return function(Je){xe||(xe=!0,Fe.call(he,Je))}}var he=this,xe=!1;return{resolve:K(this.D),reject:K(this.l)}},k.prototype.D=function(K){if(K===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(K instanceof k)this.H(K);else{e:switch(typeof K){case"object":var he=K!=null;break e;case"function":he=!0;break e;default:he=!1}he?this.A(K):this.o(K)}},k.prototype.A=function(K){var he=void 0;try{he=K.then}catch(xe){this.l(xe);return}typeof he=="function"?this.I(he,K):this.o(K)},k.prototype.l=function(K){this.u(2,K)},k.prototype.o=function(K){this.u(1,K)},k.prototype.u=function(K,he){if(this.h!=0)throw Error("Cannot settle("+K+", "+he+"): Promise already settled in state"+this.h);this.h=K,this.i=he,this.h===2&&this.G(),this.B()},k.prototype.G=function(){var K=this;H(function(){if(K.C()){var he=o.console;typeof he<"u"&&he.error(K.i)}},1)},k.prototype.C=function(){if(this.s)return!1;var K=o.CustomEvent,he=o.Event,xe=o.dispatchEvent;return typeof xe>"u"?!0:(typeof K=="function"?K=new K("unhandledrejection",{cancelable:!0}):typeof he=="function"?K=new he("unhandledrejection",{cancelable:!0}):(K=o.document.createEvent("CustomEvent"),K.initCustomEvent("unhandledrejection",!1,!0,K)),K.promise=this,K.reason=this.i,xe(K))},k.prototype.B=function(){if(this.g!=null){for(var K=0;K<this.g.length;++K)te.h(this.g[K]);this.g=null}};var te=new E;return k.prototype.H=function(K){var he=this.j();K.M(he.resolve,he.reject)},k.prototype.I=function(K,he){var xe=this.j();try{K.call(he,xe.resolve,xe.reject)}catch(Fe){xe.reject(Fe)}},k.prototype.then=function(K,he){function xe(ft,Qe){return typeof ft=="function"?function(vt){try{Fe(ft(vt))}catch(Dt){Je(Dt)}}:Qe}var Fe,Je,St=new k(function(ft,Qe){Fe=ft,Je=Qe});return this.M(xe(K,Fe),xe(he,Je)),St},k.prototype.catch=function(K){return this.then(void 0,K)},k.prototype.M=function(K,he){function xe(){switch(Fe.h){case 1:K(Fe.i);break;case 2:he(Fe.i);break;default:throw Error("Unexpected state: "+Fe.h)}}var Fe=this;this.g==null?te.h(xe):this.g.push(xe),this.s=!0},k.resolve=A,k.reject=function(K){return new k(function(he,xe){xe(K)})},k.race=function(K){return new k(function(he,xe){for(var Fe=a(K),Je=Fe.next();!Je.done;Je=Fe.next())A(Je.value).M(he,xe)})},k.all=function(K){var he=a(K),xe=he.next();return xe.done?A([]):new k(function(Fe,Je){function St(vt){return function(Dt){ft[vt]=Dt,Qe--,Qe==0&&Fe(ft)}}var ft=[],Qe=0;do ft.push(void 0),Qe++,A(xe.value).M(St(ft.length-1),Je),xe=he.next();while(!xe.done)})},k});function N(x,k){x instanceof String&&(x+="");var E=0,A=!1,H={next:function(){if(!A&&E<x.length){var te=E++;return{value:k(te,x[te]),done:!1}}return A=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}var _=typeof Object.assign=="function"?Object.assign:function(x,k){for(var E=1;E<arguments.length;E++){var A=arguments[E];if(A)for(var H in A)Object.prototype.hasOwnProperty.call(A,H)&&(x[H]=A[H])}return x};s("Object.assign",function(x){return x||_}),s("Object.is",function(x){return x||function(k,E){return k===E?k!==0||1/k===1/E:k!==k&&E!==E}}),s("Array.prototype.includes",function(x){return x||function(k,E){var A=this;A instanceof String&&(A=String(A));var H=A.length;for(E=E||0,0>E&&(E=Math.max(E+H,0));E<H;E++){var te=A[E];if(te===k||Object.is(te,k))return!0}return!1}}),s("String.prototype.includes",function(x){return x||function(k,E){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(k,E||0)!==-1}}),s("Array.prototype.keys",function(x){return x||function(){return N(this,function(k){return k})}});var P=this||self;function z(x,k){x=x.split(".");var E=P;x[0]in E||typeof E.execScript>"u"||E.execScript("var "+x[0]);for(var A;x.length&&(A=x.shift());)x.length||k===void 0?E[A]&&E[A]!==Object.prototype[A]?E=E[A]:E=E[A]={}:E[A]=k}function L(){throw Error("Invalid UTF8")}function O(x,k){return k=String.fromCharCode.apply(null,k),x==null?k:x+k}var B,U=typeof TextDecoder<"u",Q,se=typeof TextEncoder<"u",ce={},de=null;function we(x){var k;k===void 0&&(k=0),re(),k=ce[k];for(var E=Array(Math.floor(x.length/3)),A=k[64]||"",H=0,te=0;H<x.length-2;H+=3){var K=x[H],he=x[H+1],xe=x[H+2],Fe=k[K>>2];K=k[(K&3)<<4|he>>4],he=k[(he&15)<<2|xe>>6],xe=k[xe&63],E[te++]=Fe+K+he+xe}switch(Fe=0,xe=A,x.length-H){case 2:Fe=x[H+1],xe=k[(Fe&15)<<2]||A;case 1:x=x[H],E[te]=k[x>>2]+k[(x&3)<<4|Fe>>4]+xe+A}return E.join("")}function Ie(x){var k=x.length,E=3*k/4;E%3?E=Math.floor(E):"=.".indexOf(x[k-1])!=-1&&(E="=.".indexOf(x[k-2])!=-1?E-2:E-1);var A=new Uint8Array(E),H=0;return j(x,function(te){A[H++]=te}),H!==E?A.subarray(0,H):A}function j(x,k){function E(xe){for(;A<x.length;){var Fe=x.charAt(A++),Je=de[Fe];if(Je!=null)return Je;if(!/^[\s\xa0]*$/.test(Fe))throw Error("Unknown base64 encoding at char: "+Fe)}return xe}re();for(var A=0;;){var H=E(-1),te=E(0),K=E(64),he=E(64);if(he===64&&H===-1)break;k(H<<2|te>>4),K!=64&&(k(te<<4&240|K>>2),he!=64&&k(K<<6&192|he))}}function re(){if(!de){de={};for(var x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),k=["+/=","+/","-_=","-_.","-_"],E=0;5>E;E++){var A=x.concat(k[E].split(""));ce[E]=A;for(var H=0;H<A.length;H++){var te=A[H];de[te]===void 0&&(de[te]=H)}}}}var le=typeof Uint8Array=="function";function Ce(x){return le&&x!=null&&x instanceof Uint8Array}var ve;function Le(x){if(this.L=x,x!==null&&x.length===0)throw Error("ByteString should be constructed with non-empty values")}var _e=typeof Uint8Array.prototype.slice=="function",F=0,V=0;function oe(x,k){if(x.constructor===Uint8Array)return x;if(x.constructor===ArrayBuffer)return new Uint8Array(x);if(x.constructor===Array)return new Uint8Array(x);if(x.constructor===String)return Ie(x);if(x.constructor===Le)return!k&&(k=x.L)&&k.constructor===Uint8Array?k:(k=x.L,k=k==null||Ce(k)?k:typeof k=="string"?Ie(k):null,(x=x.L=k)?new Uint8Array(x):ve||(ve=new Uint8Array(0)));if(x instanceof Uint8Array)return new Uint8Array(x.buffer,x.byteOffset,x.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}function G(x,k){return Error("Invalid wire type: "+x+" (at position "+k+")")}function Y(){return Error("Failed to read varint, encoding is invalid.")}function ae(x,k){k=k===void 0?{}:k,k=k.v===void 0?!1:k.v,this.h=null,this.g=this.i=this.j=0,this.v=k,x&&pe(this,x)}function pe(x,k){x.h=oe(k,x.v),x.j=0,x.i=x.h.length,x.g=x.j}ae.prototype.reset=function(){this.g=this.j};function ye(x){if(x.g>x.i)throw Error("Tried to read past the end of the data "+x.g+" > "+x.i)}function ge(x){var k=x.h,E=k[x.g],A=E&127;if(128>E)return x.g+=1,ye(x),A;if(E=k[x.g+1],A|=(E&127)<<7,128>E)return x.g+=2,ye(x),A;if(E=k[x.g+2],A|=(E&127)<<14,128>E)return x.g+=3,ye(x),A;if(E=k[x.g+3],A|=(E&127)<<21,128>E)return x.g+=4,ye(x),A;if(E=k[x.g+4],x.g+=5,A|=(E&15)<<28,128>E)return ye(x),A;if(128<=k[x.g++]&&128<=k[x.g++]&&128<=k[x.g++]&&128<=k[x.g++]&&128<=k[x.g++])throw Y();return ye(x),A}var be=[];function De(){this.g=[]}De.prototype.length=function(){return this.g.length},De.prototype.end=function(){var x=this.g;return this.g=[],x};function Oe(x,k){for(;127<k;)x.g.push(k&127|128),k>>>=7;x.g.push(k)}function Pe(x){var k={},E=k.W===void 0?!1:k.W;this.l={v:k.v===void 0?!1:k.v},this.W=E,k=this.l,be.length?(E=be.pop(),k&&(E.v=k.v),x&&pe(E,x),x=E):x=new ae(x,k),this.g=x,this.j=this.g.g,this.h=this.i=-1}Pe.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};function qe(x){var k=x.g;if(k.g==k.i)return!1;x.j=x.g.g;var E=ge(x.g)>>>0;if(k=E>>>3,E&=7,!(0<=E&&5>=E))throw G(E,x.j);if(1>k)throw Error("Invalid field number: "+k+" (at position "+x.j+")");return x.i=k,x.h=E,!0}function nt(x){switch(x.h){case 0:if(x.h!=0)nt(x);else e:{x=x.g;for(var k=x.g,E=k+10;k<E;)if((x.h[k++]&128)===0){x.g=k,ye(x);break e}throw Y()}break;case 1:x=x.g,x.g+=8,ye(x);break;case 2:x.h!=2?nt(x):(k=ge(x.g)>>>0,x=x.g,x.g+=k,ye(x));break;case 5:x=x.g,x.g+=4,ye(x);break;case 3:k=x.i;do{if(!qe(x))throw Error("Unmatched start-group tag: stream EOF");if(x.h==4){if(x.i!=k)throw Error("Unmatched end-group tag");break}nt(x)}while(1);break;default:throw G(x.h,x.j)}}var dt=[];function ht(){this.i=[],this.h=0,this.g=new De}function $t(x,k){k.length!==0&&(x.i.push(k),x.h+=k.length)}function ln(x,k){if(k=k.ca){$t(x,x.g.end());for(var E=0;E<k.length;E++)$t(x,k[E])}}var Cn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol(void 0):void 0;function ro(x,k){Object.isFrozen(x)||(Cn?x[Cn]|=k:x.N!==void 0?x.N|=k:Object.defineProperties(x,{N:{value:k,configurable:!0,writable:!0,enumerable:!1}}))}function Pn(x){var k;return Cn?k=x[Cn]:k=x.N,k==null?0:k}function Nn(x){return ro(x,1),x}function Ht(x){return Array.isArray(x)?!!(Pn(x)&2):!1}function Ee(x){if(!Array.isArray(x))throw Error("cannot mark non-array as immutable");ro(x,2)}function He(x){return x!==null&&typeof x=="object"&&!Array.isArray(x)&&x.constructor===Object}var rt=Object.freeze(Nn([]));function Pt(x){if(Ht(x.m))throw Error("Cannot mutate an immutable Message")}var en=typeof Symbol<"u"&&typeof Symbol.hasInstance<"u";function _n(x){return{value:x,configurable:!1,writable:!1,enumerable:!1}}function qt(x,k,E){return k===-1?null:k>=x.i?x.g?x.g[k]:void 0:(E===void 0?0:E)&&x.g&&(E=x.g[k],E!=null)?E:x.m[k+x.h]}function mt(x,k,E,A){A=A===void 0?!1:A,Pt(x),k<x.i&&!A?x.m[k+x.h]=E:(x.g||(x.g=x.m[x.i+x.h]={}))[k]=E}function cr(x,k,E,A){E=E===void 0?!0:E,A=A===void 0?!1:A;var H=qt(x,k,A);return H==null&&(H=rt),Ht(x.m)?E&&(Ee(H),Object.freeze(H)):(H===rt||Ht(H))&&(H=Nn(H.slice()),mt(x,k,H,A)),H}function Mn(x,k,E){return x=qt(x,k),x=x==null?x:+x,x==null?E===void 0?0:E:x}function us(x,k,E,A){x.j||(x.j={});var H=Ht(x.m),te=x.j[E];if(!te){A=cr(x,E,!0,A===void 0?!1:A),te=[],H=H||Ht(A);for(var K=0;K<A.length;K++)te[K]=new k(A[K]),H&&Ee(te[K].m);H&&(Ee(te),Object.freeze(te)),x.j[E]=te}return te}function la(x,k,E,A,H){var te=te===void 0?!1:te;return Pt(x),te=us(x,E,k,te),E=A||new E,x=cr(x,k),H!=null?(te.splice(H,0,E),x.splice(H,0,E.m)):(te.push(E),x.push(E.m)),E}function hf(x,k){return x=qt(x,k),x==null?0:x}function ff(x,k){return x=qt(x,k),x==null?"":x}function pf(x){switch(typeof x){case"number":return isFinite(x)?x:String(x);case"object":if(x&&!Array.isArray(x)){if(Ce(x))return we(x);if(x instanceof Le){var k=x.L;return k=k==null||typeof k=="string"?k:le&&k instanceof Uint8Array?we(k):null,(x.L=k)||""}}}return x}function zs(x){var k=it;return k=k===void 0?tn:k,ke(x,k)}function ne(x,k){if(x!=null){if(Array.isArray(x))x=ke(x,k);else if(He(x)){var E={},A;for(A in x)E[A]=ne(x[A],k);x=E}else x=k(x);return x}}function ke(x,k){for(var E=x.slice(),A=0;A<E.length;A++)E[A]=ne(E[A],k);return Array.isArray(x)&&Pn(x)&1&&Nn(E),E}function it(x){return x&&typeof x=="object"&&x.toJSON?x.toJSON():(x=pf(x),Array.isArray(x)?zs(x):x)}function tn(x){return Ce(x)?new Uint8Array(x):x}function nn(x,k,E){x||(x=Gt),Gt=null;var A=this.constructor.h;x||(x=A?[A]:[]),this.h=(A?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=x;e:{if(A=this.m.length,x=A-1,A&&(A=this.m[x],He(A))){this.i=x-this.h,this.g=A;break e}k!==void 0&&-1<k?(this.i=Math.max(k,x+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE}if(E)for(k=0;k<E.length;k++)if(x=E[k],x<this.i)x+=this.h,(A=this.m[x])?Array.isArray(A)&&Nn(A):this.m[x]=rt;else{A=this.g||(this.g=this.m[this.i+this.h]={});var H=A[x];H?Array.isArray(H)&&Nn(H):A[x]=rt}}nn.prototype.toJSON=function(){return zs(this.m)},nn.prototype.toString=function(){return this.m.toString()};var Gt;function yo(){nn.apply(this,arguments)}if(m(yo,nn),en){var ds={};Object.defineProperties(yo,(ds[Symbol.hasInstance]=_n(function(){throw Error("Cannot perform instanceof checks for MutableMessage")}),ds))}function hs(x,k,E){if(E){var A={},H;for(H in E){var te=E[H],K=te.ja;K||(A.F=te.pa||te.ha.P,te.ba?(A.U=gf(te.ba),K=function(he){return function(xe,Fe,Je){return he.F(xe,Fe,Je,he.U)}}(A)):te.da?(A.T=bf(te.X.g,te.da),K=function(he){return function(xe,Fe,Je){return he.F(xe,Fe,Je,he.T)}}(A)):K=A.F,te.ja=K),K(k,x,te.X),A={F:A.F,U:A.U,T:A.T}}}ln(k,x)}var fs=Symbol();function hi(x,k,E){return x[fs]||(x[fs]=function(A,H){return k(A,H,E)})}function Rl(x){var k=x[fs];if(!k){var E=wf(x);k=function(A,H){return Cf(A,H,E)},x[fs]=k}return k}function Tb(x){var k=x.ba;if(k)return Rl(k);if(k=x.oa)return hi(x.X.g,k,x.da)}function Eb(x){var k=Tb(x),E=x.X,A=x.ha.O;return k?function(H,te){return A(H,te,E,k)}:function(H,te){return A(H,te,E)}}function mf(x,k,E,A,H,te){x=x();var K=0;for(x.length&&typeof x[0]!="number"&&(E(k,x[0]),K++);K<x.length;){E=x[K++];for(var he=K+1;he<x.length&&typeof x[he]!="number";)he++;var xe=x[K++];switch(he-=K,he){case 0:A(k,E,xe);break;case 1:A(k,E,xe,x[K++]);break;case 2:H(k,E,xe,x[K++],x[K++]);break;case 3:he=x[K++];var Fe=x[K++],Je=x[K++];Array.isArray(Je)?H(k,E,xe,he,Fe,Je):te(k,E,xe,he,Fe,Je);break;case 4:te(k,E,xe,x[K++],x[K++],x[K++],x[K++]);break;default:throw Error("unexpected number of binary field arguments: "+he)}}return k}var Nl=Symbol();function gf(x){var k=x[Nl];if(!k){var E=xf(x);k=function(A,H){return $f(A,H,E)},x[Nl]=k}return k}function bf(x,k){var E=x[Nl];return E||(E=function(A,H){return hs(A,H,k)},x[Nl]=E),E}var vf=Symbol();function Rb(x,k){x.push(k)}function Nb(x,k,E){x.push(k,E.P)}function _b(x,k,E,A,H){var te=gf(H),K=E.P;x.push(k,function(he,xe,Fe){return K(he,xe,Fe,A,te)})}function Ab(x,k,E,A,H,te){var K=bf(A,te),he=E.P;x.push(k,function(xe,Fe,Je){return he(xe,Fe,Je,A,K)})}function xf(x){var k=x[vf];return k||mf(x,x[vf]=[],Rb,Nb,_b,Ab)}var yf=Symbol();function Db(x,k){x[0]=k}function Fb(x,k,E,A){var H=E.O;x[k]=A?function(te,K,he){return H(te,K,he,A)}:H}function Ob(x,k,E,A,H,te){var K=E.O,he=Rl(H);x[k]=function(xe,Fe,Je){return K(xe,Fe,Je,A,he,te)}}function Pb(x,k,E,A,H,te,K){var he=E.O,xe=hi(A,H,te);x[k]=function(Fe,Je,St){return he(Fe,Je,St,A,xe,K)}}function wf(x){var k=x[yf];return k||mf(x,x[yf]={},Db,Fb,Ob,Pb)}function Cf(x,k,E){for(;qe(k)&&k.h!=4;){var A=k.i,H=E[A];if(!H){var te=E[0];te&&(te=te[A])&&(H=E[A]=Eb(te))}if((!H||!H(k,x,A))&&(H=k,A=x,te=H.j,nt(H),!H.W)){var K=H.g.h;H=H.g.g,H=te===H?ve||(ve=new Uint8Array(0)):_e?K.slice(te,H):new Uint8Array(K.subarray(te,H)),(te=A.ca)?te.push(H):A.ca=[H]}}return x}function ca(x,k,E){if(dt.length){var A=dt.pop();x&&(pe(A.g,x),A.i=-1,A.h=-1),x=A}else x=new Pe(x);try{return Cf(new k,x,wf(E))}finally{k=x.g,k.h=null,k.j=0,k.i=0,k.g=0,k.v=!1,x.i=-1,x.h=-1,100>dt.length&&dt.push(x)}}function $f(x,k,E){for(var A=E.length,H=A%2==1,te=H?1:0;te<A;te+=2)(0,E[te+1])(k,x,E[te]);hs(x,k,H?E[0]:void 0)}function hu(x,k){var E=new ht;$f(x,E,xf(k)),$t(E,E.g.end()),x=new Uint8Array(E.h),k=E.i;for(var A=k.length,H=0,te=0;te<A;te++){var K=k[te];x.set(K,H),H+=K.length}return E.i=[x],x}function ua(x,k){return{O:x,P:k}}var oo=ua(function(x,k,E){if(x.h!==5)return!1;x=x.g;var A=x.h[x.g],H=x.h[x.g+1],te=x.h[x.g+2],K=x.h[x.g+3];return x.g+=4,ye(x),H=(A<<0|H<<8|te<<16|K<<24)>>>0,x=2*(H>>31)+1,A=H>>>23&255,H&=8388607,mt(k,E,A==255?H?NaN:1/0*x:A==0?x*Math.pow(2,-149)*H:x*Math.pow(2,A-150)*(H+Math.pow(2,23))),!0},function(x,k,E){if(k=qt(k,E),k!=null){Oe(x.g,8*E+5),x=x.g;var A=k;A=(E=0>A?1:0)?-A:A,A===0?0<1/A?F=V=0:(V=0,F=2147483648):isNaN(A)?(V=0,F=2147483647):34028234663852886e22<A?(V=0,F=(E<<31|2139095040)>>>0):11754943508222875e-54>A?(A=Math.round(A/Math.pow(2,-149)),V=0,F=(E<<31|A)>>>0):(k=Math.floor(Math.log(A)/Math.LN2),A*=Math.pow(2,-k),A=Math.round(8388608*A),16777216<=A&&++k,V=0,F=(E<<31|k+127<<23|A&8388607)>>>0),E=F,x.g.push(E>>>0&255),x.g.push(E>>>8&255),x.g.push(E>>>16&255),x.g.push(E>>>24&255)}}),Mb=ua(function(x,k,E){if(x.h!==0)return!1;for(var A=x.g,H=128,te=0,K=x=0;4>K&&128<=H;K++)H=A.h[A.g++],ye(A),te|=(H&127)<<7*K;if(128<=H&&(H=A.h[A.g++],ye(A),te|=(H&127)<<28,x|=(H&127)>>4),128<=H)for(K=0;5>K&&128<=H;K++)H=A.h[A.g++],ye(A),x|=(H&127)<<7*K+3;if(128>H)A=te>>>0,H=x>>>0,(x=H&2147483648)&&(A=~A+1>>>0,H=~H>>>0,A==0&&(H=H+1>>>0)),A=4294967296*H+(A>>>0);else throw Y();return mt(k,E,x?-A:A),!0},function(x,k,E){if(k=qt(k,E),k!=null&&k!=null){Oe(x.g,8*E),x=x.g;var A=k;for(E=0>A,A=Math.abs(A),k=A>>>0,A=Math.floor((A-k)/4294967296),A>>>=0,E&&(A=~A>>>0,k=(~k>>>0)+1,4294967295<k&&(k=0,A++,4294967295<A&&(A=0))),F=k,V=A,E=F,k=V;0<k||127<E;)x.g.push(E&127|128),E=(E>>>7|k<<25)>>>0,k>>>=7;x.g.push(E)}}),Lb=ua(function(x,k,E){return x.h!==0?!1:(mt(k,E,ge(x.g)),!0)},function(x,k,E){if(k=qt(k,E),k!=null&&k!=null)if(Oe(x.g,8*E),x=x.g,E=k,0<=E)Oe(x,E);else{for(k=0;9>k;k++)x.g.push(E&127|128),E>>=7;x.g.push(1)}}),Sf=ua(function(x,k,E){if(x.h!==2)return!1;var A=ge(x.g)>>>0;x=x.g;var H=x.g;x.g+=A,ye(x),x=x.h;var te;if(U)(te=B)||(te=B=new TextDecoder("utf-8",{fatal:!0})),te=te.decode(x.subarray(H,H+A));else{A=H+A;for(var K=[],he=null,xe,Fe,Je;H<A;)xe=x[H++],128>xe?K.push(xe):224>xe?H>=A?L():(Fe=x[H++],194>xe||(Fe&192)!==128?(H--,L()):K.push((xe&31)<<6|Fe&63)):240>xe?H>=A-1?L():(Fe=x[H++],(Fe&192)!==128||xe===224&&160>Fe||xe===237&&160<=Fe||((te=x[H++])&192)!==128?(H--,L()):K.push((xe&15)<<12|(Fe&63)<<6|te&63)):244>=xe?H>=A-2?L():(Fe=x[H++],(Fe&192)!==128||(xe<<28)+(Fe-144)>>30!==0||((te=x[H++])&192)!==128||((Je=x[H++])&192)!==128?(H--,L()):(xe=(xe&7)<<18|(Fe&63)<<12|(te&63)<<6|Je&63,xe-=65536,K.push((xe>>10&1023)+55296,(xe&1023)+56320))):L(),8192<=K.length&&(he=O(he,K),K.length=0);te=O(he,K)}return mt(k,E,te),!0},function(x,k,E){if(k=qt(k,E),k!=null){var A=!1;if(A=A===void 0?!1:A,se){if(A&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(k))throw Error("Found an unpaired surrogate");k=(Q||(Q=new TextEncoder)).encode(k)}else{for(var H=0,te=new Uint8Array(3*k.length),K=0;K<k.length;K++){var he=k.charCodeAt(K);if(128>he)te[H++]=he;else{if(2048>he)te[H++]=he>>6|192;else{if(55296<=he&&57343>=he){if(56319>=he&&K<k.length){var xe=k.charCodeAt(++K);if(56320<=xe&&57343>=xe){he=1024*(he-55296)+xe-56320+65536,te[H++]=he>>18|240,te[H++]=he>>12&63|128,te[H++]=he>>6&63|128,te[H++]=he&63|128;continue}else K--}if(A)throw Error("Found an unpaired surrogate");he=65533}te[H++]=he>>12|224,te[H++]=he>>6&63|128}te[H++]=he&63|128}}k=te.subarray(0,H)}Oe(x.g,8*E+2),Oe(x.g,k.length),$t(x,x.g.end()),$t(x,k)}}),If=ua(function(x,k,E,A,H){if(x.h!==2)return!1;k=la(k,E,A),E=x.g.i,A=ge(x.g)>>>0;var te=x.g.g+A,K=te-E;if(0>=K&&(x.g.i=te,H(k,x),K=te-x.g.g),K)throw Error("Message parsing ended unexpectedly. Expected to read "+(A+" bytes, instead read "+(A-K)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return x.g.g=te,x.g.i=E,!0},function(x,k,E,A,H){if(k=us(k,A,E),k!=null)for(A=0;A<k.length;A++){var te=x;Oe(te.g,8*E+2);var K=te.g.end();$t(te,K),K.push(te.h),te=K,H(k[A],x),K=x;var he=te.pop();for(he=K.h+K.g.length()-he;127<he;)te.push(he&127|128),he>>>=7,K.h++;te.push(he),K.h++}});function zr(){yo.apply(this,arguments)}if(m(zr,yo),en){var kf={};Object.defineProperties(zr,(kf[Symbol.hasInstance]=_n(Object[Symbol.hasInstance]),kf))}function da(x){zr.call(this,x)}m(da,zr);function Tf(){return[1,Lb,2,oo,3,Sf,4,Sf]}function _l(x){zr.call(this,x,-1,Bb)}m(_l,zr),_l.prototype.addClassification=function(x,k){return la(this,1,da,x,k),this};function Ef(){return[1,If,da,Tf]}var Bb=[1];function ha(x){zr.call(this,x)}m(ha,zr);function Rf(){return[1,oo,2,oo,3,oo,4,oo,5,oo]}function fu(x){zr.call(this,x,-1,xP)}m(fu,zr);function PC(){return[1,If,ha,Rf]}var xP=[1];function zb(x){zr.call(this,x)}m(zb,zr);function MC(){return[1,oo,2,oo,3,oo,4,oo,5,oo,6,Mb]}function LC(x,k,E){if(E=x.createShader(E===0?x.VERTEX_SHADER:x.FRAGMENT_SHADER),x.shaderSource(E,k),x.compileShader(E),!x.getShaderParameter(E,x.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+x.getShaderInfoLog(E));return E}function BC(x){return us(x,da,1).map(function(k){return{index:hf(k,1),score:Mn(k,2),label:qt(k,3)!=null?ff(k,3):void 0,displayName:qt(k,4)!=null?ff(k,4):void 0}})}function zC(x){return{x:Mn(x,1),y:Mn(x,2),z:Mn(x,3),visibility:qt(x,4)!=null?Mn(x,4):void 0}}function WC(x){return x.map(function(k){return us(ca(k,fu,PC),ha,1).map(zC)})}function Wb(x,k){this.h=x,this.g=k,this.l=0}function VC(x,k,E){return yP(x,k),typeof x.g.canvas.transferToImageBitmap=="function"?Promise.resolve(x.g.canvas.transferToImageBitmap()):E?Promise.resolve(x.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(x.g.canvas):(x.i===void 0&&(x.i=document.createElement("canvas")),new Promise(function(A){x.i.height=x.g.canvas.height,x.i.width=x.g.canvas.width,x.i.getContext("2d",{}).drawImage(x.g.canvas,0,0,x.g.canvas.width,x.g.canvas.height),A(x.i)}))}function yP(x,k){var E=x.g;if(x.o===void 0){var A=LC(E,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),H=LC(E,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),te=E.createProgram();if(E.attachShader(te,A),E.attachShader(te,H),E.linkProgram(te),!E.getProgramParameter(te,E.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+E.getProgramInfoLog(te));A=x.o=te,E.useProgram(A),H=E.getUniformLocation(A,"sampler0"),x.j={K:E.getAttribLocation(A,"aVertex"),J:E.getAttribLocation(A,"aTex"),qa:H},x.u=E.createBuffer(),E.bindBuffer(E.ARRAY_BUFFER,x.u),E.enableVertexAttribArray(x.j.K),E.vertexAttribPointer(x.j.K,2,E.FLOAT,!1,0,0),E.bufferData(E.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),E.STATIC_DRAW),E.bindBuffer(E.ARRAY_BUFFER,null),x.s=E.createBuffer(),E.bindBuffer(E.ARRAY_BUFFER,x.s),E.enableVertexAttribArray(x.j.J),E.vertexAttribPointer(x.j.J,2,E.FLOAT,!1,0,0),E.bufferData(E.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),E.STATIC_DRAW),E.bindBuffer(E.ARRAY_BUFFER,null),E.uniform1i(H,0)}A=x.j,E.useProgram(x.o),E.canvas.width=k.width,E.canvas.height=k.height,E.viewport(0,0,k.width,k.height),E.activeTexture(E.TEXTURE0),x.h.bindTexture2d(k.glName),E.enableVertexAttribArray(A.K),E.bindBuffer(E.ARRAY_BUFFER,x.u),E.vertexAttribPointer(A.K,2,E.FLOAT,!1,0,0),E.enableVertexAttribArray(A.J),E.bindBuffer(E.ARRAY_BUFFER,x.s),E.vertexAttribPointer(A.J,2,E.FLOAT,!1,0,0),E.bindFramebuffer(E.DRAW_FRAMEBUFFER?E.DRAW_FRAMEBUFFER:E.FRAMEBUFFER,null),E.clearColor(0,0,0,0),E.clear(E.COLOR_BUFFER_BIT),E.colorMask(!0,!0,!0,!0),E.drawArrays(E.TRIANGLE_FAN,0,4),E.disableVertexAttribArray(A.K),E.disableVertexAttribArray(A.J),E.bindBuffer(E.ARRAY_BUFFER,null),x.h.bindTexture2d(0)}function wP(x){this.g=x}var CP=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function $P(x,k){return k+x}function UC(x,k){window[x]=k}function SP(x){var k=document.createElement("script");return k.setAttribute("src",x),k.setAttribute("crossorigin","anonymous"),new Promise(function(E){k.addEventListener("load",function(){E()},!1),k.addEventListener("error",function(){E()},!1),document.body.appendChild(k)})}function IP(){return T(function(x){switch(x.g){case 1:return x.o=2,w(x,WebAssembly.instantiate(CP),4);case 4:x.g=3,x.o=0;break;case 2:return x.o=0,x.j=null,x.return(!1);case 3:return x.return(!0)}})}function Vb(x){if(this.g=x,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.$=!0,this.D=Promise.resolve(),this.Z="",this.C={},this.locateFile=x&&x.locateFile||$P,typeof window=="object")var k=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")k=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.aa=k,x.options){k=a(Object.keys(x.options));for(var E=k.next();!E.done;E=k.next()){E=E.value;var A=x.options[E].default;A!==void 0&&(this.j[E]=typeof A=="function"?A():A)}}}t=Vb.prototype,t.close=function(){return this.i&&this.i.delete(),Promise.resolve()};function kP(x){var k,E,A,H,te,K,he,xe,Fe,Je,St;return T(function(ft){switch(ft.g){case 1:return x.$?(k=x.g.files===void 0?[]:typeof x.g.files=="function"?x.g.files(x.j):x.g.files,w(ft,IP(),2)):ft.return();case 2:if(E=ft.h,typeof window=="object")return UC("createMediapipeSolutionsWasm",{locateFile:x.locateFile}),UC("createMediapipeSolutionsPackedAssets",{locateFile:x.locateFile}),K=k.filter(function(Qe){return Qe.data!==void 0}),he=k.filter(function(Qe){return Qe.data===void 0}),xe=Promise.all(K.map(function(Qe){var vt=Nf(x,Qe.url);if(Qe.path!==void 0){var Dt=Qe.path;vt=vt.then(function(cn){return x.overrideFile(Dt,cn),Promise.resolve(cn)})}return vt})),Fe=Promise.all(he.map(function(Qe){return Qe.simd===void 0||Qe.simd&&E||!Qe.simd&&!E?SP(x.locateFile(Qe.url,x.aa)):Promise.resolve()})).then(function(){var Qe,vt,Dt;return T(function(cn){if(cn.g==1)return Qe=window.createMediapipeSolutionsWasm,vt=window.createMediapipeSolutionsPackedAssets,Dt=x,w(cn,Qe(vt),2);Dt.h=cn.h,cn.g=0})}),Je=function(){return T(function(Qe){return x.g.graph&&x.g.graph.url?Qe=w(Qe,Nf(x,x.g.graph.url),0):(Qe.g=0,Qe=void 0),Qe})}(),w(ft,Promise.all([Fe,xe,Je]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return A=k.filter(function(Qe){return Qe.simd===void 0||Qe.simd&&E||!Qe.simd&&!E}).map(function(Qe){return x.locateFile(Qe.url,x.aa)}),importScripts.apply(null,l(A)),H=x,w(ft,createMediapipeSolutionsWasm(Module),6);case 6:H.h=ft.h,x.l=new OffscreenCanvas(1,1),x.h.canvas=x.l,te=x.h.GL.createContext(x.l,{antialias:!1,alpha:!1,na:typeof WebGL2RenderingContext<"u"?2:1}),x.h.GL.makeContextCurrent(te),ft.g=4;break;case 7:if(x.l=document.createElement("canvas"),St=x.l.getContext("webgl2",{}),!St&&(St=x.l.getContext("webgl",{}),!St))return alert("Failed to create WebGL canvas context when passing video frame."),ft.return();x.G=St,x.h.canvas=x.l,x.h.createContext(x.l,!0,!0,{});case 4:x.i=new x.h.SolutionWasm,x.$=!1,ft.g=0}})}function TP(x){var k,E,A,H,te,K,he,xe;return T(function(Fe){if(Fe.g==1){if(x.g.graph&&x.g.graph.url&&x.Z===x.g.graph.url)return Fe.return();if(x.s=!0,!x.g.graph||!x.g.graph.url){Fe.g=2;return}return x.Z=x.g.graph.url,w(Fe,Nf(x,x.g.graph.url),3)}for(Fe.g!=2&&(k=Fe.h,x.i.loadGraph(k)),E=a(Object.keys(x.C)),A=E.next();!A.done;A=E.next())H=A.value,x.i.overrideFile(H,x.C[H]);if(x.C={},x.g.listeners)for(te=a(x.g.listeners),K=te.next();!K.done;K=te.next())he=K.value,_P(x,he);xe=x.j,x.j={},x.setOptions(xe),Fe.g=0})}t.reset=function(){var x=this;return T(function(k){x.i&&(x.i.reset(),x.o={},x.u={}),k.g=0})},t.setOptions=function(x,k){var E=this;if(k=k||this.g.options){for(var A=[],H=[],te={},K=a(Object.keys(x)),he=K.next();!he.done;te={R:te.R,S:te.S},he=K.next()){var xe=he.value;xe in this.j&&this.j[xe]===x[xe]||(this.j[xe]=x[xe],he=k[xe],he!==void 0&&(he.onChange&&(te.R=he.onChange,te.S=x[xe],A.push(function(Fe){return function(){var Je;return T(function(St){if(St.g==1)return w(St,Fe.R(Fe.S),2);Je=St.h,Je===!0&&(E.s=!0),St.g=0})}}(te))),he.graphOptionXref&&(xe={valueNumber:he.type===1?x[xe]:0,valueBoolean:he.type===0?x[xe]:!1,valueString:he.type===2?x[xe]:""},he=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),he.graphOptionXref),xe),H.push(he))))}(A.length!==0||H.length!==0)&&(this.s=!0,this.B=(this.B===void 0?[]:this.B).concat(H),this.A=(this.A===void 0?[]:this.A).concat(A))}};function EP(x){var k,E,A,H,te,K,he;return T(function(xe){switch(xe.g){case 1:if(!x.s)return xe.return();if(!x.A){xe.g=2;break}k=a(x.A),E=k.next();case 3:if(E.done){xe.g=5;break}return A=E.value,w(xe,A(),4);case 4:E=k.next(),xe.g=3;break;case 5:x.A=void 0;case 2:if(x.B){for(H=new x.h.GraphOptionChangeRequestList,te=a(x.B),K=te.next();!K.done;K=te.next())he=K.value,H.push_back(he);x.i.changeOptions(H),H.delete(),x.B=void 0}x.s=!1,xe.g=0}})}t.initialize=function(){var x=this;return T(function(k){return k.g==1?w(k,kP(x),2):k.g!=3?w(k,TP(x),3):w(k,EP(x),0)})};function Nf(x,k){var E,A;return T(function(H){return k in x.H?H.return(x.H[k]):(E=x.locateFile(k,""),A=fetch(E).then(function(te){return te.arrayBuffer()}),x.H[k]=A,H.return(A))})}t.overrideFile=function(x,k){this.i?this.i.overrideFile(x,k):this.C[x]=k},t.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},t.send=function(x,k){var E=this,A,H,te,K,he,xe,Fe,Je,St;return T(function(ft){switch(ft.g){case 1:return E.g.inputs?(A=1e3*(k==null?performance.now():k),w(ft,E.D,2)):ft.return();case 2:return w(ft,E.initialize(),3);case 3:for(H=new E.h.PacketDataList,te=a(Object.keys(x)),K=te.next();!K.done;K=te.next())if(he=K.value,xe=E.g.inputs[he]){e:{var Qe=x[he];switch(xe.type){case"video":var vt=E.o[xe.stream];if(vt||(vt=new Wb(E.h,E.G),E.o[xe.stream]=vt),vt.l===0&&(vt.l=vt.h.createTexture()),typeof HTMLVideoElement<"u"&&Qe instanceof HTMLVideoElement)var Dt=Qe.videoWidth,cn=Qe.videoHeight;else typeof HTMLImageElement<"u"&&Qe instanceof HTMLImageElement?(Dt=Qe.naturalWidth,cn=Qe.naturalHeight):(Dt=Qe.width,cn=Qe.height);cn={glName:vt.l,width:Dt,height:cn},Dt=vt.g,Dt.canvas.width=cn.width,Dt.canvas.height=cn.height,Dt.activeTexture(Dt.TEXTURE0),vt.h.bindTexture2d(vt.l),Dt.texImage2D(Dt.TEXTURE_2D,0,Dt.RGBA,Dt.RGBA,Dt.UNSIGNED_BYTE,Qe),vt.h.bindTexture2d(0),vt=cn;break e;case"detections":for(vt=E.o[xe.stream],vt||(vt=new wP(E.h),E.o[xe.stream]=vt),vt.data||(vt.data=new vt.g.DetectionListData),vt.data.reset(Qe.length),cn=0;cn<Qe.length;++cn){Dt=Qe[cn];var rn=vt.data,ur=rn.setBoundingBox,wo=cn,Wr=Dt.ea,Mt=new zb;if(mt(Mt,1,Wr.ka),mt(Mt,2,Wr.la),mt(Mt,3,Wr.height),mt(Mt,4,Wr.width),mt(Mt,5,Wr.rotation),mt(Mt,6,Wr.ia),Wr=hu(Mt,MC),ur.call(rn,wo,Wr),Dt.Y)for(rn=0;rn<Dt.Y.length;++rn){Mt=Dt.Y[rn];var qn=!!Mt.visibility;ur=vt.data,wo=ur.addNormalizedLandmark,Wr=cn,Mt=Object.assign(Object.assign({},Mt),{visibility:qn?Mt.visibility:0}),qn=new ha,mt(qn,1,Mt.x),mt(qn,2,Mt.y),mt(qn,3,Mt.z),Mt.visibility&&mt(qn,4,Mt.visibility),Mt=hu(qn,Rf),wo.call(ur,Wr,Mt)}if(Dt.V)for(rn=0;rn<Dt.V.length;++rn)ur=vt.data,wo=ur.addClassification,Wr=cn,Mt=Dt.V[rn],qn=new da,mt(qn,2,Mt.score),Mt.index&&mt(qn,1,Mt.index),Mt.label&&mt(qn,3,Mt.label),Mt.displayName&&mt(qn,4,Mt.displayName),Mt=hu(qn,Tf),wo.call(ur,Wr,Mt)}vt=vt.data;break e;default:vt={}}}switch(Fe=vt,Je=xe.stream,xe.type){case"video":H.pushTexture2d(Object.assign(Object.assign({},Fe),{stream:Je,timestamp:A}));break;case"detections":St=Fe,St.stream=Je,St.timestamp=A,H.pushDetectionList(St);break;default:throw Error("Unknown input config type: '"+xe.type+"'")}}return E.i.send(H),w(ft,E.D,4);case 4:H.delete(),ft.g=0}})};function RP(x,k,E){var A,H,te,K,he,xe,Fe,Je,St,ft,Qe,vt,Dt,cn;return T(function(rn){switch(rn.g){case 1:if(!E)return rn.return(k);for(A={},H=0,te=a(Object.keys(E)),K=te.next();!K.done;K=te.next())he=K.value,xe=E[he],typeof xe!="string"&&xe.type==="texture"&&k[xe.stream]!==void 0&&++H;1<H&&(x.I=!1),Fe=a(Object.keys(E)),K=Fe.next();case 2:if(K.done){rn.g=4;break}if(Je=K.value,St=E[Je],typeof St=="string")return Dt=A,cn=Je,w(rn,NP(x,Je,k[St]),14);if(ft=k[St.stream],St.type==="detection_list"){if(ft){for(var ur=ft.getRectList(),wo=ft.getLandmarksList(),Wr=ft.getClassificationsList(),Mt=[],qn=0;qn<ur.size();++qn){var fi=ca(ur.get(qn),zb,MC);fi={ea:{ka:Mn(fi,1),la:Mn(fi,2),height:Mn(fi,3),width:Mn(fi,4),rotation:Mn(fi,5,0),ia:hf(fi,6)},Y:us(ca(wo.get(qn),fu,PC),ha,1).map(zC),V:BC(ca(Wr.get(qn),_l,Ef))},Mt.push(fi)}ur=Mt}else ur=[];A[Je]=ur,rn.g=7;break}if(St.type==="proto_list"){if(ft){for(ur=Array(ft.size()),wo=0;wo<ft.size();wo++)ur[wo]=ft.get(wo);ft.delete()}else ur=[];A[Je]=ur,rn.g=7;break}if(ft===void 0){rn.g=3;break}if(St.type==="float_list"){A[Je]=ft,rn.g=7;break}if(St.type==="proto"){A[Je]=ft,rn.g=7;break}if(St.type!=="texture")throw Error("Unknown output config type: '"+St.type+"'");return Qe=x.u[Je],Qe||(Qe=new Wb(x.h,x.G),x.u[Je]=Qe),w(rn,VC(Qe,ft,x.I),13);case 13:vt=rn.h,A[Je]=vt;case 7:St.transform&&A[Je]&&(A[Je]=St.transform(A[Je])),rn.g=3;break;case 14:Dt[cn]=rn.h;case 3:K=Fe.next(),rn.g=2;break;case 4:return rn.return(A)}})}function NP(x,k,E){var A;return T(function(H){return typeof E=="number"||E instanceof Uint8Array||E instanceof x.h.Uint8BlobList?H.return(E):E instanceof x.h.Texture2dDataOut?(A=x.u[k],A||(A=new Wb(x.h,x.G),x.u[k]=A),H.return(VC(A,E,x.I))):H.return(void 0)})}function _P(x,k){for(var E=k.name||"$",A=[].concat(l(k.wants)),H=new x.h.StringList,te=a(k.wants),K=te.next();!K.done;K=te.next())H.push_back(K.value);te=x.h.PacketListener.implement({onResults:function(he){for(var xe={},Fe=0;Fe<k.wants.length;++Fe)xe[A[Fe]]=he.get(Fe);var Je=x.listeners[E];Je&&(x.D=RP(x,xe,k.outs).then(function(St){St=Je(St);for(var ft=0;ft<k.wants.length;++ft){var Qe=xe[A[ft]];typeof Qe=="object"&&Qe.hasOwnProperty&&Qe.hasOwnProperty("delete")&&Qe.delete()}St&&(x.D=St)}))}}),x.i.attachMultiListener(H,te),H.delete()}t.onResults=function(x,k){this.listeners[k||"$"]=x},z("Solution",Vb),z("OptionType",{BOOL:0,NUMBER:1,ma:2,0:"BOOL",1:"NUMBER",2:"STRING"});function HC(x){return x===void 0&&(x=0),x===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function GC(x){var k=this;x=x||{},this.g=new Vb({locateFile:x.locateFile,files:function(E){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:HC(E.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:WC},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:WC},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(E){return E.map(function(A){return BC(ca(A,_l,Ef))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(E){var A,H,te;return T(function(K){return K.g==1?(A=HC(E),H="third_party/mediapipe/modules/hand_landmark/"+A,w(K,Nf(k.g,A),2)):(te=K.h,k.g.overrideFile(H,te),K.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}t=GC.prototype,t.close=function(){return this.g.close(),Promise.resolve()},t.onResults=function(x){this.g.onResults(x)},t.initialize=function(){var x=this;return T(function(k){return w(k,x.g.initialize(),0)})},t.reset=function(){this.g.reset()},t.send=function(x){var k=this;return T(function(E){return w(E,k.g.send(x),0)})},t.setOptions=function(x){this.g.setOptions(x)},z("Hands",GC),z("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),z("VERSION","0.4.1646424915")}).call(zn);var GH=Hands,jH=HAND_CONNECTIONS;(function(){function t(T){var N=0;return function(){return N<T.length?{done:!1,value:T[N++]}:{done:!0}}}var e=typeof Object.defineProperties=="function"?Object.defineProperty:function(T,N,_){return T==Array.prototype||T==Object.prototype||(T[N]=_.value),T};function n(T){T=[typeof globalThis=="object"&&globalThis,T,typeof window=="object"&&window,typeof self=="object"&&self,typeof zn=="object"&&zn];for(var N=0;N<T.length;++N){var _=T[N];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=n(this);function o(T,N){if(N)e:{var _=r;T=T.split(".");for(var P=0;P<T.length-1;P++){var z=T[P];if(!(z in _))break e;_=_[z]}T=T[T.length-1],P=_[T],N=N(P),N!=P&&N!=null&&e(_,T,{configurable:!0,writable:!0,value:N})}}o("Symbol",function(T){function N(L){if(this instanceof N)throw new TypeError("Symbol is not a constructor");return new _(P+(L||"")+"_"+z++,L)}function _(L,O){this.g=L,e(this,"description",{configurable:!0,writable:!0,value:O})}if(T)return T;_.prototype.toString=function(){return this.g};var P="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",z=0;return N}),o("Symbol.iterator",function(T){if(T)return T;T=Symbol("Symbol.iterator");for(var N="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),_=0;_<N.length;_++){var P=r[N[_]];typeof P=="function"&&typeof P.prototype[T]!="function"&&e(P.prototype,T,{configurable:!0,writable:!0,value:function(){return s(t(this))}})}return T});function s(T){return T={next:T},T[Symbol.iterator]=function(){return this},T}function i(T){var N=typeof Symbol<"u"&&Symbol.iterator&&T[Symbol.iterator];return N?N.call(T):{next:t(T)}}function a(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function l(T){if(T.i)throw new TypeError("Generator is already running");T.i=!0}a.prototype.l=function(T){this.o=T};function c(T,N){T.h={F:N,G:!0},T.j=T.m}a.prototype.return=function(T){this.h={return:T},this.j=this.m};function u(T){this.g=new a,this.h=T}function d(T,N){l(T.g);var _=T.g.g;return _?h(T,"return"in _?_.return:function(P){return{value:P,done:!0}},N,T.g.return):(T.g.return(N),f(T))}function h(T,N,_,P){try{var z=N.call(T.g.g,_);if(!(z instanceof Object))throw new TypeError("Iterator result "+z+" is not an object");if(!z.done)return T.g.i=!1,z;var L=z.value}catch(O){return T.g.g=null,c(T.g,O),f(T)}return T.g.g=null,P.call(T.g,L),f(T)}function f(T){for(;T.g.j;)try{var N=T.h(T.g);if(N)return T.g.i=!1,{value:N.value,done:!1}}catch(_){T.g.o=void 0,c(T.g,_)}if(T.g.i=!1,T.g.h){if(N=T.g.h,T.g.h=null,N.G)throw N.F;return{value:N.return,done:!0}}return{value:void 0,done:!0}}function p(T){this.next=function(N){return l(T.g),T.g.g?N=h(T,T.g.g.next,N,T.g.l):(T.g.l(N),N=f(T)),N},this.throw=function(N){return l(T.g),T.g.g?N=h(T,T.g.g.throw,N,T.g.l):(c(T.g,N),N=f(T)),N},this.return=function(N){return d(T,N)},this[Symbol.iterator]=function(){return this}}function m(T){function N(P){return T.next(P)}function _(P){return T.throw(P)}return new Promise(function(P,z){function L(O){O.done?P(O.value):Promise.resolve(O.value).then(N,_).then(L,z)}L(T.next())})}o("Promise",function(T){function N(O){this.h=0,this.i=void 0,this.g=[],this.o=!1;var B=this.j();try{O(B.resolve,B.reject)}catch(U){B.reject(U)}}function _(){this.g=null}function P(O){return O instanceof N?O:new N(function(B){B(O)})}if(T)return T;_.prototype.h=function(O){if(this.g==null){this.g=[];var B=this;this.i(function(){B.l()})}this.g.push(O)};var z=r.setTimeout;_.prototype.i=function(O){z(O,0)},_.prototype.l=function(){for(;this.g&&this.g.length;){var O=this.g;this.g=[];for(var B=0;B<O.length;++B){var U=O[B];O[B]=null;try{U()}catch(Q){this.j(Q)}}}this.g=null},_.prototype.j=function(O){this.i(function(){throw O})},N.prototype.j=function(){function O(Q){return function(se){U||(U=!0,Q.call(B,se))}}var B=this,U=!1;return{resolve:O(this.A),reject:O(this.l)}},N.prototype.A=function(O){if(O===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(O instanceof N)this.C(O);else{e:switch(typeof O){case"object":var B=O!=null;break e;case"function":B=!0;break e;default:B=!1}B?this.v(O):this.m(O)}},N.prototype.v=function(O){var B=void 0;try{B=O.then}catch(U){this.l(U);return}typeof B=="function"?this.D(B,O):this.m(O)},N.prototype.l=function(O){this.u(2,O)},N.prototype.m=function(O){this.u(1,O)},N.prototype.u=function(O,B){if(this.h!=0)throw Error("Cannot settle("+O+", "+B+"): Promise already settled in state"+this.h);this.h=O,this.i=B,this.h===2&&this.B(),this.H()},N.prototype.B=function(){var O=this;z(function(){if(O.I()){var B=r.console;typeof B<"u"&&B.error(O.i)}},1)},N.prototype.I=function(){if(this.o)return!1;var O=r.CustomEvent,B=r.Event,U=r.dispatchEvent;return typeof U>"u"?!0:(typeof O=="function"?O=new O("unhandledrejection",{cancelable:!0}):typeof B=="function"?O=new B("unhandledrejection",{cancelable:!0}):(O=r.document.createEvent("CustomEvent"),O.initCustomEvent("unhandledrejection",!1,!0,O)),O.promise=this,O.reason=this.i,U(O))},N.prototype.H=function(){if(this.g!=null){for(var O=0;O<this.g.length;++O)L.h(this.g[O]);this.g=null}};var L=new _;return N.prototype.C=function(O){var B=this.j();O.s(B.resolve,B.reject)},N.prototype.D=function(O,B){var U=this.j();try{O.call(B,U.resolve,U.reject)}catch(Q){U.reject(Q)}},N.prototype.then=function(O,B){function U(de,we){return typeof de=="function"?function(Ie){try{Q(de(Ie))}catch(j){se(j)}}:we}var Q,se,ce=new N(function(de,we){Q=de,se=we});return this.s(U(O,Q),U(B,se)),ce},N.prototype.catch=function(O){return this.then(void 0,O)},N.prototype.s=function(O,B){function U(){switch(Q.h){case 1:O(Q.i);break;case 2:B(Q.i);break;default:throw Error("Unexpected state: "+Q.h)}}var Q=this;this.g==null?L.h(U):this.g.push(U),this.o=!0},N.resolve=P,N.reject=function(O){return new N(function(B,U){U(O)})},N.race=function(O){return new N(function(B,U){for(var Q=i(O),se=Q.next();!se.done;se=Q.next())P(se.value).s(B,U)})},N.all=function(O){var B=i(O),U=B.next();return U.done?P([]):new N(function(Q,se){function ce(Ie){return function(j){de[Ie]=j,we--,we==0&&Q(de)}}var de=[],we=0;do de.push(void 0),we++,P(U.value).s(ce(de.length-1),se),U=B.next();while(!U.done)})},N});var g=typeof Object.assign=="function"?Object.assign:function(T,N){for(var _=1;_<arguments.length;_++){var P=arguments[_];if(P)for(var z in P)Object.prototype.hasOwnProperty.call(P,z)&&(T[z]=P[z])}return T};o("Object.assign",function(T){return T||g});var b=this||self,v={facingMode:"user",width:640,height:480};function w(T,N){this.video=T,this.i=0,this.h=Object.assign(Object.assign({},v),N)}w.prototype.stop=function(){var T=this,N,_,P,z;return m(new p(new u(function(L){if(T.g){for(N=T.g.getTracks(),_=i(N),P=_.next();!P.done;P=_.next())z=P.value,z.stop();T.g=void 0}L.j=0})))},w.prototype.start=function(){var T=this,N;return m(new p(new u(function(_){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),N=T.h,_.return(navigator.mediaDevices.getUserMedia({video:{facingMode:N.facingMode,width:N.width,height:N.height}}).then(function(P){C(T,P)}).catch(function(P){var z="Failed to acquire camera feed: "+P;throw console.error(z),alert(z),P}))})))};function y(T){window.requestAnimationFrame(function(){S(T)})}function C(T,N){T.g=N,T.video.srcObject=N,T.video.onloadedmetadata=function(){T.video.play(),y(T)}}function S(T){var N=null;T.video.paused||T.video.currentTime===T.i||(T.i=T.video.currentTime,N=T.h.onFrame()),N?N.then(function(){y(T)}):y(T)}var $=["Camera"],I=b;$[0]in I||typeof I.execScript>"u"||I.execScript("var "+$[0]);for(var R;$.length&&(R=$.shift());)$.length||w===void 0?I[R]&&I[R]!==Object.prototype[R]?I=I[R]:I=I[R]={}:I[R]=w}).call(zn);var KH=Camera;(function(){function t(p){var m=0;return function(){return m<p.length?{done:!1,value:p[m++]}:{done:!0}}}var e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,m,g){return p==Array.prototype||p==Object.prototype||(p[m]=g.value),p};function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof zn=="object"&&zn];for(var m=0;m<p.length;++m){var g=p[m];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function o(p,m){if(m)e:{var g=r;p=p.split(".");for(var b=0;b<p.length-1;b++){var v=p[b];if(!(v in g))break e;g=g[v]}p=p[p.length-1],b=g[p],m=m(b),m!=b&&m!=null&&e(g,p,{configurable:!0,writable:!0,value:m})}}function s(p){var m=typeof Symbol<"u"&&Symbol.iterator&&p[Symbol.iterator];return m?m.call(p):{next:t(p)}}var i=typeof Object.assign=="function"?Object.assign:function(p,m){for(var g=1;g<arguments.length;g++){var b=arguments[g];if(b)for(var v in b)Object.prototype.hasOwnProperty.call(b,v)&&(p[v]=b[v])}return p};o("Object.assign",function(p){return p||i}),o("Array.prototype.fill",function(p){return p||function(m,g,b){var v=this.length||0;for(0>g&&(g=Math.max(0,v+g)),(b==null||b>v)&&(b=v),b=Number(b),0>b&&(b=Math.max(0,v+b)),g=Number(g||0);g<b;g++)this[g]=m;return this}});function a(p){return p||Array.prototype.fill}o("Int8Array.prototype.fill",a),o("Uint8Array.prototype.fill",a),o("Uint8ClampedArray.prototype.fill",a),o("Int16Array.prototype.fill",a),o("Uint16Array.prototype.fill",a),o("Int32Array.prototype.fill",a),o("Uint32Array.prototype.fill",a),o("Float32Array.prototype.fill",a),o("Float64Array.prototype.fill",a);var l=this||self;function c(p,m){p=p.split(".");var g=l;p[0]in g||typeof g.execScript>"u"||g.execScript("var "+p[0]);for(var b;p.length&&(b=p.shift());)p.length||m===void 0?g[b]&&g[b]!==Object.prototype[b]?g=g[b]:g=g[b]={}:g[b]=m}var u={color:"white",lineWidth:4,radius:6,visibilityMin:.5};function d(p){return p=p||{},Object.assign(Object.assign(Object.assign({},u),{fillColor:p.color}),p)}function h(p,m){return p instanceof Function?p(m):p}function f(p,m,g){return Math.max(Math.min(m,g),Math.min(Math.max(m,g),p))}c("clamp",f),c("drawLandmarks",function(p,m,g){if(m){g=d(g),p.save();var b=p.canvas,v=0;m=s(m);for(var w=m.next();!w.done;w=m.next())if(w=w.value,w!==void 0&&(w.visibility===void 0||w.visibility>g.visibilityMin)){p.fillStyle=h(g.fillColor,{index:v,from:w}),p.strokeStyle=h(g.color,{index:v,from:w}),p.lineWidth=h(g.lineWidth,{index:v,from:w});var y=new Path2D;y.arc(w.x*b.width,w.y*b.height,h(g.radius,{index:v,from:w}),0,2*Math.PI),p.fill(y),p.stroke(y),++v}p.restore()}}),c("drawConnectors",function(p,m,g,b){if(m&&g){b=d(b),p.save();var v=p.canvas,w=0;g=s(g);for(var y=g.next();!y.done;y=g.next()){var C=y.value;p.beginPath(),y=m[C[0]],C=m[C[1]],y&&C&&(y.visibility===void 0||y.visibility>b.visibilityMin)&&(C.visibility===void 0||C.visibility>b.visibilityMin)&&(p.strokeStyle=h(b.color,{index:w,from:y,to:C}),p.lineWidth=h(b.lineWidth,{index:w,from:y,to:C}),p.moveTo(y.x*v.width,y.y*v.height),p.lineTo(C.x*v.width,C.y*v.height)),++w,p.stroke()}p.restore()}}),c("drawRectangle",function(p,m,g){g=d(g),p.save();var b=p.canvas;p.beginPath(),p.lineWidth=h(g.lineWidth,{}),p.strokeStyle=h(g.color,{}),p.fillStyle=h(g.fillColor,{}),p.translate(m.xCenter*b.width,m.yCenter*b.height),p.rotate(m.rotation*Math.PI/180),p.rect(-m.width/2*b.width,-m.height/2*b.height,m.width*b.width,m.height*b.height),p.translate(-m.xCenter*b.width,-m.yCenter*b.height),p.stroke(),p.fill(),p.restore()}),c("lerp",function(p,m,g,b,v){return f(b*(1-(p-m)/(g-m))+v*(1-(g-p)/(g-m)),b,v)})}).call(zn);var qH=drawConnectors,XH=drawLandmarks;function YH(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Cy=YH,ZH=typeof zn=="object"&&zn&&zn.Object===Object&&zn,JH=ZH,QH=JH,eG=typeof self=="object"&&self&&self.Object===Object&&self,tG=QH||eG||Function("return this")(),QE=tG,nG=QE,rG=function(){return nG.Date.now()},oG=rG,sG=/\s/;function iG(t){for(var e=t.length;e--&&sG.test(t.charAt(e)););return e}var aG=iG,lG=aG,cG=/^\s+/;function uG(t){return t&&t.slice(0,lG(t)+1).replace(cG,"")}var dG=uG,hG=QE,fG=hG.Symbol,$y=fG,qS=$y,eR=Object.prototype,pG=eR.hasOwnProperty,mG=eR.toString,Cu=qS?qS.toStringTag:void 0;function gG(t){var e=pG.call(t,Cu),n=t[Cu];try{t[Cu]=void 0;var r=!0}catch{}var o=mG.call(t);return r&&(e?t[Cu]=n:delete t[Cu]),o}var bG=gG,vG=Object.prototype,xG=vG.toString;function yG(t){return xG.call(t)}var wG=yG,XS=$y,CG=bG,$G=wG,SG="[object Null]",IG="[object Undefined]",YS=XS?XS.toStringTag:void 0;function kG(t){return t==null?t===void 0?IG:SG:YS&&YS in Object(t)?CG(t):$G(t)}var tR=kG;function TG(t){return t!=null&&typeof t=="object"}var Sy=TG,EG=tR,RG=Sy,NG="[object Symbol]";function _G(t){return typeof t=="symbol"||RG(t)&&EG(t)==NG}var AG=_G,DG=dG,ZS=Cy,FG=AG,JS=0/0,OG=/^[-+]0x[0-9a-f]+$/i,PG=/^0b[01]+$/i,MG=/^0o[0-7]+$/i,LG=parseInt;function BG(t){if(typeof t=="number")return t;if(FG(t))return JS;if(ZS(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ZS(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=DG(t);var n=PG.test(t);return n||MG.test(t)?LG(t.slice(2),n?2:8):OG.test(t)?JS:+t}var zG=BG,WG=Cy,hv=oG,QS=zG,VG="Expected a function",UG=Math.max,HG=Math.min;function GG(t,e,n){var r,o,s,i,a,l,c=0,u=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(VG);e=QS(e)||0,WG(n)&&(u=!!n.leading,d="maxWait"in n,s=d?UG(QS(n.maxWait)||0,e):s,h="trailing"in n?!!n.trailing:h);function f(S){var $=r,I=o;return r=o=void 0,c=S,i=t.apply(I,$),i}function p(S){return c=S,a=setTimeout(b,e),u?f(S):i}function m(S){var $=S-l,I=S-c,R=e-$;return d?HG(R,s-I):R}function g(S){var $=S-l,I=S-c;return l===void 0||$>=e||$<0||d&&I>=s}function b(){var S=hv();if(g(S))return v(S);a=setTimeout(b,m(S))}function v(S){return a=void 0,h&&r?f(S):(r=o=void 0,i)}function w(){a!==void 0&&clearTimeout(a),c=0,r=l=o=a=void 0}function y(){return a===void 0?i:v(hv())}function C(){var S=hv(),$=g(S);if(r=arguments,o=this,l=S,$){if(a===void 0)return p(l);if(d)return clearTimeout(a),a=setTimeout(b,e),f(l)}return a===void 0&&(a=setTimeout(b,e)),i}return C.cancel=w,C.flush=y,C}var jG=GG,KG=jG,qG=Cy,XG="Expected a function";function YG(t,e,n){var r=!0,o=!0;if(typeof t!="function")throw new TypeError(XG);return qG(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),KG(t,e,{leading:r,maxWait:e,trailing:o})}var ZG=YG;const JG={class:"container"},QG=["width","height"],ej=lt({__name:"Hands",props:{landmarksDelay:{default:500},canvasWidth:{default:720},canvasHeight:{default:720},cameraOptions:{default:()=>({facingMode:"user",width:720,height:720})},draw:{type:Boolean,default:!1}},emits:["landmarks"],setup(t,{expose:e,emit:n}){const r=t,o=Ne(null),s=Ne(null),i=Ne(null),a=ZG(h=>n("landmarks",h),r.landmarksDelay),l=Ne(!1),c=new GH({locateFile:h=>`hands/${h}`});c.setOptions({maxNumHands:1,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5,selfieMode:!0}),Fn(l,h=>{var f;h&&o.value instanceof HTMLVideoElement&&(i.value=new KH(o.value,{onFrame:async()=>{await c.send({image:o.value})},...r.cameraOptions}),(f=i.value)==null||f.start())}),as(()=>{if(s.value instanceof HTMLCanvasElement){let h=function(p){var m,g;if(r.draw){f.save(),f.clearRect(0,0,((m=s.value)==null?void 0:m.width)||720,((g=s.value)==null?void 0:g.height)||720);for(const b of p.multiHandLandmarks)qH(f,b,jH,{color:"#00FF00",lineWidth:1}),XH(f,b,{color:"#FF0000",lineWidth:1});f.restore()}a(p)};const f=s.value.getContext("2d");c.onResults(h)}});function u(){var h;console.log("STOP"),(h=i.value)==null||h.stop()}function d(){var h;console.log("START"),l.value=!0,(h=i.value)==null||h.start()}return e({stopCamera:u,startCamera:d}),(h,f)=>(Zr(),Mi("div",JG,[Is("video",{ref_key:"video",ref:o,class:"input_video"},null,512),Is("canvas",{ref_key:"canvas",ref:s,class:"output_canvas",width:r.canvasWidth,height:r.canvasHeight},null,8,QG)]))}}),Iy=(t,e)=>{const n=t.__vccOpts||t;for(const[r,o]of e)n[r]=o;return n},tj=Iy(ej,[["__scopeId","data-v-3c68b10b"]]);function nj(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}var rj=nj,oj=tR,sj=Sy,ij="[object Arguments]";function aj(t){return sj(t)&&oj(t)==ij}var lj=aj,eI=lj,cj=Sy,nR=Object.prototype,uj=nR.hasOwnProperty,dj=nR.propertyIsEnumerable,hj=eI(function(){return arguments}())?eI:function(t){return cj(t)&&uj.call(t,"callee")&&!dj.call(t,"callee")},fj=hj,pj=Array.isArray,mj=pj,tI=$y,gj=fj,bj=mj,nI=tI?tI.isConcatSpreadable:void 0;function vj(t){return bj(t)||gj(t)||!!(nI&&t&&t[nI])}var xj=vj,yj=rj,wj=xj;function rR(t,e,n,r,o){var s=-1,i=t.length;for(n||(n=wj),o||(o=[]);++s<i;){var a=t[s];e>0&&n(a)?e>1?rR(a,e-1,n,r,o):yj(o,a):r||(o[o.length]=a)}return o}var Cj=rR,$j=Cj;function Sj(t){var e=t==null?0:t.length;return e?$j(t,1):[]}var Ij=Sj,kj=!1,rI;const Pd=typeof window<"u",Tj=t=>typeof t=="function",Ej=t=>typeof t=="string",Rj=()=>{};Pd&&((rI=window==null?void 0:window.navigator)==null?void 0:rI.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function oR(t){return typeof t=="function"?t():kt(t)}function Nj(t,e){function n(...r){t(()=>e.apply(this,r),{fn:e,thisArg:this,args:r})}return n}const sR=t=>t();function _j(t=sR){const e=Ne(!0);function n(){e.value=!1}function r(){e.value=!0}return{isActive:e,pause:n,resume:r,eventFilter:(...s)=>{e.value&&t(...s)}}}function Aj(t){return t}function Dj(t){return V0()?(y2(t),!0):!1}var oI=Object.getOwnPropertySymbols,Fj=Object.prototype.hasOwnProperty,Oj=Object.prototype.propertyIsEnumerable,Pj=(t,e)=>{var n={};for(var r in t)Fj.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&oI)for(var r of oI(t))e.indexOf(r)<0&&Oj.call(t,r)&&(n[r]=t[r]);return n};function Mj(t,e,n={}){const r=n,{eventFilter:o=sR}=r,s=Pj(r,["eventFilter"]);return Fn(t,Nj(o,e),s)}var Lj=Object.defineProperty,Bj=Object.defineProperties,zj=Object.getOwnPropertyDescriptors,Pp=Object.getOwnPropertySymbols,iR=Object.prototype.hasOwnProperty,aR=Object.prototype.propertyIsEnumerable,sI=(t,e,n)=>e in t?Lj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wj=(t,e)=>{for(var n in e||(e={}))iR.call(e,n)&&sI(t,n,e[n]);if(Pp)for(var n of Pp(e))aR.call(e,n)&&sI(t,n,e[n]);return t},Vj=(t,e)=>Bj(t,zj(e)),Uj=(t,e)=>{var n={};for(var r in t)iR.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Pp)for(var r of Pp(t))e.indexOf(r)<0&&aR.call(t,r)&&(n[r]=t[r]);return n};function Hj(t,e,n={}){const r=n,{eventFilter:o}=r,s=Uj(r,["eventFilter"]),{eventFilter:i,pause:a,resume:l,isActive:c}=_j(o);return{stop:Mj(t,e,Vj(Wj({},s),{eventFilter:i})),pause:a,resume:l,isActive:c}}function Gj(t){var e;const n=oR(t);return(e=n==null?void 0:n.$el)!=null?e:n}const vx=Pd?window:void 0;Pd&&window.document;Pd&&window.navigator;Pd&&window.location;function jj(...t){let e,n,r,o;if(Ej(t[0])||Array.isArray(t[0])?([n,r,o]=t,e=vx):[e,n,r,o]=t,!e)return Rj;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const s=[],i=()=>{s.forEach(u=>u()),s.length=0},a=(u,d,h)=>(u.addEventListener(d,h,o),()=>u.removeEventListener(d,h,o)),l=Fn(()=>Gj(e),u=>{i(),u&&s.push(...n.flatMap(d=>r.map(h=>a(u,d,h))))},{immediate:!0,flush:"post"}),c=()=>{l(),i()};return Dj(c),c}const xx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yx="__vueuse_ssr_handlers__";xx[yx]=xx[yx]||{};const Kj=xx[yx];function qj(t,e){return Kj[t]||e}function Xj(t){return t==null?"any":t instanceof Set?"set":t instanceof Map?"map":t instanceof Date?"date":typeof t=="boolean"?"boolean":typeof t=="string"?"string":typeof t=="object"?"object":Number.isNaN(t)?"any":"number"}var Yj=Object.defineProperty,iI=Object.getOwnPropertySymbols,Zj=Object.prototype.hasOwnProperty,Jj=Object.prototype.propertyIsEnumerable,aI=(t,e,n)=>e in t?Yj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lI=(t,e)=>{for(var n in e||(e={}))Zj.call(e,n)&&aI(t,n,e[n]);if(iI)for(var n of iI(e))Jj.call(e,n)&&aI(t,n,e[n]);return t};const Qj={boolean:{read:t=>t==="true",write:t=>String(t)},object:{read:t=>JSON.parse(t),write:t=>JSON.stringify(t)},number:{read:t=>Number.parseFloat(t),write:t=>String(t)},any:{read:t=>t,write:t=>String(t)},string:{read:t=>t,write:t=>String(t)},map:{read:t=>new Map(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t.entries()))},set:{read:t=>new Set(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t))},date:{read:t=>new Date(t),write:t=>t.toISOString()}};function lR(t,e,n,r={}){var o;const{flush:s="pre",deep:i=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:c=!1,shallow:u,window:d=vx,eventFilter:h,onError:f=$=>{console.error($)}}=r,p=(u?F2:Ne)(e);if(!n)try{n=qj("getDefaultStorage",()=>{var $;return($=vx)==null?void 0:$.localStorage})()}catch($){f($)}if(!n)return p;const m=oR(e),g=Xj(m),b=(o=r.serializer)!=null?o:Qj[g],{pause:v,resume:w}=Hj(p,()=>y(p.value),{flush:s,deep:i,eventFilter:h});return d&&a&&jj(d,"storage",S),S(),p;function y($){try{if($==null)n.removeItem(t);else{const I=b.write($),R=n.getItem(t);R!==I&&(n.setItem(t,I),d&&(d==null||d.dispatchEvent(new StorageEvent("storage",{key:t,oldValue:R,newValue:I,storageArea:n}))))}}catch(I){f(I)}}function C($){const I=$?$.newValue:n.getItem(t);if(I==null)return l&&m!==null&&n.setItem(t,b.write(m)),m;if(!$&&c){const R=b.read(I);return Tj(c)?c(R,m):g==="object"&&!Array.isArray(R)?lI(lI({},m),R):R}else return typeof I!="string"?I:b.read(I)}function S($){if(!($&&$.storageArea!==n)){if($&&$.key==null){p.value=m;return}if(!($&&$.key!==t)){v();try{p.value=C($)}catch(I){f(I)}finally{$?Do(w):w()}}}}}const Pl=new Map;function Wm(t){const e=V0();function n(a){var l;const c=Pl.get(t)||[];c.push(a),Pl.set(t,c);const u=()=>o(a);return(l=e==null?void 0:e.cleanups)==null||l.push(u),u}function r(a){function l(...c){o(l),a(...c)}return n(l)}function o(a){const l=Pl.get(t);if(!l)return;const c=l.indexOf(a);c>-1&&l.splice(c,1),l.length||Pl.delete(t)}function s(){Pl.delete(t)}function i(a,l){var c;(c=Pl.get(t))==null||c.forEach(u=>u(a,l))}return{on:n,once:r,off:o,emit:i,reset:s}}var cI;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(cI||(cI={}));var e8=Object.defineProperty,uI=Object.getOwnPropertySymbols,t8=Object.prototype.hasOwnProperty,n8=Object.prototype.propertyIsEnumerable,dI=(t,e,n)=>e in t?e8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,r8=(t,e)=>{for(var n in e||(e={}))t8.call(e,n)&&dI(t,n,e[n]);if(uI)for(var n of uI(e))n8.call(e,n)&&dI(t,n,e[n]);return t};const o8={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};r8({linear:Aj},o8);const Vm=Symbol("landmarksKey"),cR=lt({__name:"Gestures",props:{draw:{type:Boolean,default:!1},landmarksDelay:{type:Number,default:100}},setup(t,{expose:e}){const n=t,r=Wm(Vm),o=Ne(null);function s(){var c;(c=o.value)==null||c.startCamera()}function i(){var c;(c=o.value)==null||c.stopCamera()}function a(c){const u=[];if(c.multiHandLandmarks&&c.multiHandedness)for(let d=0;d<c.multiHandLandmarks.length;d++){const h=c.multiHandLandmarks[d],f=c.multiHandedness[d];if(f.score>.7){const p={handedness:f.label,tensoredLandmarks:Ij(h.map(m=>[m.x,m.y]))};u.push(p)}else console.warn("Handedness score is too low")}return u}function l(c){const u=a(c);r.emit({landmarks:u})}return e({stopCamera:i,startCamera:s}),(c,u)=>(Zr(),Oc(tj,{draw:n.draw,"landmarks-delay":n.landmarksDelay,ref_key:"hands",ref:o,onLandmarks:l},null,8,["draw","landmarks-delay"]))}}),s8={class:"flex flex-row center h-100"},i8={class:"section"},a8={class:"flex flex-row center",style:{"margin-top":"-50px","z-index":"2"}},l8={class:"section"},c8={class:"flex flex-row center"},u8=lt({__name:"Home",setup(t){const e=HH(),n=Me(()=>e.currentRoute.value.path),r=Ne(null),o=Ne([{label:"Add new gesture",path:"/"},{label:"Train Model",path:"/train-model"},{label:"Test Model",path:"/test-model"}]),s=Ne(null);function i(){var l;(l=s.value)==null||l.startCamera()}function a(){var l;(l=s.value)==null||l.stopCamera()}return(l,c)=>{const u=Hv("router-link"),d=Hv("RouterView");return Zr(),Mi("div",s8,[Is("div",i8,[Tt(kt(fx),{style:{width:"720px",height:"720px"},bordered:!1,"content-style":"padding: 0;"},{default:Sn(()=>[Tt(cR,{draw:!0,ref_key:"gestures",ref:s},null,512)]),_:1}),Is("div",a8,[Tt(kt(Z6),null,{default:Sn(()=>[Tt(kt(zi),{type:"primary",onClick:i},{default:Sn(()=>[hr("Start Camera")]),_:1}),Tt(kt(zi),{type:"primary",onClick:a},{default:Sn(()=>[hr("Stop Camera")]),_:1})]),_:1})])]),Is("div",l8,[Is("div",c8,[Tt(kt(A5),{id:"tabs",ref_key:"tabsInstRef",ref:r,value:kt(n),"onUpdate:value":c[0]||(c[0]=h=>$n(n)?n.value=h:null)},{default:Sn(()=>[(Zr(!0),Mi(fn,null,eT(o.value,h=>(Zr(),Oc(kt(Fp),{key:h.path,name:h.path},{default:Sn(()=>[Tt(u,{to:h},{default:Sn(()=>[Tt(kt(WE),null,{default:Sn(()=>[hr(Ip(h.label),1)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1032,["name"]))),128))]),_:1},8,["value"])]),Tt(kt(fx),{id:"right-pane",class:"flex center"},{default:Sn(()=>[Tt(d)]),_:1})])])}}}),d8=Iy(u8,[["__scopeId","data-v-b41c2553"]]);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h8=1e-7,f8=1e-4;class uR{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class ky{refCount(e){return Ur("refCount")}incRef(e){return Ur("incRef")}timerAvailable(){return!0}time(e){return Ur("time")}read(e){return Ur("read")}readSync(e){return Ur("readSync")}readToGPU(e,n){return Ur("readToGPU")}numDataIds(){return Ur("numDataIds")}disposeData(e,n){return Ur("disposeData")}write(e,n,r){return Ur("write")}move(e,n,r,o,s){return Ur("move")}createTensorFromTexture(e,n,r){return Ur("createTensorFromTexture")}memory(){return Ur("memory")}floatPrecision(){return Ur("floatPrecision")}epsilon(){return this.floatPrecision()===32?h8:f8}dispose(){return Ur("dispose")}}function Ur(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Gl(t,e,n)}function Ja(t,e,n){return Math.max(t,Math.min(e,n))}function Ty(t){return t%2===0?t:t+1}function Gl(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function m8(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function D(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function zo(t,e,n=""){D(Bt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function dR(t){D(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function bc(t,e=[],n=!1){if(e==null&&(e=[]),Array.isArray(t)||Ps(t)&&!n)for(let r=0;r<t.length;++r)bc(t[r],e,n);else e.push(t);return e}function me(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Bt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function vc(t){return t%1===0}function wx(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function nc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function hI(t,e=o=>0,n,r){return new Promise((o,s)=>{let i=0;const a=()=>{if(t()){o();return}i++;const l=e(i);if(n!=null&&i>=n){s();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function hR(t,e){let n=1,r=-1;for(let s=0;s<t.length;++s)if(t[s]>=0)n*=t[s];else if(t[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(t[s]<0)throw Error(`Shapes can not be < 0. Found ${t[s]} at dim ${s}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const o=t.slice();return o[r]=e/n,o}function Ct(t,e){const n=e.length;return t=t==null?e.map((r,o)=>o):[].concat(t),D(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),D(t.every(r=>vc(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Zi(t,e){const n=[],r=[],o=e!=null&&Array.isArray(e)&&e.length===0,s=e==null||o?null:Ct(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(s!=null){if(s[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(s[i]==null||s[i]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),s[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function sr(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else throw new Error(`Unknown data type ${t}`);return n}function Dn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function g8(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function b8(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function fR(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Ps(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function Cx(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function v8(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Md(t){return typeof t=="string"||t instanceof String}function x8(t){return typeof t=="boolean"}function $x(t){return typeof t=="number"}function Ld(t){return Array.isArray(t)?Ld(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":$x(t)?"float32":Md(t)?"string":x8(t)?"bool":"float32"}function Sx(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Ix(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function tt(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function pR(t,e,n,r=!1){const o=new Array;if(e.length===1){const s=e[0]*(r?2:1);for(let i=0;i<s;i++)o[i]=n[t+i]}else{const s=e[0],i=e.slice(1),a=i.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<s;l++)o[l]=pR(t+l*a,i,n,r)}return o}function Jo(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((o,s)=>o*s)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return pR(0,t,e,n)}function Ey(t,e){const n=gr(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function gr(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function mR(t,e){const n=t.reduce((r,o)=>r*o,1);if(e==null||e==="float32")return Jo(t,new Float32Array(n));if(e==="int32")return Jo(t,new Int32Array(n));if(e==="bool")return Jo(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function ai(t){t.forEach(e=>{D(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Es(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let o=0;o<t.length-1;++o)r+=n[o]*t[o];return r}function Kc(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let o=0;o<r.length-1;++o)r[o]=Math.floor(t/n[o]),t-=r[o]*n[o];return r[r.length-1]=t,r}function gR(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fI="tfjsflags";class y8{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=w8,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const o=this.urlFlags[e];ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${o}.`),this.set(e,o)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(gR(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);fI in e&&e[fI].split(",").forEach(r=>{const[o,s]=r.split(":");this.urlFlags[o]=$8(o,s)})}}function w8(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(C8(e,r[0],r[1]),r.join("="))),e}function C8(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function $8(t,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}function ue(){return bR}let bR=null;function S8(t){bR=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fv;function vR(){if(fv==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");fv=t}return fv}function I8(){const t=vR();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Ry(t,e){const n=I8();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Um="Abs",Bd="Acos",zd="Acosh",qc="Add",Ny="AddN",_y="All",Ay="Any",Hm="ArgMax",Gm="ArgMin",Wd="Asin",Vd="Asinh",Ud="Atan",Hd="Atanh",Gd="Atan2",jm="AvgPool",Dy="AvgPoolGrad",Km="AvgPool3D",Fy="AvgPool3DGrad",qm="BatchMatMul",Xm="BatchToSpaceND",Oy="Bincount",k8="BroadcastTo",xR="BroadcastArgs",jd="Cast",Kd="Ceil",qd="ClipByValue",Py="Complex",Ym="ComplexAbs",Zm="Concat",Jm="Conv2D",My="Conv2DBackpropFilter",Qm="Conv2DBackpropInput",eg="Conv3D",Ly="Conv3DBackpropFilterV2",By="Conv3DBackpropInputV2",Xd="Cos",Yd="Cosh",zy="Cumprod",tg="Cumsum",Wy="CropAndResize",Vy="DenseBincount",Uy="DepthToSpace",ng="DepthwiseConv2dNative",Hy="DepthwiseConv2dNativeBackpropFilter",Gy="DepthwiseConv2dNativeBackpropInput",yR="Diag",rg="Dilation2D",kx="Dilation2DBackpropInput",Tx="Dilation2DBackpropFilter",Zd="RealDiv",wR="Einsum",Jd="Elu",jy="EluGrad",Qd="Erf",og="Equal",eh="Exp",sg="ExpandDims",th="Expm1",Ky="FFT",qy="Fill",Xy="FlipLeftRight",nh="Floor",rh="FloorDiv",ig="FusedBatchNorm",ag="GatherV2",CR="GatherNd",lg="Greater",oh="GreaterEqual",sh="Identity",Yy="IFFT",Zy="Imag",ih="IsFinite",ah="IsInf",lh="IsNan",cg="LeakyRelu",ug="Less",dg="LessEqual",$R="LinSpace",ch="Log",uh="Log1p",hg="LogicalAnd",fg="LogicalNot",pg="LogicalOr",T8="LogSoftmax",mg="LRN",Jy="LRNGrad",gg="Max",dh="Maximum",bg="MaxPool",Qy="MaxPoolGrad",vg="MaxPool3D",e1="MaxPool3DGrad",SR="MaxPoolWithArgmax",xg="Mean",yg="Min",hh="Minimum",wg="MirrorPad",fh="Mod",IR="Multinomial",ph="Multiply",Cg="Neg",$g="NotEqual",t1="NonMaxSuppressionV3",n1="NonMaxSuppressionV4",r1="NonMaxSuppressionV5",Sg="OnesLike",Ig="OneHot",kg="Pack",Tg="PadV2",mh="Pow",Eg="Prelu",Rg="Prod",kR="RaggedGather",TR="RaggedRange",ER="RaggedTensorToTensor",o1="Range",s1="Real",gh="Reciprocal",bh="Relu",Ng="Reshape",_g="ResizeNearestNeighbor",i1="ResizeNearestNeighborGrad",Ag="ResizeBilinear",a1="ResizeBilinearGrad",vh="Relu6",Dg="Reverse",xh="Round",yh="Rsqrt",RR="ScatterNd",NR="SearchSorted",Fg="Select",wh="Selu",Og="Slice",Ch="Sin",$h="Sinh",Sh="Sign",Ih="Sigmoid",kh="Softplus",Th="Sqrt",Pg="Sum",Mg="SpaceToBatchND",Lg="SplitV",Bg="Softmax",l1="SparseFillEmptyRows",c1="SparseReshape",u1="SparseSegmentMean",d1="SparseSegmentSum",_R="SparseToDense",Eh="SquaredDifference",h1="Square",f1="StridedSlice",p1="StringNGrams",m1="StringSplit",g1="StringToHashBucketFast",Rh="Sub",Nh="Tan",_h="Tanh",Ah="Tile",b1="TopK",v1="Transform",rc="Transpose",x1="Unique",zg="Unpack",Wg="UnsortedSegmentSum",Vg="ZerosLike",Dh="Step",E8="FromPixels",y1="RotateWithOffset",Mp="_FusedMatMul",Lp="FusedConv2D",AR="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ao(...t){ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(...t)}function R8(...t){ue().getBool("IS_TEST")||ue().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bp=Ry("kernelRegistry",()=>new Map),Ex=Ry("gradRegistry",()=>new Map);function pI(t,e){const n=FR(t,e);return Bp.get(n)}function mI(t){return Ex.get(t)}function gI(t){const e=Bp.entries(),n=[];for(;;){const{done:r,value:o}=e.next();if(r)break;const[s,i]=o,[a]=s.split("_");a===t&&n.push(i)}return n}function DR(t){const{kernelName:e,backendName:n}=t,r=FR(e,n);Bp.has(r)&&ao(`The kernel '${e}' for backend '${n}' is already registered`),Bp.set(r,t)}function N8(t){const{kernelName:e}=t;Ex.has(e)&&ue().getBool("DEBUG")&&ao(`Overriding the gradient for '${e}'`),Ex.set(e,t)}function FR(t,e){return`${e}_${t}`}var Rx=sn,To=null;try{To=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function sn(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}sn.prototype.__isLong__;Object.defineProperty(sn.prototype,"__isLong__",{value:!0});function no(t){return(t&&t.__isLong__)===!0}sn.isLong=no;var bI={},vI={};function xl(t,e){var n,r,o;return e?(t>>>=0,(o=0<=t&&t<256)&&(r=vI[t],r)?r:(n=an(t,(t|0)<0?-1:0,!0),o&&(vI[t]=n),n)):(t|=0,(o=-128<=t&&t<128)&&(r=bI[t],r)?r:(n=an(t,t<0?-1:0,!1),o&&(bI[t]=n),n))}sn.fromInt=xl;function Eo(t,e){if(isNaN(t))return e?Fa:Ro;if(e){if(t<0)return Fa;if(t>=OR)return LR}else{if(t<=-yI)return qr;if(t+1>=yI)return MR}return t<0?Eo(-t,e).neg():an(t%xc|0,t/xc|0,e)}sn.fromNumber=Eo;function an(t,e,n){return new sn(t,e,n)}sn.fromBits=an;var zp=Math.pow;function w1(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ro;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return w1(t.substring(1),e,n).neg();for(var o=Eo(zp(n,8)),s=Ro,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var c=Eo(zp(n,a));s=s.mul(c).add(Eo(l))}else s=s.mul(o),s=s.add(Eo(l))}return s.unsigned=e,s}sn.fromString=w1;function ls(t,e){return typeof t=="number"?Eo(t,e):typeof t=="string"?w1(t,e):an(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}sn.fromValue=ls;var xI=1<<16,_8=1<<24,xc=xI*xI,OR=xc*xc,yI=OR/2,wI=xl(_8),Ro=xl(0);sn.ZERO=Ro;var Fa=xl(0,!0);sn.UZERO=Fa;var Xl=xl(1);sn.ONE=Xl;var PR=xl(1,!0);sn.UONE=PR;var Nx=xl(-1);sn.NEG_ONE=Nx;var MR=an(-1,2147483647,!1);sn.MAX_VALUE=MR;var LR=an(-1,-1,!0);sn.MAX_UNSIGNED_VALUE=LR;var qr=an(0,-2147483648,!1);sn.MIN_VALUE=qr;var Be=sn.prototype;Be.toInt=function(){return this.unsigned?this.low>>>0:this.low};Be.toNumber=function(){return this.unsigned?(this.high>>>0)*xc+(this.low>>>0):this.high*xc+(this.low>>>0)};Be.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(qr)){var n=Eo(e),r=this.div(n),o=r.mul(n).sub(this);return r.toString(e)+o.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Eo(zp(e,6),this.unsigned),i=this,a="";;){var l=i.div(s),c=i.sub(l.mul(s)).toInt()>>>0,u=c.toString(e);if(i=l,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};Be.getHighBits=function(){return this.high};Be.getHighBitsUnsigned=function(){return this.high>>>0};Be.getLowBits=function(){return this.low};Be.getLowBitsUnsigned=function(){return this.low>>>0};Be.getNumBitsAbs=function(){if(this.isNegative())return this.eq(qr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&(e&1<<n)==0;n--);return this.high!=0?n+33:n+1};Be.isZero=function(){return this.high===0&&this.low===0};Be.eqz=Be.isZero;Be.isNegative=function(){return!this.unsigned&&this.high<0};Be.isPositive=function(){return this.unsigned||this.high>=0};Be.isOdd=function(){return(this.low&1)===1};Be.isEven=function(){return(this.low&1)===0};Be.equals=function(e){return no(e)||(e=ls(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Be.eq=Be.equals;Be.notEquals=function(e){return!this.eq(e)};Be.neq=Be.notEquals;Be.ne=Be.notEquals;Be.lessThan=function(e){return this.comp(e)<0};Be.lt=Be.lessThan;Be.lessThanOrEqual=function(e){return this.comp(e)<=0};Be.lte=Be.lessThanOrEqual;Be.le=Be.lessThanOrEqual;Be.greaterThan=function(e){return this.comp(e)>0};Be.gt=Be.greaterThan;Be.greaterThanOrEqual=function(e){return this.comp(e)>=0};Be.gte=Be.greaterThanOrEqual;Be.ge=Be.greaterThanOrEqual;Be.compare=function(e){if(no(e)||(e=ls(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Be.comp=Be.compare;Be.negate=function(){return!this.unsigned&&this.eq(qr)?qr:this.not().add(Xl)};Be.neg=Be.negate;Be.add=function(e){no(e)||(e=ls(e));var n=this.high>>>16,r=this.high&65535,o=this.low>>>16,s=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=s+c,h+=f>>>16,f&=65535,h+=o+l,d+=h>>>16,h&=65535,d+=r+a,u+=d>>>16,d&=65535,u+=n+i,u&=65535,an(h<<16|f,u<<16|d,this.unsigned)};Be.subtract=function(e){return no(e)||(e=ls(e)),this.add(e.neg())};Be.sub=Be.subtract;Be.multiply=function(e){if(this.isZero())return Ro;if(no(e)||(e=ls(e)),To){var n=To.mul(this.low,this.high,e.low,e.high);return an(n,To.get_high(),this.unsigned)}if(e.isZero())return Ro;if(this.eq(qr))return e.isOdd()?qr:Ro;if(e.eq(qr))return this.isOdd()?qr:Ro;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(wI)&&e.lt(wI))return Eo(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,o=this.high&65535,s=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=i*u,f+=p>>>16,p&=65535,f+=s*u,h+=f>>>16,f&=65535,f+=i*c,h+=f>>>16,f&=65535,h+=o*u,d+=h>>>16,h&=65535,h+=s*c,d+=h>>>16,h&=65535,h+=i*l,d+=h>>>16,h&=65535,d+=r*u+o*c+s*l+i*a,d&=65535,an(f<<16|p,d<<16|h,this.unsigned)};Be.mul=Be.multiply;Be.divide=function(e){if(no(e)||(e=ls(e)),e.isZero())throw Error("division by zero");if(To){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?To.div_u:To.div_s)(this.low,this.high,e.low,e.high);return an(n,To.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Fa:Ro;var r,o,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Fa;if(e.gt(this.shru(1)))return PR;s=Fa}else{if(this.eq(qr)){if(e.eq(Xl)||e.eq(Nx))return qr;if(e.eq(qr))return Xl;var i=this.shr(1);return r=i.div(e).shl(1),r.eq(Ro)?e.isNegative()?Xl:Nx:(o=this.sub(e.mul(r)),s=r.add(o.div(e)),s)}else if(e.eq(qr))return this.unsigned?Fa:Ro;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=Ro}for(o=this;o.gte(e);){r=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:zp(2,a-48),c=Eo(r),u=c.mul(e);u.isNegative()||u.gt(o);)r-=l,c=Eo(r,this.unsigned),u=c.mul(e);c.isZero()&&(c=Xl),s=s.add(c),o=o.sub(u)}return s};Be.div=Be.divide;Be.modulo=function(e){if(no(e)||(e=ls(e)),To){var n=(this.unsigned?To.rem_u:To.rem_s)(this.low,this.high,e.low,e.high);return an(n,To.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Be.mod=Be.modulo;Be.rem=Be.modulo;Be.not=function(){return an(~this.low,~this.high,this.unsigned)};Be.and=function(e){return no(e)||(e=ls(e)),an(this.low&e.low,this.high&e.high,this.unsigned)};Be.or=function(e){return no(e)||(e=ls(e)),an(this.low|e.low,this.high|e.high,this.unsigned)};Be.xor=function(e){return no(e)||(e=ls(e)),an(this.low^e.low,this.high^e.high,this.unsigned)};Be.shiftLeft=function(e){return no(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?an(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):an(0,this.low<<e-32,this.unsigned)};Be.shl=Be.shiftLeft;Be.shiftRight=function(e){return no(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?an(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):an(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Be.shr=Be.shiftRight;Be.shiftRightUnsigned=function(e){if(no(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return an(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?an(n,0,this.unsigned):an(n>>>e-32,0,this.unsigned)};Be.shru=Be.shiftRightUnsigned;Be.shr_u=Be.shiftRightUnsigned;Be.toSigned=function(){return this.unsigned?an(this.low,this.high,!1):this};Be.toUnsigned=function(){return this.unsigned?this:an(this.low,this.high,!0)};Be.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Be.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Be.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};sn.fromBytes=function(e,n,r){return r?sn.fromBytesLE(e,n):sn.fromBytesBE(e,n)};sn.fromBytesLE=function(e,n){return new sn(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};sn.fromBytesBE=function(e,n){return new sn(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const A8=OP({__proto__:null,default:Rx},[Rx]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ia=Rx||A8;function Ug(t){return Ia.fromString(t,!0,16)}const BR=Ug("c3a5c85c97cb3127"),wa=Ug("b492b66fbe98f273"),wr=Ug("9ae16a3b2f90404f");function _x(t){return t.xor(t.shru(47))}function zR(t,e,n){const r=t.slice(e,e+n);return Ia.fromBytes(Array.from(r),!0,!0)}function Xt(t,e){return zR(t,e,8)}function CI(t,e){return zR(t,e,4)}function Yn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Ai(t,e,n=Ug("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let o=e.xor(r).mul(n);return o=o.xor(o.shru(47)),o=o.mul(n),o}function D8(t,e,n,r,o,s){o=o.add(t),s=Yn(s.add(o).add(r),21);const i=o;return o=o.add(e),o=o.add(n),s=s.add(Yn(o,44)),[o.add(r),s.add(i)]}function Xf(t,e,n,r){return D8(Xt(t,e),Xt(t,e+8),Xt(t,e+16),Xt(t,e+24),n,r)}function F8(t,e=t.length){if(e>=8){const n=wr.add(e*2),r=Xt(t,0).add(wr),o=Xt(t,e-8),s=Yn(o,37).mul(n).add(r),i=Yn(r,25).add(o).mul(n);return Ai(s,i,n)}if(e>=4){const n=wr.add(e*2),r=CI(t,0);return Ai(r.shl(3).add(e),CI(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],o=t[e-1],s=n+(r<<8),i=e+(o<<2);return _x(wr.mul(s).xor(BR.mul(i))).mul(wr)}return wr}function O8(t,e=t.length){const n=wr.add(e*2),r=Xt(t,0).mul(wa),o=Xt(t,8),s=Xt(t,e-8).mul(n),i=Xt(t,e-16).mul(wr);return Ai(Yn(r.add(o),43).add(Yn(s,30)).add(i),r.add(Yn(o.add(wr),18)).add(s),n)}function P8(t,e=t.length){const n=wr.add(e*2),r=Xt(t,0).mul(wr),o=Xt(t,8),s=Xt(t,e-8).mul(n),i=Xt(t,e-16).mul(wr),a=Yn(r.add(o),43).add(Yn(s,30)).add(i),l=Ai(a,r.add(Yn(o.add(wr),18)).add(s),n),c=Xt(t,16).mul(n),u=Xt(t,24),d=a.add(Xt(t,e-32)).mul(n),h=l.add(Xt(t,e-24)).mul(n);return Ai(Yn(c.add(u),43).add(Yn(d,30)).add(h),c.add(Yn(u.add(r),18)).add(d),n)}function M8(t,e=t.length){const n=Ia.fromNumber(81,!0);if(e<=32)return e<=16?F8(t,e):O8(t,e);if(e<=64)return P8(t,e);let r=n,o=n.mul(wa).add(113),s=_x(o.mul(wr).add(113)).mul(wr),i=[Ia.UZERO,Ia.UZERO],a=[Ia.UZERO,Ia.UZERO];r=r.mul(wr).add(Xt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do r=Yn(r.add(o).add(i[0]).add(Xt(t,l+8)),37).mul(wa),o=Yn(o.add(i[1]).add(Xt(t,l+48)),42).mul(wa),r=r.xor(a[1]),o=o.add(i[0]).add(Xt(t,l+40)),s=Yn(s.add(a[0]),33).mul(wa),i=Xf(t,l,i[1].mul(wa),r.add(a[0])),a=Xf(t,l+32,s.add(a[1]),o.add(Xt(t,l+16))),[s,r]=[r,s],l+=64;while(l!==c);const d=wa.add(s.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=Yn(r.add(o).add(i[0]).add(Xt(t,l+8)),37).mul(d),o=Yn(o.add(i[1]).add(Xt(t,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),o=o.add(i[0].mul(9).add(Xt(t,l+40))),s=Yn(s.add(a[0]),33).mul(d),i=Xf(t,l,i[1].mul(d),r.add(a[0])),a=Xf(t,l+32,s.add(a[1]),o.add(Xt(t,l+16))),[s,r]=[r,s],Ai(Ai(i[0],a[0],d).add(_x(o).mul(BR)).add(s),Ai(i[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ji(t,e){return e==="string"?Di(t):yl([t],e)}function L8(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function yl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=bc(t)),ue().getBool("DEBUG")&&g8(t,e),L8(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function _r(){return ue().platform.now()}function Di(t,e="utf-8"){return e=e||"utf-8",ue().platform.encode(t,e)}function Wi(t,e="utf-8"){return e=e||"utf-8",ue().platform.decode(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B8{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new W8)}profileKernel(e,n,r){let o;const s=()=>{o=r()};let i;const a=_r();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(s);else{s();for(const c of o)c.dataSync();i=Promise.resolve({kernelMs:_r()-a})}if(ue().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<o.length;c++){const u=o[c];u.data().then(d=>{z8(d,u.dtype,e)})}return{kernelName:e,outputs:o,inputs:n,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:o,inputs:s,extraInfo:i}=e;r.forEach(a=>{Promise.all([a.data(),o,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],s,l[2])})})}}function z8(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const o=t[r];if(isNaN(o)||!isFinite(o))return console.warn(`Found ${o} in the result of '${n}'`),!0}return!1}class W8{logKernelProfile(e,n,r,o,s,i){const a=typeof o=="number"?nc(`${o}ms`,9):o.error,l=nc(e,25),c=n.rank,u=n.size,d=nc(n.shape.toString(),14);let h="";for(const f in s){const p=s[f];if(p!=null){const m=p.shape||n.shape,g=m.length;h+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(t,e,n){const r={},o={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(r[h.id]){c.outputs.forEach(m=>r[m.id]=!0),f=!0,o[c.id]=!0;break}if(f)break}}const s={};s[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(s[c.outputs[d].id]){for(const h in u)s[u[h].id]=!0,i[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(o[c.id]&&i[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];r[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function U8(t,e,n,r){for(let o=e.length-1;o>=0;o--){const s=e[o],i=[];if(s.outputs.forEach(l=>{const c=t[l.id];c!=null?i.push(c):i.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const a=s.gradient(i);for(const l in s.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=s.inputs[l];if(!Bt(c.shape,u.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=r(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $I=20,$u=3,pv=7;function H8(t,e,n,r){const o=tt(e),s=G8(t,e,n,o),i=e.length,a=bp(t,e,n,o,s),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function G8(t,e,n,r){const o=me(e),s=r[r.length-1],i=new Array(s).fill(0),a=e.length,l=n==="complex64"?Ru(t):t;if(a>1)for(let c=0;c<o/s;c++){const u=c*s;for(let d=0;d<s;d++)i[d]=Math.max(i[d],Eu(l[u+d],0,n).length)}return i}function Eu(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(pv))} + ${parseFloat(t[1].toFixed(pv))}j`:Md(t)?r=`'${t}'`:n==="bool"?r=WR(t):r=parseFloat(t.toFixed(pv)).toString(),nc(r,e)}function WR(t){return t===0?"false":"true"}function bp(t,e,n,r,o,s=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=Ru(t);return[Eu(m[0],0,n)]}return n==="bool"?[WR(t[0])]:[t[0].toString()]}if(l===1){if(a>$I){const g=$u*i;let b=Array.from(t.slice(0,g)),v=Array.from(t.slice((a-$u)*i,a*i));return n==="complex64"&&(b=Ru(b),v=Ru(v)),["["+b.map((w,y)=>Eu(w,o[y],n)).join(", ")+", ..., "+v.map((w,y)=>Eu(w,o[a-$u+y],n)).join(", ")+"]"]}return["["+(n==="complex64"?Ru(t):Array.from(t)).map((g,b)=>Eu(g,o[b],n)).join(", ")+"]"]}const c=e.slice(1),u=r.slice(1),d=r[0]*i,h=[];if(a>$I){for(let m=0;m<$u;m++){const g=m*d,b=g+d;h.push(...bp(t.slice(g,b),c,n,u,o,!1))}h.push("...");for(let m=a-$u;m<a;m++){const g=m*d,b=g+d;h.push(...bp(t.slice(g,b),c,n,u,o,m===a-1))}}else for(let m=0;m<a;m++){const g=m*d,b=g+d;h.push(...bp(t.slice(g,b),c,n,u,o,m===a-1))}const f=l===2?",":"";h[0]="["+h[0]+f;for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(s?"":p),h}function Ru(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pr{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=me(e),r!=null){const o=r.length;D(o===this.size,()=>`Length of values '${o}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Dn(n,this.size),this.strides=tt(e)}set(e,...n){n.length===0&&(n=[0]),D(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const o of e){if(o<0||o>=this.shape[n]){const s=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(s)}n++}let r=e[e.length-1];for(let o=0;o<e.length-1;++o)r+=this.strides[o]*e[o];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return jo().makeTensor(this.values,this.shape,this.dtype)}}let jo=null,jl=null;function j8(t){jo=t}function K8(t){jl=t}class An{constructor(e,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=me(e),this.strides=tt(e),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return jl.buffer(this.shape,this.dtype,e)}bufferSync(){return jl.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Jo(this.shape,e,this.dtype==="complex64")}arraySync(){return Jo(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=jo().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Wi(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),jo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=jo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Wi(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await jo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(jo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return jl.print(this,e)}clone(){return this.throwIfDisposed(),jl.clone(this)}toString(e=!1){const n=this.dataSync();return H8(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),jl.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),jo().makeVariable(this,e,n,r)}}Object.defineProperty(An,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function fe(){return Ry("Tensor",()=>An)}fe();class Wp extends An{constructor(e,n,r,o){super(e.shape,e.dtype,e.dataId,o),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Bt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);jo().disposeTensor(this),this.dataId=e.dataId,jo().incRef(this,null)}dispose(){jo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Wp,Symbol.hasInstance,{value:t=>t instanceof An&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var SI;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(SI||(SI={}));var Ax;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Ax||(Ax={}));var Dx;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Dx||(Dx={}));var Fx;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Fx||(Fx={}));var Ox;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Ox||(Ox={}));const q8={float32:Fx,int32:Ax,bool:Dx,complex64:Ox};function Jr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return q8[t][e]}function C1(t){return Jr(t,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kn(t,e){if(t.dtype===e.dtype)return[t,e];const n=Jr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function VR(t){const e=[];return UR(t,e,new Set),e}function UR(t,e,n){if(t==null)return;if(t instanceof An){e.push(t);return}if(!X8(t))return;const r=t;for(const o in r){const s=r[o];n.has(s)||(n.add(s),UR(s,e,n))}}function X8(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mv(t){return t.kernelName!=null}class II{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class yc{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new II}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(ao(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new B8(this.backendInstance),!0}setupRegisteredKernels(){gI(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){gI(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof ky)&&typeof r.then=="function"){const o=++this.pendingBackendInitId,s=r.then(i=>o<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(o<this.pendingBackendInitId||(this.pendingBackendInit=null,ao(`Initialization of backend ${e} failed`),ao(i.stack||i.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return ao(`Initialization of backend ${e} failed`),ao(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:o,asyncInit:s}=this.initializeBackend(r);if(s||o)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),o=r.backend,s=this.readSync(n),i=o.refCount(n);o.disposeData(n,!0),r.backend=e,e.move(n,s,r.shape,r.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let o;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(o),()=>(o=n(),o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),o))}scopedRun(e,n,r){e();try{const o=r();return n(),o}catch(o){throw n(),o}}nextTensorId(){return yc.nextTensorId++}nextVariableId(){return yc.nextVariableId++}clone(e){const n=Z.runKernel(sh,{x:e}),r={x:e},o=i=>({x:()=>{const a="float32",l={x:i},c={dtype:a};return Z.runKernel(jd,l,c)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[n],o,s,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(pI(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const o=this.backend.numDataIds();let s=0;r.forEach(l=>{s+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=o-n-s-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const o=this.isTapeOn(),s=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=mv(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(mv(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const b=pI(p,this.backendName);D(b!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const v=this.backend.numDataIds();l=b.kernelFunc({inputs:m,attrs:g,backend:this.backend});const w=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,v,w);const y=w.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(o){const C=this.getTensorsForGradient(p,m,y);r=this.saveTensorsForBackwardMode(C)}return y}}else{const{forwardFunc:p}=e,m=g=>{!o||(r=g.map(b=>this.keep(this.clone(b))))};a=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const b=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,g,b),b}}const{inputs:u,attrs:d}=e,h=mv(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),o&&this.addTapeNode(c,u,n,h,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const o=mI(e);if(o!=null){const s=o.inputsToSave||[],i=o.outputsToSave||[];let a;o.saveAllInputs?(D(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=s.map(c=>n[c]);const l=r.filter((c,u)=>i[u]);return a.concat(l)}return[]}makeTensor(e,n,r,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;let s=e;r==="string"&&Md(e[0])&&(s=e.map(l=>Di(l)));const i=o.write(s,n,r),a=new An(n,r,i,this.nextTensorId());if(this.trackTensor(a,o),r==="string"){const l=this.state.tensorInfo.get(i),c=v8(s);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,r,o){r=r||"float32";const s={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(s,o)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:o,dtype:s}=e,i=new An(o,s,r,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,r,o){r=r||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.cast(o));const s=new Wp(e,n,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Cx(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Wp||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Cx(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const o of this.state.activeProfile.kernels)o.kernelTimeMs=await o.kernelTimeMs,o.extraInfo=await o.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,o,s,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:s},l=mI(e);l!=null&&(o=l.gradFunc),o!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=r[d],f=gr(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),o(c.length>1?c:c[0],s,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=VR(e),r=new Set(n.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){const i=this.state.activeScope.track[s];!i.kept&&!r.has(i.id)&&i.dispose()}const o=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(s=>{!s.kept&&s.scopeId===o.id&&this.track(s)})}gradients(e,n,r,o=!1){if(D(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));D(s instanceof An,()=>"The result y returned by f() must be a tensor.");const i=V8(this.state.activeTape,n,s);if(!o&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[s.id]=r==null?Y8(s.shape):r,U8(a,i,c=>this.tidy(c),Z8);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:s,grads:l}})}customGrad(e){return D(Sx(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{D(n.every(a=>a instanceof An),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const o={};n.forEach((a,l)=>{o[l]=a});const s=(a,l)=>(r=e(...n,l),D(r.value instanceof An,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),D(Sx(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i=(a,l)=>{const c=r.gradFunc(a,l),u=Array.isArray(c)?c:[c];D(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),D(u.every(h=>h instanceof An),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:s,backwardsFunc:i,inputs:o})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=_r(),r=await this.backend.time(e);return r.wallMs=_r()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new II;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}yc.nextTensorId=0;yc.nextVariableId=0;function Y8(t){const e=Ey(me(t),"float32");return Z.makeTensor(e,t,"float32")}function HR(){const t=vR();if(t._tfengine==null){const e=new y8(t);t._tfengine=new yc(e)}return S8(t._tfengine.ENV),j8(()=>t._tfengine),t._tfengine}const Z=HR();function Z8(t,e){const n={a:t,b:e};return Z.runKernel(qc,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J8(){return typeof navigator<"u"&&navigator!=null}function GR(t){if(t||J8()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function jR(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const po=ue();po.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});po.registerFlag("IS_BROWSER",()=>jR());po.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");po.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));po.registerFlag("PROD",()=>!1);po.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>po.getBool("DEBUG"));po.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);po.registerFlag("IS_TEST",()=>!1);po.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);po.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);po.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);po.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hg(t,e){let n=t;if(Ps(t))return e==="string"?[]:[t.length];if(typeof t=="object"&&"texture"in t){const o=t.channels||"RGBA";return[t.height,t.width*o.length]}if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Ps(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&ue().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&KR(t,r,[]),r}function KR(t,e,n){if(n=n||[],!Array.isArray(t)&&!Ps(t)){D(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}D(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),D(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let o=0;o<t.length;++o)KR(t[o],r,n.concat(o))}function kI(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function M(t,e,n,r="numeric"){if(t instanceof An)return kI(r,t.dtype,e,n),t;let o=Ld(t);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),kI(r,o,e,n),t==null||!Ps(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const s=Hg(t,o);!Ps(t)&&!Array.isArray(t)&&(t=[t]);const a=o!=="string"?yl(t,o):bc(t,[],!0);return Z.makeTensor(a,s,o)}function qR(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((s,i)=>M(s,`${e}[${i}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q8="__op";function J(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Q8;const o=(...s)=>{Z.startScope(n);try{const i=r(...s);return gR(i)&&console.error("Cannot return a Promise inside of tidy."),Z.endScope(i),i}catch(i){throw Z.endScope(null),i}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(t,e){const n=M(t,"real","complex"),r=M(e,"imag","complex");zo(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const o={real:n,imag:r};return Z.runKernel(Py,o)}const Qa=J({complex_:eK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gg(t,e,n,r){if(r==null&&(r=Ld(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(typeof t=="object"&&"texture"in t){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from texture only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return t.channels=t.channels||"RGBA",Z.backend.createTensorFromTexture(t,e||n,r)}if(!Ps(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ai(e);const o=me(e),s=me(n);D(o===s,()=>`Based on the provided shape, [${e}], the tensor should have ${o} values but has ${s}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==me(e.slice(i)):!0;D(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Ps(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?yl(t,r):bc(t,[],!0),Z.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oc(t,e,n){const r=Hg(t,n);return Gg(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TI={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vp=4;async function EI(t,e){const n=[],r=[],o=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<o.length;++i){const a=o[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((g,b)=>g+b.length,0)+Vp*h.length,p=new Uint8Array(f);let m=0;for(let g=0;g<h.length;g++){const b=h[g],v=new Uint8Array(new Uint32Array([b.length]).buffer);p.set(v,m),m+=Vp,p.set(b,m),m+=b.length}d(p)});r.push(u)}else r.push(l.data());e!=null&&(c.group=e),n.push(c)}const s=await Promise.all(r);return{data:nK(s),specs:n}}function tK(t,e){const n={};let r,o=0;for(const s of e){const i=s.name,a=s.dtype,l=s.shape,c=me(l);let u;if("quantization"in s){const d=s.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${s.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(a!=="float32")throw new Error(`Weight ${s.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${a}.`)}else throw new Error(`Weight ${s.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const h=TI[d.dtype],f=t.slice(o,o+c*h),p=d.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(a==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){u=new Float32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];u[m]=g*d.scale+d.min}}else if(d.dtype==="float16")r===void 0&&(r=dK()),u=r(p);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(a==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);u=new Int32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];u[m]=Math.round(g*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);o+=c*h}else if(a==="string"){const d=me(s.shape);u=[];for(let h=0;h<d;h++){const f=new Uint32Array(t.slice(o,o+Vp))[0];o+=Vp;const p=new Uint8Array(t.slice(o,o+f));u.push(p),o+=f}}else{const d=TI[a],h=t.slice(o,o+c*d);if(a==="float32")u=new Float32Array(h);else if(a==="int32")u=new Int32Array(h);else if(a==="bool")u=new Uint8Array(h);else if(a==="complex64"){u=new Float32Array(h);const f=new Float32Array(u.length/2),p=new Float32Array(u.length/2);for(let b=0;b<f.length;b++)f[b]=u[b*2],p[b]=u[b*2+1];const m=oc(f,l,"float32"),g=oc(p,l,"float32");n[i]=Qa(m,g),m.dispose(),g.dispose()}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);o+=c*d}a!=="complex64"&&(n[i]=oc(u,l,a))}return n}function nK(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(s=>{if(e+=s.byteLength,n.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(e);let o=0;return n.forEach(s=>{r.set(new Uint8Array(s.buffer),o),o+=s.byteLength}),r.buffer}const $1=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function RI(t){return $1?Buffer.byteLength(t):new Blob([t]).size}function rK(t){if($1)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,o=e.length;r<o;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function oK(t){if($1){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function XR(t){if(t.length===1)return t[0];let e=0;t.forEach(o=>{e+=o.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(o=>{n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function YR(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function sK(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function iK(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),sK(t,n,r)}function jg(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:RI(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:RI(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}function aK(t){const e=[];for(const n of t)e.push(...n.weights);return e}function lK(){const t=n=>{let r=n<<13,o=0;for(;(r&8388608)===0;)o-=8388608,r<<=1;return r&=-8388609,o+=947912704,r|o},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function cK(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function uK(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function dK(){const t=lK(),e=cK(),n=uK();return r=>{const o=new ArrayBuffer(4*r.length),s=new Uint32Array(o);for(let i=0;i<r.length;i++){const a=r[i],l=t[n[a>>10]+(a&1023)]+e[a>>10];s[i]=l}return new Float32Array(o)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ln{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Ln.instance==null&&(Ln.instance=new Ln),Ln.instance}static registerSaveRouter(e){Ln.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Ln.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Ln.getHandlers(e,"save")}static getLoadHandlers(e,n){return Ln.getHandlers(e,"load",n)}static getHandlers(e,n,r){const o=[];return(n==="load"?Ln.getInstance().loadRouters:Ln.getInstance().saveRouters).forEach(i=>{const a=i(e,r);a!==null&&o.push(a)}),o}}const hK=t=>Ln.getSaveHandlers(t),fK=(t,e)=>Ln.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Px="tensorflowjs",Mx=1,Oa="models_store",ki="model_info_store";function ZR(){if(!ue().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Lx(t){const e=t.result;e.createObjectStore(Oa,{keyPath:"modelPath"}),e.createObjectStore(ki,{keyPath:"modelPath"})}class el{constructor(e){if(this.indexedDB=ZR(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,o)=>{const s=this.indexedDB.open(Px,Mx);s.onupgradeneeded=()=>Lx(s),s.onsuccess=()=>{const i=s.result;if(n==null){const a=i.transaction(Oa,"readonly"),c=a.objectStore(Oa).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),o(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=u=>(i.close(),o(c.error)),a.oncomplete=()=>i.close()}else{const a=jg(n),l=i.transaction(ki,"readwrite");let c=l.objectStore(ki);const u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a});let d;u.onsuccess=()=>{d=i.transaction(Oa,"readwrite");const f=d.objectStore(Oa).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a});f.onsuccess=()=>r({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(ki);const m=c.delete(this.modelPath);m.onsuccess=()=>(i.close(),o(f.error)),m.onerror=g=>(i.close(),o(f.error))}},u.onerror=h=>(i.close(),o(u.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},s.onerror=i=>o(s.error)})}}el.URL_SCHEME="indexeddb://";const JR=t=>ue().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(el.URL_SCHEME)?pK(t.slice(el.URL_SCHEME.length)):null;Ln.registerSaveRouter(JR);Ln.registerLoadRouter(JR);function pK(t){return new el(t)}function mK(t){return t.startsWith(el.URL_SCHEME)?t.slice(el.URL_SCHEME.length):t}class gK{constructor(){this.indexedDB=ZR()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(Px,Mx);r.onupgradeneeded=()=>Lx(r),r.onsuccess=()=>{const o=r.result,s=o.transaction(ki,"readonly"),a=s.objectStore(ki).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(o.close(),n(a.error)),s.oncomplete=()=>o.close()},r.onerror=o=>n(r.error)})}async removeModel(e){return e=mK(e),new Promise((n,r)=>{const o=this.indexedDB.open(Px,Mx);o.onupgradeneeded=()=>Lx(o),o.onsuccess=()=>{const s=o.result,i=s.transaction(ki,"readwrite"),a=i.objectStore(ki),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return s.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=s.transaction(Oa,"readwrite");const f=c.objectStore(Oa).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>r(l.error)};u.onsuccess=d,u.onerror=h=>(d(),s.close(),r(l.error))}},l.onerror=u=>(s.close(),r(l.error)),i.oncomplete=()=>{c==null?s.close():c.oncomplete=()=>s.close()}},o.onerror=s=>r(o.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qs="/",Kl="tensorflowjs_models",QR="info",bK="model_topology",vK="weight_specs",xK="weight_data",yK="model_metadata";function eN(t){return{info:[Kl,t,QR].join(qs),topology:[Kl,t,bK].join(qs),weightSpecs:[Kl,t,vK].join(qs),weightData:[Kl,t,xK].join(qs),modelMetadata:[Kl,t,yK].join(qs)}}function tN(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function wK(t){const e=t.split(qs);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(qs)}function CK(t){return t.startsWith(tl.URL_SCHEME)?t.slice(tl.URL_SCHEME.length):t}class tl{constructor(e){if(!ue().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=eN(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),o=jg(e);try{this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,rK(e.weightData));const s={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(s)),{modelArtifactsInfo:o}}catch{throw tN(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const o=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(o==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=o;const s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){const a=JSON.parse(s);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=oK(i),n}}tl.URL_SCHEME="localstorage://";const nN=t=>ue().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(tl.URL_SCHEME)?$K(t.slice(tl.URL_SCHEME.length)):null;Ln.registerSaveRouter(nN);Ln.registerLoadRouter(nN);function $K(t){return new tl(t)}class SK{constructor(){D(ue().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),D(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Kl+qs,r=qs+QR;for(let o=0;o<this.LS.length;++o){const s=this.LS.key(o);if(s.startsWith(n)&&s.endsWith(r)){const i=wK(s);e[i]=JSON.parse(this.LS.getItem(s))}}return e}async removeModel(e){e=CK(e);const n=eN(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return tN(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NI="://";class vs{constructor(){this.managers={}}static getInstance(){return vs.instance==null&&(vs.instance=new vs),vs.instance}static registerManager(e,n){D(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(NI)&&(e=e.slice(0,e.indexOf(NI))),D(e.length>0,()=>"scheme must not be an empty string.");const r=vs.getInstance();D(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=vs.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(vs.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IK{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!ue().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const o=this.functionRefs[r.data.index];o(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(ue().get("IS_BROWSER")){ue().setPlatform("browser",new IK);try{vs.registerManager(tl.URL_SCHEME,new SK)}catch{}try{vs.registerManager(el.URL_SCHEME,new gK)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK={importFetch:()=>require("node-fetch")};let gv;class TK{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return ue().global.fetch!=null?ue().global.fetch(e,n):(gv==null&&(gv=kK.importFetch()),gv(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}}ue().get("IS_NODE")&&!ue().get("IS_BROWSER")&&ue().setPlatform("node",new TK);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wt(t,e="float32",n){return e=e||"float32",ai(t),new pr(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EK(t,e){const n=M(t,"x","cast");if(!b8(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},o={dtype:e};return Z.runKernel(jd,r,o)}const Ve=J({cast_:EK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RK(t){const n={x:M(t,"x","clone","string_or_numeric")};return Z.runKernel(sh,n)}const Ha=J({clone_:RK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NK(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */HR();const _K={buffer:wt,cast:Ve,clone:Ha,print:NK};K8(_K);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AK="model",DK=".json",FK=".weights.bin";function _I(t){return new Promise(e=>setTimeout(e)).then(t)}class nl{constructor(e){if(!ue().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(nl.URL_SCHEME)&&(e=e.slice(nl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=AK),this.modelJsonFileName=e+DK,this.weightDataFileName=e+FK}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=YR(e,r),s=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=s,await _I(()=>i.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;a.download=this.weightDataFileName,a.href=n,await _I(()=>a.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:jg(e)}}}}nl.URL_SCHEME="downloads://";const OK=t=>ue().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(nl.URL_SCHEME)?PK(t.slice(nl.URL_SCHEME.length)):null;Ln.registerSaveRouter(OK);function PK(t="model"){return new nl(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AI(t,e,n,r){i(t),n=n==null?0:n,r=r==null?1:r,a(n,r);let o=0;const s=l=>(l.then(c=>{const u=n+ ++o/t.length*(r-n);return e(u),c}),l);function i(l){D(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){D(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),D(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),D(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function MK(t,e){e==null&&(e={});const n=e.fetchFunc==null?ue().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),o=0,s=.5,a=(e.onProgress==null?await Promise.all(r):await AI(r,e.onProgress,o,s)).map(d=>d.arrayBuffer()),l=.5,c=1;return e.onProgress==null?await Promise.all(a):await AI(a,e.onProgress,l,c)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LK="application/octet-stream",BK="application/json";class S1{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(D(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ue().platform.fetch,D(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&D(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],o=YR(e,r);n.body.append("model.json",new Blob([JSON.stringify(o)],{type:BK}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:LK}),"model.weights.bin");const s=await this.fetch(this.path,n);if(s.ok)return{modelArtifactsInfo:jg(e),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const r=n.modelTopology,o=n.weightsManifest;if(r==null&&o==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return iK(n,s=>this.loadWeights(s))}async loadWeights(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,o]=zK(n),s=this.weightPathPrefix||r,i=aK(e),a=[],l=[];for(const u of e)for(const d of u.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(d)):a.push(s+d+o);this.weightUrlConverter&&a.push(...await Promise.all(l));const c=await MK(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,XR(c)]}}S1.URL_SCHEME_REGEX=/^https?:\/\//;function zK(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),o=n>e?t.substring(n):"";return[r+"/",o]}function DI(t){return t.match(S1.URL_SCHEME_REGEX)!=null}const rN=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>DI(r)):n=DI(t),n)return oN(t,e)}return null};Ln.registerSaveRouter(rN);Ln.registerLoadRouter(rN);function oN(t,e){return new S1(t,e)}function WK(t,e){return oN(t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VK(t,e,n=!1,r=!1){let o=M(t,"a","matMul"),s=M(e,"b","matMul");[o,s]=kn(o,s);const i={a:o,b:s},a={transposeA:n,transposeB:r};return Z.runKernel(qm,i,a)}const Lt=J({matMul_:VK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UK(t,e,n=1,r=0,o="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:M(t,"indices","oneHot","int32")},a={dtype:o,depth:e,onValue:n,offValue:r};return Z.runKernel(Ig,i,a)}const sN=J({oneHot_:UK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bs(){return Z}function Bx(){return Z.memory()}function ie(t,e){return Z.tidy(t,e)}function yt(t){VR(t).forEach(n=>n.dispose())}function Rs(t){return Z.keep(t)}function iN(t,e,n=1){return Z.registerBackend(t,e,n)}function HK(){return Z.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GK(t){const n={input:M(t,"input","imag")};return Z.runKernel(Zy,n)}const I1=J({imag_:GK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jK(t){const n={x:M(t,"x","neg")};return Z.runKernel(Cg,n)}const yn=J({neg_:jK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KK(t){const n={input:M(t,"input","real")};return Z.runKernel(s1,n)}const Up=J({real_:KK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qK(t,e,n){const r=M(t,"x","transpose");if(e==null&&(e=r.shape.map((i,a)=>a).reverse()),D(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(i=>{D(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const o={x:r},s={perm:e};return r.dtype==="complex64"?ie(()=>{let i=Up(r),a=I1(r);return i=Z.runKernel(rc,{x:i},s),a=Z.runKernel(rc,{x:a},s),n&&(a=yn(a)),Qa(i,a)}):Z.runKernel(rc,o,s)}const Et=J({transpose_:qK});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wc(t,e){const n=t.length,r=[];for(let o=0;o<n;o++){const s=n-1-o,i=t[s]||1;(e[e.length-1-o]||1)>1&&i===1&&r.unshift(s)}return r}function Kn(t,e){const n=[];for(let r=0;r<e.length;r++){const o=t[t.length-r-1],s=e.length-r-1,i=e[s];(o==null||o===1&&i>1)&&n.unshift(s)}return n}function bt(t,e){const n=[],r=Math.max(t.length,e.length);for(let o=0;o<r;o++){let s=t[t.length-o-1];s==null&&(s=1);let i=e[e.length-o-1];if(i==null&&(i=1),s===1)n.unshift(i);else if(i===1)n.unshift(s);else if(s!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else n.unshift(s)}return n}function k1(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(me(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const o=e.shape,s=o[o.length-1];let i=1;for(let d=0;d<o.length-1;++d)i*=o[d];const a=t.shape,l=o.slice();l.pop();let c=1;for(let d=s;d<n;++d)c*=a[d],l.push(a[d]);const u=[...tt(t.shape).map(d=>d/c),1].slice(0,s);return[l,i,c,u]}function aN(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${o}.`;if(n.rank<o)throw new Error(s+` update.rank < ${o}. `);if(t.length<r+(n.rank-o))throw new Error(s+` Output shape length < ${r+(n.rank-o)}`);if(n.rank!==o+t.length-r)throw new Error(s+` update.rank != ${o+t.length-r}`);for(let i=0;i<o;++i)if(n.shape[i]!==e.shape[i])throw new Error(s+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-o;++i)if(n.shape[i+o]!==t[i+r])throw new Error(s+` updates.shape[${i+o}] (${n.shape[i+o]}) != shape[${i+o}] (${t[i+o]})`)}function XK(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}aN(n,e,t)}function Fh(t,e,n){const r=e.shape.length,o=r>1?e.shape[r-1]:1,s=n.length;let i=1;for(let d=o;d<s;++d)i*=n[d];const a=o<1?1:o,l=me(e.shape)/a,c=[...tt(n.slice(0,o)),1],u=me(n);return{sliceRank:o,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zx=-2,YK=-1;function T1(t,e,n){const r=t.shape.length;D(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),D(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let o=0;o<r;++o)D(e[o]+n[o]<=t.shape[o],()=>`Error in slice${r}D: begin[${o}] + size[${o}] (${e[o]+n[o]}) would overflow input.shape[${o}] (${t.shape[o]})`)}function ZK(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function E1(t,e,n){const r=[];for(let o=0;o<t.length;o++)r[o]=Math.ceil((e[o]-t[o])/n[o]);return r}function lN(t,e,n,r){const o=[...t];for(let s=o.length;s<r.length;s++)o.push(1);for(let s=0;s<n;s++)s===0?o[e]=1:(o.splice(e,0,1),o.pop());return o}function cN(t,e,n){return n<=t?n:n-(e-1)}function uN(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function JK(t,e,n,r,o,s,i,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=dN(i,f,p,r,t),d=hN(a,f,p,o,t),h=lN(s,f,p,t)}else for(let f=0;f<c;f++)u[f]=pN(i,r,s,t,f,l),d[f]=mN(a,o,s,t,f,l),h[f]=fN(s,f,l);return{begin:u,end:d,strides:h}}function dN(t,e,n,r,o){const s=[...o],i=uN(n,e);for(let a=0;a<s.length;a++)if(i.indexOf(a)>-1)s[a]=0;else{const l=cN(e,n,a);let c=r[l];t&1<<l&&(c=0),s[a]=c}return s}function hN(t,e,n,r,o){const s=[...o],i=uN(n,e);for(let a=0;a<s.length;a++)if(i.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{const l=cN(e,n,a);let c=r[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),s[a]=c}for(let a=0;a<s.length;a++){const l=o[a];s[a]<0&&(s[a]+=l),s[a]=Ja(0,s[a],o[a])}return s}function fN(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function pN(t,e,n,r,o,s){let i=e[o];const a=n[o]||1;(t&1<<o||s&1<<o||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=r[o];return i<0&&(i+=l),i=Ja(0,i,l-1),i}function mN(t,e,n,r,o,s){let i=e[o];const a=n[o]||1;(t&1<<o||s&1<<o||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=r[o];return i<0&&(i+=l),a>0?i=Ja(0,i,l):i=Ja(-1,i,l-1),i}function R1(t,e,n){let r=n.length;for(let o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(let o=r+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function N1(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function Kg(t,e,n){let r;const o=t.shape.length;typeof e=="number"?r=[e,...new Array(o-1).fill(0)]:e.length<o?r=e.concat(new Array(o-e.length).fill(0)):r=e.slice(),r.forEach(i=>{D(i!==-1,()=>"slice() does not support negative begin indexing.")});let s;return n==null?s=new Array(o).fill(-1):typeof n=="number"?s=[n,...new Array(o-1).fill(-1)]:n.length<o?s=n.concat(new Array(o-n.length).fill(-1)):s=n,s=s.map((i,a)=>i>=0?i:(D(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,s]}function _1(t,e,n,r,o,s,i,a,l){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:o,endMask:s,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let w=0;w<d.dims;w++)u&&(1<<w&a)!==0&&d.numAddAxisAfterEllipsis++,1<<w&i&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};QK(d,h);let f=!0,p=!0,m=!0;const g=[],b=[];for(let w=0;w<t.length;++w){if(h.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const y=!!(h.shrinkAxisMask&1<<w),C=t[w];if(C===-1){g.push(y?1:-1);continue}const S=[h.beginMask&1<<w,h.endMask&1<<w],$=[h.strides[w]>0?0:-1,h.strides[w]>0?C:C-1];if(y&&h.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[w]===1;const I=!!(h.beginMask&1<<w&&h.endMask&1<<w);if(h.beginValid&&h.endValid){if(y){const _=h.begin[w]<0?C+h.begin[w]:h.begin[w];if(h.begin[w]=_,h.end[w]=h.begin[w]+1,_<0||_>=C)throw Error(`slice index ${h.begin[w]} of dimension ${w} out of bounds.`)}else h.begin[w]=FI(h.begin[w],0,h.strides[w],C,S,$),h.end[w]=FI(h.end[w],1,h.strides[w],C,S,$);const N=h.strides[w]===1&&h.begin[w]===0&&h.end[w]===C;f=f&&N,p=p&&(w===0&&h.strides[w]===1||N)}else f=f&&h.strides[w]===1&&I,p=p&&(w===0&&h.strides[w]===1||I);let R,T=!1;if(h.beginValid&&h.endValid?(R=h.end[w]-h.begin[w],T=!0):y?(R=1,T=!0):I&&C>=0&&(h.strides[w]<0?R=-C:R=C,T=!0),T){let N;R===0||R<0!=h.strides[w]<0?N=0:N=Math.trunc(R/h.strides[w])+(R%h.strides[w]!==0?1:0),g.push(N)}else g.push(-1)}for(let w=0;w<h.finalShapeGatherIndices.length;++w){const y=h.finalShapeGatherIndices[w];y>=0?b.push(g[y]):y===zx&&b.push(1)}return{finalShapeSparse:b.filter((w,y)=>h.finalShapeGatherIndices[y]!==zx),finalShape:b,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function QK(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const o=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<o;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(zx),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(YK),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function FI(t,e,n,r,o,s){if(o[e])return n>0?s[e]:s[e+1&1];{const i=t<0?r+t:t;return i<s[0]?s[0]:i>s[1]?s[1]:i}}const e9=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:T1,maskToAxes:ZK,computeOutShape:E1,stridesWithElidedDims:lN,getNormalizedAxes:JK,startIndicesWithElidedDims:dN,stopIndicesWithElidedDims:hN,stridesForAxis:fN,startForAxis:pN,stopForAxis:mN,isSliceContinous:R1,computeFlatOffset:N1,parseSliceParams:Kg,sliceInfo:_1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xc{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class ko{constructor(){this.classNameMap={}}static getMap(){return ko.instance==null&&(ko.instance=new ko),ko.instance}static register(e){ko.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Te(t){D(t.className!=null,()=>"Class being registered does not have the static className property defined."),D(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),D(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),ko.register(t)}/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9(t,e){let n=M(t,"a","add"),r=M(e,"b","add");[n,r]=kn(n,r);const o={a:n,b:r};return Z.runKernel(qc,o)}const Re=J({add_:t9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n9(t,e){let n=M(t,"a","floorDiv"),r=M(e,"b","floorDiv");[n,r]=kn(n,r);const o={a:n,b:r};return Z.runKernel(rh,o)}const gN=J({floorDiv_:n9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r9(t,e){let n=M(t,"a","div"),r=M(e,"b","div");if([n,r]=kn(n,r),n.dtype==="int32"&&r.dtype==="int32")return gN(n,r);const o={a:n,b:r},s={};return Z.runKernel(Zd,o,s)}const et=J({div_:r9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(t,e){let n=M(t,"a","mul"),r=M(e,"b","mul");[n,r]=kn(n,r);const o={a:n,b:r};return Z.runKernel(ph,o)}const q=J({mul_:o9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(t){const e=M(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return Z.runKernel(Ym,n)}else{const n={x:e};return Z.runKernel(Um,n)}}const Xn=J({abs_:s9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(t){const n={x:M(t,"x","acos")};return Z.runKernel(Bd,n)}const a9=J({acos_:i9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(t){const n={x:M(t,"x","acosh")};return Z.runKernel(zd,n)}const c9=J({acosh_:l9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(t,e=null,n=!1){const o={x:M(t,"x","all","bool")},s={axis:e,keepDims:n};return Z.runKernel(_y,o,s)}const bN=J({all_:u9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d9(t,e=null,n=!1){const o={x:M(t,"x","any","bool")},s={axis:e,keepDims:n};return Z.runKernel(Ay,o,s)}const Wx=J({any_:d9});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(t,e=0){const r={x:M(t,"x","argMax")},o={axis:e};return Z.runKernel(Hm,r,o)}const md=J({argMax_:h9});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(t,e=0){const r={x:M(t,"x","argMin")},o={axis:e};return Z.runKernel(Gm,r,o)}const p9=J({argMin_:f9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(t){const n={x:M(t,"x","asin")};return Z.runKernel(Wd,n)}const g9=J({asin_:m9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(t){const n={x:M(t,"x","asinh")};return Z.runKernel(Vd,n)}const v9=J({asinh_:b9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(t){const n={x:M(t,"x","atan")};return Z.runKernel(Ud,n)}const y9=J({atan_:x9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(t,e){let n=M(t,"a","atan2"),r=M(e,"b","atan2");[n,r]=kn(n,r);const o={a:n,b:r};return Z.runKernel(Gd,o)}const C9=J({atan2_:w9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9(t){const n={x:M(t,"x","atanh")};return Z.runKernel(Hd,n)}const S9=J({atanh_:$9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oh(t,e,n,r,o="NHWC",s){const i=t[3],a=[...e,i],l=ci(o);return ir(t,a,n,s,r,null,null,l)}function Wo(t,e,n,r,o,s,i="channelsLast"){const[a,l]=Hp(e);let c;if(i==="channelsLast")c=[a,l,t[3],t[3]];else if(i==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return ir(t,c,n,r,o,s,!1,i)}function li(t,e,n,r,o,s,i="NDHWC"){const[a,l,c]=Vx(e);let u,d;if(i==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Qi(t,u,n,r,o,!1,d,s)}function ir(t,e,n,r,o,s,i=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[m,g]=Hp(n),[b,v]=Hp(r),w=sc(h,b),y=sc(f,v),{padInfo:C,outHeight:S,outWidth:$}=T9(o,c,u,m,g,w,y,s,a),I=i?p*d:p;let R;return a==="channelsFirst"?R=[l,I,S,$]:a==="channelsLast"&&(R=[l,S,$,I]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:S,outWidth:$,outChannels:I,padInfo:C,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:f,effectiveFilterHeight:w,effectiveFilterWidth:y,dilationHeight:b,dilationWidth:v,inShape:t,outShape:R,filterShape:e}}function Qi(t,e,n,r,o,s=!1,i="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,d,h]=t;else if(i==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[f,p,m,,g]=e,[b,v,w]=Vx(n),[y,C,S]=Vx(r),$=sc(f,y),I=sc(p,C),R=sc(m,S),{padInfo:T,outDepth:N,outHeight:_,outWidth:P}=E9(o,c,u,d,b,v,w,$,I,R,a),z=s?g*h:g;let L;return i==="channelsFirst"?L=[l,z,N,_,P]:i==="channelsLast"&&(L=[l,N,_,P,z]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:N,outHeight:_,outWidth:P,outChannels:z,padInfo:T,strideDepth:b,strideHeight:v,strideWidth:w,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:$,effectiveFilterHeight:I,effectiveFilterWidth:R,dilationDepth:y,dilationHeight:C,dilationWidth:S,inShape:t,outShape:L,filterShape:e}}function I9(t,e,n,r,o){r==null&&(r=A1(t,e,n));const s=t[0],i=t[1],a=Ga((s-e+2*r)/n+1,o),l=Ga((i-e+2*r)/n+1,o);return[a,l]}function k9(t,e,n,r,o,s){o==null&&(o=A1(t,e,r));const i=t[0],a=t[1],l=t[2],c=Ga((i-e+2*o)/r+1,s),u=Ga((a-e+2*o)/r+1,s),d=Ga((l-e+2*o)/r+1,s);return[c,u,d,n]}function A1(t,e,n,r=1){const o=sc(e,r);return Math.floor((t[0]*(n-1)-n+o)/2)}function Hp(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Vx(t){return typeof t=="number"?[t,t,t]:t}function sc(t,e){return e<=1?t:t+(t-1)*(e-1)}function T9(t,e,n,r,o,s,i,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=I9([e,n],s,r,t,a);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/r),d=Math.ceil(n/o);const h=Math.max(0,(u-1)*r+s-e),f=Math.max(0,(d-1)*o+i-n),p=Math.floor(h/2),m=h-p,g=Math.floor(f/2),b=f-g;c={top:p,bottom:m,left:g,right:b,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-s+1)/r),d=Math.ceil((n-i+1)/o);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=Ga((e-s+h+f)/r+1,a),d=Ga((n-i+p+m)/o+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function E9(t,e,n,r,o,s,i,a,l,c,u){let d,h,f,p;if(typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const g=k9([e,n,r,1],a,1,o,t,u);h=g[0],f=g[1],p=g[2]}else if(t==="same"){h=Math.ceil(e/o),f=Math.ceil(n/s),p=Math.ceil(r/i);const m=(h-1)*o+a-e,g=(f-1)*s+l-n,b=(p-1)*i+c-r,v=Math.floor(m/2),w=m-v,y=Math.floor(g/2),C=g-y,S=Math.floor(b/2),$=b-S;d={top:y,bottom:C,left:S,right:$,front:v,back:w,type:"SAME"}}else if(t==="valid")d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((e-a+1)/o),f=Math.ceil((n-l+1)/s),p=Math.ceil((r-c+1)/i);else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function Ga(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function rl(t){const[e,n,r]=Hp(t);return e===1&&n===1&&r===1}function br(t,e){return rl(t)||rl(e)}function ci(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Lr(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")D(vc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(o=>{D(vc(o),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${o}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(t,e){const r={x:M(t,"x","reshape","string_or_numeric")},o={shape:e};return Z.runKernel(Ng,r,o)}const ee=J({reshape_:R9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(t,e,n,r,o){const s=M(t,"x","avgPool","float32"),i=1;D(br(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=s,l=!1;s.rank===3&&(l=!0,a=ee(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Lr("avgPool",r,o);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:o};let d=Z.runKernel(jm,c,u);return d=Ve(d,s.dtype),l?ee(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const D1=J({avgPool_:N9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(t,e,n,r,o,s="NDHWC"){const i=M(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=ee(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),D(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Lr("avgPool3d",r,o);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:o,dataFormat:s};let d=Z.runKernel(Km,c,u);return d=Ve(d,a.dtype),l?ee(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const A9=J({avgPool3d_:_9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(t,e=0){D(t.length>=1,()=>"Pass at least one tensor to concat");const n=qR(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),n.length===1)return Ha(n[0]);const r=n,o={axis:e};return Z.runKernel(Zm,r,o)}const mr=J({concat_:D9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(t){const n={x:M(t,"x","sigmoid","float32")};return Z.runKernel(Ih,n)}const Yc=J({sigmoid_:F9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(t,e,n){const r=M(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const o={x:r},s={begin:e,size:n};return Z.runKernel(Og,o,s)}const Vt=J({slice_:O9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(t){const n={x:M(t,"x","tanh","float32")};return Z.runKernel(_h,n)}const F1=J({tanh_:P9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(t,e,n){const r=M(t,"x","batchToSpaceND"),o=e.reduce((a,l)=>a*l);D(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),D(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),D(r.shape[0]%o===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${o}`);const s={x:r},i={blockShape:e,crops:n};return Z.runKernel(Xm,s,i)}const O1=J({batchToSpaceND_:M9});function L9(t){let e;return t.rank===0||t.rank===1?e=ee(t,[1,1,1,t.size]):t.rank===2?e=ee(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=ee(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(t,e,n,r,o,s){s==null&&(s=.001);const i=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let c;o!=null&&(c=M(o,"scale","batchNorm"));let u;r!=null&&(u=M(r,"offset","batchNorm")),D(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:L9(i),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:s},p=Z.runKernel(ig,h,f);return ee(p,i.shape)}const qg=J({batchNorm_:B9});function z9(t,e,n,r,o,s){const i=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let c;o!=null&&(c=M(o,"scale","batchNorm"));let u;return r!=null&&(u=M(r,"offset","batchNorm")),D(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),D(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),D(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),qg(i,a,l,u,c,s)}const W9=J({batchNorm2d_:z9});function V9(t,e,n,r,o,s){const i=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let c;o!=null&&(c=M(o,"scale","batchNorm"));let u;return r!=null&&(u=M(r,"offset","batchNorm")),D(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),D(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),D(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),qg(i,a,l,u,c,s)}const U9=J({batchNorm3d_:V9});function H9(t,e,n,r,o,s){const i=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let c;o!=null&&(c=M(o,"scale","batchNorm"));let u;return r!=null&&(u=M(r,"offset","batchNorm")),D(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),D(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),D(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),qg(i,a,l,u,c,s)}const G9=J({batchNorm4d_:H9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j9(t,e,n){const r=M(t,"x","bincount"),o=M(e,"weights","bincount");D(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(o.size===r.size||o.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${o.shape}.`);const s={x:r,weights:o},i={size:n};return Z.runKernel(Oy,s,i)}const K9=J({bincount_:j9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(t,e){let n=M(t,"broadcastTo","x");const r=n.shape;if(ai(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=ee(n,c)}const o=n.shape,s=Array.from(e);for(let c=e.length-1;c>=0;c--)if(o[c]===e[c])s[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(s.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Ha(n);const a={x:n},l={reps:s};return Z.runKernel(Ah,a,l)}const ju=J({broadcastTo_:q9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(t){const n={x:M(t,"x","ceil","float32")};return Z.runKernel(Kd,n)}const Y9=J({ceil_:X9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ph(t,e,n){ai(t);const r={shape:t,value:e,dtype:n};return Z.runKernel(qy,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(t,e,n){const r=M(t,"x","clipByValue");if(D(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Ph(r.shape,e,r.dtype);const o={x:r},s={clipValueMin:e,clipValueMax:n};return Z.runKernel(qd,o,s)}const mo=J({clipByValue_:Z9});function J9(t){return mr(t,0)}const Q9=J({concat1d_:J9});function e7(t,e){return mr(t,e)}const t7=J({concat2d_:e7});function n7(t,e){return mr(t,e)}const r7=J({concat3d_:n7});function o7(t,e){return mr(t,e)}const s7=J({concat4d_:o7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(t,e,n,r,o="NHWC",s=[1,1],i){const a=M(t,"x","conv2d","float32"),l=M(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=ee(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Lr("conv2d",r,i);const d=o==="NHWC"?c.shape[3]:c.shape[1];D(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),D(br(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const h={x:c,filter:l},f={strides:n,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i},p=Z.runKernel(Jm,h,f);return u?ee(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const ol=J({conv2d_:i7});function a7(t,e,n,r,o="NWC",s=1,i){const a=M(t,"x","conv1d"),l=M(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=ee(a,[1,a.shape[0],a.shape[1]])),D(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),D(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Lr("conv1d",r,i),D(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),D(br(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),D(o==="NWC",()=>`Error in conv1d: got dataFormat of ${o} but only NWC is currently supported.`);const d=ee(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=ee(c,[c.shape[0],1,c.shape[1],c.shape[2]]),g=ol(h,d,[1,n],r,"NHWC",[1,s],i);return u?ee(g,[g.shape[2],g.shape[3]]):ee(g,[g.shape[0],g.shape[2],g.shape[3]])}const vN=J({conv1d_:a7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(t,e,n,r,o,s="NHWC",i){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=ee(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),D(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),D(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),D(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=s==="NHWC"?a[3]:a[1],d=s==="NHWC"?l.shape[3]:l.shape[1];D(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),D(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Lr("conv2dDerInput",o,i);const h={dy:l,filter:n},f={strides:r,pad:o,dataFormat:s,dimRoundingMode:i,inputShape:a},p=Z.runKernel(Qm,h,f);return c?ee(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const P1=J({conv2DBackpropInput_:l7});function c7(t,e,n,r,o,s){const i=M(t,"x","conv2dTranspose"),a=M(e,"filter","conv2dTranspose");return P1(n,i,a,r,o,"NHWC",s)}const xN=J({conv2dTranspose_:c7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(t,e,n,r,o="NDHWC",s=[1,1,1]){const i=M(t,"x","conv3d"),a=M(e,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=ee(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),D(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),D(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),D(br(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),D(o==="NDHWC",()=>`Error in conv3d: got dataFormat of ${o} but only NDHWC is currently supported.`);const u={x:l,filter:a},d={strides:n,pad:r,dataFormat:o,dilations:s},h=Z.runKernel(eg,u,d);return c?ee(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const d7=J({conv3d_:u7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h7(t,e,n,r,o){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let s=t,i=e,a=!1;e.rank===4&&(a=!0,i=ee(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);const l=s[4],c=i.shape[4];D(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),D(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),D(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),D(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),D(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:i,filter:n},d={pad:o,strides:r,inputShape:s},h=Z.runKernel(By,u,d);return a?ee(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const yN=J({conv3DBackpropInput_:h7});function f7(t,e,n,r,o){const s=M(t,"x","conv3dTranspose"),i=M(e,"filter","conv3dTranspose");return yN(n,s,i,r,o)}const p7=J({conv3dTranspose_:f7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(t){const n={x:M(t,"x","cos","float32")};return Z.runKernel(Xd,n)}const M1=J({cos_:m7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7(t){const n={x:M(t,"x","cosh","float32")};return Z.runKernel(Yd,n)}const wN=J({cosh_:g7});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7(t,e=0,n=!1,r=!1){const s={x:M(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return Z.runKernel(zy,s,i)}const Ux=J({cumprod_:b7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v7(t,e=0,n=!1,r=!1){const s={x:M(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return Z.runKernel(tg,s,i)}const CN=J({cumsum_:v7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x7(t,e,n,r=!1){const o=M(t,"x","denseBincount"),s=M(e,"weights","denseBincount");D(o.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${o.dtype}`),D(o.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${o.rank}.`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(s.size===o.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${o.shape}, weights shape: ${s.shape}.`);const i={x:o,weights:s},a={size:n,binaryOutput:r};return Z.runKernel(Vy,i,a)}const OI=J({denseBincount_:x7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(t,e,n="NHWC"){const r=M(t,"x","depthToSpace","float32"),o=n==="NHWC"?r.shape[1]:r.shape[2],s=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];D(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),D(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e}  for depthToSpace with input shape
    ${r.shape}`),D(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e} for depthToSpace with input shape
        ${r.shape}`),D(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return Z.runKernel(Uy,a,l)}const w7=J({depthToSpace_:y7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(t,e,n,r,o="NHWC",s=[1,1],i){const a=M(t,"x","depthwiseConv2d","float32"),l=M(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=ee(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=o==="NHWC"?c.shape[3]:c.shape[1];D(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Lr("depthwiseConv2d",r,i);const h={x:c,filter:l},f={strides:n,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i},p=Z.runKernel(ng,h,f);return u?ee(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const L1=J({depthwiseConv2d_:C7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(t,e,n,r,o=[1,1],s="NHWC"){const i=M(t,"x","dilation2d"),a=M(e,"filter","dilation2d");D(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),D(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),D(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=i,c=!1;i.rank===3&&(l=ee(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0);const u={x:l,filter:a},d={strides:n,pad:r,dilations:o},h=Z.runKernel(rg,u,d);return c?ee(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const S7=J({dilation2d_:$7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(t,e){let n=M(t,"a","equal","string_or_numeric"),r=M(e,"b","equal","string_or_numeric");[n,r]=kn(n,r),bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(og,o)}const Ms=J({equal_:I7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7(t,e,n){const r=M(e,"a","where"),o=M(n,"b","where"),s=M(t,"condition","where","bool"),i=bt(bt(s.shape,r.shape),o.shape),a=ju(s,i),l=ju(r,i),c=ju(o,i),u={condition:a,t:l,e:c};return Z.runKernel(Fg,u)}const Qr=J({where_:k7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(t){const n={x:M(t,"x","zerosLike")};return Z.runKernel(Vg,n)}const Nt=J({zerosLike_:T7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(t,e){let n=M(t,"a","div"),r=M(e,"b","div");[n,r]=kn(n,r);const o=et(n,r),s=Nt(o),i=Ms(r,s);return Qr(i,s,o)}const R7=J({divNoNan_:E7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N7(t,e){const n=M(t,"t1","dot"),r=M(e,"t2","dot");D((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const o=n.rank===1?n.size:n.shape[1],s=r.rank===1?r.size:r.shape[0];if(D(o===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${o} and ${s}.`),n.rank===1&&r.rank===1){const i=ee(n,[1,-1]),a=ee(r,[-1,1]),l=Lt(i,a);return ee(l,[])}else if(n.rank===1&&r.rank===2){const i=ee(n,[1,-1]),a=ee(r,[r.shape[0],r.shape[1]]),l=Lt(i,a);return ee(l,[l.size])}else if(n.rank===2&&r.rank===1){const i=ee(r,[-1,1]),a=Lt(n,i);return ee(a,[a.size])}else{const i=ee(r,[r.shape[0],r.shape[1]]);return Lt(n,i)}}const _7=J({dot_:N7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7(t){const n={x:M(t,"x","elu","float32")};return Z.runKernel(Jd,n)}const Xg=J({elu_:A7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D7(t){let e=M(t,"x","erf");D(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ve(e,"float32"));const n={x:e};return Z.runKernel(Qd,n)}const F7=J({erf_:D7});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B1(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function $N(t,e,n){const r=t.length+e.length,o=[];let s=0,i=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?o.push(t[s++]):o.push(e[i++]);return o}function er(t,e){const n=[],r=t.length;for(let s=0;s<r;s++)e.indexOf(s)===-1&&n.push(t[s]);const o=e.map(s=>t[s]);return[n,o]}function Tn(t,e){const n=e.map(r=>1);return $N(t,n,e)}function ar(t,e,n){D(B1(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function wn(t,e){if(B1(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function ea(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function En(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7(t,e=null,n=!1){const o={x:M(t,"x","max")},s={reductionIndices:e,keepDims:n};return Z.runKernel(gg,o,s)}const Qo=J({max_:O7});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(t,e=null,n=!1){const o={x:M(t,"x","min")},s={axis:e,keepDims:n};return Z.runKernel(yg,o,s)}const Gp=J({min_:P7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(t,e){let n=M(t,"base","pow"),r=M(e,"exp","pow");[n,r]=kn(n,r);const o={a:n,b:r};return Z.runKernel(mh,o)}const Cc=J({pow_:M7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ut(t,e){if((Ps(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ps(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Gg(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(t){const n={x:M(t,"x","sqrt","float32")};return Z.runKernel(Th,n)}const kr=J({sqrt_:L7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(t){const e=M(t,"x","square"),n={};return Z.runKernel("Square",{x:e},n)}const Zt=J({square_:B7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(t,e=null,n=!1){let r=M(t,"x","sum");r.dtype==="bool"&&(r=Ve(r,"int32"));const o={x:r},s={axis:e,keepDims:n};return Z.runKernel(Pg,o,s)}const Xe=J({sum_:z7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7(t,e="euclidean",n=null,r=!1){t=M(t,"x","norm");const o=SN(t,e,n);let s=o.shape;if(r){const i=Ct(n,t.shape);s=Tn(o.shape,i)}return ee(o,s)}function SN(t,e,n=null){if(t.rank===0)return Xn(t);if(t.rank!==1&&n===null)return SN(ee(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Xe(Xn(t),n);if(e===1/0)return Qo(Xn(t),n);if(e===-1/0)return Gp(Xn(t),n);if(e==="euclidean"||e===2)return kr(Xe(Cc(Xn(t),ut(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Qo(Xe(Xn(t),n[0]),n[1]-1);if(e===1/0)return Qo(Xe(Xn(t),n[1]),n[0]);if(e===-1/0)return Gp(Xe(Xn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return kr(Xe(Zt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Yg=J({norm_:W7});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V7(t,e=null,n=!1){return Yg(t,"euclidean",e,n)}const U7=J({euclideanNorm_:V7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7(t){const n={x:M(t,"x","exp")};return Z.runKernel(eh,n)}const Oo=J({exp_:H7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(t,e=0){const n=M(t,"x","expandDims","string_or_numeric");D(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},o={dim:e};return Z.runKernel(sg,r,o)}const Gr=J({expandDims_:G7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j7(t){const n={x:M(t,"x","expm1")};return Z.runKernel(th,n)}const K7=J({expm1_:j7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(t,e){const n=M(t,"x","tile","string_or_numeric");D(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},o={reps:e};return Z.runKernel(Ah,r,o)}const Yo=J({tile_:q7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(t,e,n,r="float32"){e==null&&(e=t);const o=wt([t,e],r),s=t<=e?t:e;for(let a=0;a<s;++a)o.set(1,a,a);const i=ee(o.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return Yo(Gr(i,0),[n[0],1,1]);if(n.length===2)return Yo(Gr(Gr(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return Yo(Gr(Gr(Gr(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const IN=J({eye_:X7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(t){const n={x:M(t,"x","floor","float32")};return Z.runKernel(nh,n)}const Zg=J({floor_:Y7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7(t,e,n=0,r=0){const o=M(t,"x","gather"),s=M(e,"indices","gather","int32"),i={x:o,indices:s},a={axis:n,batchDims:r};return Z.runKernel(ag,i,a)}const z1=J({gather_:Z7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J7(t,e){let n=M(t,"a","greater","string_or_numeric"),r=M(e,"b","greater","string_or_numeric");[n,r]=kn(n,r),bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(lg,o)}const vo=J({greater_:J7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q7(t,e){let n=M(t,"a","greaterEqual","string_or_numeric"),r=M(e,"b","greaterEqual","string_or_numeric");[n,r]=kn(n,r),bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(oh,o)}const wl=J({greaterEqual_:Q7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eq(t){const n={x:M(t,"x","isFinite")};return Z.runKernel(ih,n)}const tq=J({isFinite_:eq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nq(t){const n={x:M(t,"x","isInf")};return Z.runKernel(ah,n)}const rq=J({isInf_:nq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(t){const n={x:M(t,"x","isNaN")};return Z.runKernel(lh,n)}const sq=J({isNaN_:oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iq(t,e=.2){const r={x:M(t,"x","leakyRelu")},o={alpha:e};return Z.runKernel(cg,r,o)}const W1=J({leakyRelu_:iq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aq(t,e){let n=M(t,"a","less","string_or_numeric"),r=M(e,"b","less","string_or_numeric");[n,r]=kn(n,r),bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(ug,o)}const kN=J({less_:aq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lq(t,e){let n=M(t,"a","lessEqual","string_or_numeric"),r=M(e,"b","lessEqual","string_or_numeric");[n,r]=kn(n,r),bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(dg,o)}const Zc=J({lessEqual_:lq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(t,e=5,n=1,r=1,o=.5){const s=M(t,"x","localResponseNormalization");D(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),D(vc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=s,a=!1;s.rank===3&&(a=!0,i=ee(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:i},c={depthRadius:e,bias:n,alpha:r,beta:o},u=Z.runKernel(mg,l,c);return a?ee(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const uq=J({localResponseNormalization_:cq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(t){const n={x:M(t,"x","log","float32")};return Z.runKernel(ch,n)}const Po=J({log_:dq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hq(t){const n={x:M(t,"x","log1p")};return Z.runKernel(uh,n)}const V1=J({log1p_:hq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fq(t,e){D(Sx(t),()=>"The f passed in variableGrads(f) must be a function"),D(e==null||Array.isArray(e)&&e.every(c=>c instanceof Wp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in Z.registeredVariables)e.push(Z.registeredVariables[c])}const r=n?e.filter(c=>!c.trainable):null,o=e.length;e=e.filter(c=>c.trainable),D(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${o} variables is trainable.`);const s=!0,{value:i,grads:a}=Z.gradients(t,e,null,s);D(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),D(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:i,grads:l}}function sl(t){return Z.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pq(t){const n={x:M(t,"x","softplus")};return Z.runKernel(kh,n)}const Mh=J({softplus_:pq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(t){const e=M(t,"x","logSigmoid");return sl(r=>({value:yn(Mh(yn(r))),gradFunc:i=>q(i,Yc(yn(r)))}))(e)}const gq=J({logSigmoid_:mq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bq(t,e){let n=M(t,"a","sub"),r=M(e,"b","sub");[n,r]=kn(n,r);const o={a:n,b:r};return Z.runKernel(Rh,o)}const Ye=J({sub_:bq});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(t,e=-1){const n=M(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return sl((o,s)=>{const a=Qo(o,e,!0),l=Ye(o,a),c=Ye(Ve(l,"float32"),Po(Xe(Oo(l),e,!0)));return s([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,m=Oo(f);return Ye(d,q(Xe(d,e,p),m))}}})(n)}const TN=J({logSoftmax_:vq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xq(t,e=null,n=!1){const r=M(t,"x","logSumExp"),o=Ct(e,r.shape),s=Qo(r,o,!0),i=Ye(r,s),a=Oo(i),l=Xe(a,o),c=Po(l),u=Re(ee(s,c.shape),c);if(n){const d=Tn(u.shape,o);return ee(u,d)}return u}const EN=J({logSumExp_:xq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yq(t,e){const n=M(t,"a","logicalAnd","bool"),r=M(e,"b","logicalAnd","bool");bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(hg,o)}const ti=J({logicalAnd_:yq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wq(t){const n={x:M(t,"x","logicalNot","bool")};return Z.runKernel(fg,n)}const U1=J({logicalNot_:wq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cq(t,e){const n=M(t,"a","logicalOr","bool"),r=M(e,"b","logicalOr","bool");bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(pg,o)}const RN=J({logicalOr_:Cq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $q(t,e){const n=M(t,"a","logicalXor","bool"),r=M(e,"b","logicalXor","bool");return bt(n.shape,r.shape),ti(RN(t,e),U1(ti(t,e)))}const Sq=J({logicalXor_:$q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iq(t,e,n,r,o){const s=M(t,"x","maxPool"),i=1;let a=s,l=!1;s.rank===3&&(l=!0,a=ee(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),D(br(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Lr("maxPool",r,o);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:o},d=Z.runKernel(bg,c,u);return l?ee(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const H1=J({maxPool_:Iq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kq(t,e=[1,1,1],n,r,o,s="NDHWC"){const i=M(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=ee(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),D(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Lr("maxPool3d",r,o);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:o,dataFormat:s},d=Z.runKernel(vg,c,u);return l?ee(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Tq=J({maxPool3d_:kq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(t,e){let n=M(t,"a","maximum"),r=M(e,"b","maximum");[n,r]=kn(n,r),n.dtype==="bool"&&(n=Ve(n,"int32"),r=Ve(r,"int32")),bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(dh,o)}const ta=J({maximum_:Eq});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(t,e=null,n=!1){const o={x:M(t,"x","mean")},s={axis:e,keepDims:n};return Z.runKernel(xg,o,s)}const In=J({mean_:Rq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zn(t,e="float32"){if(ai(t),e==="complex64"){const r=Zn(t,"float32"),o=Zn(t,"float32");return Qa(r,o)}const n=gr(me(t),e);return Z.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function na(t,e="float32"){if(ai(t),e==="complex64"){const r=na(t,"float32"),o=Zn(t,"float32");return Qa(r,o)}const n=Ey(me(t),e);return Z.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nq(t,e){let n=M(t,"a","minimum"),r=M(e,"b","minimum");[n,r]=kn(n,r),n.dtype==="bool"&&(n=Ve(n,"int32"),r=Ve(r,"int32")),bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel(hh,o)}const Jg=J({minimum_:Nq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _q(t,e,n){D(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=M(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");D(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const o=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)D(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),D(e[a][0]>=0&&e[a][0]<=r.shape[a]-o&&e[a][1]>=0&&e[a][1]<=r.shape[a]-o,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-o} or less than 0 for input of shape ${r.shape}`);const s={paddings:e,mode:n},i={x:r};return Z.runKernel(wg,i,s)}const Aq=J({mirrorPad_:_q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(t,e){let n=M(t,"a","mod"),r=M(e,"b","mod");[n,r]=kn(n,r);const o={a:n,b:r};return Z.runKernel(fh,o)}const Fq=J({mod_:Dq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oq(t,e=null,n=!1){t=M(t,"x","moments");const r=Ct(e,t.shape),o=In(t,r,n);let s=o.shape;n||(s=Tn(o.shape,r));const i=Zt(Ye(Ve(t,"float32"),ee(o,s))),a=In(i,r,n);return{mean:o,variance:a}}const G1=J({moments_:Oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(t,e){let n=M(t,"a","notEqual","string_or_numeric"),r=M(e,"b","notEqual","string_or_numeric");[n,r]=kn(n,r),bt(n.shape,r.shape);const o={a:n,b:r};return Z.runKernel($g,o)}const gd=J({notEqual_:Pq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mq(t){const n={x:M(t,"x","onesLike")};return Z.runKernel(Sg,n)}const Mo=J({onesLike_:Mq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(t,e,n=0){const r=M(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const o={paddings:e,constantValue:n},s={x:r};return Z.runKernel(Tg,s,o)}const j1=J({pad_:Lq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(t,e,n){const r=M(t,"x","spaceToBatchND");D(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),D(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),D(r.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const o={x:r},s={blockShape:e,paddings:n};return Z.runKernel(Mg,o,s)}const K1=J({spaceToBatchND_:Bq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(t,e,n,r,o,s,i){o==null&&(o=[1,1]),s==null&&(s=1),r===0&&(r="valid");const a=M(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=ee(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(br(s,o),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${o}'`);const u=Wo(l.shape,e,s,o,r),d=[u.dilationHeight,u.dilationWidth];let h;r==="same"?h=Vq([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=Wq([u.inHeight,u.inWidth],d,h),g=f?r:"valid",b=f?l:K1(l,d,p),w=(n==="avg"?()=>D1(b,e,s,g,i):()=>H1(b,e,s,g,i))(),y=f?w:O1(w,d,m);return c?ee(y,[y.shape[1],y.shape[2],y.shape[3]]):y}function Wq(t,e,n){const r=n.map(u=>u[0]),o=n.map(u=>u[1]),s=t.concat(r,o),i=e.map((u,d)=>(u-s[d]%u)%u),a=o.map((u,d)=>u+i[d]),l=e.map((u,d)=>[r[d],a[d]]),c=e.map((u,d)=>[0,i[d]]);return[l,c]}function Vq(t,e){const r=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),o=r.map(i=>Math.floor(i/2)),s=r.map((i,a)=>i-o[a]);return r.map((i,a)=>[o[a],s[a]])}const Uq=J({pool_:zq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hq(t,e){const n=M(t,"x","prelu"),r=M(e,"alpha","prelu"),o={x:n,alpha:r};return Z.runKernel(Eg,o)}const q1=J({prelu_:Hq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(t,e=null,n=!1){let r=M(t,"x","prod");r.dtype==="bool"&&(r=Ve(r,"int32"));const o={x:r},s={axis:e,keepDims:n};return Z.runKernel(Rg,o,s)}const jq=J({prod_:Gq});var NN={exports:{}};(function(t){(function(e,n,r){function o(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function s(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var u=new o(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&s(d,u),h.state=function(){return s(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.alea=i})(zn,t,!1)})(NN);var _N={exports:{}};(function(t){(function(e,n,r){function o(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function s(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var c=new o(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xor128=i})(zn,t,!1)})(_N);var AN={exports:{}};(function(t){(function(e,n,r){function o(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var c=new o(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xorwow=i})(zn,t,!1)})(AN);var DN={exports:{}};(function(t){(function(e,n,r){function o(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function s(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var c=new o(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xorshift7=i})(zn,t,!1)})(DN);var FN={exports:{}};(function(t){(function(e,n,r){function o(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,m,g,b=[],v=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,v=Math.max(v,d.length)),p=0,m=-32;m<v;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,h=b[m&127]^=f+g,p=h==0?p+1:0);for(p>=128&&(b[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=b[p+34&127],h=b[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,b[p]=f^h;u.w=g,u.X=b,u.i=p}c(l,a)}function s(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var c=new o(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xor4096=i})(zn,t,!1)})(FN);var ON={exports:{}};(function(t){(function(e,n,r){function o(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function s(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var c=new o(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.tychei=i})(zn,t,!1)})(ON);var PN={exports:{}};const Kq={},qq=Object.freeze(Object.defineProperty({__proto__:null,default:Kq},Symbol.toStringTag,{value:"Module"})),Xq=E6(qq);(function(t){(function(e,n,r){var o=256,s=6,i=52,a="random",l=r.pow(o,s),c=r.pow(2,i),u=c*2,d=o-1,h;function f(y,C,S){var $=[];C=C==!0?{entropy:!0}:C||{};var I=b(g(C.entropy?[y,w(n)]:y==null?v():y,3),$),R=new p($),T=function(){for(var N=R.g(s),_=l,P=0;N<c;)N=(N+P)*o,_*=o,P=R.g(1);for(;N>=u;)N/=2,_/=2,P>>>=1;return(N+P)/_};return T.int32=function(){return R.g(4)|0},T.quick=function(){return R.g(4)/4294967296},T.double=T,b(w(R.S),n),(C.pass||S||function(N,_,P,z){return z&&(z.S&&m(z,R),N.state=function(){return m(R,{})}),P?(r[a]=N,_):N})(T,I,"global"in C?C.global:this==r,C.state)}function p(y){var C,S=y.length,$=this,I=0,R=$.i=$.j=0,T=$.S=[];for(S||(y=[S++]);I<o;)T[I]=I++;for(I=0;I<o;I++)T[I]=T[R=d&R+y[I%S]+(C=T[I])],T[R]=C;($.g=function(N){for(var _,P=0,z=$.i,L=$.j,O=$.S;N--;)_=O[z=d&z+1],P=P*o+O[d&(O[z]=O[L=d&L+_])+(O[L]=_)];return $.i=z,$.j=L,P})(o)}function m(y,C){return C.i=y.i,C.j=y.j,C.S=y.S.slice(),C}function g(y,C){var S=[],$=typeof y,I;if(C&&$=="object")for(I in y)try{S.push(g(y[I],C-1))}catch{}return S.length?S:$=="string"?y:y+"\0"}function b(y,C){for(var S=y+"",$,I=0;I<S.length;)C[d&I]=d&($^=C[d&I]*19)+S.charCodeAt(I++);return w(C)}function v(){try{var y;return h&&(y=h.randomBytes)?y=y(o):(y=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(y)),w(y)}catch{var C=e.navigator,S=C&&C.plugins;return[+new Date,e,S,e.screen,w(n)]}}function w(y){return String.fromCharCode.apply(0,y)}if(b(r.random(),n),t.exports){t.exports=f;try{h=Xq}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:zn,[],Math)})(PN);var Yq=NN.exports,Zq=_N.exports,Jq=AN.exports,Qq=DN.exports,eX=FN.exports,tX=ON.exports,Cl=PN.exports;Cl.alea=Yq;Cl.xor128=Zq;Cl.xorwow=Jq;Cl.xorshift7=Qq;Cl.xor4096=eX;Cl.tychei=tX;var X1=Cl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MN{constructor(e,n,r,o,s){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=s||Math.random();this.random=X1.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const o=this.nextVal;return this.nextVal=NaN,o}let e,n,r=!1;for(;!r;){let o,s,i;do o=2*this.random()-1,s=2*this.random()-1,i=o*o+s*s;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*o*a,n=this.mean+this.stdDev*s*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class nX{constructor(e=0,n=1,r,o){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=X1.alea(o)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rX(t,e=0,n=1,r,o){if(ai(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const s=new MN(e,n,r,!1,o),i=wt(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}const oX=J({randomNormal_:rX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sX(t,e=0,n=1,r="float32",o){ai(t);const s=wt(t,r),i=new nX(e,n,null,o);for(let a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}const Qg=J({randomUniform_:sX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bd(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const o={start:t,stop:e,step:n,dtype:r};return Z.runKernel(o1,{},o)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iX(t){const n={x:M(t,"x","reciprocal")};return Z.runKernel(gh,n)}const aX=J({reciprocal_:iX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(t){const n={x:M(t,"x","relu")};return Z.runKernel(bh,n)}const ui=J({relu_:lX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cX(t){const n={x:M(t,"x","relu6")};return Z.runKernel(vh,n)}const LN=J({relu6_:cX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uX(t,e){const r={x:M(t,"x","reverse")},o={dims:e};return Z.runKernel(Dg,r,o)}const il=J({reverse_:uX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dX(t){const n={x:M(t,"x","round")};return Z.runKernel(xh,n)}const BN=J({round_:dX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hX(t){const n={x:M(t,"x","rsqrt","float32")};return Z.runKernel(yh,n)}const zN=J({rsqrt_:hX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fX(t){const n={x:M(t,"x","selu")};return Z.runKernel(wh,n)}const WN=J({selu_:fX});function pX(t,e,n,r,o,s=[1,1],i="NHWC"){const a=M(t,"x","separableConv2d"),l=M(e,"depthwiseFilter","separableConv2d"),c=M(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=ee(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");D(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),D(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),D(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];D(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=L1(u,l,r,o,i,s),g=ol(p,c,1,"valid",i);return d?ee(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const VN=J({separableConv2d_:pX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mX(t){const n={x:M(t,"x","sign")};return Z.runKernel(Sh,n)}const gX=J({sign_:mX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bX(t){const n={x:M(t,"x","sin","float32")};return Z.runKernel(Ch,n)}const UN=J({sin_:bX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vX(t){const n={x:M(t,"x","sinh")};return Z.runKernel($h,n)}const HN=J({sinh_:vX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xX(t,e,n){const r=M(t,"x","slice1d");return D(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Vt(r,[e],[n])}const Y1=J({slice1d_:xX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yX(t,e,n){const r=M(t,"x","slice2d");return D(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Vt(r,e,n)}const GN=J({slice2d_:yX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wX(t,e,n){const r=M(t,"x","slice3d");return D(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Vt(r,e,n)}const Z1=J({slice3d_:wX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CX(t,e,n){const r=M(t,"x","slice4d");return D(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Vt(r,e,n)}const jp=J({slice4d_:CX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(t,e=-1){const n=M(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},o={dim:e};return Z.runKernel(Bg,r,o)}const J1=J({softmax_:$X});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SX(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Z.runKernel(Ky,e)}const jN=J({fft_:SX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IX(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Z.runKernel(Yy,e)}const Hx=J({ifft_:IX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const o=ee(t,[n,e]);r=Hx(o)}else{const o=[n,2*(e-1)],s=ee(Up(t),[n,e]),i=ee(I1(t),[n,e]),a=il(Vt(s,[0,1],[n,e-2]),1),l=q(il(Vt(i,[0,1],[n,e-2]),1),ut(-1)),c=mr([s,a],1),u=mr([i,l],1),d=ee(Qa(c,u),[o[0],o[1]]);r=Hx(d)}if(r=Up(r),t.rank===3&&t.shape[0]!==0){const o=r,s=t.shape[0];r=ee(r,[s,r.shape[0]/s,r.shape[1]]),o.dispose()}return r}const TX=J({irfft_:kX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EX(t,e,n=0){const o={x:M(t,"x","split")},s={numOrSizeSplits:e,axis:n};return Z.runKernel(Lg,o,s)}const ho=J({split_:EX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RX(t,e){D(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let o;if(e!=null&&e<n){const p=t.shape.map(g=>0),m=t.shape.map(g=>g);m[t.shape.length-1]=e,o=Vt(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,o=mr([t,Zn(p)],t.shape.length-1),n=e}else o=t;const s=Nt(o),i=ee(Qa(o,s),[r,n]),a=jN(i),l=Math.floor(n/2)+1,c=Up(a),u=I1(a),d=ho(c,[l,n-l],c.shape.length-1),h=ho(u,[l,n-l],u.shape.length-1),f=o.shape.slice();return f[o.shape.length-1]=l,ee(Qa(d[0],h[0]),f)}const KN=J({rfft_:RX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NX(t,e){let n=M(t,"a","squaredDifference"),r=M(e,"b","squaredDifference");[n,r]=kn(n,r),bt(n.shape,r.shape);const o={a:n,b:r},s={};return Z.runKernel(Eh,o,s)}const qN=J({squaredDifference_:NX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _X(t,e){const n=M(t,"x","squeeze","string_or_numeric");return ee(n,Zi(n.shape,e).newShape)}const Lh=J({squeeze_:_X});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AX(t,e=0){const n=qR(t,"tensors","stack","string_or_numeric");D(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&D(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,o={axis:e};return Z.runKernel(kg,r,o)}const Vi=J({stack_:AX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DX(t,e=0){const r={x:M(t,"x","step")},o={alpha:e};return Z.runKernel(Dh,r,o)}const Bh=J({step_:DX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(t,e,n,r,o=0,s=0,i=0,a=0,l=0){const u={x:M(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:o,endMask:s,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return Z.runKernel(f1,u,d)}const OX=J({stridedSlice_:FX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PX(t){const n={x:M(t,"x","tan","float32")};return Z.runKernel(Nh,n)}const MX=J({tan_:PX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xr(t,e){dR(t);const n=Hg(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Gg(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ic(t,e,n){if(dR(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Hg(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Gg(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LX(t,e=1,n=!0){const r=M(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const o=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>o)throw new Error(`'k' passed to topk() must be <= the last dimension (${o}) but got ${e}`);const s={x:r},i={k:e,sorted:n},[a,l]=Z.runKernel(b1,s,i);return{values:a,indices:l}}const BX=J({topk_:LX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zX(t,e=0,n=1,r,o){if(ai(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const s=new MN(e,n,r,!0,o),i=wt(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}const XN=J({truncatedNormal_:zX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WX(t,e=0){const n=M(t,"x","unique","string_or_numeric");D(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},o={axis:e},[s,i]=Z.runKernel(x1,r,o);return{values:s,indices:i}}const VX=J({unique_:WX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UX(t,e,n){const r=M(t,"x","unsortedSegmentSum"),o=M(e,"segmentIds","unsortedSegmentSum","int32");D(vc(n),()=>"numSegments must be of dtype int");const s={x:r,segmentIds:o},i={numSegments:n};return Z.runKernel(Wg,s,i)}const YN=J({unsortedSegmentSum_:UX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HX(t,e=0){const n=M(t,"x","unstack","string_or_numeric");D(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},o={axis:e};return Z.runKernel(zg,r,o)}const al=J({unstack_:HX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GX(t,e=!0,n,r){return Z.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZN(t,e){const n=[];for(let s=0;s<e.length;s++)e[s]&&n.push(s);const r=wt(t,"int32"),o=wt([n.length,t.length],"int32");for(let s=0;s<n.length;s++){const i=r.indexToLoc(n[s]),a=s*t.length;o.values.set(i,a)}return o.toTensor()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jX(t,e){if(e==null)return t.shape.slice();if(Bt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KX(t,e,n,r){const o=M(t,"x","dropout");if(D(o.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${o.dtype} tensor instead.`),D(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof An?o.clone():o;const s=jX(o,n),i=1-e,a=et(Zg(Re(Qg(s,0,1,"float32",r),i)),i);return q(o,a)}const qX=J({dropout_:KX});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XX(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function JN(t,e,n){const r=1-t%2,o=new Float32Array(t);for(let s=0;s<t;++s){const i=2*Math.PI*s/(t+r-1);o[s]=e-n*Math.cos(i)}return Xr(o,"float32")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YX(t,e,n,r,o,s="NHWC",i){let a=t;t.rank===3&&(a=ee(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=ee(e,[1,e.shape[0],e.shape[1],e.shape[2]])),D(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),D(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),D(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=s==="NHWC"?a.shape[3]:a.shape[1],u=s==="NHWC"?l.shape[3]:l.shape[1];D(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),D(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),Lr("conv2dDerFilter",o,i);const d={x:a,dy:l},h={strides:r,pad:o,dataFormat:s,dimRoundingMode:i,filterShape:n};return Z.runKernel(My,d,h)}const Q1=J({conv2DBackpropFilter_:YX});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ew(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return q(t,Bh(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function tw(t,e){let n=e;const r=Kn(t.shape,e.shape);return r.length>0&&(n=Xe(n,r)),ee(n,t.shape)}function nw(t,e,n,r){if(e==="linear")return t;if(e==="relu")return ui(t);if(e==="elu")return Xg(t);if(e==="relu6")return LN(t);if(e==="prelu")return q1(t,n);if(e==="leakyrelu")return W1(t,r);if(e==="sigmoid")return Yc(t);throw new Error(`Unknown fused activation ${e}.`)}const rw=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX({x:t,filter:e,strides:n,pad:r,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",rw(Z.state.gradientDepth,l)===!1){D(o==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${o} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=ol(t,e,n,r,o,s,i);return a!=null&&(S=Re(S,a)),nw(S,l,c,u)}const d=M(t,"x","conv2d","float32"),h=M(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=ee(d,[1,d.shape[0],d.shape[1],d.shape[2]])),D(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),D(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Lr("fused conv2d",r,i);const m=o==="NHWC"?f.shape[3]:f.shape[1];D(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),D(br(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const g=ir(f.shape,h.shape,n,s,r,i);let b;a!=null&&(b=M(a,"bias","fused conv2d"),[b]=kn(b,d),o==="NHWC"?bt(g.outShape,b.shape):(D(b.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`),D(b.shape.length===0||b.shape[0]===g.outChannels||b.shape[0]===1,()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let v;if(c!=null){const S=c.shape;if(D(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)D(S[0]===1||S[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${g.outChannels}).`);else if(S.length===3)try{bt(S,g.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(I)}v=M(c,"prelu weights","fused conv2d")}const w=(S,$)=>{D(o==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${o} but only NHWC is currently supported.`);const[I,R,T,N]=$,_=ew(S,T,l);D(rl(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const P=P1(R.shape,_,I,n,r),z=Q1(R,_,I.shape,n,r),L=[P,z];if(N!=null){const O=tw(N,_);L.push(O)}return L},y={x:f,filter:h,bias:b,preluActivationWeights:v},C={strides:n,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?sl(($,I,R)=>{let T=Z.runKernel(Lp,y,C);return R([I,$,T]),p&&(T=ee(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:w}})(f,h):sl(($,I,R,T)=>{let N=Z.runKernel(Lp,y,C);return T([I,$,N,R]),p&&(N=ee(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:w}})(f,h,b)}const JX=J({fusedConv2d_:ZX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QX(t,e,n,r,o,s=[1,1],i){let a=t;t.rank===3&&(a=ee(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=ee(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:r,pad:o,dimRoundingMode:i,dilations:s,filterShape:n};return Z.runKernel(Hy,c,u)}const eY=J({depthwiseConv2dNativeBackpropFilter_:QX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tY(t,e,n,r,o,s=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=ee(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:r,pad:o,dimRoundingMode:i,dilations:s,inputShape:t},d=Z.runKernel(Gy,c,u);return l?ee(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const nY=J({depthwiseConv2dNativeBackpropInput_:tY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rY({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:o,activation:s="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(rw(Z.state.gradientDepth,s)===!1){let N=Lt(t,e,n,r);return o!=null&&(N=Re(N,o)),nw(N,s,i,a)}let l=M(t,"a","fused matMul"),c=M(e,"b","fused matMul");[l,c]=kn(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=me(p),b=me(m);D(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=bt(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),y=n?ee(l,[g,u,h]):ee(l,[g,h,u]),C=r?ee(c,[b,f,d]):ee(c,[b,d,f]);let S;o!=null&&(S=M(o,"bias","fused matMul"),[S]=kn(S,l),bt(w,S.shape));let $;i!=null&&($=M(i,"prelu weights","fused matMul"));const I=(N,_)=>{const[P,z,L,O]=_,B=ew(ee(N,L.shape),L,s);let U,Q;if(!n&&!r?(U=Lt(B,z,!1,!0),Q=Lt(P,B,!0,!1)):!n&&r?(U=Lt(B,z,!1,!1),Q=Lt(B,P,!0,!1)):n&&!r?(U=Lt(z,B,!1,!0),Q=Lt(P,B,!1,!1)):(U=Lt(z,B,!0,!0),Q=Lt(B,P,!0,!0)),o!=null){const se=tw(O,B);return[U,Q,se]}else return[U,Q]},R={a:y,b:C,bias:S,preluActivationWeights:$},T={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:a};return o==null?sl((_,P,z)=>{const L=Z.runKernel(Mp,R,T);return z([_,P,L]),{value:ee(L,w),gradFunc:I}})(y,C):sl((_,P,z,L)=>{const O=Z.runKernel(Mp,R,T);return L([_,P,O,z]),{value:ee(O,w),gradFunc:I}})(y,C,S)}const PI=J({fusedMatMul_:rY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oY(t){return JN(t,.54,.46)}const pye=J({hammingWindow_:oY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sY(t){return JN(t,.5,.5)}const iY=J({hannWindow_:sY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aY(t,e,n,r=!1,o=0){let s=0;const i=[];for(;s+e<=t.size;)i.push(Vt(t,s,e)),s+=n;if(r)for(;s<t.size;){const a=s+e-t.size,l=mr([Vt(t,s,e-a),Ph([a],o)]);i.push(l),s+=n}return i.length===0?ic([],[0,e]):ee(mr(i),[i.length,e])}const lY=J({frame_:aY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(t,e,n,r,o=iY){r==null&&(r=XX(e));const s=lY(t,e,n),i=q(s,o(e));return KN(i,r)}const mye=J({stft_:cY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uY(t,e,n,r,o="bilinear",s=0){const i=M(t,"image","cropAndResize"),a=M(e,"boxes","cropAndResize","float32"),l=M(n,"boxInd","cropAndResize","int32"),c=a.shape[0];D(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),D(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),D(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),D(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),D(o==="bilinear"||o==="nearest",()=>`method must be bilinear or nearest, but was ${o}`);const u={image:i,boxes:a,boxInd:l},d={method:o,extrapolationValue:s,cropSize:r};return Z.runKernel(Wy,u,d)}const dY=J({cropAndResize_:uY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hY(t){const e=M(t,"image","flipLeftRight","float32");D(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return Z.runKernel(Xy,n,{})}const fY=J({flipLeftRight_:hY});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pY(t){const e=M(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];D(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),D(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const o=new Array(e.rank);return o.fill(1,0,n),o[n]=3,Yo(e,o)}const mY=J({grayscaleToRGB_:pY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gY(t,e,n=0,r=.5){const o=M(t,"image","rotateWithOffset","float32");D(o.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${o.rank}.`);const s={image:o},i={radians:e,fillValue:n,center:r};return Z.runKernel(y1,s,i)}const bY=J({rotateWithOffset_:gY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jc(t,e,n,r,o,s){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),s==null&&(s=0);const i=t.shape[0];return n=Math.min(n,i),D(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),D(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),D(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),D(e.rank===1,()=>"scores must be a 1D tensor"),D(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),D(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vY(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY){const s=M(t,"boxes","nonMaxSuppression","float32"),i=M(e,"scores","nonMaxSuppression","float32"),a=Jc(s,i,n,r,o);n=a.maxOutputSize,r=a.iouThreshold,o=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return Z.runKernel(t1,{boxes:s,scores:i},l)}const xY=J({nonMaxSuppression_:vY});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yY(t,e,n){const r=wY(t,e,n),o=r<0?-(r+1):r;t.splice(o,0,e)}function wY(t,e,n){return $Y(t,e,n||CY)}function CY(t,e){return t>e?1:t<e?-1:0}function $Y(t,e,n){let r=0,o=t.length,s=0,i=!1;for(;r<o;){s=r+(o-r>>>1);const a=n(e,t[s]);a>0?r=s+1:(o=s,i=!a)}return i?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ow(t,e,n,r,o){return aw(t,e,n,r,o,0)}function sw(t,e,n,r,o,s){return aw(t,e,n,r,o,0,!1,s,!0)}function iw(t,e,n,r,o,s){return aw(t,e,n,r,o,s,!0)}function aw(t,e,n,r,o,s,i=!1,a=!1,l=!1){const c=[];for(let g=0;g<e.length;g++)e[g]>o&&c.push({score:e[g],boxIndex:g,suppressBeginIndex:0});c.sort(MI);const u=s>0?-.5/s:0,d=[],h=[];for(;d.length<n&&c.length>0;){const g=c.pop(),{score:b,boxIndex:v,suppressBeginIndex:w}=g;if(b<o)break;let y=!1;for(let C=d.length-1;C>=w;--C){const S=SY(t,v,d[C]);if(S>=r){y=!0;break}if(g.score=g.score*IY(r,u,S),g.score<=o)break}g.suppressBeginIndex=d.length,y||(g.score===b?(d.push(v),h.push(g.score)):g.score>o&&yY(c,g,MI))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function SY(t,e,n){const r=t.subarray(e*4,e*4+4),o=t.subarray(n*4,n*4+4),s=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),u=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),h=Math.max(o[1],o[3]),f=(a-s)*(l-i),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const m=Math.max(s,c),g=Math.max(i,u),b=Math.min(a,d),v=Math.min(l,h),w=Math.max(b-m,0)*Math.max(v-g,0);return w/(f+p-w)}function IY(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function MI(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function kY(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY){const s=M(t,"boxes","nonMaxSuppressionAsync"),i=M(e,"scores","nonMaxSuppressionAsync"),a=Jc(s,i,n,r,o);n=a.maxOutputSize,r=a.iouThreshold,o=a.scoreThreshold;const l=await Promise.all([s.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:d}=ow(c,u,n,r,o);return s!==t&&s.dispose(),i!==e&&i.dispose(),Xr(d,"int32")}const TY=kY;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EY(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY,s=0){const i=M(t,"boxes","nonMaxSuppression"),a=M(e,"scores","nonMaxSuppression"),l=Jc(i,a,n,r,o,s);n=l.maxOutputSize,r=l.iouThreshold,o=l.scoreThreshold,s=l.softNmsSigma;const c={boxes:i,scores:a},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:s},d=Z.runKernel(r1,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const RY=J({nonMaxSuppressionWithScore_:EY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function NY(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY,s=0){const i=M(t,"boxes","nonMaxSuppressionAsync"),a=M(e,"scores","nonMaxSuppressionAsync"),l=Jc(i,a,n,r,o,s);n=l.maxOutputSize,r=l.iouThreshold,o=l.scoreThreshold,s=l.softNmsSigma;const c=await Promise.all([i.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=iw(u,d,n,r,o,s);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Xr(h,"int32"),selectedScores:Xr(f)}}const _Y=NY;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AY(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY,s=!1){const i=M(t,"boxes","nonMaxSuppression"),a=M(e,"scores","nonMaxSuppression"),l=Jc(i,a,n,r,o,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:i,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:s},p=Z.runKernel(n1,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const DY=J({nonMaxSuppressionPadded_:AY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function FY(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY,s=!1){const i=M(t,"boxes","nonMaxSuppressionAsync"),a=M(e,"scores","nonMaxSuppressionAsync"),l=Jc(i,a,n,r,o,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:m}=sw(h,f,c,u,d,s);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Xr(p,"int32"),validOutputs:ut(m,"int32")}}const OY=FY;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PY(t,e,n=!1,r=!1){const o=M(t,"images","resizeBilinear");D(o.rank===3||o.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${o.rank}.`),D(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),D(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=o,i=!1;o.rank===3&&(i=!0,s=ee(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const a={images:s},l={alignCorners:n,halfPixelCenters:r,size:e},c=Z.runKernel(Ag,a,l);return i?ee(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const QN=J({resizeBilinear_:PY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MY(t,e,n=!1,r=!1){const o=M(t,"images","resizeNearestNeighbor");D(o.rank===3||o.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${o.rank}.`),D(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),D(o.dtype==="float32"||o.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),D(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=o,i=!1;o.rank===3&&(i=!0,s=ee(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const a={images:s},l={alignCorners:n,halfPixelCenters:r,size:e},c=Z.runKernel(_g,a,l);return i?ee(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const e_=J({resizeNearestNeighbor_:MY});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LY(t,e="binary",n=!1,r=.5){const o=M(t,"image","threshold"),s=.2989,i=.587,a=.114,l=o.shape[0]*o.shape[1];let c=q(Xr([r]),255),u,d,h,f;if(D(o.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${o.rank}.`),D(o.shape[2]===3||o.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${o.shape[2]}.`),D(o.dtype==="int32"||o.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${o.dtype}.`),D(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),o.shape[2]===3){[u,d,h]=ho(o,[1,1,1],-1);const g=q(u,s),b=q(d,i),v=q(h,a);f=Re(Re(g,b),v)}else f=t;if(e==="otsu"){const g=K9(Ve(BN(f),"int32"),oc([]),256);c=BY(g,l)}const p=n?Zc(f,c):vo(f,c);return Ve(q(p,255),"int32")}function BY(t,e){let n=Xr([-1]),r=Xr([0]),o=Xr([0]),s,i,a,l,c,u;for(let d=0;d<t.size-1;d++){s=Vt(t,0,d+1),i=Vt(t,d+1),c=et(Xe(s),e),u=et(Xe(i),e);const h=Xe(q(s,bd(0,s.size)));a=et(h,Xe(s));const f=Ph(i.shape,s.size),p=Re(bd(0,i.size),f),m=q(i,p);l=et(Xe(m),Xe(i));const g=Ye(a,l),b=Ye(a,l),v=q(c,u);o=q(q(v,g),b);const w=vo(o,r);r=Qr(w,o,r),n=Qr(w,Xr([d]),n)}return n}const zY=J({threshold_:LY});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WY(t,e,n="nearest",r="constant",o=0,s){const i=M(t,"image","transform","float32"),a=M(e,"transforms","transform","float32");D(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),D(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);const l={image:i,transforms:a},c={interpolation:n,fillMode:r,fillValue:o,outputShape:s};return Z.runKernel(v1,l,c)}const VY=J({transform_:WY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UY(t,e,n){D(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),D(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const r=M(t,"a","bandPart");D(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const o=r.shape,[s,i]=r.shape.slice(-2);if(!(e<=s))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${s}).`);if(!(n<=i))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`);e<0&&(e=s),n<0&&(n=i);const a=ee(bd(0,s,1,"int32"),[-1,1]),l=bd(0,i,1,"int32"),c=Ye(a,l),u=ti(Zc(c,ut(+e,"int32")),wl(c,ut(-n,"int32"))),d=Zn([s,i],r.dtype);return ee(Vi(al(ee(r,[-1,s,i])).map(h=>Qr(u,h,d))),o)}const HY=J({bandPart_:UY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GY(t){let e;if(Array.isArray(t)){e=!1,D(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const o=t[0].shape[0];for(let s=1;s<t.length;++s)D(t[s].shape[0]===o,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[s].shape[0]} vs. ${o})`)}else e=!0,t=ho(t,t.shape[0],0).map(o=>Lh(o,[0]));D(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let o=0;o<t.length;++o)n.push(Z.tidy(()=>{let s=r[o];if(o>0)for(let i=0;i<o;++i){const a=q(Xe(q(n[i],s)),n[i]);s=Ye(s,a)}return et(s,Yg(s,"euclidean"))}));return e?Vi(n,0):n}const jY=J({gramSchmidt_:GY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KY(t,e=!1){if(D(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return LI(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),r=al(ee(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],s=[];r.forEach(l=>{const[c,u]=LI(l,e);o.push(c),s.push(u)});const i=ee(Vi(o,0),t.shape),a=ee(Vi(s,0),t.shape);return[i,a]}}function LI(t,e=!1){return Z.tidy(()=>{D(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let o=IN(n),s=Ha(t);const i=ic([[1]],[1,1]);let a=Ha(i);const l=n>=r?r:n;for(let c=0;c<l;++c){const u=s,d=a,h=o;[a,s,o]=Z.tidy(()=>{const f=Vt(s,[c,c],[n-c,1]),p=Yg(f),m=Vt(s,[c,c],[1,1]),g=Qr(vo(m,0),ic([[-1]]),ic([[1]])),b=Ye(m,q(g,p)),v=et(f,b);v.shape[0]===1?a=Ha(i):a=mr([i,Vt(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const w=yn(et(Lt(g,b),p)),y=Vt(s,[c,0],[n-c,r]),C=q(w,a),S=Et(a);if(c===0)s=Ye(y,Lt(C,Lt(S,y)));else{const R=Ye(y,Lt(C,Lt(S,y)));s=mr([Vt(s,[0,0],[c,r]),R],0)}const $=Et(C),I=Vt(o,[0,c],[n,o.shape[1]-c]);if(c===0)o=Ye(I,Lt(Lt(I,a),$));else{const R=Ye(I,Lt(Lt(I,a),$));o=mr([Vt(o,[0,0],[n,c]),R],1)}return[a,s,o]}),yt([u,d,h])}return!e&&n>r&&(o=Vt(o,[0,0],[n,r]),s=Vt(s,[0,0],[r,r])),[o,s]})}const qY=J({qr_:KY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Dr;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Dr||(Dr={}));function XY(t,e,n=Dr.SUM_BY_NONZERO_WEIGHTS){const r=M(t,"losses","computeWeightedLoss");let o=null;e!=null&&(o=M(e,"weights","computeWeightedLoss"));const s=o==null?r:q(r,o);if(n===Dr.NONE)return s;if(n===Dr.SUM)return Xe(s);if(n===Dr.MEAN){if(o==null)return In(s);{const i=r.size/o.size,a=et(Xe(s),Xe(o));return i>1?et(a,ut(i)):a}}if(n===Dr.SUM_BY_NONZERO_WEIGHTS){if(o==null)return et(Xe(s),ut(r.size));{const i=q(o,na(r.shape)),a=Ve(Xe(gd(i,ut(0))),"float32");return et(Xe(s),a)}}throw Error(`Unknown reduction: ${n}`)}const ra=J({computeWeightedLoss_:XY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YY(t,e,n,r=Dr.SUM_BY_NONZERO_WEIGHTS){const o=M(t,"labels","absoluteDifference"),s=M(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=M(n,"weights","absoluteDifference")),zo(o.shape,s.shape,"Error in absoluteDifference: ");const a=Xn(Ye(o,s));return ra(a,i,r)}const gye=J({absoluteDifference_:YY});function ZY(t,e,n,r,o=Dr.SUM_BY_NONZERO_WEIGHTS){const s=M(t,"labels","cosineDistance"),i=M(e,"predictions","cosineDistance");let a=null;r!=null&&(a=M(r,"weights","cosineDistance")),zo(s.shape,i.shape,"Error in cosineDistance: ");const l=ut(1),c=Ye(l,Xe(q(s,i),n,!0));return ra(c,a,o)}const bye=J({cosineDistance_:ZY});function JY(t,e,n,r=Dr.SUM_BY_NONZERO_WEIGHTS){let o=M(t,"labels","hingeLoss");const s=M(e,"predictions","hingeLoss");let i=null;n!=null&&(i=M(n,"weights","hingeLoss")),zo(o.shape,s.shape,"Error in hingeLoss: ");const a=ut(1);o=Ye(q(ut(2),o),a);const l=ui(Ye(a,q(o,s)));return ra(l,i,r)}const vye=J({hingeLoss_:JY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QY(t,e,n,r=1,o=Dr.SUM_BY_NONZERO_WEIGHTS){const s=M(t,"labels","huberLoss"),i=M(e,"predictions","huberLoss");let a=null;n!=null&&(a=M(n,"weights","huberLoss")),zo(s.shape,i.shape,"Error in huberLoss: ");const l=ut(r),c=Xn(Ye(i,s)),u=Jg(c,l),d=Ye(c,u),h=Re(q(ut(.5),Zt(u)),q(l,d));return ra(h,a,o)}const xye=J({huberLoss_:QY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eZ(t,e,n,r=1e-7,o=Dr.SUM_BY_NONZERO_WEIGHTS){const s=M(t,"labels","logLoss"),i=M(e,"predictions","logLoss");let a=null;n!=null&&(a=M(n,"weights","logLoss")),zo(s.shape,i.shape,"Error in logLoss: ");const l=ut(1),c=ut(r),u=yn(q(s,Po(Re(i,c)))),d=q(Ye(l,s),Po(Re(Ye(l,i),c))),h=Ye(u,d);return ra(h,a,o)}const yye=J({logLoss_:eZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tZ(t,e,n,r=Dr.SUM_BY_NONZERO_WEIGHTS){const o=M(t,"labels","meanSquaredError"),s=M(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=M(n,"weights","meanSquaredError")),zo(o.shape,s.shape,"Error in meanSquaredError: ");const a=qN(o,s);return ra(a,i,r)}const wye=J({meanSquaredError_:tZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nZ(t,e){const n=M(t,"labels","sigmoidCrossEntropyWithLogits"),r=M(e,"logits","sigmoidCrossEntropyWithLogits");zo(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const o=ui(r),s=q(r,n),i=V1(Oo(yn(Xn(r))));return Re(Ye(o,s),i)}function rZ(t,e,n,r=0,o=Dr.SUM_BY_NONZERO_WEIGHTS){let s=M(t,"multiClassLabels","sigmoidCrossEntropy");const i=M(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=M(n,"weights","sigmoidCrossEntropy")),zo(s.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){const c=ut(r),u=ut(1),d=ut(.5);s=Re(q(s,Ye(u,c)),q(d,c))}const l=nZ(s,i);return ra(l,a,o)}const Cye=J({sigmoidCrossEntropy_:rZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oZ(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return sl((o,s,i)=>{const l=EN(s,[n],!0),c=Ye(Ve(s,"float32"),l);i([o,c]);const u=yn(q(c,o));return{value:Xe(u,[n]),gradFunc:(f,p)=>{const[m,g]=p,b=Tn(f.shape,[n]);return[q(ee(f,b),Ye(Ve(m,"float32"),Oo(g))),q(ee(f,b),Ye(Oo(g),Ve(m,"float32")))]}}})(t,e)}function sZ(t,e,n,r=0,o=Dr.SUM_BY_NONZERO_WEIGHTS){let s=M(t,"onehotLabels","softmaxCrossEntropy");const i=M(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=M(n,"weights","softmaxCrossEntropy")),zo(s.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){const c=ut(r),u=ut(1),d=ut(s.shape[1]);s=Re(q(s,Ye(u,c)),et(c,d))}const l=oZ(s,i);return ra(l,a,o)}const $ye=J({softmaxCrossEntropy_:sZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iZ(t,e,n,r){const o=M(t,"indices","sparseFillEmptyRows","int32"),s=M(e,"values","sparseFillEmptyRows"),i=M(n,"denseShape","sparseFillEmptyRows","int32"),a=M(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(o.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${o.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:o,values:s,denseShape:i,defaultValue:a},c=Z.runKernel(l1,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const Sye=J({sparseFillEmptyRows_:iZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aZ(t,e,n){const r=M(t,"inputIndices","sparseReshape","int32"),o=M(e,"inputShape","sparseReshape","int32"),s=M(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(o.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${o.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const i={inputIndices:r,inputShape:o,newShape:s},a=Z.runKernel(c1,i);return{outputIndices:a[0],outputShape:a[1]}}const Iye=J({sparseReshape_:aZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lZ(t,e,n){const r=M(t,"data","sparseSegmentMean"),o=M(e,"indices","sparseSegmentMean","int32"),s=M(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${o.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);const i={data:r,indices:o,segmentIds:s};return Z.runKernel(u1,i)}const kye=J({sparseSegmentMean_:lZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cZ(t,e,n){const r=M(t,"data","sparseSegmentSum"),o=M(e,"indices","sparseSegmentSum","int32"),s=M(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${o.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);const i={data:r,indices:o,segmentIds:s};return Z.runKernel(d1,i)}const Tye=J({sparseSegmentSum_:cZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uZ(t,e,n,r,o,s,i,a){const l=M(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=M(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:r,leftPad:o,rightPad:s,padWidth:i,preserveShortSequences:a},d={data:l,dataSplits:c},h=Z.runKernel(p1,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}const Eye=J({stringNGrams_:uZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dZ(t,e,n=!0){const r=M(t,"input","stringSplit","string"),o=M(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(o.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${o.shape}`);const s={skipEmpty:n},i={input:r,delimiter:o},a=Z.runKernel(m1,i,s);return{indices:a[0],values:a[1],shape:a[2]}}const Rye=J({stringSplit_:dZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hZ(t,e){const n=M(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const o={input:n};return Z.runKernel(g1,o,r)}const Nye=J({stringToHashBucketFast_:hZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pa={flipLeftRight:fY,grayscaleToRGB:mY,resizeNearestNeighbor:e_,resizeBilinear:QN,rotateWithOffset:bY,cropAndResize:dY,nonMaxSuppression:xY,nonMaxSuppressionAsync:TY,nonMaxSuppressionWithScore:RY,nonMaxSuppressionWithScoreAsync:_Y,nonMaxSuppressionPadded:DY,nonMaxSuppressionPaddedAsync:OY,threshold:zY,transform:VY},fZ={bandPart:HY,gramSchmidt:jY,qr:qY};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oa extends Xc{minimize(e,n=!1,r){const{value:o,grads:s}=this.computeGradients(e,r);if(r!=null){const i=r.map(a=>({name:a.name,tensor:s[a.name]}));this.applyGradients(i)}else this.applyGradients(s);return yt(s),n?o:(o.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return fq(e,n)}dispose(){this.iterations_!=null&&yt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:ut(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(oa,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lw extends oa{constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const s=Z.registeredVariables[r],i=!1;this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${r}/accum_grad`,variable:ie(()=>Nt(s).variable(i))}),this.accumulatedUpdates[o]==null&&(this.accumulatedUpdates[o]={originalName:`${r}/accum_var`,variable:ie(()=>Nt(s).variable(i))});const a=Array.isArray(e)?e[o].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[o].variable,c=this.accumulatedUpdates[o].variable;ie(()=>{const u=Re(q(l,this.rho),q(Zt(a),1-this.rho)),d=q(et(kr(Re(c,this.epsilon)),kr(Re(l,this.epsilon))),a),h=Re(q(c,this.rho),q(Zt(d),1-this.rho));l.assign(u),c.assign(h);const f=Re(q(d,-this.learningRate),s);s.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(yt(this.accumulatedGrads.map(e=>e.variable)),yt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}lw.className="Adadelta";Te(lw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cw extends oa{constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const s=Z.registeredVariables[r];this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${r}/accumulator`,variable:ie(()=>Ph(s.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[o].tensor:e[r];if(i==null)return;const a=this.accumulatedGrads[o].variable;ie(()=>{const l=Re(a,Zt(i));a.assign(l);const c=Re(q(et(i,kr(Re(l,Z.backend.epsilon()))),-this.learningRate),s);s.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&yt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}cw.className="Adagrad";Te(cw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uw extends oa{constructor(e,n,r,o=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=o,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ie(()=>{this.accBeta1=ut(n).variable(),this.accBeta2=ut(r).variable()}),o==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ie(()=>{const r=Ye(1,this.accBeta1),o=Ye(1,this.accBeta2);n.forEach((s,i)=>{const a=Z.registeredVariables[s],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${s}/m`,variable:ie(()=>Nt(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${s}/v`,variable:ie(()=>Nt(a).variable(l))});const c=Array.isArray(e)?e[i].tensor:e[s];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,h=Re(q(u,this.beta1),q(c,1-this.beta1)),f=Re(q(d,this.beta2),q(Zt(c),1-this.beta2)),p=et(h,r),m=et(f,o);u.assign(h),d.assign(f);const g=Re(q(et(p,Re(kr(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(q(this.accBeta1,this.beta1)),this.accBeta2.assign(q(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&yt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&yt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),ie(()=>{this.accBeta1.assign(Cc(this.beta1,this.iterations_+1)),this.accBeta2.assign(Cc(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}uw.className="Adam";Te(uw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dw extends oa{constructor(e,n,r,o=null,s=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=o,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ie(()=>{this.iteration=ut(0).variable(),this.accBeta1=ut(n).variable()}),o==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ie(()=>{const r=Ye(1,this.accBeta1),o=et(-this.learningRate,Re(q(this.iteration,this.decay),1));n.forEach((s,i)=>{const a=Z.registeredVariables[s],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${s}/m`,variable:Nt(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${s}/v`,variable:Nt(a).variable(l)});const c=Array.isArray(e)?e[i].tensor:e[s];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,h=Re(q(u,this.beta1),q(c,1-this.beta1)),f=q(d,this.beta2),p=Xn(c),m=ta(f,p);u.assign(h),d.assign(m);const g=Re(q(et(o,r),et(h,Re(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(Re(this.iteration,1)),this.accBeta1.assign(q(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&yt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&yt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}dw.className="Adamax";Te(dw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eb extends oa{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const s=Array.isArray(e)?e[o].tensor:e[r];if(s==null)return;const i=Z.registeredVariables[r];ie(()=>{const a=Re(q(this.c,s),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Rs(ut(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}eb.className="SGD";Te(eb);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hw extends eb{constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=ut(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const s=Z.registeredVariables[r];this.accumulations[o]==null&&(this.accumulations[o]={originalName:`${r}/momentum`,variable:ie(()=>Nt(s).variable(!1))});const i=this.accumulations[o].variable,a=Array.isArray(e)?e[o].tensor:e[r];a!=null&&ie(()=>{let l;const c=Re(q(this.m,i),a);this.useNesterov?l=Re(q(this.c,Re(a,q(c,this.m))),s):l=Re(q(this.c,c),s),i.assign(c),s.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&yt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}hw.className="Momentum";Te(hw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fw extends oa{constructor(e,n=.9,r=0,o=null,s=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=o,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,o==null&&(this.epsilon=Z.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const s=Z.registeredVariables[r],i=!1;this.accumulatedMeanSquares[o]==null&&(this.accumulatedMeanSquares[o]={originalName:`${r}/rms`,variable:ie(()=>Nt(s).variable(i))}),this.accumulatedMoments[o]==null&&(this.accumulatedMoments[o]={originalName:`${r}/momentum`,variable:ie(()=>Nt(s).variable(i))}),this.accumulatedMeanGrads[o]==null&&this.centered&&(this.accumulatedMeanGrads[o]={originalName:`${r}/mg`,variable:ie(()=>Nt(s).variable(i))});const a=Array.isArray(e)?e[o].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[o].variable,c=this.accumulatedMoments[o].variable;ie(()=>{const u=Re(q(l,this.decay),q(Zt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[o].variable,h=Re(q(d,this.decay),q(a,1-this.decay)),f=et(q(a,this.learningRate),kr(Ye(u,Re(Zt(h),this.epsilon)))),p=Re(q(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const m=Ye(s,p);s.assign(m)}else{const d=Re(q(l,this.decay),q(Zt(a),1-this.decay)),h=Re(q(c,this.momentum),et(q(a,this.learningRate),kr(Re(d,this.epsilon))));l.assign(d),c.assign(h);const f=Ye(s,h);s.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&yt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&yt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&yt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}fw.className="RMSProp";Te(fw);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ba{static sgd(e){return new eb(e)}static momentum(e,n,r=!1){return new hw(e,n,r)}static rmsprop(e,n=.9,r=0,o=null,s=!1){return new fw(e,n,r,o,s)}static adam(e=.001,n=.9,r=.999,o=null){return new uw(e,n,r,o)}static adadelta(e=.001,n=.95,r=null){return new lw(e,n,r)}static adamax(e=.002,n=.9,r=.999,o=null,s=0){return new dw(e,n,r,o,s)}static adagrad(e,n=.1){return new cw(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ml={sgd:ba.sgd,momentum:ba.momentum,adadelta:ba.adadelta,adagrad:ba.adagrad,rmsprop:ba.rmsprop,adamax:ba.adamax,adam:ba.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pZ=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t())();function pw(){return new Promise(t=>pZ(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mw(t,e){const n=t[0].length;t.forEach((o,s)=>{D(o.length===n,()=>`Error in concat${n}D: rank of tensors[${s}] must be the same as the rank of the rest (${n})`)}),D(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((o,s)=>{for(let i=0;i<n;i++)D(i===e||o[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${s}] (${o}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function Ns(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ko;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Ko||(Ko={}));function t_(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let o=1;o<n.length;++o){const s=n[o],i=r[r.length-n.length+o],a=r[i];if(s>=0)if(a>=0){if(a!==s)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${o+t}] = ${s} but shape[${o+t}] = ${a}`)}else r[i]=s}return r}function n_(t){const e={FIRST_DIM_SIZE:Ko.FIRST_DIM_SIZE,VALUE_ROWIDS:Ko.VALUE_ROWIDS,ROW_LENGTHS:Ko.ROW_LENGTHS,ROW_SPLITS:Ko.ROW_SPLITS,ROW_LIMITS:Ko.ROW_LIMITS,ROW_STARTS:Ko.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function r_(t){return t.length===0?0:t[0]===Ko.FIRST_DIM_SIZE?t.length-1:t.length}function o_(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let o=0;o<Math.min(n,r-1);++o){const s=t[o],i=e[o+1];if(s>=0&&i>=0&&s!==1&&s!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${o-t.length}] = ${s} but ragged tensor input.flatValues.shape[${o-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gw=30;function tb(t){return t<=gw?t:Ix(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bw(t,e,n){const r=n*(typeof t=="number"?t:t[0]),o=e*(typeof t=="number"?t:t[1]);return[r,o]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zh(t,e,n,r=!0){let o=[];if(r)o=o.concat(e.slice(0)),o.push(t[0]/n),o=o.concat(t.slice(1));else{o=o.concat(t[0]);const s=e.length;for(let i=0;i<s;++i)o=o.concat([t[i+1]/e[i],e[i]]);o=o.concat(t.slice(s+1))}return o}function Wh(t,e,n=!0){const r=[];if(n){r.push(e);for(let o=e+1;o<t;++o)o<=2*e?(r.push(o),r.push(o-(e+1))):r.push(o)}else{const o=[],s=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?s.push(i):o.push(i);r.push(...o),r.push(0),r.push(...s)}return r}function Vh(t,e,n,r=!0){const o=[];r?o.push(t[0]/n):o.push(t[0]*n);for(let s=1;s<t.length;++s)s<=e.length?r?o.push(e[s-1]*t[s]):o.push(t[s]/e[s-1]):o.push(t[s]);return o}function vw(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function xw(t,e,n){const r=t.slice(0,1);for(let o=0;o<n;++o)r.push(t[o+1]-e[o][0]-e[o][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nb=1.7580993408473768,rb=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yw=.3275911,ww=.254829592,Cw=-.284496736,$w=1.421413741,Sw=-1.453152027,Iw=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ni(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function s_(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function i_(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let o=0;o<t.length;o+=4)n[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:n,imag:r}}function a_(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let o=2;o<t.length;o+=4)n[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:n,imag:r}}function kw(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function l_(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function c_(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let o=0;o<Math.ceil(t/2);o++){const s=(e?2:-2)*Math.PI*(o/t);n[o]=Math.cos(s),r[o]=Math.sin(s)}return{real:n,imag:r}}function u_(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),o=Math.cos(r),s=Math.sin(r);return{real:o,imag:s}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bv="->",mZ=/->/g,BI=",",zI="...";function Tw(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(mZ,"").length)/bv.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${bv}").`);const[r,o]=t.split(bv);D(r.indexOf(zI)===-1,()=>`The ellipsis notation ("${zI}") is not supported yet.`);const s=r.split(BI),i=s.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<o.length;++h){const f=o[h];if(!s.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<r.length;++h){const f=r[h];a.indexOf(f)===-1&&f!==BI&&a.push(f)}const l=new Array(s.length);for(let h=0;h<i;++h){if(new Set(s[h].split("")).size!==s[h].length)throw new Error(`Found duplicate axes in input component ${s[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<s[h].length;++f)l[h].push(a.indexOf(s[h][f]))}const c=a.length,u=o.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function Ew(t,e){let n=new Array(t);n.fill(-1);for(let o=0;o<e.length;++o)n[e[o]]=o;const r=[];for(let o=0;o<t;++o)n[o]===-1&&r.push(o);return n=n.filter(o=>o!==-1),{permutationIndices:n,expandDims:r}}function Rw(t,e,n){const r=new Array(t);for(let o=0;o<n.length;++o){const s=n[o].shape;for(let i=0;i<e[o].length;++i)r[e[o][i]]===void 0?r[e[o][i]]=s[i]:D(r[e[o][i]]===s[i],()=>`Expected dimension ${r[e[o][i]]} at axis ${i} of input shaped ${JSON.stringify(s)}, but got dimension ${s[i]}`)}}function Nw(t,e){const n=t,r=[];let o=0;t.length===0&&n.push(-1),o=t.length+1;for(let i=0;i<o;++i)r.push([]);const s=[];for(let i=0;i<n.length;++i){const a=n[i],l=gZ(e,a);for(const c of l)s.indexOf(c)===-1&&(r[i].push(c),s.push(c))}return{path:n,steps:r}}function _w(t){return t.every((e,n)=>e===n)}function gZ(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function Aw(t,e,n=0){let r=[];if(typeof e=="number")D(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const o=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);D(o<=1,()=>"There should be only one negative value in split array.");const s=e.indexOf(-1);if(s!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[s]=t.shape[n]-i}D(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function h_(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function f_(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function m_(t,e){return`size ${t} must be non-negative, not ${e}`}function g_(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function b_(t,e){const n=me(t),r=me(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function v_(t,e){const n=me(t),r=me(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gx(){return"segment ids must be >= 0"}function x_(){return"segment ids are not increasing"}function y_(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function w_(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_(t,e){let n=!1,r;for(t<=gw?(r=t,n=!0):r=Ix(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=Ix(t,r+1);return r}function $_(t,e,n){const r=[],o=t.length;for(let s=0;s<o;s++)s!==e?r.push(t[s]):r.push(n);return r}function Dw(t,e,n,r){const o=e.shape.length,s=t.shape.length;if(r!==0&&(r<-o||r>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${r}`);if(r<0&&(r+=o),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<r;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=r;d<o;d++)a.push(e.shape[d]);for(let d=n+1;d<s;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:a}}const bZ=Object.freeze(Object.defineProperty({__proto__:null,segOpComputeOptimalWindowSize:C_,computeOutShape:$_,collectGatherOpShapeInfo:Dw},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ll(t){try{return t.map(e=>Wi(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function S_(t){return t.map(e=>Di(e))}const vZ=Object.freeze(Object.defineProperty({__proto__:null,slice_util:e9,segment_util:bZ,fromUint8ToStringArray:ll,fromStringArrayToUint8:S_,upcastType:Jr,axesAreInnerMostDims:B1,combineLocations:$N,computeOutAndReduceShapes:er,expandShapeToKeepDim:Tn,assertAxesAreInnerMostDims:ar,getAxesPermutation:wn,getUndoAxesPermutation:ea,getInnerMostAxes:En,getBroadcastDims:wc,getReductionAxes:Kn,assertAndGetBroadcastShape:bt,assertParamsConsistent:mw,computeOutShape:Ns,computeDilation2DInfo:Oh,computePool2DInfo:Wo,computePool3DInfo:li,computeConv2DInfo:ir,computeConv3DInfo:Qi,computeDefaultPad:A1,tupleValuesAreOne:rl,eitherStridesOrDilationsAreOne:br,convertConv2DDataFormat:ci,checkPadOnDimRoundingMode:Lr,getFusedDyActivation:ew,getFusedBiasGradient:tw,applyActivation:nw,shouldFuse:rw,get RowPartitionType(){return Ko},combineRaggedTensorToTensorShapes:t_,getRowPartitionTypesHelper:n_,getRaggedRank:r_,validateDefaultValueShape:o_,PARALLELIZE_THRESHOLD:gw,computeOptimalWindowSize:tb,getImageCenter:bw,getReshaped:zh,getPermuted:Wh,getReshapedPermuted:Vh,getSliceBeginCoords:vw,getSliceSize:xw,prepareAndValidate:k1,validateUpdateShape:aN,validateInput:XK,calculateShapes:Fh,SELU_SCALEALPHA:nb,SELU_SCALE:rb,ERF_P:yw,ERF_A1:ww,ERF_A2:Cw,ERF_A3:$w,ERF_A4:Sw,ERF_A5:Iw,warn:ao,log:R8,mergeRealAndImagArrays:ni,splitRealAndImagArrays:s_,complexWithEvenIndex:i_,complexWithOddIndex:a_,getComplexWithIndex:kw,assignToTypedArray:l_,exponents:c_,exponent:u_,decodeEinsumEquation:Tw,getEinsumPermutation:Ew,checkEinsumDimSizes:Rw,getEinsumComputePath:Nw,isIdentityPermutation:_w,prepareSplitSize:Aw,getSparseFillEmptyRowsIndicesDenseShapeMismatch:d_,getSparseFillEmptyRowsNegativeIndexErrorMessage:h_,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:f_,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:p_,getSparseReshapeNegativeOutputDimErrorMessage:m_,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:g_,getSparseReshapeInputOutputMultipleErrorMessage:b_,getSparseReshapeInputOutputMismatchErrorMessage:v_,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Gx,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:x_,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:y_,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:w_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_={kernelName:Um,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,Bh(Ve(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xZ={kernelName:Bd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Zt(Ve(n,"float32")),o=kr(Ye(ut(1),r));return yn(et(t,o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yZ={kernelName:zd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=kr(Ye(Zt(Ve(n,"float32")),1));return et(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wZ={kernelName:qc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=bt(n.shape,r.shape);return{a:()=>{let a=t;const l=Kn(n.shape,o);return l.length>0&&(a=Xe(a,l)),ee(a,n.shape)},b:()=>{let a=t;const l=Kn(r.shape,o);return l.length>0&&(a=Xe(a,l)),ee(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CZ={kernelName:Ny,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,o)=>{n[o]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Z={kernelName:Hm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Nt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SZ={kernelName:Gm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Nt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IZ={kernelName:Wd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>et(t,kr(Ye(ut(1),Zt(Ve(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kZ={kernelName:Vd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=kr(Re(ut(1),Zt(Ve(n,"float32"))));return et(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TZ={kernelName:Gd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=bt(n.shape,r.shape);return{a:()=>{const a=Re(Zt(n),Zt(r));let l=q(t,et(r,a));const c=Kn(n.shape,o);return c.length>0&&(l=Xe(l,c)),ee(l,n.shape)},b:()=>{const a=Re(Zt(n),Zt(r));let l=yn(q(t,et(n,a)));const c=Kn(r.shape,o);return c.length>0&&(l=Xe(l,c)),ee(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EZ={kernelName:Ud,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>et(t,Re(Zt(Ve(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RZ={kernelName:Hd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>et(t,Ye(ut(1),Zt(Ve(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NZ(t,e,n,r,o,s){const i=M(t,"dy","avgPool3dGrad"),a=M(e,"input","avgPool3dGrad");let l=i,c=a,u=!1;a.rank===4&&(u=!0,l=ee(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=ee(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),D(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),D(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Lr("avgPool3dGrad",o,s);const d={dy:l,input:c},h={filterSize:n,strides:r,pad:o,dimRoundingMode:s},f=Z.runKernel(Fy,d,h);return u?ee(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const _Z=J({avgPool3dGrad_:NZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AZ={kernelName:Km,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:o,strides:s,pad:i,dimRoundingMode:a}=n;return{x:()=>_Z(t,r,o,s,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(t,e,n,r,o){const s=M(t,"dy","avgPoolGrad"),i=M(e,"input","avgPoolGrad");D(i.rank===s.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${s.rank})`);let a=i,l=s,c=!1;i.rank===3&&(c=!0,a=ee(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=ee(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),D(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:r,pad:o},h=Z.runKernel(Dy,u,d);return c?ee(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const FZ=J({avgPoolGrad_:DZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OZ={kernelName:jm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:o,strides:s,pad:i}=n;return{x:()=>FZ(t,r,o,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PZ={kernelName:qm,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,o]=e,{transposeA:s,transposeB:i}=n;return!s&&!i?{a:()=>Lt(t,o,!1,!0),b:()=>Lt(r,t,!0,!1)}:!s&&i?{a:()=>Lt(t,o,!1,!1),b:()=>Lt(t,r,!0,!1)}:s&&!i?{a:()=>Lt(o,t,!1,!0),b:()=>Lt(r,t,!1,!1)}:{a:()=>Lt(o,t,!0,!0),b:()=>Lt(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MZ={kernelName:Xm,gradFunc:(t,e,n)=>{const{blockShape:r,crops:o}=n;return{x:()=>K1(t,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LZ={kernelName:k8,gradFunc:(t,e,n)=>{const r=n,o=r.inputShape,s=r.shape,i=Array.from(s);for(let l=o.length-1;l>=0;l--)if(o[l]===s[l])i[l]=1;else if(o[l]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${s}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>Xe(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BZ={kernelName:jd,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zZ={kernelName:Kd,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WZ={kernelName:qd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:o,clipValueMax:s}=n;return{x:()=>Qr(ti(wl(r,o),Zc(r,s)),t,Nt(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VZ={kernelName:Ym,inputsToSave:["x"],gradFunc:I_.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UZ={kernelName:Zm,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:o}=n,s=Ct(o,e[0].shape)[0],i=r.map(l=>l[s]);return ho(t,i,s).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HZ={kernelName:Jm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,o]=e,{dilations:s,strides:i,pad:a,dataFormat:l}=n;return D(rl(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>P1(r.shape,t,o,i,a,l),filter:()=>Q1(r,t,o.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GZ={kernelName:Qm,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,o]=e,{strides:s,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>ol(t,o,s,i,a,1,l),filter:()=>Q1(t,r,o.shape,s,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jZ(t,e,n,r,o){let s=t;t.rank===4&&(s=ee(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=ee(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),D(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),D(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),D(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),D(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),D(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:s,dy:i},l={strides:r,pad:o,filterShape:n};return Z.runKernel(Ly,a,l)}const KZ=J({conv3DBackpropFilter_:jZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qZ={kernelName:eg,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:o,pad:s}=n;D(rl(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[i,a]=e;return{x:()=>yN(i.shape,t,a,o,s),filter:()=>KZ(i,t,a.shape,o,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XZ={kernelName:Xd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(yn(UN(Ve(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YZ={kernelName:Yd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(HN(Ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZZ={kernelName:tg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:o,exclusive:s,reverse:i}=n;return{x:()=>{const a=wn([o],r.rank);let l=CN(t,o,s,!i);return a!=null&&(l=Et(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ={kernelName:ng,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:o,pad:s,dimRoundingMode:i}=n,a=r==null?[1,1]:r;D(rl(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return D(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),D(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),D(br(o,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${o} and dilations '${a}'.`),Lr("depthwiseConv2d",s,i),{x:()=>nY(l.shape,t,c,o,s,a,i),filter:()=>eY(l,t,c.shape,o,s,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QZ={kernelName:rg,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,o]=e,s={x:r,filter:o,dy:t},i={x:r,filter:o,dy:t};return{x:()=>Z.runKernel(kx,s,n),filter:()=>Z.runKernel(Tx,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eJ={kernelName:Jd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>Z.runKernel(jy,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tJ={kernelName:Qd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=q(Oo(yn(Zt(n))),2/Math.sqrt(Math.PI));return{x:()=>q(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nJ={kernelName:eh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJ={kernelName:sg,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>ee(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oJ={kernelName:th,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,Oo(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ={kernelName:nh,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iJ={kernelName:rh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=bt(n.shape,r.shape);return{a:()=>{const a=et(t,Ve(r,"float32")),l=Kn(n.shape,o);return l.length>0?ee(Xe(a,l),n.shape):a},b:()=>{let a=q(t,Ve(n,"float32"));const l=Kn(r.shape,o);l.length>0&&(a=ee(Xe(a,l),r.shape));const c=Zt(r);return yn(et(a,Ve(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ={kernelName:ig,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[o,s,i,a]=e,l=a==null?ut(1):a,c=Kn(s.shape,o.shape),u=[];if(s.rank===1){for(let y=0;y<o.shape.length-1;++y)u.push(o.shape[y]);u.push(1)}const d=Ye(o,s),h=q(t,l),f=zN(Re(i,ut(r))),p=q(q(q(f,f),f),ut(-.5));return{x:()=>s.rank===1?ee(q(q(t,Yo(ee(f,[1,1,1,s.shape[0]]),u)),l),o.shape):ee(q(q(t,f),l),o.shape),mean:()=>{let y=q(q(f,ut(-1)),h);return s.rank===1&&(y=Xe(y,c)),ee(y,s.shape)},variance:()=>{let y=q(q(p,d),h);return s.rank===1&&(y=Xe(y,c)),ee(y,s.shape)},scale:()=>{const y=q(d,f);let C=q(t,y);return s.rank===1&&(C=Xe(C,c)),ee(C,s.shape)},offset:()=>{let y=t;return s.rank===1&&(y=Xe(y,c)),ee(y,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lJ={kernelName:ag,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,o]=e,{axis:s}=n,i=Ct(s,r.shape)[0];return{x:()=>{const l=r.shape,c=o.size,u=l.slice(0,i),d=u.length,h=l.slice(s,l.length).slice(1),f=h.length,p=WI(0,d),m=WI(d+1,d+1+f),g=VI([u,[c],h]),b=ee(t,g),v=ee(o,[c]),w=VI([[d],p,m]),y=Et(b,w);let C=YN(y,v,r.shape[i]);const S=ea(w);return C=Et(C,S),C},indices:()=>o}}};function WI(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function VI(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cJ={kernelName:oh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Nt(n),b:()=>Nt(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJ={kernelName:sh,gradFunc:t=>({x:()=>Ve(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dJ={kernelName:ih,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJ={kernelName:ah,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fJ={kernelName:lh,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pJ={kernelName:cg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:o}=n,s=vo(r,0);return{x:()=>Qr(s,t,q(t,o))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mJ={kernelName:uh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>et(t,Re(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gJ={kernelName:ch,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>et(t,Ve(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bJ={kernelName:T8,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:o}=n;return{logits:()=>{const i=Oo(r);return Ye(t,q(Xe(t,o,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vJ(t,e,n,r=5,o=1,s=1,i=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:o,alpha:s,beta:i};return Z.runKernel(Jy,a,l)}const xJ=J({localResponseNormalizationBackprop_:vJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yJ={kernelName:mg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,o]=e,{depthRadius:s,bias:i,alpha:a,beta:l}=n;return{x:()=>xJ(r,o,t,s,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_(t,e,n,r){return e.rank<n.rank&&(e=ee(e,Tn(e.shape,r))),t.rank<n.rank&&(t=ee(t,Tn(t.shape,r))),{x:()=>q(t,Ve(Ms(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UI={kernelName:gg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:o}=r,s=e[0],i=e[1],a=Ct(o,s.shape),l=k_(t,i,s,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wJ={kernelName:dh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>q(t,Ve(wl(n,r),"float32")),b:()=>q(t,Ve(kN(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CJ(t,e,n,r,o,s,i){const a=M(t,"dy","maxPool3dGrad"),l=M(e,"input","maxPool3dGrad"),c=M(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=ee(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=ee(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=ee(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),D(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),D(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),D(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),Lr("maxPool3dGrad",s,i);const p={dy:u,input:d,output:h},m={filterSize:r,strides:o,pad:s,dimRoundingMode:i},g=Z.runKernel(e1,p,m);return f?ee(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const $J=J({maxPool3dGrad_:CJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SJ={kernelName:vg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,o]=e,{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>$J(t,r,o,s,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(t,e,n,r,o,s,i){const a=M(t,"dy","maxPoolGrad"),l=M(e,"input","maxPoolGrad"),c=M(n,"output","maxPoolGrad");D(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),D(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),D(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Lr("maxPoolGrad",s,i);const u={dy:a,input:l,output:c},d={filterSize:r,strides:o,pad:s,dimRoundingMode:i};return Z.runKernel(Qy,u,d)}const kJ=J({maxPoolGrad_:IJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ={kernelName:bg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,o]=e,{filterSize:s,strides:i,pad:a}=n;return{x:()=>kJ(t,r,o,s,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ={kernelName:xg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:o}=n,s=Ct(o,r.shape),a=er(r.shape,s)[1],l=me(a);return{x:()=>{const u=r.shape.slice();s.forEach(f=>{u[f]=1});const d=ee(t,u);return et(q(d,na(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RJ={kernelName:yg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:o}=r,[s,i]=e,a=Ct(o,s.shape),l=k_(t,i,s,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NJ={kernelName:hh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>q(t,Ve(Zc(n,r),"float32")),b:()=>q(t,Ve(vo(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J={kernelName:wg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:o}=n,s=o.map(i=>i[0]);return{x:()=>Vt(t,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AJ={kernelName:fh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=bt(n.shape,r.shape);return{a:()=>{const a=Kn(n.shape,o);return a.length>0?ee(Xe(t,a),n.shape):t},b:()=>{const a=q(t,yn(Zg(et(n,r)))),l=Kn(r.shape,o);return l.length>0?ee(Xe(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DJ={kernelName:ph,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=bt(n.shape,r.shape);return{a:()=>{const a=q(t,Ve(r,"float32")),l=Kn(n.shape,o);return l.length>0?ee(Xe(a,l),n.shape):a},b:()=>{const a=q(t,Ve(n,"float32")),l=Kn(r.shape,o);return l.length>0?ee(Xe(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FJ={kernelName:Cg,gradFunc:t=>({x:()=>yn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OJ={kernelName:Ig,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Zn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PJ={kernelName:Sg,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MJ={kernelName:kg,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return al(t,r).map(s=>()=>s)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HI={kernelName:Tg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:o}=n,s=o.map(i=>i[0]);return{x:()=>Vt(t,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJ={kernelName:mh,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,o]=e,s=n,i=r,a=bt(s.shape,i.shape);return{a:()=>{const u=Ve(i,"float32");let d=q(t,q(u,Cc(s,Ye(u,ut(1)))));const h=Kn(s.shape,a);return h.length>0&&(d=Xe(d,h)),ee(d,s.shape)},b:()=>{const u=vo(s,0),d=Qr(u,Po(s),Nt(s));let h=q(t,q(o,d));const f=Kn(i.shape,a);return f.length>0&&(h=Xe(h,f)),ee(h,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BJ={kernelName:Eg,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,o=vo(n,0);return{x:()=>Qr(o,t,q(t,r)),alpha:()=>{let s=Qr(o,Nt(t),q(t,n));const i=Kn(r.shape,t.shape);return i.length>0&&(s=Xe(s,i)),ee(s,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zJ(t,e,n){const r=t.shape.slice();r[n]=1;const o=ee(e,r),s=Ux(t,n,!0,!1),i=Ux(t,n,!0,!0),a=q(s,i);return q(o,a)}function WJ(t,e,n){const r=t.shape.length,o=r-n.length,s=wn(n,r);let i=t;s!=null&&(i=Et(t,s));const a=i.shape.slice(),c=a.splice(r-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=i.reshape(a);let d=zJ(u,e,o);if(d=d.reshape(i.shape),s!=null){const h=ea(s);d=Et(d,h)}return d}const VJ={kernelName:Rg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:o}=n;let s=[];return o==null?s=r.shape.map((i,a)=>a):typeof o=="number"?s=[o]:s=o,{x:()=>WJ(r,t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UJ={kernelName:Zd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=bt(n.shape,r.shape);return{a:()=>{const a=et(t,Ve(r,"float32")),l=Kn(n.shape,o);return l.length>0?ee(Xe(a,l),n.shape):a},b:()=>{let a=q(t,Ve(n,"float32"));const l=Kn(r.shape,o);l.length>0&&(a=ee(Xe(a,l),r.shape));const c=Zt(r);return yn(et(a,Ve(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HJ={kernelName:gh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>et(t,yn(Zt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GJ={kernelName:vh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=q(Zc(n,6),Bh(n));return{x:()=>q(t,Ve(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jJ={kernelName:bh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,Ve(Bh(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KJ={kernelName:Ng,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qJ={kernelName:Ag,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,o={dy:t,images:r};return{images:()=>Z.runKernel(a1,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XJ={kernelName:_g,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,o={dy:t,images:r};return{images:()=>Z.runKernel(i1,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YJ={kernelName:Dg,gradFunc:(t,e,n)=>{const{dims:r}=n,o=Ct(r,t.shape);return{x:()=>il(t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZJ={kernelName:xh,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JJ={kernelName:yh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yn(et(t,q(Cc(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QJ={kernelName:Fg,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Ve(Nt(n),"float32"),t:()=>q(t,Ve(n,t.dtype)),e:()=>q(t,Ve(U1(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eQ={kernelName:wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=vo(n,ut(0)),o=ut(nb),s=ut(rb),i=q(t,s),a=q(q(t,o),Oo(Ve(n,"float32")));return Qr(r,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tQ={kernelName:Ih,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,q(n,Ye(ut(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nQ={kernelName:Sh,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rQ={kernelName:Ch,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(M1(Ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oQ={kernelName:$h,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(wN(Ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sQ={kernelName:Og,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:o,size:s}=n,i=r.shape,[a,l]=Kg(r,o,s),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],i[u]-a[u]-l[u]]);return{x:()=>j1(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iQ={kernelName:Bg,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:o}=n,s=!0,i=q(t,r);return{logits:()=>Ye(i,q(Xe(i,[o],s),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aQ={kernelName:kh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,Yc(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GI={kernelName:Mg,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:o}=n;return{x:()=>O1(t,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jI={kernelName:Lg,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>mr(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lQ={kernelName:Th,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>et(t,q(kr(Ve(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cQ={kernelName:h1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,q(Ve(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uQ={kernelName:Eh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=ut(2);return{a:()=>q(t,q(o,Ye(n,r))),b:()=>q(t,q(o,Ye(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dQ={kernelName:Dh,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hQ={kernelName:Rh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=bt(n.shape,r.shape);return{a:()=>{let a=t;const l=Kn(n.shape,o);return l.length>0&&(a=Xe(a,l)),ee(a,n.shape)},b:()=>{let a=t;const l=Kn(r.shape,o);return l.length>0&&(a=Xe(a,l)),ee(yn(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fQ={kernelName:Pg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,o=r.shape.slice(),{axis:s}=n;Ct(s,r.shape).forEach(c=>{o[c]=1});const a=ee(t,o),l=q(a,na(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQ={kernelName:Nh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>et(t,Zt(M1(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mQ={kernelName:_h,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(Ye(ut(1),Zt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gQ={kernelName:Ah,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:o}=n;return{x:()=>{let i=Nt(r);if(r.rank===1)for(let a=0;a<o[0];++a)i=Re(i,Vt(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)i=Re(i,Vt(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let c=0;c<o[2];++c)i=Re(i,Vt(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let c=0;c<o[2];++c)for(let u=0;u<o[3];++u)i=Re(i,Vt(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bQ={kernelName:rc,gradFunc:(t,e,n)=>{const r=n,{perm:o}=r,s=ea(o);return{x:()=>Et(t,s)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vQ={kernelName:zg,gradFunc:(t,e,n)=>{const r=n,{axis:o}=r;return{value:()=>Vi(t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xQ={kernelName:Wg,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>yQ(t,n)}}};function yQ(t,e){const n=ta(e,Nt(e)),r=z1(t,n);let o=wl(e,ut(0,"int32"));const s=r.rank-o.rank;for(let a=0;a<s;++a)o=Gr(o,a+1);o=ti(o,na(r.shape,"bool"));const i=Nt(r);return Qr(o,r,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wQ={kernelName:Vg,gradFunc:t=>({x:()=>Nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CQ=[I_,xZ,yZ,wZ,CZ,$Z,SZ,IZ,kZ,TZ,EZ,RZ,AZ,OZ,PZ,MZ,LZ,BZ,zZ,WZ,VZ,UZ,GZ,HZ,qZ,XZ,YZ,ZZ,JZ,QZ,UJ,eJ,tJ,nJ,rJ,oJ,iJ,sJ,aJ,lJ,cJ,uJ,dJ,hJ,fJ,pJ,mJ,gJ,bJ,yJ,UI,UI,wJ,SJ,TJ,EJ,RJ,NJ,_J,AJ,DJ,FJ,OJ,PJ,MJ,HI,HI,LJ,BJ,VJ,HJ,GJ,jJ,KJ,qJ,XJ,YJ,ZJ,JJ,QJ,eQ,tQ,nQ,rQ,oQ,sQ,iQ,aQ,GI,GI,jI,jI,lQ,uQ,cQ,dQ,hQ,fQ,pQ,mQ,gQ,bQ,vQ,xQ,wQ];for(const t of CQ)N8(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.abs=function(){return this.throwIfDisposed(),Xn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.acos=function(){return this.throwIfDisposed(),a9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.acosh=function(){return this.throwIfDisposed(),c9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.add=function(t){return this.throwIfDisposed(),Re(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.all=function(t,e){return this.throwIfDisposed(),bN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.any=function(t,e){return this.throwIfDisposed(),Wx(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.argMax=function(t){return this.throwIfDisposed(),md(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.argMin=function(t){return this.throwIfDisposed(),p9(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.asScalar=function(){return this.throwIfDisposed(),D(this.size===1,()=>"The array must have only 1 element."),ee(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.asType=function(t){return this.throwIfDisposed(),Ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.as1D=function(){return this.throwIfDisposed(),ee(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.as2D=function(t,e){return this.throwIfDisposed(),ee(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),ee(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),ee(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.as5D=function(t,e,n,r,o){return this.throwIfDisposed(),ee(this,[t,e,n,r,o])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.asin=function(){return this.throwIfDisposed(),g9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.asinh=function(){return this.throwIfDisposed(),v9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.atan=function(){return this.throwIfDisposed(),y9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.atan2=function(t){return this.throwIfDisposed(),C9(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.atanh=function(){return this.throwIfDisposed(),S9(this)};fe().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),D1(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),O1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.batchNorm=function(t,e,n,r,o){return this.throwIfDisposed(),qg(this,t,e,n,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.broadcastTo=function(t){return this.throwIfDisposed(),ju(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.cast=function(t){return this.throwIfDisposed(),Ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.ceil=function(){return this.throwIfDisposed(),Y9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),mo(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof An&&(t=[t]),mr([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.conv1d=function(t,e,n,r,o,s){return this.throwIfDisposed(),vN(this,t,e,n,r,o,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.conv2dTranspose=function(t,e,n,r,o){return this.throwIfDisposed(),xN(this,t,e,n,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.conv2d=function(t,e,n,r,o,s){return this.throwIfDisposed(),ol(this,t,e,n,r,o,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.cos=function(){return this.throwIfDisposed(),M1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.cosh=function(){return this.throwIfDisposed(),wN(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Ux(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),CN(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),w7(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.depthwiseConv2d=function(t,e,n,r,o,s){return this.throwIfDisposed(),L1(this,t,e,n,r,o,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.dilation2d=function(t,e,n,r,o){return this.throwIfDisposed(),S7(this,t,e,n,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.divNoNan=function(t){return this.throwIfDisposed(),R7(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.div=function(t){return this.throwIfDisposed(),et(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.dot=function(t){return this.throwIfDisposed(),_7(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.elu=function(){return this.throwIfDisposed(),Xg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.equal=function(t){return this.throwIfDisposed(),Ms(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.erf=function(){return this.throwIfDisposed(),F7(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),U7(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.exp=function(){return this.throwIfDisposed(),Oo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.expandDims=function(t){return this.throwIfDisposed(),Gr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.expm1=function(){return this.throwIfDisposed(),K7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.fft=function(){return this.throwIfDisposed(),jN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.flatten=function(){return this.throwIfDisposed(),ee(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.floor=function(){return this.throwIfDisposed(),Zg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.floorDiv=function(t){return this.throwIfDisposed(),gN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.gather=function(t,e){return this.throwIfDisposed(),z1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.greaterEqual=function(t){return this.throwIfDisposed(),wl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.greater=function(t){return this.throwIfDisposed(),vo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.ifft=function(){return this.throwIfDisposed(),Hx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.irfft=function(){return this.throwIfDisposed(),TX(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.isFinite=function(){return this.throwIfDisposed(),tq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.isInf=function(){return this.throwIfDisposed(),rq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.isNaN=function(){return this.throwIfDisposed(),sq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.leakyRelu=function(t){return this.throwIfDisposed(),W1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.lessEqual=function(t){return this.throwIfDisposed(),Zc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.less=function(t){return this.throwIfDisposed(),kN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),uq(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.logSigmoid=function(){return this.throwIfDisposed(),gq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.logSoftmax=function(t){return this.throwIfDisposed(),TN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),EN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.log=function(){return this.throwIfDisposed(),Po(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.log1p=function(){return this.throwIfDisposed(),V1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.logicalAnd=function(t){return this.throwIfDisposed(),ti(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.logicalNot=function(){return this.throwIfDisposed(),U1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.logicalOr=function(t){return this.throwIfDisposed(),RN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.logicalXor=function(t){return this.throwIfDisposed(),Sq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Lt(this,t,e,n)};fe().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),H1(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.max=function(t,e){return this.throwIfDisposed(),Qo(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.maximum=function(t){return this.throwIfDisposed(),ta(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.mean=function(t,e){return this.throwIfDisposed(),In(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.min=function(t,e){return this.throwIfDisposed(),Gp(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.minimum=function(t){return this.throwIfDisposed(),Jg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Aq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.mod=function(t){return this.throwIfDisposed(),Fq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.mul=function(t){return this.throwIfDisposed(),q(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.neg=function(){return this.throwIfDisposed(),yn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Yg(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.notEqual=function(t){return this.throwIfDisposed(),gd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),sN(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.onesLike=function(){return this.throwIfDisposed(),Mo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.pad=function(t,e){return this.throwIfDisposed(),j1(this,t,e)};fe().prototype.pool=function(t,e,n,r,o,s){return this.throwIfDisposed(),Uq(this,t,e,n,r,o,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.pow=function(t){return this.throwIfDisposed(),Cc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.prelu=function(t){return this.throwIfDisposed(),q1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.prod=function(t,e){return this.throwIfDisposed(),jq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.reciprocal=function(){return this.throwIfDisposed(),aX(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.relu=function(){return this.throwIfDisposed(),ui(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.relu6=function(){return this.throwIfDisposed(),LN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.reshapeAs=function(t){return this.throwIfDisposed(),ee(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.reshape=function(t){return this.throwIfDisposed(),ee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),QN(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),e_(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.reverse=function(t){return this.throwIfDisposed(),il(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.rfft=function(){return this.throwIfDisposed(),KN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.round=function(){return this.throwIfDisposed(),BN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.rsqrt=function(){return this.throwIfDisposed(),zN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.selu=function(){return this.throwIfDisposed(),WN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.separableConv2d=function(t,e,n,r,o,s){return this.throwIfDisposed(),VN(this,t,e,n,r,o,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.sigmoid=function(){return this.throwIfDisposed(),Yc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.sign=function(){return this.throwIfDisposed(),gX(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.sin=function(){return this.throwIfDisposed(),UN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.sinh=function(){return this.throwIfDisposed(),HN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.slice=function(t,e){return this.throwIfDisposed(),Vt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.softmax=function(t){return this.throwIfDisposed(),J1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.softplus=function(){return this.throwIfDisposed(),Mh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),K1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.split=function(t,e){return this.throwIfDisposed(),ho(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.sqrt=function(){return this.throwIfDisposed(),kr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.square=function(){return this.throwIfDisposed(),Zt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.squaredDifference=function(t){return this.throwIfDisposed(),qN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.squeeze=function(t){return this.throwIfDisposed(),Lh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof An?[this,t]:[this,...t];return Vi(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.step=function(t){return this.throwIfDisposed(),Bh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.stridedSlice=function(t,e,n,r,o,s,i,a){return this.throwIfDisposed(),OX(this,t,e,n,r,o,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.sub=function(t){return this.throwIfDisposed(),Ye(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.sum=function(t,e){return this.throwIfDisposed(),Xe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.tan=function(){return this.throwIfDisposed(),MX(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.tanh=function(){return this.throwIfDisposed(),F1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.tile=function(t){return this.throwIfDisposed(),Yo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.toBool=function(){return this.throwIfDisposed(),Ve(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.toFloat=function(){return this.throwIfDisposed(),Ve(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.toInt=function(){return this.throwIfDisposed(),Ve(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.topk=function(t,e){return this.throwIfDisposed(),BX(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.transpose=function(t){return this.throwIfDisposed(),Et(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.unique=function(t){return this.throwIfDisposed(),VX(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),YN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.unstack=function(t){return this.throwIfDisposed(),al(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.where=function(t,e){return this.throwIfDisposed(),Qr(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fe().prototype.zerosLike=function(){return this.throwIfDisposed(),Nt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ws extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ws.prototype)}}class No extends Error{constructor(e){super(e),Object.setPrototypeOf(this,No.prototype)}}class X extends Error{constructor(e){super(e),Object.setPrototypeOf(this,X.prototype)}}class gt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,gt.prototype)}}class Fw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Fw.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class T_{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cl(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Cs(t,e){if(!t)throw new Fw(e)}function KI(t,e){let n=0;for(const r of t)r===e&&n++;return n}function Ar(t){return t.length===1?t[0]:t}function on(t){return Array.isArray(t)?t:[t]}function Gs(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function ka(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let $o={};function Ow(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function jx(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>jx(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:jx(r))}}}function Uh(t,e={},n={},r="object",o=!1){if(typeof t=="string"){const s=t;let i;if(s in n)i=n[s];else if(s in $o)i=$o[s];else if(i=e[s],i==null)throw new X(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const s=t;if(s.className==null||s.config==null)throw new X(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);const i=s.className;let a,l;if(i in n?[a,l]=n[i]:i in $o?[a,l]=$o.className:i in e&&([a,l]=e[i]),a==null)throw new X(`Unknown ${r}: ${i}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys($o))c[f]=$o[f];for(const f of Object.keys(n))c[f]=n[f];const u=s.config;u.customObjects=c;const d=Object.assign({},$o);for(const f of Object.keys(n))$o[f]=n[f];jx(s.config);const h=l(a,s.config,n,o);return $o=Object.assign({},d),h}else{const c=Object.assign({},$o);for(const d of Object.keys(n))$o[d]=n[d];const u=new a(s.config);return $o=Object.assign({},c),u}}}function $Q(t,e){return t<e?-1:t>e?1:0}function Yf(t,e){return-1*$Q(t,e)}function Fi(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function SQ(t){if(t==null)throw new X(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function $l(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new X(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function Pw(t,e,n=0,r=1/0){return Cs(n>=0),Cs(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(o=>typeof o===e)}function Jn(t,e){Array.isArray(t)?(D(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>Jn(n,`element ${r+1} of ${e}`))):D(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${E_(t)}.`)}function E_(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>E_(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function IQ(t,e,n){let r=n!=null?n():_r(),o;return(...i)=>{const a=n!=null?n():_r();return a-r<e||(r=a,o=t(...i)),o}}function R_(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let kQ=0;function N_(){return kQ++}const Zf={};function ob(t=""){return t in Zf||(Zf[t]=0),Zf[t]+=1,t+Zf[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const TQ=["channelsFirst","channelsLast"],EQ=["nearest","bilinear"],RQ=["valid","same","causal"],NQ=["max","avg"],_Q=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ll=new Map;function Rn(t){$l(TQ,"DataFormat",t)}function AQ(t){$l(EQ,"InterpolationFormat",t)}function xo(t){$l(RQ,"PaddingMode",t)}function __(t){$l(NQ,"PoolMode",t)}const Ku=[],qI="/";function ja(t,e){Ku.push(t);try{const n=e();return Ku.pop(),n}catch(n){throw Ku.pop(),n}}function DQ(){return Ku.length===0?"":Ku.join(qI)+qI}function A_(t){if(!F_(t))throw new Error("Not a valid tensor name: '"+t+"'");return DQ()+t}function D_(t){if(!F_(t))throw new Error("Not a valid tensor name: '"+t+"'");Ll.has(t)||Ll.set(t,0);const e=Ll.get(t);if(Ll.set(t,Ll.get(t)+1),e>0){const n=`${t}_${e}`;return Ll.set(n,1),n}else return t}const FQ=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function F_(t){return!!t.match(FQ)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function OQ(t){return t===parseInt(t.toString(),10)}function Oi(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let o=e;o<n;++o)r*=t[o];return r}function $c(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function Ui(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function os(t,e){if(e<t)throw new X(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let vv;function Wn(){return vv==null&&(vv=HK().epsilon()),vv}function ss(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _s(t,e){return Ve(t,e)}function Hh(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),ee(t,n)}function PQ(t,e){return ie(()=>{if(t.shape.length!==2)throw new X(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Hh(t,1);return Kx(n,[1,e,1])})}function MQ(t){const e=[Oi(t.shape)];return ee(t,e)}function LQ(t){if(t.rank<=1)throw new X(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Oi(t.shape,1)];return ee(t,e)}function Ka(t,e,n){return ie(()=>{switch(t.rank){case 1:return Y1(t,e,n);case 2:return GN(t,[e,0],[n,t.shape[1]]);case 3:return Z1(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return jp(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Vt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Vt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new X(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function xv(t,e,n){return ie(()=>{switch(t.rank){case 1:return Y1(t,e,n);case 2:return GN(t,[0,e],[t.shape[0],n]);case 3:return Z1(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return jp(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new X(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Jf(t,e,n,r){return ie(()=>{switch(t.rank){case 1:return Y1(t,e,n);case 2:switch(r){case 1:return Ka(t,e,n);case 2:return xv(t,e,n);default:throw new X(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Ka(t,e,n);case 2:return Z1(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return xv(t,e,n);default:throw new X(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Ka(t,e,n);case 2:return jp(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return jp(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return xv(t,e,n);default:throw new X(`The axis is not within the rank of the tensor ${r}`)}default:throw new X(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Mw(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),mr(t,e)}function XI(t,e){switch(t.rank){case 1:return Q9([t,e]);case 2:return t7([t,e],0);case 3:return r7([t,e],0);case 4:return s7([t,e],0);default:throw new X(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Kx(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new X(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Yo(t,e)}function sb(t,e=0,n=1,r,o){return oX(t,e,n,r,o)}function As(t,e,n,r){if(t.rank<2||e.rank<2)throw new gt(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const o=t.shape.slice(-1)[0],s=e.shape.slice(-2)[0];if(o!==s)throw new gt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return PI({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?qx(t.rank,r,ss()):null,activation:n});{const o=t.shape.slice(),s=o.pop();t=ee(t,[-1,s]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),c=[...i,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=ee(Et(e,u),[l,-1]);const d=[...o,...c];return ee(PI({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?qx(t.rank,r,ss()):null,activation:n}),d)}}function O_(t,e,n){return ie(()=>(Array.isArray(e)?e=Xr(e,"int32"):e=Ve(e,"int32"),z1(t,e,n)))}function Gh(t){return q(t,t)}function qx(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new X(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?ee(e,[1,r[0],1,1,1]):ee(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?ee(e,[1,1,1,1,r[0]]):ee(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?ee(e,[1,r[0],1,1]):ee(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?ee(e,[1,1,1,r[0]]):ee(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?ee(e,[1,r[0],1]):ee(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?ee(e,[1,1,r[0]]):ee(e,[1].concat(r))}else if(t<3)return e;throw new X(`Unsupported input rank by biasAdd: ${e.rank}`)}function cs(t,e,n){return ie(()=>(n==null&&(n=ss()),Rn(n),Re(t,qx(t.rank,e,n))))}function BQ(t,e=1){if(e!==1)throw new gt(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Xg(t)}function zQ(t){return ie(()=>et(t,Re(Xn(t),1)))}function P_(t,e,n,r){return ie(()=>qX(t,e,n,r))}function WQ(t){return ie(()=>{const e=Re(.5,q(.2,t));return mo(e,0,1)})}function jh(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const VQ=["fanIn","fanOut","fanAvg"],UQ=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HQ(t){$l(VQ,"FanMode",t)}function GQ(t){$l(UQ,"Distribution",t)}class Vo extends Xc{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class M_ extends Vo{apply(e,n){return Zn(e,n)}}M_.className="Zeros";Te(M_);class Lw extends Vo{apply(e,n){return na(e,n)}}Lw.className="Ones";Te(Lw);class L_ extends Vo{constructor(e){if(super(),typeof e!="object")throw new X(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new X(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return ie(()=>q(ut(this.value),na(e,n)))}getConfig(){return{value:this.value}}}L_.className="Constant";Te(L_);class B_ extends Vo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Qg(e,this.minval,this.maxval,n)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}B_.className="RandomUniform";Te(B_);class z_ extends Vo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new gt(`randomNormal does not support dType ${n}.`);return sb(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}z_.className="RandomNormal";Te(z_);class W_ extends Vo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new gt(`truncatedNormal does not support dType ${n}.`);return XN(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}W_.className="TruncatedNormal";Te(W_);class V_ extends Vo{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return ie(()=>{if(e.length!==2||e[0]!==e[1])throw new X("Identity matrix initializer can only be used for 2D square matrices.");return q(this.gain,IN(e[0]))})}getConfig(){return{gain:this.gain}}}V_.className="Identity";Te(V_);function jQ(t,e="channelsLast"){let n,r;if(Rn(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const o=Oi(t,2);n=t[1]*o,r=t[0]*o}else if(e==="channelsLast"){const o=Oi(t,0,t.length-2);n=t[t.length-2]*o,r=t[t.length-1]*o}}else{const o=Oi(t);n=Math.sqrt(o),r=Math.sqrt(o)}return[n,r]}class eo extends Vo{constructor(e){if(super(),e.scale<0)throw new X(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,HQ(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,GQ(this.distribution),this.seed=e.seed}apply(e,n){const r=jQ(e),o=r[0],s=r[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,o):this.mode==="fanOut"?i/=Math.max(1,s):i/=Math.max(1,(o+s)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new gt(`${this.getClassName()} does not support dType ${n}.`);return XN(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return Qg(e,-a,a,n)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}eo.className="VarianceScaling";Te(eo);class Bw extends eo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return eo.className}}Bw.className="GlorotUniform";Te(Bw);class zw extends eo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return eo.className}}zw.className="GlorotNormal";Te(zw);class Ww extends eo{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return eo.className}}Ww.className="HeNormal";Te(Ww);class Vw extends eo{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return eo.className}}Vw.className="HeUniform";Te(Vw);class Uw extends eo{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return eo.className}}Uw.className="LeCunNormal";Te(Uw);class Hw extends eo{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return eo.className}}Hw.className="LeCunNormal";Te(Hw);class U_ extends Vo{constructor(e){if(super(),this.DEFAULT_GAIN=1,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed,this.seed!=null)throw new gt("Random seed is not implemented for Orthogonal Initializer yet.")}apply(e,n){return ie(()=>{if(e.length<2)throw new gt("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${e[0]*e[1]}) elements: Slowness may result.`);const r=e[0]>e[1]?[e[1],e[0]]:e,o=sb(r,0,1,"float32");let s=fZ.gramSchmidt(o);return e[0]>e[1]&&(s=Et(s)),q(this.gain,s)})}getConfig(){return{gain:this.gain,seed:this.seed}}}U_.className="Orthogonal";Te(U_);const YI={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function ZI(t,e={}){return Uh(t,ko.getMap().classNameMap,e,"initializer")}function xn(t){return Ow(t)}function mn(t){if(typeof t=="string"){const e=t in YI?YI[t]:t;if(e==="GlorotNormal")return new zw;if(e==="GlorotUniform")return new Bw;if(e==="HeNormal")return new Ww;if(e==="HeUniform")return new Vw;if(e==="LeCunNormal")return new Uw;if(e==="LeCunUniform")return new Hw;{const n={};return n.className=e,n.config={},ZI(n)}}else return t instanceof Vo?t:ZI(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xx(t){return Array.isArray(t)&&Array.isArray(t[0])}function Kp(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function at(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new X(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ot(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new X(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qp(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,o)=>r*o);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const JI="Variable";class KQ{constructor(e,n="float32",r=JI,o=!0,s=null){this.dtype=n==null?"float32":n,this.shape=e.shape,this.id=N_(),r=r==null?JI:r,this.originalName=A_(r),this.name=D_(this.originalName),this.trainable_=o,this.constraint=s,this.val=GX(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),qQ(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function qQ(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Yx(t){return t.map(e=>e.read())}function Gw(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Vn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class ks{constructor(e,n,r,o,s,i,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=o,this.callArgs=s,this.outputTensorIndex=a,this.id=N_(),i!=null&&(this.originalName=A_(i),this.name=D_(this.originalName)),this.rank=n.length}}let XQ=0;class ib{constructor(e,n){this.callArgs=n,this.id=XQ++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let YQ=0;class It extends Xc{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=YQ++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=Gs(r)+"_"+ob(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let s=null;e.batchSize!=null&&(s=e.batchSize),r=[s].concat(e.inputShape)}this.batchInputShape=r;let o=e.dtype;o==null&&(o=e.inputDType),o==null&&(o="float32"),this.dtype=o}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new No(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new X(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Ar(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Ar(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ws(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ws(`Layer ${this.name} is not connected, no input to return.`);return Ar(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ws(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ws(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ar(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=on(e),this.inputSpec==null||this.inputSpec.length===0)return;const n=on(this.inputSpec);if(e.length!==n.length)throw new X(`Layer ${this.name} expects ${n.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let r=0;r<e.length;r++){const o=e[r],s=n[r];if(s==null)continue;const i=o.rank;if(s.ndim!=null&&i!==s.ndim)throw new X(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${i}`);if(s.maxNDim!=null&&i>s.maxNDim)throw new X(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${i}`);if(s.minNDim!=null&&i<s.minNDim)throw new X(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${i}.`);if(s.dtype!=null&&o.dtype!==s.dtype)throw new X(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${o.dtype}.`);if(s.axes){const a=o.shape;for(const l in s.axes){const c=Number(l),u=s.axes[l],d=c>=0?a[c]:a[a.length+c];if(u!=null&&[u,null].indexOf(d)===-1)throw new X(`Input ${r} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${u} but got shape ${a}.`)}}if(s.shape!=null)for(let a=0;a<s.shape.length;++a){const l=s.shape[a],c=o.shape[a];if(l!=null&&c!=null&&l!==c)throw new X(`Input ${r} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${o.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=on(e);let o=!0;for(const i of r)if(!(i instanceof ks)){o=!1;break}let s=!0;for(const i of r)if(i instanceof ks){s=!1;break}if(o===s)throw new X("Arguments to apply() must be all SymbolicTensors or all Tensors");return ja(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of on(e))i.push(a.shape);this.build(Ar(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(e),s){let i=this.call(e,n);const a=on(i),l=[];for(let c of a)r.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=Ar(l),this.activityRegularizer!=null)throw new gt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=ZQ(e),a=this.computeOutputShape(i);let l;const c=JQ(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new ks(c,u,this,on(e),n,this.name,d)):l=new ks(c,a,this,on(e),n,this.name),this.addInboundNode(e,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new gt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,o)=>{r!=null&&e[o]!=null&&e[o]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ws(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ws(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new No(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return qp(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Yx(e?this.trainableWeights:this.weights)}setWeights(e){ie(()=>{const n=this.weights;if(n.length!==e.length)throw new X(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],o=Yx(n);for(let s=0;s<o.length;++s){const i=o[s],a=n[s],l=e[s];if(!Bt(i.shape,l.shape))throw new X(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}Gw(r)})}addWeight(e,n,r,o,s,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new X(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(o=l!=null?l():mn("zeros"));const c=o.apply(n,r),u=new KQ(c,r,e,i,a);return c.dispose(),s!=null&&this.addLoss(()=>s.apply(u.read())),i==null&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=on(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(e,n,r,o,s,i,a=null){const l=on(e);n=on(n),r=on(r),o=on(o),s=Kp(s),i=Kp(i);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new ib({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:o,inputShapes:s,outputShapes:i},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function ZQ(t){t=on(t);const e=[];for(const n of t)e.push(n.shape);return Ar(e)}function JQ(t){return"float32"}function H_(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const o=[];for(let s=0;s<r.inboundLayers.length;s++){const i=r.inputTensors[s],a=r.inboundLayers[s],l=r.nodeIndices[s],c=H_(i,a,l);for(const u of c)o.indexOf(u)===-1&&o.push(u)}return o}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Kh extends It{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:ob("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new X("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new X("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new X("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const o=new ks(this.dtype,this.batchInputShape,this,[],{},this.name);o.nodeIndex=0,o.tensorIndex=0,new ib({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new X(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Kh.className="InputLayer";Te(Kh);function QQ(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new X("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Kh({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function eee(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Ve(e,t.dtype)}catch{throw new X(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Ti{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Ti)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=eee(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new X(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof ks){if(this.id2Value[e.id]==null)throw new X(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new X(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof ks){if(this.id2Value[e.id]==null)throw new X(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new X(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&yt(this.id2Mask)}}const Xp=new T_,Yp=new T_;function tee(t){Xp!=null&&Xp.setMaxEntries(t),Yp!=null&&Yp.setMaxEntries(t)}function Nu(t,e,n,r){const o=n==null?!1:n.training,s=Array.isArray(t),i=s?t:[t],a=i.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const u=a.join(",")+"|"+e.names().sort().join(",");let d=Xp.get(u),h;if(d==null){const p=nee(i,e);d=p.sorted,h=p.recipientCounts,Xp.put(u,d),Yp.put(u,h)}h={},o||Object.assign(h,Yp.get(u));const f=new Ti(e);for(let p=0;p<d.length;++p){if(r!=null){const R=Bx().numTensors;R>r.maxNumTensors&&(r.maxNumTensors=R),R<r.minNumTensors&&(r.minNumTensors=R)}const m=d[p],g=m.sourceLayer;if(g instanceof Kh)continue;const b=[],v=[],w=[];let y=!1;for(const R of m.inputs){const T=f.getValue(R),N=f.getMask(R);b.push(T),v.push(N),N!=null&&(y=!0),o||(h[R.name]--,h[R.name]===0&&!e.hasKey(R)&&a.indexOf(R.name)===-1&&!T.isDisposed&&R.sourceLayer.stateful!==!0&&w.push(T))}y&&(n=n||{},n.mask=v[0]);const C=on(g.apply(b,n));let S=null;g.supportsMasking&&(S=g.computeMask(b,v));const $=oee(m),I=Array.isArray($)?$:[$];for(let R=0;R<I.length;++R){f.hasKey(I[R])||f.add(I[R],C[R],Array.isArray(S)?S[0]:S);const T=a.indexOf(I[R].name);T!==-1&&(l[T]=C[R])}o||yt(w)}return f.disposeMasks(),s?l:l[0]}function nee(t,e){D(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const o=QI(t[0],e);n=o.sorted,r=o.recipientMap}else{const o=new Set;for(const s of t){const{sorted:i,recipientMap:a}=QI(s,e);for(const l of i)o.has(l.name)||(n.push(l),o.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(c=>r[l].add(c))}}return{sorted:n,recipientCounts:ree(r)}}function ree(t){const e={};for(const n in t)e[n]=t[n].size;return e}function QI(t,e){const n=new Set,r=[],o={};for(const a of e.names())n.add(a);const s=[],i=[];for(s.push(t);s.length>0;){const a=s[s.length-1];if(n.has(a.name)){s.pop();continue}const l=i[i.length-1]===s.length-1;if(a.inputs.length===0||l)s.pop(),r.push(a),n.add(a.name),l&&i.pop();else{i.push(s.length-1);for(const c of a.inputs)o[c.name]==null&&(o[c.name]=new Set),o[c.name].add(a.name),!n.has(c.name)&&s.push(c)}}return{sorted:r,recipientMap:o}}function oee(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const o of t.sourceLayer.inboundNodes[r].outputTensors)if(o.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const see=ue();see.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,tee);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jw(t,e){return ie(()=>kr(Xe(q(t,t),e,!0)))}class qh extends Xc{getConfig(){return{}}}class G_ extends qh{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ie(()=>{const n=jw(e,this.axis),r=mo(n,0,this.maxValue);return q(e,et(r,Re(Wn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}G_.className="MaxNorm";Te(G_);class j_ extends qh{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ie(()=>et(e,Re(Wn(),jw(e,this.axis))))}getConfig(){return{axis:this.axis}}}j_.className="UnitNorm";Te(j_);class K_ extends qh{apply(e){return ui(e)}}K_.className="NonNeg";Te(K_);class q_ extends qh{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ie(()=>{const n=jw(e,this.axis),r=Re(q(this.rate,mo(n,this.minValue,this.maxValue)),q(1-this.rate,n));return q(e,et(r,Re(Wn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}q_.className="MinMaxNorm";Te(q_);const ek={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Un(t){return Ow(t)}function tk(t,e={}){return Uh(t,ko.getMap().classNameMap,e,"constraint")}function Hn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in ek?ek[t]:t,config:{}};return tk(n)}else return t instanceof qh?t:tk(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function va(t){if(t==null)return;const e=[],n=[],r=[];for(const o in t){const s=t[o];if(typeof s!="number"){const i=s;e.push(i.data()),n.push(o),r.push(i)}}if(e.length>0){const o=await Promise.all(e);for(let s=0;s<o.length;++s)t[n[s]]=o[s][0];yt(r)}}function X_(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var nk;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(nk||(nk={}));const iee=125;class vd{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class aee{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class lee extends vd{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const o in n){const s=n[o];if(typeof s=="number")this.totals.hasOwnProperty(o)||(this.totals[o]=0),this.totals[o]=this.totals[o]+s*r;else{let i;o in this.totals?i=this.totals[o]:this.totals[o]=0;const a=ie(()=>Re(this.totals[o],q(s,r)));this.totals[o]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:ie(()=>{const o=q(et(1,this.seen),this.totals[r]);n[r]=o,this.totals[r].dispose(),Rs(n[r])}))}}class cee extends vd{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const s in this.history){const i=this.history[s];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),n.push(s),r.push(a)}}const o=await Promise.all(e);for(let s=0;s<o.length;++s)this.history[n[s]][r[s]].dispose(),this.history[n[s]][r[s]]=o[s][0]}}class uee extends vd{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||pw,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=iee),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");$x(this.yieldEvery)&&(this.maybeWait=IQ(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const o=[];this.yield!=null&&(await va(r),o.push(this.yield(e,n,r))),o.push(this.nextFrameFunc()),await Promise.all(o)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await va(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await va(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await va(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await va(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):$x(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await va(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await va(e),await this.trainEnd(e))}}function Y_(t,e){return t==null&&(t={}),t instanceof vd?[t]:Array.isArray(t)&&t[0]instanceof vd?t:on(t).map(r=>new uee(r,e))}class Io{constructor(){}static registerCallbackConstructor(e,n){D(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Io.checkForDuplicate(n),Io.constructors[e]==null&&(Io.constructors[e]=[]),Io.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Io.constructors)Io.constructors[+n].forEach(o=>{if(o===e)throw new X("Duplicate callback constructor.")})}static clear(){Io.constructors={}}static createCallbacks(e){const n=[];for(const r in Io.constructors){const o=+r;e>=o&&n.push(...Io.constructors[o])}return n.map(r=>new r)}}Io.constructors={};function Z_(t,e,n,r,o,s,i,a,l){const c=new cee,u=[new lee,...Io.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new aee(u);return d.setParams({epochs:n,initialEpoch:r,samples:o,steps:s,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ds(t,e={},n=!1){return Uh(t,ko.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zp(t,e){return ie(()=>{t.dtype!=="float32"&&(t=Ve(t,"float32"));const n=Xe(Gh(t),e,!0),r=Ph(n.shape,Wn()),o=kr(ta(n,r));return et(t,o)})}function ab(t,e){return ie(()=>In(Gh(Ye(e,t)),-1))}function Kw(t,e){return ie(()=>In(Xn(Ye(e,t)),-1))}function qw(t,e){return ie(()=>{const n=Ye(t,e),r=mo(Xn(t),Wn(),Number.MAX_VALUE),o=Xn(et(n,r));return q(100,In(o,-1))})}function dee(t,e){return ie(()=>{const n=mo(e,Wn(),Number.MAX_VALUE),r=Po(Re(1,n)),o=mo(t,Wn(),Number.MAX_VALUE),s=Po(Re(1,o));return In(Gh(Ye(r,s)),-1)})}function hee(t,e){return ie(()=>{const n=ta(0,Ye(1,q(t,e)));return In(Gh(n),-1)})}function fee(t,e){return ie(()=>{const n=ta(0,Ye(1,q(t,e)));return In(n,-1)})}function pee(t,e){return ie(()=>{const n=Xe(q(t,e),-1),r=Qo(q(Ye(1,t),e),-1);return ta(0,Re(1,Ye(r,n)))})}function mee(t,e){return ie(()=>{const n=Math.log(2),r=Ye(e,t),o=Ye(Re(r,Mh(q(-2,r))),n);return In(o,-1)})}function xd(t,e,n=!1){return ie(()=>{if(n)e=J1(e);else{const r=Xe(e,e.shape.length-1,!0);e=et(e,r)}return e=mo(e,Wn(),1-Wn()),yn(Xe(q(Ve(t,"float32"),Po(e)),e.shape.length-1))})}function Jp(t,e,n=!1){return ie(()=>{const r=Ve(Zg(MQ(t)),"int32");e=mo(e,Wn(),1-Wn());const o=e.shape,s=ee(sN(r,o[o.length-1]),o);return xd(s,e,n)})}function gee(t,e){if(!Bt(t.shape,e.shape))throw new X(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return ie(()=>{const n=ui(e),r=yn(Xn(e));return Re(Ye(n,q(e,t)),V1(Oo(r)))})}function lb(t,e){return ie(()=>{let n;return n=mo(e,Wn(),1-Wn()),n=Po(et(n,Ye(1,n))),In(gee(t,n),-1)})}function bee(t,e){return ie(()=>{const n=mo(t,Wn(),1),r=mo(e,Wn(),1);return Xe(q(t,Po(et(n,r))),-1)})}function vee(t,e){return ie(()=>{const n=Po(Re(Wn(),e));return In(Ye(e,q(t,n)),-1)})}function J_(t,e){return ie(()=>{const n=Zp(t,-1),r=Zp(e,-1),o=q(n,r);return yn(Xe(o,-1))})}const Qp={meanSquaredError:ab,meanAbsoluteError:Kw,meanAbsolutePercentageError:qw,meanSquaredLogarithmicError:dee,squaredHinge:hee,hinge:fee,categoricalHinge:pee,logcosh:mee,categoricalCrossentropy:xd,sparseCategoricalCrossentropy:Jp,binaryCrossentropy:lb,kullbackLeiblerDivergence:bee,poisson:vee,cosineProximity:J_};function yv(t){if(typeof t=="string"){if(t in Qp)return Qp[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new X(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Q_(t,e){return ie(()=>{const n=q(.5,Mo(e)),r=_s(vo(e,n),t.dtype);return In(Ms(t,r),-1)})}function eA(t,e){return ie(()=>_s(Ms(md(t,-1),md(e,-1)),"float32"))}function xee(t,e){return ie(()=>Ve(Xe(ti(Ms(t,1),Ms(e,1))),"float32"))}function yee(t,e){return ie(()=>Ve(Xe(ti(Ms(t,0),Ms(e,1))),"float32"))}function wee(t,e){return ie(()=>{const n=xee(t,e),r=yee(t,e),o=Re(n,r);return Ve(Qr(vo(o,0),et(n,o),0),"float32")})}function Cee(t,e){return lb(t,e)}function $ee(t,e){return t.rank===e.rank&&(t=Lh(t,[t.rank-1])),e=md(e,-1),e.dtype!==t.dtype&&(e=Ve(e,t.dtype)),Ve(Ms(t,e),"float32")}const See=ab,Iee=ab,kee=Kw,Tee=Kw,Eee=qw,Ree=qw,tA=xd,Nee=J_,nA=Jp,em={binaryAccuracy:Q_,categoricalAccuracy:eA,precision:wee,categoricalCrossentropy:tA,sparseCategoricalCrossentropy:nA,mse:See,MSE:Iee,mae:kee,MAE:Tee,mape:Eee,MAPE:Ree,cosine:Nee};function _ee(t){if(typeof t=="string"&&t in em)return em[t];if(typeof t!="string"&&t!=null)return t;throw new X(`Unknown metric ${t}`)}function Qf(t){if(Cs(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Qp))if(Qp[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(em))if(em[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Aee(t){const e={Adagrad:()=>Ml.adagrad(.01),Adadelta:()=>Ml.adadelta(1,.95,Wn()),Adam:()=>Ml.adam(.001,.9,.999,Wn()),Adamax:()=>Ml.adamax(.002,.9,.999,Wn(),0),RMSProp:()=>Ml.rmsprop(.001,.9,0,Wn()),SGD:()=>Ml.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new X(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const rk=1*1024*1024;function ok(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Zx(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>rk&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${rk}.`)}}function Zx(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!Zx(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!Zx(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dee(t,e,n,r=console.log){const o=Oee(t),s=["Layer (type)","Input Shape","Output shape","Param #"];o?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let i;if(!o){s.push("Receives inputs"),i=[];for(const u in t.nodesByDepth)i.push(...t.nodesByDepth[u])}r("_".repeat(e)),tm(s,n,r),r("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)o?Pee(a[u],n,r):Mee(a[u],n,i,r),r((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=Fee(t),c=qp(t.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(e))}function Fee(t){let e;return t.collectedTrainableWeights!=null?e=qp(t.collectedTrainableWeights):e=qp(t.trainableWeights),e}function Oee(t){let e=!0;const n=[],r=[];for(const o in t.nodesByDepth)n.push(t.nodesByDepth[o]);for(const o of n){if(o.length>1||o.length===1&&o[0].inboundLayers.length>1){e=!1;break}r.push(...o)}if(e)for(const o of t.layers){let s=!1;for(const i of o.inboundNodes)if(r.indexOf(i)!==-1)if(s){e=!1;break}else s=!0;if(!e)break}return e}function tm(t,e,n=console.log){let r="";for(let o=0;o<t.length;++o)o>0&&(r=r.slice(0,r.length-1)+" "),r+=t[o],r=r.slice(0,e[o]),r+=" ".repeat(e[o]-r.length);n(r)}function Pee(t,e,n){let r,o;try{o=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const s=t.name,i=t.getClassName(),a=[`${s} (${i})`,o,r,t.countParams().toString()];tm(a,e,n)}function Mee(t,e,n,r){let o,s;try{s=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{s="multiple"}try{o=JSON.stringify(t.outputShape)}catch{o="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];i.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=i.length===0?"":i[0],u=[`${a} (${l})`,s,o,t.countParams().toString(),c];tm(u,e,r);for(let d=1;d<i.length;++d)tm(["","","","",i[d]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rA(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function nm(t,e){if(t===null)return null;if(typeof t=="string")return ka(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let o=0;o<r;++o){const s=t[o];rA(e,o,s)?n.push(s):n.push(nm(s,e))}return n}else{const n={};for(const r of Object.keys(t)){const o=t[r];if(r==="name"&&typeof o=="string")n[r]=o;else{const s=ka(r);n[s]=nm(o,s)}}return n}}function Jx(t,e){if(t==null)return null;if(typeof t=="string")return Gs(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let o=0;o<r;++o){const s=t[o];rA(e,o,s)?n.push(s):n.push(Jx(s,e))}return n}else{const n={};for(const r of Object.keys(t)){const o=t[r],s=Gs(r);(r==="name"||r==="className")&&typeof o=="string"?n[s]=o:n[s]=Jx(o,r)}return n}}/** @license See the LICENSE file. */const oA="4.1.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Go extends It{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const v=this.getClassName().toLowerCase();this.name=ob(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Fi(this.inputs).length!==this.inputs.length)throw new X(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);Fi(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const w=v.sourceLayer,y=v.nodeIndex,C=v.tensorIndex;this.outputLayers.push(w),this.outputLayersNodeIndices.push(y),this.outputLayersTensorIndices.push(C)}for(const v of this.inputs){const w=v.sourceLayer,y=v.nodeIndex,C=v.tensorIndex;Cs(y===0,"input layer has >1 nodes"),Cs(C===0,"input layer has >1 tensors"),this.inputLayers.push(w),this.inputLayersNodeIndices.push(y),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const w=this.inputLayers[v];if(!(w instanceof Kh))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${v} (0-based) originates from layer type ${w.getClassName()}.`);this.inputNames.push(w.name),this.feedInputShapes.push(w.batchInputShape),this.feedInputNames.push(w.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);const n={},r={},o={},s={},i={},a=[],l=(v,w,y,C,S,$)=>{(C==null||S==null||$==null)&&(C=v.sourceLayer,S=v.nodeIndex,$=v.tensorIndex);const I=C.inboundNodes[S];if(y.indexOf(I)!==-1)throw new No(`The tensor ${v.name} at layer "${C.name}" is part of a cycle.`);if(w.indexOf(I)!==-1)return;this.containerNodes.add(Go.nodeKey(C,S)),C.id in i||(i[C.id]=Object.keys(i).length),y.indexOf(I)===-1&&y.push(I);const R=I.inboundLayers.length;for(let T=0;T<R;T++){const N=I.inputTensors[T],_=I.inboundLayers[T],P=I.nodeIndices[T],z=I.tensorIndices[T];l(N,w,y,_,P,z)}for(w.push(I);y.indexOf(I)>=0;)y.splice(y.indexOf(I),1);a.push(I)},c=[],u=[];for(const v of this.outputs)l(v,c,u);const d=a.slice().reverse();for(const v of d){r[v.id]=v,v.id in n||(n[v.id]=0);let w=n[v.id];const y=o[v.outboundLayer.id]==null?0:o[v.outboundLayer.id];w=Math.max(w,y),o[v.outboundLayer.id]=w,s[v.outboundLayer.id]=v.outboundLayer,n[v.id]=w;for(let C=0;C<v.inboundLayers.length;C++){const S=v.inboundLayers[C],$=v.nodeIndices[C],I=S.inboundNodes[$],R=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(w+1,R),r[I.id]=I}}const h={};for(const v in n){const w=n[v];w in h||(h[w]=[]),h[w].push(r[v])}const f={};for(const v in o){const w=o[v];w in f||(f[w]=[]),f[w].push(s[v])}let p=Object.keys(f).map(v=>parseInt(v,10)).sort(Yf);this.layers=[];for(const v of p){const w=f[v];w.sort((y,C)=>{const S=i[y.id],$=i[C.id];return S<$?-1:S>$?1:0});for(const y of w)y instanceof Go&&this.internalContainerRefs.push(y),this.layers.push(y)}this.layersByDepth=f,p=Object.keys(h).map(v=>parseInt(v,10)).sort(Yf);const m=this.inputs.slice(),g=[];for(const v of p)for(const w of h[v]){const y=w.outboundLayer;if(y!=null){for(const C of w.inputTensors)if(m.indexOf(C)===-1)throw new No(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${y.name}". The following previous layers were accessed without issue: ${g}`);for(const C of w.outputTensors)m.push(C);g.push(y.name)}}this.nodesByDepth=h;const b=this.layers.map(v=>v.name);for(const v of b){const w=b.filter(y=>y===v).length;if(w!==1)throw new No(`The name "${v}" is used ${w} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(b))}this.outboundNodes=[],this.inboundNodes=[],new ib({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new X("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let o=0;for(const i of this.layers)for(const a of i.weights){if(r[a.originalName]!=null)throw new X(`Duplicate weight name: ${a.originalName}`);r[a.originalName]=a,o++}const s=[];for(const i in e){let a=i;if(r[i]==null){const l=i.split("/");a=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(r[a]!=null)s.push([r[a],e[i]]);else if(n)throw new X(`Provided weight data has no target variable: ${i}`);delete r[a]}if(n){const i=[];for(const a in r)i.push(a);if(i.length>0)throw new X(`${i.length} of ${o} weights are not set: ${i}`)}Gw(s)}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${oA}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=Jx(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return ie(()=>{e=on(e);const r=new Ti;for(let o=0;o<this.inputs.length;++o)r.add(this.inputs[o],e[o]);return Nu(this.outputs,r,n)})}computeMask(e,n){return ie(()=>{e=on(e);let r;return n==null?r=cl(null,e.length):r=on(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=Kp(e);if(n.length!==this.inputLayers.length)throw new X(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";r[u]=c}const o=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Yf);if(o.length>1)for(const a of o){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const d=[];for(let m=0;m<c.inboundLayers.length;m++){const g=c.inboundLayers[m],b=c.nodeIndices[m],v=c.tensorIndices[m],w=`${g.name}_${b}_${v}`,y=r[w];d.push(y)}const h=u.computeOutputShape(Ar(d)),f=Kp(h),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const g=`${u.name}_${p}_${m}`;r[g]=f[m]}}}const s=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;i.push(d)}for(let a=0;a<i.length;a++){const l=i[a];Cs(l in r),s.push(r[l])}return Ar(s)}runInternalGraph(e,n){n==null&&(n=cl(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];r[c.id]=[u,d]}const o=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Yf);for(const l of o){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of h)m.id in r&&p.push(r[m.id]);if(p.length===h.length){let m={},g,b,v,w;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[y,C]=p[0];m.mask==null&&(m.mask=C),v=on(d.call(y,m)),w=on(d.computeMask(y,C)),g=[y],b=[C]}else g=p.map(y=>y[0]),b=p.map(y=>y[1]),m.mask==null&&(m.mask=b),v=on(d.call(g,m)),w=on(d.computeMask(g,b));if(d.activityRegularizer)throw new gt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let y=0;y<f.length;++y){const C=f[y],S=v[y],$=w[y];r[C.id]=[S,$]}}}}const s=[],i=[],a=[];for(const l of this.outputs){Cs(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=r[l.id];a.push(c.shape),s.push(c),i.push(u)}return[s,i,a]}buildNodeConversionMap(e){const n={};let r;for(const o of this.layers){r=o instanceof Go?1:0;for(let s=0;s<o.inboundNodes.length;s++){const i=Go.nodeKey(o,s);this.containerNodes.has(i)&&(n[i]=r,r+=1)}}return n}getLayer(e,n){if(n!=null){if(this.layers.length<=n)throw new X(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}else if(e==null)throw new X("Provide either a layer name or layer index");for(const r of this.layers)if(r.name===e)return r;throw new X(`No such layer: ${e}`)}calculateLosses(){return ie(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const o=Go.nodeKey(n,r);this.containerNodes.has(o)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),c=[];for(let d=0;d<i.inboundNodes.length;d++){const h=i.inboundNodes[d],f=Go.nodeKey(i,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let g=0;g<h.inboundLayers.length;g++){const b=h.inboundLayers[g],v=h.nodeIndices[g],w=h.tensorIndices[g],y=Go.nodeKey(b,v);let C=n[y];C==null&&(C=0),m.push([b.name,C,w,p])}c.push(m)}}}const u={};u.name=i.name,u.className=a,u.config=l,u.inboundNodes=c,r.push(u)}e.layers=r;const o=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=Go.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[i];o.push([a.name,u,d])}e.inputLayers=o;const s=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=Go.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[i];s.push([a.name,u,d])}return e.outputLayers=s,e}static fromConfig(e,n,r={},o=!1){const s={},i={};function a(g,b){g.name in i?i[g.name].push(b):i[g.name]=[b]}function l(g,b){const v=[];let w;for(const y of b){const C=y[0],S=y[1],$=y[2];if(w=y[3]==null?{}:y[3],!(C in s)){a(g,b);return}const I=s[C];if(I.inboundNodes.length<=S){a(g,b);return}const R=I.inboundNodes[S];v.push(R.outputTensors[$])}v.length>0&&g.apply(Ar(v),w)}function c(g){const b=g.name,v=Ds(g,n.customObjects!=null?n.customObjects:{});v.setFastWeightInitDuringBuild(o),s[b]=v,g.inboundNodes.forEach(y=>{if(!(y instanceof Array))throw new X(`Corrupted configuration, expected array for nodeData: ${y}`);a(v,y)})}const u=n.name,d=n.layers;for(const g of d)c(g);for(;!SQ(i);)for(const g of d){const b=s[g.name];if(b.name in i){const v=i[b.name];delete i[b.name];for(const w of v)l(b,w)}}const h=[],f=[],p=n.inputLayers;for(const g of p){const b=g[0],v=g[1],w=g[2];Cs(b in s);const C=s[b].inboundNodes[v].outputTensors;h.push(C[w])}const m=n.outputLayers;for(const g of m){const b=g[0],v=g[1],w=g[2];Cs(b in s);const C=s[b].inboundNodes[v].outputTensors;f.push(C[w])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new X("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ie(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lee(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(o=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const o=[];return e.forEach(s=>{s in t?o.push(t[s]):o.push(null)}),o}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function sA(t,e){return Lee(t,e,"classWeight")}async function iA(t,e,n,r){if(e!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const o=ie(()=>{if(t.shape.length===1)return Ha(t);if(t.shape.length===2){if(t.shape[1]>1)return md(t,1);if(t.shape[1]===1)return ee(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await o.data());yt(o);const i=[];return s.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),Xr(i,"float32")}else return null}function Bee(t,e){return q(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zee=32;function aA(t,e){let n,r;const o=e;n=o.xs,r=o.ys,D(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const s=sk("input",t.inputNames,n),i=sk("output",t.outputNames,r),a=s[0].shape[0];D(s.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),D(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<s.length;l++)D(s[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${s[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)D(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:s,ys:i}}function sk(t,e,n){if(n instanceof An)return[n];if(Array.isArray(n))return D(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const o of e){if(n[o]==null)throw new X(`The feature data generated by the dataset lacks the required ${t} key '${o}'.`);r.push(n[o])}return r}}function Wee(t){if(t.length===3)throw new gt("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function Vee(t,e,n){const r=n.batchesPerEpoch!=null;if(D(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),D(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),D(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),D(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),D(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const o=n.validationData!=null;let s,i;if(o)if(ik(n.validationData))D(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const g=Wee(n.validationData);s=g.xs,i=g.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;o?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();const u=Y_(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=Z_(u,d,n.epochs,null,null,Uee(e,n),null,o,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const g={};await h.onEpochBegin(p);let b=0,v=0;for(r||(m=await e.iterator());!r||b<n.batchesPerEpoch;){const w=await m.next();if(r&&w.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${b} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(w.value!=null){const{xs:y,ys:C}=aA(t,w.value),S={};S.batch=v,S.size=y[0].shape[0],await h.onBatchBegin(v,S);const $=[];if(n.classWeight!=null){const T=sA(n.classWeight,t.outputNames);for(let N=0;N<T.length;++N)$.push(await iA(C[N],null,T[N]))}const I=y.concat(C).concat($),R=a(I);yt(I);for(let T=0;T<l.length;++T){const N=l[T],_=R[T];S[N]=_,Rs(_)}await h.onBatchEnd(v,S),X_(S),v++,b++}if(r?b>=n.batchesPerEpoch:w.done){if(o){let y;ik(n.validationData)?y=on(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):y=on(t.evaluate(s,i,{batchSize:n.validationBatchSize==null?zee:n.validationBatchSize,verbose:0}));for(let C=0;C<t.metricsNames.length;++C)g[`val_${t.metricsNames[C]}`]=y[C]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,g),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Uee(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function ik(t){return typeof t.iterator=="function"}function Hee(t){return typeof t.next=="function"}async function Gee(t,e,n){n=n||{};const r=n.batches!=null,o=t.testFunction;let s=[];if(n.verbose>0)throw new gt("Verbose mode is not implemented yet.");D(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=Hee(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<n.batches;){const c=await i.next();if(s=ie(()=>{if(c.value){const{xs:u,ys:d}=aA(t,c.value),h=u.concat(d),f=ie(()=>o(h));if(yt(h),l===0)for(let m=0;m<f.length;++m)s.push(ut(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const g=f[m],b=s[m];s[m]=ie(()=>Re(s[m],q(p,g))),l>0&&yt(b)}yt(f),a+=p,++l}return s}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<s.length;++c){const u=s[c];s[c]=et(s[c],a),yt(u)}return Ar(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wv(t){D(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Su(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>Ka(r,e,n-e)):Ka(t,e,n-e)}function Qx(t,e){return ie(()=>t==null?null:Array.isArray(t)?t.map(n=>Qx(n,e)):O_(t,e.dtype==="int32"?e:Ve(e,"int32")))}function Cv(t,e){const n=[];let r=0,o=null;for(;r<t;)o=r+e,o>=t&&(o=t),n.push([r,o]),r=o;return n}function lA(t){const e=[];t instanceof An&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(Hh(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Ho(t,e){if(t==null)return;const n=[];if(e instanceof An)n.push(e.id);else if(Array.isArray(e))e.forEach(o=>n.push(o.id));else if(e!=null)for(const o in e){const s=e[o];n.push(s.id)}const r=[];if(t instanceof An)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(o=>{n.indexOf(o.id)===-1&&r.push(o)});else if(t!=null)for(const o in t){const s=t[o];n.indexOf(s.id)===-1&&r.push(s)}r.forEach(o=>{o.isDisposed||o.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jee(t){return t instanceof An}function e0(t){return Array.isArray(t)}function ak(t){return!jee(t)&&!e0(t)}function lk(t,e,n,r=!0,o=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(e0(t)&&t.length>0)i=!0;else if(ak(t)){for(const a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new X(`Error when checking model ${o} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let s;if(ak(t)){t=t,s=[];for(const i of e){if(t[i]==null)throw new X(`No data provided for "${i}". Need data for each key in: ${e}`);s.push(t[i])}}else if(e0(t)){if(t=t,t.length!==e.length)throw new X(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);s=t}else{if(t=t,e.length>1)throw new X(`The model ${o} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);s=[t]}if(s=lA(s),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=s[i];if(a.shape.length!==n[i].length)throw new X(`Error when checking ${o}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!r)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u>=0&&c!==u)throw new X(`${o} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${o} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return s}function Kee(t,e,n){const r=Fi(t.map(s=>s.shape[0]));r.sort();const o=Fi(e.map(s=>s.shape[0]));if(o.sort(),r.length>1)throw new X(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(o.length>1)throw new X(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(s=>s.shape))}`);if(r.length>0&&o.length>0&&!Bt(r,o))throw new X(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${o[0]} target sample(s).`)}function qee(t,e,n){const r=[ab,lb,xd];for(let o=0;o<t.length;++o){const s=t[o],i=e[o],a=n[o];if(i!=null){if(i===xd&&s.shape[s.shape.length-1]===1)throw new X(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(i)!==-1){const l=s.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new X(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function ck(t,e,n,r=!0,o=""){let s;if(Array.isArray(t)){if(t.length!==e.length)throw new X(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);s=t}else{if(e.length>1)throw new X(`The model expects ${e.length} ${o} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);s=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=s[i];if(a.shape.length!==n[i].length)throw new X(`Error when checking ${o}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!r)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u!==c)throw new X(`Error when checking ${o}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function Xee(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const o of e){let s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}const Yee="layers-model";class ac extends Go{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new X("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Dee(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Aee(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof oa))throw new X("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new X(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(yv(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new X(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>yv(a))}else{const i=yv(e.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],ja("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(r.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const o=Xee(e.metrics,this.outputNames),s=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};ja("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(r.indexOf(i)!==-1)continue;const a=o[i];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[i];g[g.length-1]===1||this.lossFunctions[i]===lb?["accuracy","acc"].indexOf(p)!==-1?h=Q_:["crossentropy","ce"].indexOf(p)!==-1&&(h=Cee):this.lossFunctions[i]===Jp?["accuracy","acc"].indexOf(p)!==-1?h=$ee:["crossentropy","ce"].indexOf(p)!==-1&&(h=nA):["accuracy","acc"].indexOf(p)!==-1?h=eA:["crossentropy","ce"].indexOf(p)!==-1&&(h=tA);let b;["accuracy","acc"].indexOf(p)!==-1?b="acc":["crossentropy","ce"].indexOf(p)!==-1&&(b="ce"),f=h,d=u+b}else f=_ee(p),d=u+Qf(p);let m;ja(d,()=>{m=f}),s(i,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const o=r.batchSize==null?32:r.batchSize;wv(o);const s=!0,i=this.standardizeUserDataXY(e,n,s,o);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,o,r.verbose,r.steps);return Ar(c)}finally{Ho(i[0],e),Ho(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),Gee(this,e,n)}checkNumSamples(e,n,r,o="steps"){let s;if(r!=null){if(s=null,n!=null)throw new X(`If ${o} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?s=e[0].shape[0]:s=e.shape[0];else throw new X(`Either the input data should have a defined shape, or ${o} shoud be specified.`);return s}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new X("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),o=r?n:[n],s=this.retrieveSymbolicTensors(o),i=new Ti;if(e instanceof An&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new X(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new X(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const a=Nu(s,i);return r?a:a[0]}retrieveSymbolicTensors(e){const n=cl(null,e.length);let r=e.length;for(const o of this.layers){const s=Array.isArray(o.output)?o.output:[o.output],i=s.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(n[a]=s[l],r--),r===0)break}if(r===0)break}if(r>0){const o=[];throw n.forEach((s,i)=>{s==null&&o.push(e[i])}),new X(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(o)}`)}return n}predictLoop(e,n=32,r=!1){return ie(()=>{const o=this.checkNumSamples(e);if(r)throw new gt("Verbose predictLoop() is not implemented yet.");const s=Cv(o,n),i=this.outputs.map(a=>[]);for(let a=0;a<s.length;++a)ie(()=>{const c=s[a][0],u=s[a][1],d=Su(e,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new Ti(h);return Nu(this.outputs,f)}).forEach((c,u)=>i[u].push(c));return Ar(i.map(a=>mr(a,0)))})}predict(e,n={}){const r=lA(e);ck(r,this.inputNames,this.feedInputShapes,!1);try{const o=n.batchSize==null?32:n.batchSize;return wv(o),this.predictLoop(r,o)}finally{Ho(r,e)}}predictOnBatch(e){ck(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,o){if(this.optimizer_==null)throw new No("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const s=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===Jp?s.push(a.slice(0,a.length-1).concat([1])):s.push(a)}if(e=lk(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=lk(n,this.feedOutputNames,s,!1,"target"),Kee(e,n),qee(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&o!=null&&o>0&&e[0].shape[0]%o!==0)throw new X(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${o}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,o,s=!0,i){const[a,l]=this.standardizeUserDataXY(e,n,s,i);if(r!=null)throw new Error("sample weight is not supported yet.");let c=null;if(o!=null){const u=sA(o,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await iA(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,r,o=0,s){return ie(()=>{const i=this.checkNumSamples(n,r,s,"steps"),a=[];if(o>0)throw new gt("Verbose mode is not implemented yet.");if(s!=null)throw new gt("steps mode in testLoop() is not implemented yet");{const l=Cv(i,r),c=Xr(os(0,i));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=Ka(c,d,h-d),p=Qx(n,f),m=e(p);if(u===0)for(let g=0;g<m.length;++g)a.push(ut(0));for(let g=0;g<m.length;++g){const b=m[g];a[g]=Re(a[g],q(h-d,b))}}for(let u=0;u<a.length;++u)a[u]=et(a[u],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const o=e[r];let s=o;if(KI(e,o)>1){const i=KI(e.slice(0,r),o);s+=`_${i}`}n.push(s)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:r[m]});const h=new Ti(d),f=Nu(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let b=g(o[m],f[m]);s[m]!=null&&(b=Bee(b,s[m]));const v=In(b);n.push(v),m===0?p=b:p=Re(p,b)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=n[m];else{const b=this.metricsTensors[m][0],v=this.metricsTensors[m][1];g=In(b(o[v],f[v]))}Rs(g),i.push(g)}return p=In(p),this.calculateLosses().forEach(m=>{p=Re(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read()),c=!0;return[this.optimizer_.minimize(a,c,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>ie(()=>{const n=[];let r;const o=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:o[c]});const a=new Ti(i),l=Nu(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=In(u(s[c],l[c]));c===0?r=d:r=Re(r,d),n.push(r)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=In(u(s[d],l[d]));n.push(h)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let o,s,i,a,l,c,u,d,h;try{const f=r.batchSize==null?32:r.batchSize;wv(f);const p=!1,m=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,p,f);o=m[0],s=m[1],h=m[2];let g=!1,b;if(r.validationData!=null&&r.validationData.length>0){if(g=!0,r.validationData.length===2)l=r.validationData[0],c=r.validationData[1];else throw r.validationData.length===3?new gt("validationData including sample weights is not supported yet."):new X(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const R=!0,T=await this.standardizeUserData(l,c,null,null,R,f);u=T[0],d=T[1],b=u.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){g=!0;const R=Math.floor(o[0].shape[0]*(1-r.validationSplit)),T=o[0].shape[0];u=Su(o,R,T),i=o,o=Su(o,0,R),d=Su(s,R,T),a=s,s=Su(s,0,R),b=u.concat(d)}else r.validationSteps!=null&&(g=!0);const v=o.concat(s).concat(h);this.checkTrainableWeightsConsistency();const w=this.makeTrainFunction(),y=this.getDedupedMetricsNames();let C,S;g?(this.makeTestFunction(),C=this.testFunction,S=y.slice().concat(y.map(R=>"val_"+R))):(C=null,b=[],S=y.slice());const $=Y_(r.callbacks,r.yieldEvery);return await this.fitLoop(w,v,y,f,r.epochs,r.verbose,$,C,b,r.shuffle,S,r.initialEpoch,null,null)}finally{this.isTraining=!1,Ho(o,e),Ho(s,n),Ho(i,e),Ho(a,n),Ho(u,l),Ho(d,c),h!=null&&yt(h)}}async fitLoop(e,n,r,o,s,i,a,l,c,u,d,h,f,p){o==null&&(o=32),s==null&&(s=1),u==null&&(u=!0),h==null&&(h=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new X("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(n,o,f,"steps_per_epoch");let b;g!=null&&(b=os(0,g)),i==null&&(i=1);const{callbackList:v,history:w}=Z_(a,i,s,h,g,f,o,m,d);v.setModel(this),this.history=w,await v.onTrainBegin(),this.stopTraining_=!1;for(let y=h;y<s;++y){await v.onEpochBegin(y);const C={};if(f!=null)throw new gt("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new gt("batch shuffling is not implemneted yet");u&&p8(b);const S=Xr(b),$=Cv(g,o);for(let I=0;I<$.length;++I){const R={};if(await v.onBatchBegin(I,R),ie(()=>{const T=$[I][0],N=$[I][1],_=Ka(S,T,N-T);R.batch=I,R.size=N-T;const P=Qx(n,_),z=e(P);for(let L=0;L<r.length;++L){const O=r[L],B=z[L];R[O]=B,Rs(B)}if(I===$.length-1&&m){const L=this.testLoop(l,c,o);for(let O=0;O<r.length;++O){const B=r[O],U=L[O];Rs(U),C["val_"+B]=U}}}),await v.onBatchEnd(I,R),X_(R),this.stopTraining_)break}S.dispose()}if(await v.onEpochEnd(y,C),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return Vee(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),o=r[0],s=r[1],a=this.makeTrainFunction()(o.concat(s)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return yt(a),Ho(r[0],e),Ho(r[1],n),Ar(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,o=r?this.trainableWeights:this.weights,s=this.getWeights(r);for(let i=0;i<o.length;++i)r&&!o[i].trainable||n.push({name:o[i].originalName,tensor:s[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Bx().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Bx().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Gs(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Gs(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const o of n)if(typeof r[o]=="string")e[o]=Gs(r[o]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Gs(Qf(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Gs(Qf(e)));{const e={};for(const n in this.metrics)e[n]=Gs(Qf(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=nm(e.optimizer_config),r=Ds(n);let o;if(typeof e.loss=="string")o=ka(e.loss);else if(Array.isArray(e.loss))o=e.loss.map(i=>ka(i));else if(e.loss!=null){o={};for(const i in e.loss)o[i]=ka(e.loss[i])}let s;if(Array.isArray(e.metrics))s=e.metrics.map(i=>ka(i));else if(e.metrics!=null){s={};for(const i in e.metrics)s[i]=ka(e.metrics[i])}this.compile({loss:o,metrics:s,optimizer:r})}async save(e,n){if(typeof e=="string"){const c=hK(e);if(c.length===0)throw new X(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new X(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new X("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await EI(this.getNamedWeights(n)),o=!1,s=null,a={modelTopology:this.toJSON(s,o),format:Yee,generatedBy:`TensorFlow.js tfjs-layers v${oA}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await EI(await this.optimizer.getWeights(),c);r.specs.push(...d),r.data=XR([r.data,u])}return this.userDefinedMetadata!=null&&(ok(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){ok(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}ac.className="Model";Te(ac);class cA extends ac{}cA.className="Functional";Te(cA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function t0(t,e){if(e==null&&(e={}),typeof t=="string"){const n=fK(t,e);if(n.length===0)n.push(WK(t,e));else if(n.length>1)throw new X(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return Zee(t,void 0,e)}async function Zee(t,e,n){if(n==null&&(n={}),t.load==null)throw new X("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await t.load();let o=r.modelTopology;o.model_config!=null&&(o=o.model_config);const s=n.strict==null?!0:n.strict,i=r.weightData!=null&&r.weightSpecs!=null&&s,a=Ds(nm(o),e,i),l=r.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),r.userDefinedMetadata!=null&&a.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new X("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:u}=Jee(r.weightData,r.weightSpecs);a.loadWeights(c,s),a.optimizer!=null&&u.length>0&&await a.optimizer.setWeights(u),yt(c),yt(u.map(d=>d.tensor))}return a}function Jee(t,e){const n=tK(t,e),r={},o=[];return e.forEach(s=>{s.group==="optimizer"?o.push({name:s.name,tensor:n[s.name]}):r[s.name]=n[s.name]}),{modelWeights:r,optimizerWeights:o}}class Sc extends ac{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:ob("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new X(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Sc||e instanceof ac;let r;if(n){if(r=e,r.outputs.length!==1)throw new X("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new X("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new X("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const o=QQ({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(o)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new X(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new X("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=H_(this.outputs[0])}this.inboundNodes=[],new ib({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:cl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(o=>o.shape),outputShapes:this.outputs[0].shape})}else{const o=e.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ot(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new ac({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new No("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new No("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new No("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new No("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},o=!1){let s,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new X("Legacy serialization format not supported yet.");s=n}else D(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=n.layers,delete n.layers,i=n;const a=new e(i);if(!(a instanceof Sc))throw new gt(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of s){const u=Ds(l,void 0,o);o&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new X("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new X("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}Sc.className="Sequential";Te(Sc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qee(t){return new Sc(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Br extends Xc{getConfig(){return{}}}class uA extends Br{apply(e,n=1){return BQ(e,n)}}uA.className="elu";Te(uA);class dA extends Br{apply(e){return WN(e)}}dA.className="selu";Te(dA);class hA extends Br{apply(e){return ui(e)}}hA.className="relu";Te(hA);class fA extends Br{apply(e){return ie(()=>Jg(6,ui(e)))}}fA.className="relu6";Te(fA);class pA extends Br{apply(e){return e}}pA.className="linear";Te(pA);class mA extends Br{apply(e){return Yc(e)}}mA.className="sigmoid";Te(mA);class gA extends Br{apply(e){return WQ(e)}}gA.className="hardSigmoid";Te(gA);class bA extends Br{apply(e){return Mh(e)}}bA.className="softplus";Te(bA);class vA extends Br{apply(e){return zQ(e)}}vA.className="softsign";Te(vA);class xA extends Br{apply(e){return F1(e)}}xA.className="tanh";Te(xA);class Xw extends Br{apply(e,n=-1){return J1(e,n)}}Xw.className="softmax";Te(Xw);class yA extends Br{apply(e,n=-1){return TN(e,n)}}yA.className="logSoftmax";Te(yA);class wA extends Br{apply(e,n=1){return ie(()=>q(Yc(q(e,n)),e))}}wA.className="swish";Te(wA);class CA extends Br{apply(e){return ie(()=>q(e,F1(Mh(e))))}}CA.className="mish";Te(CA);function Hi(t){return t.getClassName()}function $v(t,e={}){return Uh(t,ko.getMap().classNameMap,e,"activation")}function Gi(t){if(t==null){const e={};return e.className="linear",e.config={},$v(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},$v(e)}else return t instanceof Br?t:$v(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ete(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class $A extends Xc{}class SA extends $A{constructor(e){super(),ete(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ie(()=>{let n=Zn([1]);return this.hasL1&&(n=Re(n,Xe(q(this.l1,Xn(e))))),this.hasL2&&(n=Re(n,Xe(q(this.l2,Gh(e))))),ee(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}SA.className="L1L2";Te(SA);const uk={l1l2:"L1L2"};function jt(t){return Ow(t)}function dk(t,e={}){return Uh(t,ko.getMap().classNameMap,e,"regularizer")}function gn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in uk?uk[t]:t,config:{}};return dk(n)}else return t instanceof $A?t:dk(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class IA extends It{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=at(e);let r=ui(e);return this.maxValue!=null&&(r=mo(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}IA.className="ReLU";Te(IA);class kA extends It{constructor(e){super(e==null?{}:e),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=at(e);return W1(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}kA.className="LeakyReLU";Te(kA);class TA extends It{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=mn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=gn(e.alphaRegularizer),this.alphaConstraint=Hn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new X(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ot(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const o of this.sharedAxes)n[o-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let o=1;o<e.length;++o)r[o]=e[o];this.inputSpec=[new Vn({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=at(e),q1(e,this.alpha.read())}getConfig(){const e={alphaInitializer:xn(this.alphaInitializer),alphaRegularizer:jt(this.alphaRegularizer),alphaConstraint:Un(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}TA.className="PReLU";Te(TA);class EA extends It{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new gt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=at(e);return Xg(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}EA.className="ELU";Te(EA);class RA extends It{constructor(e){super(e==null?{}:e),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=at(e);return q(r,Ve(vo(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}RA.className="ThresholdedReLU";Te(RA);class NA extends It{constructor(e){super(e==null?{}:e),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new Xw().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){const r=at(e);return this.softmax(r,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}NA.className="Softmax";Te(NA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lc(t,e,n){if(typeof t=="number")return cl(t,e);if(t.length!==e)throw new X(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const o=t[r];if(!OQ(o))throw new X(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${o}`)}return t}function es(t,e,n,r,o=1){if(t==null)return t;const s=e+(e-1)*(o-1);let i;return n==="same"?i=t:i=t-s+1,Math.floor((i+r-1)/r)}function $s(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+Ui([n-e,0]);else if(r==="same")t=t*e;else throw new X(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yw(t,e){return ie(()=>(Rn(e),e==="channelsFirst"?Et(t,[0,2,3,1]):t))}function _A(t,e){return ie(()=>(Rn(e),e==="channelsFirst"?Et(t,[0,2,3,4,1]):t))}function tte(t,e,n,r=1,o="valid",s,i=1){return ie(()=>{if(s==null&&(s=ss()),Rn(s),t.shape.length!==3)throw new X(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new X(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new X(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(s==="channelsFirst"&&(t=Et(t,[0,2,1])),o==="causal")throw new gt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=vN(t,e,r,o==="same"?"same":"valid","NWC",i);return n!=null&&(a=cs(a,n)),a})}function hk(t,e,n,r=[1,1],o="valid",s,i,a=null){return ie(()=>{if(s==null&&(s=ss()),Rn(s),t.rank!==3&&t.rank!==4)throw new X(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new X(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=Yw(t,s);if(o==="causal")throw new gt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=JX({x:l,filter:e,strides:r,pad:o==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),s==="channelsFirst"&&(l=Et(l,[0,3,1,2])),l})}function nte(t,e,n,r=[1,1,1],o="valid",s,i){return ie(()=>{if(s==null&&(s=ss()),Rn(s),t.rank!==4&&t.rank!==5)throw new X(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new X(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=_A(t,s);if(o==="causal")throw new gt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=d7(a,e,r,o==="same"?"same":"valid","NDHWC",i),n!=null&&(a=cs(a,n)),s==="channelsFirst"&&(a=Et(a,[0,4,1,2,3])),a})}class cb extends It{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",cb.verifyArgs(n),this.rank=e,Jn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new gt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=lc(n.kernelSize,e,"kernelSize"),this.strides=lc(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,xo(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Rn(this.dataFormat),this.activation=Gi(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=mn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Hn(n.biasConstraint),this.biasRegularizer=gn(n.biasRegularizer),this.activityRegularizer=gn(n.activityRegularizer),this.dilationRate=lc(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new X(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new X(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new X(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Cs("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!Pw(e.kernelSize,"number",1,3))throw new X(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Hi(this.activation),useBias:this.useBias,biasInitializer:xn(this.biasInitializer),biasRegularizer:jt(this.biasRegularizer),activityRegularizer:jt(this.activityRegularizer),biasConstraint:Un(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Qc extends cb{constructor(e,n){super(e,n),this.kernel=null,Qc.verifyArgs(n),this.filters=n.filters,Jn(this.filters,"filters"),this.kernelInitializer=mn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Hn(n.kernelConstraint),this.kernelRegularizer=gn(n.kernelRegularizer)}build(e){e=Ot(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new X(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],o=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return ie(()=>{e=at(e);let r;const o=this.bias==null?null:this.bias.read(),s=R_(this.activation.getClassName());if(s!=null&&this.rank===2)r=hk(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=tte(e,this.kernel.read(),o,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=hk(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=nte(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new gt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Ot(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let s=0;s<r.length;++s){const i=es(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);n.push(i)}let o=[e[0]];return this.dataFormat==="channelsLast"?(o=o.concat(n),o.push(this.filters)):(o.push(this.filters),o=o.concat(n)),o}getConfig(){const e={filters:this.filters,kernelInitializer:xn(this.kernelInitializer),kernelRegularizer:jt(this.kernelRegularizer),kernelConstraint:Un(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new X(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Xh extends Qc{constructor(e){super(2,e),Xh.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Pw(e.kernelSize,"number",1,2))throw new X(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Xh.className="Conv2D";Te(Xh);class Yh extends Qc{constructor(e){super(3,e),Yh.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new X(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Yh.className="Conv3D";Te(Yh);class AA extends Xh{constructor(e){if(super(e),this.inputSpec=[new Vn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new X(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ot(e),e.length!==4)throw new X("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new X("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],o=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Vn({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return ie(()=>{let r=at(e);if(r.shape.length!==4)throw new X(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const o=r.shape,s=o[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=o[i],c=o[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=$s(l,h,u,this.padding),m=$s(c,f,d,this.padding),g=[s,p,m,this.filters];this.dataFormat!=="channelsLast"&&(r=Et(r,[0,2,3,1]));let b=xN(r,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(b=Et(b,[0,3,1,2])),this.bias!=null&&(b=cs(b,this.bias.read(),this.dataFormat)),this.activation!=null&&(b=this.activation.apply(b)),b})}computeOutputShape(e){e=Ot(e);const n=e.slice();let r,o,s;this.dataFormat==="channelsFirst"?(r=1,o=2,s=3):(r=3,o=1,s=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[r]=this.filters,n[o]=$s(n[o],l,i,this.padding),n[s]=$s(n[s],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}AA.className="Conv2DTranspose";Te(AA);class DA extends Yh{constructor(e){if(super(e),this.inputSpec=[new Vn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new X(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ot(e),e.length!==5)throw new X("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new X("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],o=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Vn({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return ie(()=>{let r=at(e);if(r.shape.length!==5)throw new X(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const o=r.shape,s=o[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const c=o[l],u=o[i],d=o[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],b=this.strides[2],v=$s(c,m,h,this.padding),w=$s(u,g,f,this.padding),y=$s(d,b,p,this.padding),C=[s,v,w,y,this.filters];this.dataFormat!=="channelsLast"&&(r=Et(r,[0,2,3,4,1]));let S=p7(r,this.kernel.read(),C,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=Et(S,[0,4,1,2,3])),this.bias!==null&&(S=cs(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=Ot(e);const n=e.slice();let r,o,s,i;this.dataFormat==="channelsFirst"?(r=1,o=2,s=3,i=4):(r=4,o=1,s=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[r]=this.filters,n[o]=$s(n[o],u,a,this.padding),n[s]=$s(n[s],d,l,this.padding),n[i]=$s(n[i],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}DA.className="Conv3DTranspose";Te(DA);class FA extends Qc{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new X("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new X("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new X(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=mn(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=gn(n.depthwiseRegularizer),this.depthwiseConstraint=Hn(n.depthwiseConstraint),this.pointwiseInitializer=mn(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=gn(n.pointwiseRegularizer),this.pointwiseConstraint=Hn(n.pointwiseConstraint)}build(e){if(e=Ot(e),e.length<this.rank+2)throw new X(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new X(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],o=this.kernelSize.concat([r,this.depthMultiplier]),s=[];for(let a=0;a<this.rank;++a)s.push(1);s.push(r*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Vn({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return ie(()=>{e=at(e);let r;if(this.rank===1)throw new gt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Et(e,[0,2,3,1])),r=VN(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=cs(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Et(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=xn(this.depthwiseInitializer),e.pointwiseInitializer=xn(this.pointwiseInitializer),e.depthwiseRegularizer=jt(this.depthwiseRegularizer),e.pointwiseRegularizer=jt(this.pointwiseRegularizer),e.depthwiseConstraint=Un(this.depthwiseConstraint),e.pointwiseConstraint=Un(this.pointwiseConstraint),e}}FA.className="SeparableConv";class OA extends FA{constructor(e){super(2,e)}}OA.className="SeparableConv2D";Te(OA);class ub extends Qc{constructor(e){super(1,e),ub.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Pw(e.kernelSize,"number",1,1))throw new X(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}ub.className="Conv1D";Te(ub);class PA extends It{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return ie(()=>{if(e=at(e),this.dataFormat==="channelsLast"){const r=Jf(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Jf(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Jf(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Jf(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}PA.className="Cropping2D";Te(PA);class MA extends It{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Rn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,AQ(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return ie(()=>{let r=at(e);const o=r.shape;if(this.dataFormat==="channelsFirst"){r=Et(r,[0,2,3,1]);const s=this.size[0]*o[2],i=this.size[1]*o[3],a=this.interpolation==="nearest"?Pa.resizeNearestNeighbor(r,[s,i]):Pa.resizeBilinear(r,[s,i]);return Et(a,[0,3,1,2])}else{const s=this.size[0]*o[1],i=this.size[1]*o[2];return this.interpolation==="nearest"?Pa.resizeNearestNeighbor(r,[s,i]):Pa.resizeBilinear(r,[s,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}MA.className="UpSampling2D";Te(MA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rte(t,e,n=[1,1],r="valid",o,s){return ie(()=>{o==null&&(o=ss()),Rn(o);let i=Yw(t,o);if(t.rank!==4)throw new X(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new X(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=L1(i,e,n,r==="same"?"same":"valid","NHWC",s),o==="channelsFirst"&&(i=Et(i,[0,3,1,2])),i})}class LA extends cb{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=mn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Hn(e.depthwiseConstraint),this.depthwiseRegularizer=gn(e.depthwiseRegularizer)}build(e){if(e=Ot(e),e.length<4)throw new X(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new X(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],o=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",o,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ie(()=>{e=at(e);let r=rte(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=cs(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Ot(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,s=es(n,this.kernelSize[0],this.padding,this.strides[0]),i=es(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],o,s,i]:[e[0],s,i,o]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=xn(this.depthwiseInitializer),e.depthwiseRegularizer=jt(this.depthwiseRegularizer),e.depthwiseConstraint=Un(this.depthwiseRegularizer),e}}LA.className="DepthwiseConv2D";Te(LA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function BA(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new X("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function o(s){return s==null||Array.isArray(s)?s:[s]}return e=o(e),n=o(n),{inputs:t,initialState:e,constants:n}}function zA(t,e,n,r=!1,o,s,i=!1,a=!1){return ie(()=>{const l=e.shape.length;if(l<3)throw new X(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(os(2,l));if(e=Et(e,c),s!=null)throw new gt("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),o!=null&&(o=Ve(Ve(o,"bool"),"float32"),o.rank===l-1&&(o=Gr(o,-1)),o=Et(o,c)),r&&(e=il(e,0),o!=null&&(o=il(o,0)));const u=[];let d,h=n;const f=e.shape[0],p=al(e);let m;o!=null&&(m=al(o));for(let b=0;b<f;++b){const v=p[b],w=ie(()=>t(v,h));if(o==null)d=w[0],h=w[1];else{const y=ie(()=>{const C=m[b],S=Ye(Mo(C),C),$=Re(q(w[0],C),q(h[0],S)),I=h.map((R,T)=>Re(q(w[1][T],C),q(R,S)));return{output:$,newStates:I}});d=y.output,h=y.newStates}a&&u.push(d)}let g;return a&&(g=Vi(u,1)),[d,g,h]})}class sa extends It{constructor(e){super(e);let n;if(e.cell==null)throw new X("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new Qw({cells:e.cell}):n=e.cell,n.stateSize==null)throw new X("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Vn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return os(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Xx(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let o;if(this.returnSequences?o=[e[0],e[1],r]:o=[e[0],r],this.returnState){const s=[];for(const i of n)s.push([e[0],i]);return[o].concat(s)}else return o}computeMask(e,n){return ie(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const o=this.states.map(s=>null);return[r].concat(o)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new gt("Constants support is not implemented in RNN yet.");Xx(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Vn({shape:[n,null,...r]});const o=[e[0]].concat(e.slice(2));this.cell.build(o);let s;if(Array.isArray(this.cell.stateSize)?s=this.cell.stateSize:s=[this.cell.stateSize],this.stateSpec!=null){if(!Bt(this.stateSpec.map(i=>i.shape[i.shape.length-1]),s))throw new X(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map(i=>new Vn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){ie(()=>{if(!this.stateful)throw new ws("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new X("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>Zn([r,o])):this.states_=[Zn([r,this.cell.stateSize])];else if(e==null)yt(this.states_),this.keptStates!=null&&(yt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>Zn([r,o])):this.states_[0]=Zn([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new X(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):yt(this.states_);for(let o=0;o<this.states_.length;++o){const s=e[o],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[o]:this.cell.stateSize,a=[r,i];if(!Bt(s.shape,a))throw new X(`State ${o} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${s.shape}`);this.states_[o]=s}}this.states_=this.states_.map(o=>Rs(o.clone()))})}apply(e,n){let r=n==null?null:n.initialState,o=n==null?null:n.constants;n==null&&(n={});const s=BA(e,r,o,this.numConstants);e=s.inputs,r=s.initialState,o=s.constants;let i=[],a=[];if(r!=null){n.initialState=r,i=i.concat(r),this.stateSpec=[];for(const c of r)this.stateSpec.push(new Vn({shape:c.shape}));a=a.concat(this.stateSpec)}if(o!=null&&(n.constants=o,i=i.concat(o),this.numConstants=o.length),i[0]instanceof ks){const c=[e].concat(i),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return ie(()=>{const r=n==null?null:n.mask,o=n==null?null:n.training;let s=n==null?null:n.initialState;e=at(e),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==i)throw new X(`RNN Layer has ${i} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:o},c=zA((p,m)=>{const g=this.cell.call([p].concat(m),a);return[g[0],g.slice(1)]},e,s,this.goBackwards,r,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,o);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return ie(()=>{let n=Zn(e.shape);return n=Xe(n,[1,2]),n=Hh(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?Kx(n,[1,r]):n):this.cell.stateSize>1?[Kx(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===sa.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const o=n.cell,s=Ds(o,r);return new e(Object.assign(n,{cell:s}))}}sa.className="RNN";Te(sa);class db extends It{}class Zw extends db{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Jn(this.units,"units"),this.activation=Gi(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=mn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=mn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=mn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gn(e.kernelRegularizer),this.recurrentRegularizer=gn(e.recurrentRegularizer),this.biasRegularizer=gn(e.biasRegularizer),this.kernelConstraint=Hn(e.kernelConstraint),this.recurrentConstraint=Hn(e.recurrentConstraint),this.biasConstraint=Hn(e.biasConstraint),this.dropout=$c([1,Ui([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=$c([1,Ui([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ot(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ie(()=>{if(e=e,e.length!==2)throw new X(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const o=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ji({ones:()=>Mo(e),rate:this.dropout,training:o,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ji({ones:()=>Mo(r),rate:this.recurrentDropout,training:o,dropoutFunc:this.dropoutFunc}));let s;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?s=As(q(e,i),this.kernel.read()):s=As(e,this.kernel.read()),this.bias!=null&&(s=cs(s,this.bias.read())),a!=null&&(r=q(r,a));let l=Re(s,As(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Hi(this.activation),useBias:this.useBias,kernelInitializer:xn(this.kernelInitializer),recurrentInitializer:xn(this.recurrentInitializer),biasInitializer:xn(this.biasInitializer),kernelRegularizer:jt(this.kernelRegularizer),recurrentRegularizer:jt(this.recurrentRegularizer),biasRegularizer:jt(this.biasRegularizer),activityRegularizer:jt(this.activityRegularizer),kernelConstraint:Un(this.kernelConstraint),recurrentConstraint:Un(this.recurrentConstraint),biasConstraint:Un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}Zw.className="SimpleRNNCell";Te(Zw);class WA extends sa{constructor(e){e.cell=new Zw(e),super(e)}call(e,n){return ie(()=>{this.cell.dropoutMask!=null&&(yt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(yt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,o=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(e,{mask:r,training:o,initialState:s})})}static fromConfig(e,n){return new e(n)}}WA.className="SimpleRNN";Te(WA);class Jw extends db{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new X("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Jn(this.units,"units"),this.activation=Gi(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Gi(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=mn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=mn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=mn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gn(e.kernelRegularizer),this.recurrentRegularizer=gn(e.recurrentRegularizer),this.biasRegularizer=gn(e.biasRegularizer),this.kernelConstraint=Hn(e.kernelConstraint),this.recurrentConstraint=Hn(e.recurrentConstraint),this.biasConstraint=Hn(e.biasConstraint),this.dropout=$c([1,Ui([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=$c([1,Ui([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ot(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ie(()=>{if(e=e,e.length!==2)throw new X(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let o=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ji({ones:()=>Mo(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ji({ones:()=>Mo(o),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=q(e,s[0]));let u=As(e,this.kernel.read());this.useBias&&(u=cs(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(o=q(o,i[0]));const d=this.recurrentKernel.read(),[h,f]=ho(d,[2*this.units,this.units],d.rank-1),p=As(o,h),[m,g,b]=ho(u,3,u.rank-1),[v,w]=ho(p,2,p.rank-1);a=this.recurrentActivation.apply(Re(m,v)),l=this.recurrentActivation.apply(Re(g,w));const y=As(q(l,o),f);c=this.activation.apply(Re(b,y));const C=Re(q(a,o),q(Re(1,yn(a)),c));return[C,C]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Hi(this.activation),recurrentActivation:Hi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:xn(this.kernelInitializer),recurrentInitializer:xn(this.recurrentInitializer),biasInitializer:xn(this.biasInitializer),kernelRegularizer:jt(this.kernelRegularizer),recurrentRegularizer:jt(this.recurrentRegularizer),biasRegularizer:jt(this.biasRegularizer),activityRegularizer:jt(this.activityRegularizer),kernelConstraint:Un(this.kernelConstraint),recurrentConstraint:Un(this.recurrentConstraint),biasConstraint:Un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}Jw.className="GRUCell";Te(Jw);class VA extends sa{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Jw(e),super(e)}call(e,n){return ie(()=>{this.cell.dropoutMask!=null&&(yt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(yt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,o=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(e,{mask:r,training:o,initialState:s})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}VA.className="GRU";Te(VA);class hb extends db{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Jn(this.units,"units"),this.activation=Gi(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Gi(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=mn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=mn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=mn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=gn(e.kernelRegularizer),this.recurrentRegularizer=gn(e.recurrentRegularizer),this.biasRegularizer=gn(e.biasRegularizer),this.kernelConstraint=Hn(e.kernelConstraint),this.recurrentConstraint=Hn(e.recurrentConstraint),this.biasConstraint=Hn(e.biasConstraint),this.dropout=$c([1,Ui([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=$c([1,Ui([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ot(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let o;if(this.useBias){if(this.unitForgetBias){const s=this.biasInitializer,i=this.units;o=new(n=class extends Vo{apply(l,c){const u=s.apply([i]),d=new Lw().apply([i]),h=s.apply([i*2]);return XI(XI(u,d),h)}},n.className="CustomInit",n)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,o,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return ie(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new X(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let o=e[1];const s=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ji({ones:()=>Mo(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ji({ones:()=>Mo(o),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=q(e,i[0]));let h=As(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(o=q(o,a[0])),h=Re(h,As(o,this.recurrentKernel.read())),this.useBias&&(h=cs(h,this.bias.read()));const[f,p,m,g]=ho(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=Re(q(c,s),q(l,this.activation.apply(m))),d=this.recurrentActivation.apply(g);const b=q(d,this.activation.apply(u));return[b,b,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Hi(this.activation),recurrentActivation:Hi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:xn(this.kernelInitializer),recurrentInitializer:xn(this.recurrentInitializer),biasInitializer:xn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:jt(this.kernelRegularizer),recurrentRegularizer:jt(this.recurrentRegularizer),biasRegularizer:jt(this.biasRegularizer),activityRegularizer:jt(this.activityRegularizer),kernelConstraint:Un(this.kernelConstraint),recurrentConstraint:Un(this.recurrentConstraint),biasConstraint:Un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}hb.className="LSTMCell";Te(hb);class UA extends sa{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new hb(e),super(e)}call(e,n){return ie(()=>{this.cell.dropoutMask!=null&&(yt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(yt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,o=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(e,{mask:r,training:o,initialState:s})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}UA.className="LSTM";Te(UA);class Qw extends db{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return ie(()=>{e=e;let r=e.slice(1);const o=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?o.push(r.splice(0,a.stateSize.length)):o.push(r.splice(0,1));o.reverse();const s=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=o[a],a===0?i=[e[0]].concat(r):i=[i[0]].concat(r),i=l.call(i,n),s.push(i.slice(1))}r=[];for(const a of s.slice().reverse())r.push(...a);return[i[0]].concat(r)})}build(e){Xx(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,o)=>{ja(`RNNCell_${o}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=s=>({className:s.getClassName(),config:s.getConfig()}),o={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),o)}static fromConfig(e,n,r={}){const o=[];for(const s of n.cells)o.push(Ds(s,r));return new e({cells:o})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return Yx(e)}setWeights(e){const n=[];for(const r of this.cells){const o=r.weights.length,s=e.splice(o);for(let i=0;i<r.weights.length;++i)n.push([r.weights[i],s[i]])}Gw(n)}}Qw.className="StackedRNNCells";Te(Qw);function ji(t){const{ones:e,rate:n,training:r=!1,count:o=1,dropoutFunc:s}=t,i=()=>s!=null?s(e(),n):P_(e(),n),a=()=>jh(i,e,r);return!o||o<=1?Rs(a().clone()):Array(o).fill(void 0).map(a).map(c=>Rs(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var ote=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};class HA extends sa{constructor(e){if(e.unroll)throw new gt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new gt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Vn({ndim:5})]}call(e,n){return ie(()=>{if(this.cell.dropoutMask!=null&&(yt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(yt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new X("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,o=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(e,{mask:r,training:o,initialState:s})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return ie(()=>{const{stateSize:n}=this.cell,r=e.shape,o=this.computeSingleOutputShape(r),s=[o[0],...o.slice(2)],i=Zn(s);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){ie(()=>{if(!this.stateful)throw new ws("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,o=this.computeSingleOutputShape(r),s=[o[0],...o.slice(2)];if(r[0]==null)throw new X("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Zn(s)):this.states_=[Zn(s)];else if(e==null)yt(this.states_),this.keptStates!=null&&(yt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Zn(s)):this.states_[0]=Zn(s);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new X(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):yt(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=s;if(!Bt(l.shape,c))throw new X(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Rs(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:o,padding:s,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=es(c,o[0],s,i[0],a[0]),h=es(u,o[1],s,i[1],a[1]);return[...e.slice(0,2),...l?[r,d,h]:[d,h,r]]}}HA.className="ConvRNN2D";class eC extends hb{constructor(e){const{filters:n,kernelSize:r,strides:o,padding:s,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Jn(this.filters,"filters"),this.kernelSize=lc(r,2,"kernelSize"),this.kernelSize.forEach(l=>Jn(l,"kernelSize")),this.strides=lc(o||1,2,"strides"),this.strides.forEach(l=>Jn(l,"strides")),this.padding=s||"valid",xo(this.padding),this.dataFormat=i||"channelsLast",Rn(this.dataFormat),this.dilationRate=lc(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Jn(l,"dilationRate"))}build(e){var n;e=Ot(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new X(`The channel dimension of the input should be defined. Found ${e[r]}`);const o=e[r],s=4,i=this.kernelSize.concat([o,this.filters*s]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*s]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends Vo{apply(h,f){const p=c.apply([u]),m=na([u]),g=c.apply([u*2]);return Mw([p,m,g])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*s],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return ie(()=>{if(e.length!==3)throw new X(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,o=e[0],s=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ji({ones:()=>Mo(o),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(se,ce,de)=>!ce||!ce[de]?se:q(ce[de],se);let u=c(o,l,0),d=c(o,l,1),h=c(o,l,2),f=c(o,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ji({ones:()=>Mo(s),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(s,p,0),g=c(s,p,1),b=c(s,p,2),v=c(s,p,3);const w=3,[y,C,S,$]=ho(this.kernel.read(),a,w),[I,R,T,N]=this.useBias?ho(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,y,I,this.padding),d=this.inputConv(d,C,R,this.padding),h=this.inputConv(h,S,T,this.padding),f=this.inputConv(f,$,N,this.padding);const[_,P,z,L]=ho(this.recurrentKernel.read(),a,w);m=this.recurrentConv(m,_),g=this.recurrentConv(g,P),b=this.recurrentConv(b,z),v=this.recurrentConv(v,L);const O=this.recurrentActivation.apply(Re(u,m)),B=this.recurrentActivation.apply(Re(d,g)),U=Re(q(B,i),q(O,this.activation.apply(Re(h,b)))),Q=q(this.recurrentActivation.apply(Re(f,v)),this.activation.apply(U));return[Q,Q,U]})}getConfig(){const e=super.getConfig(),n=ote(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,n,r,o){const s=ol(e,n,this.strides,o||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?cs(s,r,this.dataFormat):s}recurrentConv(e,n){return ol(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}eC.className="ConvLSTM2DCell";Te(eC);class GA extends HA{constructor(e){const n=new eC(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}GA.className="ConvLSTM2D";Te(GA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fb extends It{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let o=0;o<this.noiseShape.length;++o)r.push(this.noiseShape[o]==null?n[o]:this.noiseShape[o]);return r}call(e,n){return ie(()=>{this.invokeCallHook(e,n);const r=at(e);if(0<this.rate&&this.rate<1){const o=n.training==null?!1:n.training,s=this.getNoiseShape(r);return jh(()=>P_(r,this.rate,s,this.seed),()=>r,o)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}fb.className="Dropout";Te(fb);class jA extends fb{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}jA.className="SpatialDropout1D";Te(jA);class tC extends It{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Jn(this.units,"units"),this.activation=Gi(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=mn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=mn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Hn(e.kernelConstraint),this.biasConstraint=Hn(e.biasConstraint),this.kernelRegularizer=gn(e.kernelRegularizer),this.biasRegularizer=gn(e.biasRegularizer),this.activityRegularizer=gn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ot(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ot(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return ie(()=>{this.invokeCallHook(e,n);const r=at(e),o=R_(this.activation.getClassName());let s;return o!=null?s=As(r,this.kernel.read(),o,this.bias?this.bias.read():null):(s=As(r,this.kernel.read()),this.bias!=null&&(s=cs(s,this.bias.read())),this.activation!=null&&(s=this.activation.apply(s))),s})}getConfig(){const e={units:this.units,activation:Hi(this.activation),useBias:this.useBias,kernelInitializer:xn(this.kernelInitializer),biasInitializer:xn(this.biasInitializer),kernelRegularizer:jt(this.kernelRegularizer),biasRegularizer:jt(this.biasRegularizer),activityRegularizer:jt(this.activityRegularizer),kernelConstraint:Un(this.kernelConstraint),biasConstraint:Un(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}tC.className="Dense";Te(tC);class KA extends It{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ot(e);for(const n of e.slice(1))if(n==null)throw new X(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Oi(e,1)]}call(e,n){return ie(()=>{this.invokeCallHook(e,n);let r=at(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const o=[0];for(let s=2;s<r.rank;++s)o.push(s);o.push(1),r=Et(r,o)}return LQ(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}KA.className="Flatten";Te(KA);class qA extends It{constructor(e){super(e),this.supportsMasking=!0,this.activation=Gi(e.activation)}call(e,n){return ie(()=>{this.invokeCallHook(e,n);const r=at(e);return this.activation.apply(r)})}getConfig(){const e={activation:Hi(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}qA.className="Activation";Te(qA);class XA extends It{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return ie(()=>(e=at(e),PQ(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}XA.className="RepeatVector";Te(XA);class YA extends It{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",o=n.slice();let s=1,i=null;for(let l=0;l<o.length;++l){const c=o[l];if(this.isUnknown(c))if(i===null)i=l;else throw new X("Can only specifiy one unknown dimension.");else s*=c}const a=Oi(e);if(i!==null){if(s===0||a%s!==0)throw new X(r);o[i]=a/s}else if(a!==s)throw new X(r);return o}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return ie(()=>{this.invokeCallHook(e,n);const r=at(e),o=r.shape,s=o.slice(0,1).concat(this.fixUnknownDimension(o.slice(1),this.targetShape));return ee(r,s)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}YA.className="Reshape";Te(YA);class ZA extends It{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=os(1,e.dims.length+1);if(!Bt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Vn({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ot(e);const n=e.slice();return this.dims.forEach((r,o)=>{n[o+1]=e[r]}),n}call(e,n){return Et(at(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}ZA.className="Permute";Te(ZA);class JA extends It{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=at(e),o=-1;return Wx(gd(r,this.maskValue),o)}call(e,n){return ie(()=>{this.invokeCallHook(e,n);const r=at(e),o=-1,s=!0,i=Wx(gd(r,this.maskValue),o,s);return q(r,Ve(i,r.dtype))})}}JA.className="Masking";Te(JA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class QA extends It{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(on(e.inputLength))}this.inputDim=e.inputDim,Jn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Jn(this.outputDim,"outputDim"),this.embeddingsInitializer=mn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=gn(e.embeddingsRegularizer),this.activityRegularizer=gn(e.activityRegularizer),this.embeddingsConstraint=Hn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return ie(()=>this.maskZero?(e=at(e),gd(e,Nt(e))):null)}computeOutputShape(e){if(e=Ot(e),this.inputLength==null)return[...e,this.outputDim];const n=on(this.inputLength);if(n.length!==e.length-1)throw new X(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let o=0;o<n.length;++o){const s=n[o],i=e[o+1];if(s!=null&&i!=null&&s!==i)throw new X(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);s==null&&(n[r]=i),r++}}return[e[0],...n,this.outputDim]}call(e,n){return ie(()=>{this.invokeCallHook(e,n);let r=at(e);r.dtype!=="int32"&&(r=_s(r,"int32"));const o=O_(this.embeddings.read(),ee(r,[r.size]));return ee(o,Ot(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:xn(this.embeddingsInitializer),embeddingsRegularizer:jt(this.embeddingsRegularizer),activityRegularizer:jt(this.activityRegularizer),embeddingsConstraint:Un(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}QA.className="Embedding";Te(QA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Sl extends It{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new gt}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let o=0;o<n.length;++o){const s=e[e.length-n.length+o],i=n[o];if(s==null||i==null||s<0||i<0)r.push(null);else if(s===1)r.push(i);else if(i===1)r.push(s);else{if(s!==i)throw new X("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(s)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ot(e)]),e=e,e.length<2)throw new X(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const s of e)s!=null&&s[0]!==null&&n.push(s[0]);if(n=Fi(n),n.length>1)throw new X(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);r=this.computeElementwiseOpOutputShape(r,i)}const o=e.map(s=>s.length);e.indexOf(null)===-1&&Fi(o).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return ie(()=>{if(e=e,this.reshapeRequired){const r=[],o=e.map(s=>s.rank);if(o.indexOf(null)===-1){const s=Ui(o);for(let i of e){const a=i.rank;for(let l=0;l<s-a;++l)i=Hh(i,1);r.push(i)}return this.mergeFunction(r)}else{let s=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=ee(l,[d].concat(Oi(u.slice(1))));f=Et(f,[1,0]),f=ee(f,h),r.push(f),s=!0}else if(c>1){const u=os(1,c).concat([0]);r.push(Et(l,u)),s=!0}else r.push(l)}let i=this.mergeFunction(r);const a=i.rank;if(s){if(a==null){const l=i.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));i=ee(Et(ee(i,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(os(0,a-1));i=Et(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let o=1;o<e.length;++o){const s=e[o]==null?null:e[o].slice(1);n=this.computeElementwiseOpOutputShape(n,s)}let r=[];for(const o of e)o!=null&&o[0]!==null&&r.push(o[0]);return r=Fi(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return ie(()=>{if(n==null)return null;if(!Array.isArray(n))throw new X("`mask` should be an Array");if(!Array.isArray(e))throw new X("`inputs` should be an Array");if(n.length!==e.length)throw new X(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(o=>o==null))return null;n=n.map(o=>o==null?o:Gr(o,0));let r=n[0];for(let o=1;o<n.length-1;++o)r=ti(r,n[o]);return r})}}class eD extends Sl{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=Re(n,e[r]);return n})}}eD.className="Add";Te(eD);class tD extends Sl{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=q(n,e[r]);return n})}}tD.className="Multiply";Te(tD);class nD extends Sl{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=Re(n,e[r]);return q(1/e.length,n)})}}nD.className="Average";Te(nD);class rD extends Sl{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=ta(n,e[r]);return n})}}rD.className="Maximum";Te(rD);class oD extends Sl{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Jg(n,e[r]);return n})}}oD.className="Minimum";Te(oD);class sD extends Sl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new X("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const o of e)if(o!=null){n=!1;break}if(n)return;const r=[];for(let o=0;o<e.length;++o){const s=e[o].slice();s.splice(this.axis,1);let i=!1;for(const a of r)if(Bt(a,s)){i=!0;break}i||r.push(s)}if(r.length>1)throw new X("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ie(()=>Mw(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new X("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),o=this.axis<0?r.length+this.axis:this.axis;for(const s of n.slice(1)){if(r[o]==null||s[o]==null){r[o]=null;break}r[o]+=s[o]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new X("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new X("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new X(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return ie(()=>{let r=!0;if(n.forEach(i=>{if(i!=null){r=!1;return}}),r)return null;const o=[];for(let i=0;i<e.length;++i)n[i]==null?o.push(Ve(Mo(e[i]),"bool")):n[i].rank<e[i].rank?o.push(Gr(n[i],-1)):o.push(n[i]);const s=mr(o,this.axis);return bN(s,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}sD.className="Concatenate";Te(sD);function Iu(t,e){for(;t<0;)t+=e;return t}function ste(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new gt("batchDot is not implemented for tensors of 4D or higher rank yet");if(D(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),D(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new gt("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,o=e.shape.length;n==null&&(n=[r-1,o-2]);const s=n;return ie(()=>{let i;if(r>o){i=r-o;const l=[];for(let c=0;c<i;++c)l.push(1);e=ee(e,e.shape.concat(l))}else if(o>r){i=o-r;const l=[];for(let c=0;c<i;++c)l.push(1);t=ee(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&e.shape.length===2)s[0]===s[1]?a=Xe(q(t,e),s[0]):a=Xe(q(Et(t,[1,0]),e),s[1]);else{const l=s[0]!==t.shape.length-1,c=s[1]===e.shape.length-1;a=Lt(t,e,l,c)}if(i>0){let l;r>o?l=r+o-3:l=r-1;const c=[];for(let u=l;u<l+i;++u)c.push(u);a=Lh(a,c)}return a.shape.length===1&&(a=Gr(a,1)),a})}class iD extends Sl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){D(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new gt("Dot layer does not support tensors of 4D or higher rank yet.");const o=this.interpretAxes(n,r);if(n[o[0]]!==r[o[1]])throw new X(`Dimension incompatibility: ${n[o[0]]} !== ${r[o[1]]}`)}mergeFunction(e){if(e.length!==2)throw new X(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],o;return Array.isArray(this.axes)?o=this.axes.map((s,i)=>Iu(s,e[i].shape.length)):o=[Iu(this.axes,n.shape.length),Iu(this.axes,r.shape.length)],this.normalize&&(n=Zp(n,o[0]),r=Zp(r,o[1])),ste(n,r,o)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[Iu(this.axes,e.length),Iu(this.axes,n.length)],r}computeOutputShape(e){D(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new gt("Dot layer does not support tensors of 4D or higher rank yet.");const o=this.interpretAxes(n,r);n.splice(o[0],1),r.splice(o[1],1),r.splice(0,1);const s=n.concat(r);return s.length===1&&s.push(1),s}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}iD.className="Dot";Te(iD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aD extends It{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return ie(()=>{this.invokeCallHook(e,n);const r=at(e);return jh(()=>Re(sb(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}aD.className="GaussianNoise";Te(aD);class lD extends It{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ie(()=>{this.invokeCallHook(e,n);const r=at(e);return this.rate>0&&this.rate<1?jh(()=>{const s=Math.sqrt(this.rate/(1-this.rate));return q(r,sb(r.shape,1,s))},()=>r,n.training||!1):r})}}lD.className="GaussianDropout";Te(lD);class cD extends It{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||at(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ie(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return jh(()=>{const s=at(e),i=1.6732632423543772,a=1.0507009873554805,l=-i*a;let c=wl(Qg(r),this.rate);c=_s(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-u*l*this.rate,h=Re(q(s,c),q(Re(c,-1),l));return Re(q(h,u),d)},()=>at(e),n.training||!1)}return e})}}cD.className="AlphaDropout";Te(cD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yd(t,e,n,r,o,s=.001){let i;if(t.rank===2)i=W9(t,e,n,r,o,s);else if(t.rank===3)i=U9(t,e,n,r,o,s);else if(t.rank===4)i=G9(t,e,n,r,o,s);else throw new gt(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function ite(t,e,n,r,o=.001){return ie(()=>{const s=G1(t,r),i=s.mean,a=s.variance;return[yd(t,i,a,n,e,o),i,a]})}function ate(t,e,n,r,o=.001){return ie(()=>{const s=G1(t,r),i=s.mean,a=s.variance,l=[];for(const p of os(0,t.rank))r.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=ee(i,l),u=ee(a,l),d=e==null?null:ee(e,l),h=n==null?null:ee(n,l);return[yd(t,c,u,h,d,o),i,a]})}function lte(t,e,n,r,o=.001){return Bt(r.slice().sort(),os(0,t.rank-1))?ite(t,e,n,r,o):ate(t,e,n,r,o)}class uD extends It{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=mn(e.betaInitializer||"zeros"),this.gammaInitializer=mn(e.gammaInitializer||"ones"),this.movingMeanInitializer=mn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=mn(e.movingVarianceInitializer||"ones"),this.betaConstraint=Hn(e.betaConstraint),this.gammaConstraint=Hn(e.gammaConstraint),this.betaRegularizer=gn(e.betaRegularizer),this.gammaRegularizer=gn(e.gammaRegularizer)}build(e){e=Ot(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new X(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Vn({ndim:e.length,axes:{[n]:r}})];const o=[r];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return ie(()=>{const r=n.training==null?!1:n.training,o=at(e),s=o.shape,i=s.length,a=os(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const c=cl(1,i);c[l]=s[l];const u=a.slice();u.sort();const d=!Bt(u,os(0,i).slice(0,i-1)),h=()=>{if(d){const v=ee(this.movingMean.read(),c),w=ee(this.movingVariance.read(),c),y=this.center?ee(this.beta.read(),c):null,C=this.scale?ee(this.gamma.read(),c):null;return yd(o,v,w,y,C,this.epsilon)}else return yd(o,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();const[f,p,m]=lte(o,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(v,w,y)=>{ie(()=>{const C=1-y,S=v.read(),$=q(Ye(S,w),C);v.write(Ye(S,$))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:xn(this.betaInitializer),gammaInitializer:xn(this.gammaInitializer),movingMeanInitializer:xn(this.movingMeanInitializer),movingVarianceInitializer:xn(this.movingVarianceInitializer),betaRegularizer:jt(this.betaRegularizer),gammaRegularizer:jt(this.gammaRegularizer),betaConstraint:Un(this.betaConstraint),gammaConstraint:Un(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}uD.className="BatchNormalization";Te(uD);class dD extends It{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=mn(e.betaInitializer||"zeros"),this.gammaInitializer=mn(e.gammaInitializer||"ones"),this.betaRegularizer=gn(e.betaRegularizer),this.gammaRegularizer=gn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ot(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=n);for(const s of this.axis)if(s<0||s>=n)throw new Error(`Invalid axis: ${s}`);if(this.axis.length!==Fi(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(s=>e[s]),o=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,o):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,o):this.beta=null,this.built=!0}call(e,n){const r=at(e),o=r.shape,s=o.length;return ie(()=>{let{mean:a,variance:l}=G1(r,this.axis,!0);const c=cl(1,s);for(const m of this.axis)c[m]=o[m];const u=m=>m!=null&&m.shape.length!==s?ee(m,c):m;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<s;++m)this.axis.indexOf(m)!==-1?(f.push(o[m]),p.push(1)):(f.push(1),p.push(o[m]));return a=Yo(a,f),l=Yo(l,f),d!=null&&(d=Yo(d,p)),h!=null&&(h=Yo(h,p)),yd(r,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:xn(this.betaInitializer),gammaInitializer:xn(this.gammaInitializer),betaRegularizer:jt(this.betaRegularizer),gammaRegularizer:jt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}dD.className="LayerNormalization";Te(dD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cte(t,e,n){return ie(()=>{if(t.rank!==4)throw new X(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new X("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=ss()),n!=="channelsLast"&&n!=="channelsFirst")throw new X(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],j1(t,r)})}class hD extends It{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?ss():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new X(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new X(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new X(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new Vn({ndim:4})]}computeOutputShape(e){e=Ot(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return ie(()=>cte(at(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}hD.className="ZeroPadding2D";Te(hD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pb(t,e,n,r,o,s){return ie(()=>{Rn(o),__(s),xo(r),n==null&&(n=[1,1]),r==null&&(r="valid"),o==null&&(o=ss()),s==null&&(s="max"),t=Yw(t,o);let i;const a=r==="same"?"same":"valid";return s==="max"?i=H1(t,e,n,a):i=D1(t,e,n,a),o==="channelsFirst"&&(i=Et(i,[0,3,1,2])),i})}function fD(t,e,n,r,o,s){return ie(()=>{Rn(o),__(s),xo(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),o==null&&(o=ss()),s==null&&(s="max"),t=_A(t,o);let i;const a=r==="same"?"same":"valid";return s==="max"?i=Tq(t,e,n,a):i=A9(t,e,n,a),o==="channelsFirst"&&(i=Et(i,[0,4,1,2,3])),i})}class pD extends It{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new X(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Jn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new X(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Jn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,xo(this.padding),this.inputSpec=[new Vn({ndim:3})]}computeOutputShape(e){e=Ot(e);const n=es(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return ie(()=>{this.invokeCallHook(e,n),e=Hh(at(e),2);const r=this.poolingFunction(at(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Lh(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class mD extends pD{constructor(e){super(e)}poolingFunction(e,n,r,o,s){return Rn(s),xo(o),pb(e,n,r,o,s,"max")}}mD.className="MaxPooling1D";Te(mD);class gD extends pD{constructor(e){super(e)}poolingFunction(e,n,r,o,s){return Rn(s),xo(o),pb(e,n,r,o,s,"avg")}}gD.className="AveragePooling1D";Te(gD);class bD extends It{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new X(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Jn(this.poolSize,"poolSize"),Jn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Rn(this.dataFormat),xo(this.padding),this.inputSpec=[new Vn({ndim:4})]}computeOutputShape(e){e=Ot(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=es(n,this.poolSize[0],this.padding,this.strides[0]),r=es(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return ie(()=>(this.invokeCallHook(e,n),this.poolingFunction(at(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class vD extends bD{constructor(e){super(e)}poolingFunction(e,n,r,o,s){return Rn(s),xo(o),pb(e,n,r,o,s,"max")}}vD.className="MaxPooling2D";Te(vD);class xD extends bD{constructor(e){super(e)}poolingFunction(e,n,r,o,s){return Rn(s),xo(o),pb(e,n,r,o,s,"avg")}}xD.className="AveragePooling2D";Te(xD);class yD extends It{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new X(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Jn(this.poolSize,"poolSize"),Jn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Rn(this.dataFormat),xo(this.padding),this.inputSpec=[new Vn({ndim:5})]}computeOutputShape(e){e=Ot(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=es(n,this.poolSize[0],this.padding,this.strides[0]),r=es(r,this.poolSize[1],this.padding,this.strides[1]),o=es(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,o]:[e[0],n,r,o,e[4]]}call(e,n){return ie(()=>(this.invokeCallHook(e,n),this.poolingFunction(at(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class wD extends yD{constructor(e){super(e)}poolingFunction(e,n,r,o,s){return Rn(s),xo(o),fD(e,n,r,o,s,"max")}}wD.className="MaxPooling3D";Te(wD);class CD extends yD{constructor(e){super(e)}poolingFunction(e,n,r,o,s){return Rn(s),xo(o),fD(e,n,r,o,s,"avg")}}CD.className="AveragePooling3D";Te(CD);class $D extends It{constructor(e){super(e),this.inputSpec=[new Vn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new gt}}class SD extends $D{constructor(e){super(e||{})}call(e,n){return ie(()=>{const r=at(e);return In(r,1)})}}SD.className="GlobalAveragePooling1D";Te(SD);class ID extends $D{constructor(e){super(e||{})}call(e,n){return ie(()=>{const r=at(e);return Qo(r,1)})}}ID.className="GlobalMaxPooling1D";Te(ID);class kD extends It{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Rn(this.dataFormat),this.inputSpec=[new Vn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new gt}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class TD extends kD{call(e,n){return ie(()=>{const r=at(e);return this.dataFormat==="channelsLast"?In(r,[1,2]):In(r,[2,3])})}}TD.className="GlobalAveragePooling2D";Te(TD);class ED extends kD{call(e,n){return ie(()=>{const r=at(e);return this.dataFormat==="channelsLast"?Qo(r,[1,2]):Qo(r,[2,3])})}}ED.className="GlobalMaxPooling2D";Te(ED);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class RD extends It{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const o=n.layer,s=Ds(o,r);delete n.layer;const i={layer:s};return Object.assign(i,n),new e(i)}}class ND extends RD{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ot(e),e.length<3)throw new X(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ot(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),o=e[1];return[r[0],o].concat(r.slice(1))}call(e,n){return ie(()=>(e=at(e),zA((i,a)=>[at(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}ND.className="TimeDistributed";Te(ND);function ute(t){$l(_Q,"BidirectionalMergeMode",t)}const dte="concat";class _D extends RD{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=Ds(r),n.goBackwards=n.goBackwards!==!0;const o={};if(o.className=e.layer.getClassName(),o.config=n,this.backwardLayer=Ds(o),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?dte:e.mergeMode,ute(this.mergeMode),e.weights)throw new gt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,o,s;return this.returnState&&(s=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,o=[r]):this.mergeMode==null?o=[r,r.slice()]:o=[r],this.returnState?this.mergeMode==null?o.concat(s).concat(s.slice()):[r].concat(s).concat(s.slice()):Ar(o)}apply(e,n){let r=n==null?null:n.initialState,o=n==null?null:n.constants;n==null&&(n={});const s=BA(e,r,o,this.numConstants);if(e=s.inputs,r=s.initialState,o=s.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&o==null)return super.apply(e,n);const i=[],a=[];if(r!=null){const c=r.length;if(c%2>0)throw new X("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,i.push(...r);const u=r.map(d=>new Vn({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(o!=null)throw new gt("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof ks;for(const c of i)if(c instanceof ks!==l)throw new X("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(i),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return ie(()=>{const r=n.initialState;let o,s;if(r==null)o=this.forwardLayer.call(e,n),s=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),c=r.slice(r.length/2);o=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),s=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let i;this.returnState&&(Array.isArray(o)&&(i=o.slice(1).concat(s.slice(1))),o=o[0],s=s[0]),this.returnSequences&&(s=il(s,1));let a;return this.mergeMode==="concat"?a=Mw([o,s]):this.mergeMode==="sum"?a=Re(o,s):this.mergeMode==="ave"?a=q(.5,Re(o,s)):this.mergeMode==="mul"?a=q(o,s):this.mergeMode==null&&(a=[o,s]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){ja(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),ja(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const s=this.forwardLayer.states.map(i=>null);return Array.isArray(r)?r.concat(s).concat(s):[r].concat(s).concat(s)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=Ds(n.layer);if(delete n.layer,n.numConstants!=null)throw new gt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const o=n;return o.layer=r,new e(o)}}_D.className="Bidirectional";Te(_D);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class AD extends It{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ie(()=>(e=at(e),e.dtype!=="float32"&&(e=_s(e,"float32")),Re(q(e,this.scale),this.offset)))}}AD.className="Rescaling";Te(AD);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:hte,cropAndResize:fte}=Pa;class DD extends It{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,o,s,i,a,l){return ie(()=>{let c,u=!1;const d=n/i,h=r/a,f=(o+n)/i,p=(s+r)/a,m=[d,h,f,p],g=[];e.rank===3?(u=!0,c=Vi([e])):c=e;for(let C=0;C<c.shape[0];C++)g.push(m);const b=oc(g,[g.length,4]),v=bd(0,g.length,1,"int32"),y=fte(c,b,v,[o,s],"nearest");return _s(u?at(al(y)):y,l)})}upsize(e,n,r,o){return ie(()=>{const s=hte(e,[n,r]);return _s(s,o)})}call(e,n){return ie(()=>{const r=at(e),o=r.dtype,s=r.shape,i=s[s.length-3],a=s[s.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(r,l,c,this.height,this.width,i,a,o):this.upsize(e,this.height,this.width,o)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ot(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}DD.className="CenterCrop";Te(DD);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pte(t,e,n,r){let o=at(t);if(o.dtype!=="int32"&&(o=_s(o,"int32")),e==="int")return o;const s=o.shape;if(o.rank===0&&(o=Gr(o,-1)),e==="oneHot"&&o.shape[o.shape.length-1]!==1&&(o=Gr(o,-1)),o.rank>2)throw new X(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${s} which would result in output rank ${o.rank}.`);const i=["multiHot","oneHot"].includes(e),a=o;let l;if(typeof r<"u"&&e==="count"?l=OI(a,r,n,i):l=OI(a,[],n,i),e!=="tfIdf")return l;if(r)return q(l,r);throw new X("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FD extends It{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ot(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return ie(()=>{e=at(e),e.dtype!=="int32"&&(e=_s(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new X(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=at(n.countWeights)}const o=Qo(e),s=Gp(e),i=vo(this.numTokens,o).bufferSync().get(0),a=wl(s,0).bufferSync().get(0);if(!(i&&a))throw new X(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return pte(e,this.outputMode,this.numTokens,r)})}}FD.className="CategoryEncoding";Te(FD);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mte=["bilinear","nearest"],fk=new Set(mte);class OD extends It{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(fk.has(e.interpolation))this.interpolation=e.interpolation;else throw new X(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){e=Ot(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ie(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Pa.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Pa.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...fk]} are supported`)})}}OD.className="Resizing";Te(OD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sv(t){return new tC(t)}function pk(t){return new fb(t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gte=ue();gte.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var mk;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(mk||(mk={}));var gk;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(gk||(gk={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var bk;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(bk||(bk={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ke(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bte=ZN;class mb extends ky{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new uR(this,bs())}nextDataId(){return mb.nextDataId++}write(e,n,r){this.firstUse&&(this.firstUse=!1,ue().get("IS_NODE")&&ao(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const o={id:this.nextDataId()};return this.data.set(o,{values:e,dtype:r,refCount:1}),o}makeTensorInfo(e,n,r){let o;if(n==="string"&&r!=null&&r.length>0&&Md(r[0])){const s=r.map(i=>Di(i));o=this.write(s,e,n)}else o=this.write(r,e,n);return{dataId:o,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,o,s){this.data.set(e,{values:n,dtype:o,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const o=this.readSync(r.real.dataId),s=this.readSync(r.imag.dataId);return ni(o,s)}return this.data.get(e).values}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(o=>Wi(o));return wt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return wt(e.shape,e.dtype,n)}makeOutput(e,n,r){return bs().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=_r();return e(),{kernelMs:_r()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ke([e],"where");const n=this.readSync(e.dataId);return bte(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}mb.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PD(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const vte=t=>{const{x:e}=t.inputs,n=t.backend;Ke(e,"abs");let r=new Float32Array(me(e.shape));const o=n.data.get(e.dataId).values;return r=PD(o),n.makeOutput(r,e.shape,e.dtype)},xte={kernelName:Um,backendName:"cpu",kernelFunc:vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function On(t){return(e,n,r,o,s)=>{const i=bt(e,n),a=i.length,l=tt(i),c=me(i),u=sr(s,c),d=e.length,h=n.length,f=tt(e),p=tt(n),m=wc(e,i),g=wc(n,i);if(m.length+g.length===0)for(let b=0;b<u.length;++b)u[b]=t(r[b%r.length],o[b%o.length]);else for(let b=0;b<u.length;++b){const v=Kc(b,a,l),w=v.slice(-d);m.forEach($=>w[$]=0);const y=Es(w,d,f),C=v.slice(-h);g.forEach($=>C[$]=0);const S=Es(C,h,p);u[b]=t(r[y],o[S])}return[u,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jr(t){const{inputs:e,backend:n}=t,{real:r,imag:o}=e,s=n.data.get(r.dataId).values,i=n.data.get(o.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",s),imag:n.makeTensorInfo(o.shape,"float32",i)},a}const yte={kernelName:Py,backendName:"cpu",kernelFunc:jr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rm(t,e,n="float32"){if(n==="complex64"){const o=rm(t,e,"float32"),s=rm(t,e,"float32");return jr({inputs:{real:o,imag:s},backend:t})}const r=gr(me(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ls(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const wte={kernelName:sh,backendName:"cpu",kernelFunc:Ls};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ul(t){const{inputs:e,backend:n}=t,{input:r}=e,o=n.data.get(r.dataId).complexTensorInfos.real,s=n.data.get(o.dataId).values;return n.makeTensorInfo(o.shape,o.dtype,s)}const Cte={kernelName:s1,backendName:"cpu",kernelFunc:ul};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MD(t,e,n,r){if(r==="int32"){const o=Int32Array.from(t);return[e,"int32",o]}if(r==="bool"){const o=yl([0],n),[s,i]=On((a,l)=>a!==l?1:0)(e,[],t,o,"bool");return[i,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Ki(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{dtype:s}=r;if(s==="complex64"){if(o.dtype==="complex64")return Ls({inputs:{x:o},backend:n});const u=rm(n,o.shape,o.dtype),d=Ki({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),h=jr({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(o.dtype==="complex64"){const u=ul({inputs:{input:o},backend:n}),d=Ki({inputs:{x:u},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(u),d}if(!fR(o.dtype,s)){const u=Ls({inputs:{x:o},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:s}}const i=n.data.get(o.dataId).values,[a,l,c]=MD(i,o.shape,o.dtype,s);return n.makeTensorInfo(a,l,c)}const $te={kernelName:jd,backendName:"cpu",kernelFunc:Ki};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tr(t,e,n,r){return n==null?({inputs:o,backend:s})=>{const{a:i,b:a}=o,l=s;Ke([i,a],t);const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,d=i.dtype==="string"?ll(c):c,h=i.dtype==="string"?ll(u):u,f=r||i.dtype,[p,m]=e(i.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:o,backend:s})=>{const{a:i,b:a}=o,l=s;if(i.dtype==="complex64"||a.dtype==="complex64"){const c=Ki({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=Ki({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),b=g.complexTensorInfos.real,v=g.complexTensorInfos.imag,w=l.data.get(b.dataId).values,y=l.data.get(v.dataId).values,[C,S,$]=n(i.shape,a.shape,f,p,w,y),I=l.makeTensorInfo($,"float32",C),R=l.makeTensorInfo($,"float32",S),T=jr({inputs:{real:I,imag:R},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(I),l.disposeIntermediateTensorInfo(R),T}else{const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,d=r||i.dtype,[h,f]=e(i.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function nC(t){return(e,n,r,o,s,i)=>{const a=bt(e,n),l=me(a),c=a.length,u=tt(a),d=sr("float32",l),h=sr("float32",l),f=wc(e,a),p=wc(n,a),m=ni(r,o),g=ni(s,i),b=e.length,v=tt(e),w=n.length,y=tt(n);if(f.length+p.length===0)for(let C=0;C<d.length;C++){const S=C%m.length,$=C%g.length,I=t(m[S*2],m[S*2+1],g[$*2],g[$*2+1]);d[C]=I.real,h[C]=I.imag}else for(let C=0;C<d.length;C++){const S=Kc(C,c,u),$=S.slice(-b);f.forEach(_=>$[_]=0);const I=Es($,b,v),R=S.slice(-w);p.forEach(_=>R[_]=0);const T=Es(R,w,y),N=t(m[I*2],m[I*2+1],g[T*2],g[T*2+1]);d[C]=N.real,h[C]=N.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LD=On((t,e)=>t+e),Ste=nC((t,e,n,r)=>({real:t+n,imag:e+r})),Ic=tr(qc,LD,Ste),Ite={kernelName:qc,backendName:"cpu",kernelFunc:Ic};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rC(t,e,n,r,o){const s=me(r),i=gr(o,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=o||(s>0?i[l]+=e[a]:i[l]+=1)}return i}function BD(t,e,n,r=!1){const o=t.shape[0],s=t.shape[1],i=wt([o,n],e.dtype);for(let a=0;a<o;a++)for(let l=0;l<s;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?i.set(1,a,c):e.size>0?i.set(i.get(a,c)+e.get(a,l),a,c):i.set(i.get(a,c)+1,a,c))}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ia(t){return(e,n,r)=>{const o=sr(n,e.length);for(let s=0;s<e.length;++s)o[s]=t(e[s],r);return o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zt(t,e,n){return({inputs:r,attrs:o,backend:s})=>{const{x:i}=r;if(Ke(i,t),i.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const a=s,l=a.data.get(i.dataId).values,c=me(i.shape),u=n||i.dtype,d=Dn(u,c);for(let h=0;h<c;++h)d[h]=e(l[h],o);return a.makeTensorInfo(i.shape,u,d)}}function eu(t,e,n){return({inputs:r,attrs:o,backend:s})=>{const{x:i}=r;if(Ke(i,t),i.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const a=s,l=a.data.get(i.dataId).values,c=n||i.dtype,u=e(l,c,o);return a.makeTensorInfo(i.shape,c,u)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zD=ia(t=>Math.ceil(t)),kte=eu(Kd,zD),Tte={kernelName:Kd,backendName:"cpu",kernelFunc:kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WD(t,e,n,r){const o=Dn(n,me(e));if(r&&n!=="string"){let s=0;t.forEach(i=>{const a=me(i.shape);o.set(i.vals,s),s+=a})}else{let s=0;t.forEach(i=>{const a=n==="string"?ll(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const u=c*e[1]+s;for(let d=0;d<i.shape[1];++d)o[u+d]=a[l++]}s+=i.shape[1]})}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VD=On((t,e)=>t===e?1:0),UD=tr(og,VD,null,"bool"),Ete={kernelName:og,backendName:"cpu",kernelFunc:UD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HD=ia(t=>Math.exp(t)),GD=eu(eh,HD,"float32"),Rte={kernelName:eh,backendName:"cpu",kernelFunc:GD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jD=ia(t=>Math.expm1(t)),Nte=eu(th,jD),_te={kernelName:th,backendName:"cpu",kernelFunc:Nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KD=ia(t=>Math.floor(t)),Ate=eu(nh,KD),Dte={kernelName:nh,backendName:"cpu",kernelFunc:Ate};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qD(t,e,n,r,o,s,i,a,l){const c=wt([r,s],n);for(let u=0;u<r;u++){const d=[];let h=0;for(let f=0;f<o;f++){const p=t[u*o+f];h+=p*i[f],d.push(p)}if(h<0||h>=l/s)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<s;f++)c.values[u*s+f]=e.get(...e.indexToLoc(h*s+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XD(t,e,n){const r=wt(n,t.dtype);for(let o=0;o<r.size;++o){const i=r.indexToLoc(o).slice(),a=i[0],l=i[2],c=e.locToIndex([a,l]);i[2]=e.values[c];const u=t.locToIndex(i);0<=u&&u<t.values.length&&(r.values[o]=t.values[u])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YD=On((t,e)=>t>e?1:0),Fte=tr(lg,YD,null,"bool"),Ote={kernelName:lg,backendName:"cpu",kernelFunc:Fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZD=On((t,e)=>t>=e?1:0),Pte=tr(oh,ZD,null,"bool"),Mte={kernelName:oh,backendName:"cpu",kernelFunc:Pte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JD=On((t,e)=>t<e?1:0),Lte=tr(ug,JD,null,"bool"),Bte={kernelName:ug,backendName:"cpu",kernelFunc:Lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QD=On((t,e)=>t<=e?1:0),zte=tr(dg,QD,null,"bool"),Wte={kernelName:dg,backendName:"cpu",kernelFunc:zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eF(t,e,n){const r=(e-t)/(n-1),o=gr(n,"float32");o[0]=t;for(let s=1;s<o.length;s++)o[s]=o[s-1]+r;return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tF=ia(t=>Math.log(t)),Vte=eu(ch,tF),Ute={kernelName:ch,backendName:"cpu",kernelFunc:Vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nF(t,e,n,r){const o=sr(r,me(n));for(let s=0;s<o.length;++s){const i=s*e;let a=t[i];for(let l=0;l<e;++l){const c=t[i+l];(Number.isNaN(c)||c>a)&&(a=c)}o[s]=a}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rF=On((t,e)=>Math.max(t,e)),Hte=tr(dh,rF),Gte={kernelName:dh,backendName:"cpu",kernelFunc:Hte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oF=On((t,e)=>Math.min(t,e)),jte=tr(hh,oF),Kte={kernelName:hh,backendName:"cpu",kernelFunc:jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oC=On((t,e)=>t*e),qte=nC((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),gb=tr(ph,oC,qte),Xte={kernelName:ph,backendName:"cpu",kernelFunc:gb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sF(t,e,n){const r=Ji(-1,n);return oC([],e,r,t,n)}function Yte(t){const{inputs:e,backend:n}=t,{x:r}=e;Ke(r,"neg");const o=n.data.get(r.dataId).values,[s,i]=sF(o,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,s)}const Zte={kernelName:Cg,backendName:"cpu",kernelFunc:Yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iF=On((t,e)=>t!==e?1:0),Jte=tr($g,iF,null,"bool"),Qte={kernelName:$g,backendName:"cpu",kernelFunc:Jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sC(t,e,n,r,o){const s=e.length,i=me(e),a=tt(e),l=tt(o),c=sr(n,me(o));for(let u=0;u<i;++u){const d=Kc(u,s,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[r[p]];const f=Es(h,s,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Or(t){const{inputs:e,attrs:n,backend:r}=t,{x:o}=e,{perm:s}=n;Ke(o,"transpose");const i=o.shape.length,a=new Array(i);for(let d=0;d<a.length;d++)a[d]=o.shape[s[d]];const l=r.data.get(o.dataId).values,c=sC(l,o.shape,o.dtype,s,a);return{dataId:r.write(c,a,o.dtype),shape:a,dtype:o.dtype}}const ene={kernelName:rc,backendName:"cpu",kernelFunc:Or};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aF(t,e,n,r){const[o,s]=er(t,r),i=Jr(e,"int32"),a=gr(me(o),i),l=me(s);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:o,outDtype:i}}function tne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r;Ke(o,"prod");const a=o.shape.length,l=Ct(s,o.shape),c=wn(l,a);let u=l,d=o;const h=[];c!=null&&(d=Or({inputs:{x:o},backend:n,attrs:{perm:c}}),h.push(d),u=En(u.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:g}=aF(d.shape,d.dtype,f,u);let b=m;return i&&(b=Tn(m,l)),h.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(b,g,p)}const nne={kernelName:Rg,backendName:"cpu",kernelFunc:tne};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(t,e,n){t.forEach((r,o)=>{if(r<0||r>=n){const s=Kc(o,e.length,tt(e)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${n})`)}})}function one(t,e){for(let n=0;n<t.length;++n){const r=t[n],o=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>o)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function sne(t,e,n,r){const o=[];let s=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);one(n,r);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const m=a[p],g=m[m.length-1]-f[u];for(let b=u;b<d;++b)a[p].push(f[b+1]+g)}u=f[u],d=f[d]}d!==u&&(o.push([u,d]),s+=d-u)}return{outSplits:a,valueSlices:o,numValues:s}}function ine(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,o=Dn("int32",r);e.push(o),t[n].forEach((s,i)=>o[i]=s)}return e}function vk(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function ane(t,e,n,r,o,s){const i=vk(e,2)[1],a=vk(s,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<r;++d)o[l*a+d]=t[u*i+d];++l}}function lne(t,e,n,r,o){const s=e.slice();s[0]=o;const i=Dn(n,me(s)),a=t.length,l=a===0?0:a/e[0];return ane(t,e,r,l,i,s),[i,s]}function lF(t,e,n,r,o,s,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(rne(s,i,l),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:u,valueSlices:d,numValues:h}=sne(s,i,t,c),f=ine(u),p=lne(n,r,o,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xk=2147483647;function cF(t,e,n,r,o,s,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(o.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=o.length===0,c=i.length===0,u=[];a||u.push(e[0]),l||u.push(o[0]),c||u.push(i[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=Dn("int32",d+1);h[0]=0;for(let g=0;g<d;++g){const b=a?t[0]:t[g],v=l?r[0]:r[g],w=c?s[0]:s[g];if(w===0)throw new Error("Requires delta != 0");let y;if(w>0&&v<b||w<0&&v>b)y=0;else if(y=Math.ceil(Math.abs((v-b)/w)),y>xk)throw new Error(`Requires ((limit - start) / delta) <= ${xk}`);h[g+1]=h[g]+y}const f=h[d],p=Dn(n,f);let m=0;for(let g=0;g<d;++g){const b=h[g+1]-h[g];let v=a?t[0]:t[g];const w=c?s[0]:s[g];for(let y=0;y<b;++y)p[m++]=v,v+=w}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var So=Ko;class om{constructor(e,n,r,o,s,i,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=o,this.valuesDType=s,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=n_(u),this.raggedRank=r_(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===So.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===So.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case So.VALUE_ROWIDS:return om.getMaxWidthValueRowID(n);case So.ROW_SPLITS:return om.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${So[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let o=0;o<n-1;++o){const s=e[o+1]-e[o];s>r&&(r=s)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,o=e[0],s=0;for(let i=1;i<n;++i){const a=e[i];a!==o&&(o=a,s=Math.max(i-r,s),r=i)}return Math.max(n-r,s)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return wk(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;o_(r,n);const o=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=t_(this.raggedRank,o,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,r){const o=Math.min(e,r),s=[];let i=0;for(let a=0;a<o;++a,i+=n)s.push(i);for(let a=o;a<e;++a)s.push(-1);return D(s.length===e,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(e,n,r,o){const s=e.length,i=[];for(let a=0;a<s-1;++a){const l=e[a+1]-e[a];let c=Math.min(o,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)i.push(u),u+=r;for(let d=0;d<l-c;++d)i.push(-1)}if(s>0&&i.length!==e[s-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,r,o){const s=e.length,i=[];if(s===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];i.push(c);for(let u=1;u<s;++u){const d=e[u];if(d===l)c>=0&&(++a,a<o?c+=r:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}i.push(c)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,r,o){const s=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case So.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,n,r,o);case So.ROW_SPLITS:if(s.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(s,n,r,o);default:throw new Error(`Unsupported partition type: ${So[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case So.FIRST_DIM_SIZE:return e[0];case So.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case So.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${So[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),o=new Array(this.raggedRank+1);o[o.length-1]=1;for(let l=o.length-2;l>=0;--l)o[l]=o[l+1]*r[l+1];const s=wk(r,!1),i=Dn(this.valuesDType,me(s));if(o[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,o[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,o[c],r[c]);this.setOutput(this.raggedRank,l,i,s)}return[s,i]}setOutput(e,n,r,o){if(r.length===0)return;const s=this.values,i=r;let a=o.slice();a=a.slice(e+1);const l=me(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;ie(()=>{const m=ee(u,p);u=ju(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(h<f){const g=s.subarray(d*l),b=i.subarray(h*l),v=(f-h)*l;yk(b,g,v)}if(p>=c){const g=r.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const g=i.slice(f*l);yk(g,u,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function yk(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function wk(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function uF(t,e,n,r,o,s,i,a,l,c){return new om(t,e,n,r,o,s,i,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dF(t,e,n,r){const o=t===e,s=t<e&&n<0,i=e<t&&n>1;if(o||s||i)return gr(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=gr(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hF=ia(t=>1/Math.sqrt(t)),cne=eu(yh,hF),une={kernelName:yh,backendName:"cpu",kernelFunc:cne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yl(t,e,n,r,o,s,i,a,l,c){const u=[r/o,o],d=t.values,h=e.values;if(r===0)return wt(n,e.dtype);const f=wt(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<s;p++){const m=[];let g=0;for(let b=0;b<i;b++){const v=d[p*i+b];m.push(v),g+=v*a[b]}if(g<0||g>=r/o)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let b=0;b<o;b++)c?f.values[g*o+b]+=h[p*o+b]:f.values[g*o+b]=e.rank===0?h[0]:h[p*o+b]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dne=ia(t=>1/(1+Math.exp(-t))),fF=zt(Ih,t=>1/(1+Math.exp(-t))),hne={kernelName:Ih,backendName:"cpu",kernelFunc:fF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pF(t,e,n,r,o){const s=R1(r,e,n),i=me(n),a=tt(r);if(s){const d=N1(e,a);return o==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=o==="string"?ll(t):t,c=wt(r,o,l),u=wt(n,o);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,m)=>p+e[m]);u.set(c.get(...f),...h)}return o==="string"?S_(u.values):u.values}function dl(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{begin:s,size:i}=r;Ke(o,"slice");const[a,l]=Kg(o,s,i);T1(o,a,l);const c=n.data.get(o.dataId).values,u=pF(c,a,l,o.shape,o.dtype);return n.makeTensorInfo(l,o.dtype,u)}const fne={kernelName:Og,backendName:"cpu",kernelFunc:dl};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mF(t,e,n,r,o,s,i){const a=e[0],l=s[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(d_(a));const g=Dn(n,0),b=Dn(o,0);return[g,[0,d],b,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let g=0;g<a;++g){const b=t[g*d];if(b<0)throw new Error(h_(g,b));if(b>=l)throw new Error(f_(g,b,l));++p[b],h=h&&b>=f,f=b}let m=!0;for(let g=0;g<l;++g){const b=p[g]===0;c[g]=b,m=m&&!b,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&h){const g=t,b=r;for(let v=0;v<a;++v)u[v]=v;return[g,[a,d],b,c,u]}else{const g=p[l-1],b=Dn(n,g*d),v=Dn(o,g),w=new Array(l).fill(0);for(let y=0;y<a;++y){const C=t[y*d],S=w[C],$=(C===0?0:p[C-1])+S;w[C]++;for(let I=0;I<d;++I)b[$*d+I]=t[y*d+I];v[$]=r[y],u[y]=$}for(let y=0;y<l;++y)if(w[y]===0){const S=y===0?0:p[y-1];b[S*d+0]=y;for(let $=1;$<d;++$)b[S*d+$]=0;v[S]=i}return[b,[g,d],v,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gF(t,e,n,r,o){const s=me(r),i=e[0],a=o.length,l=[];let c=1,u=-1;for(let g=0;g<a;++g){const b=o[g];if(b===-1){if(u!==-1)throw new Error(p_(u,g));u=g,l.push(1)}else{if(b<0)throw new Error(m_(g,b));c*=b,l.push(b)}}if(u!==-1){if(c<=0)throw new Error(g_());const g=Math.trunc(s/c);if(c*g!==s)throw new Error(b_(r,l));l[u]=g}if(me(l)!==s)throw new Error(v_(r,l));const h=r.length,f=[];if(h>0){f[h-1]=1;for(let g=h-2;g>=0;--g)f[g]=f[g+1]*r[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=Dn(n,i*a);for(let g=0;g<i;++g){let b=0;for(let v=0;v<h;++v)b+=t[g*h+v]*f[v];for(let v=0;v<a;++v)m[g*a+v]=Math.trunc(b/p[v]),b%=p[v]}return[m,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iC(t,e,n,r,o,s=!1,i=0){const a=r.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?o[a-1]+1:0;if(d<0)throw new Error(Gx());const h=e.slice();h[0]=d;const f=h.reduce((w,y)=>w*y,1),p=Dn(n,f);if(a===0)return d>0&&p.fill(i),[p,h];if(d<=0)throw new Error(Gx());let m=0,g=1,b=0,v=o[m];for(;;){let w=0;if(g<a){if(w=o[g],v===w){++g;continue}if(v>=w)throw new Error(x_())}if(v<0||v>=d)throw new Error(y_(v,d));v>b&&p.fill(i,b*c,v*c);for(let y=m;y<g;++y){const C=r[y];if(C<0||C>=l[0])throw new Error(w_(y,r[y],l[0]));for(let S=0;S<c;S++)p[v*c+S]+=t[C*c+S]}if(s)for(let y=0;y<c;y++)p[v*c+y]/=g-m;if(m=g,++g,b=v+1,v=w,g>a)break}return b<d&&p.fill(i,b*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pne=ia(t=>Math.sqrt(t)),mne=zt(Th,t=>Math.sqrt(t)),gne={kernelName:Th,backendName:"cpu",kernelFunc:mne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bF=On((t,e)=>{const n=t-e;return n*n}),bne=tr(Eh,bF),vne={kernelName:Eh,backendName:"cpu",kernelFunc:bne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vF(t,e,n,r){const o=wt(t,e.dtype);for(let s=0;s<o.size;s++){const i=o.indexToLoc(s),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+r[l];o.set(e.get(...a),...i)}return o}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xne{constructor(e,n,r,o,s,i){this.separator=Di(e),this.nGramWidths=n,this.leftPad=Di(r),this.rightPad=Di(o),this.padWidth=s,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,o,s,i){for(let a=0;a<s;++a){const l=this.getPadWidth(i),c=Math.max(0,l-a),u=Math.max(0,l-(s-(a+1))),d=i-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let v=0;v<d;++v)f+=e[h+v].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,r[o+a]=new Uint8Array(f);const m=r[o+a];let g=0;const b=v=>v.forEach(w=>m[g++]=w);for(let v=0;v<c;++v)b(this.leftPad),b(this.separator);for(let v=0;v<d-1;++v)b(e[h+v]),b(this.separator);if(d>0){b(e[h+d-1]);for(let v=0;v<u;++v)b(this.separator),b(this.rightPad)}else{for(let v=0;v<u-1;++v)b(this.rightPad),b(this.separator);b(this.rightPad)}}}compute(e,n){const r=e.length,o=n.length;if(o>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<o;++c){let u=n[c]>=l;if(u=u&&n[c]<=r,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${r}]`);l=n[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const s=o-1,i=Dn("int32",o);if(r===0||o===0){const l=new Array(r);for(let c=0;c<=s;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=s;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),i[l]=i[l-1]+u}const a=new Array(i[s]);for(let l=0;l<s;++l){const c=n[l];let u=i[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth,f=1;this.createNGrams(e,c,a,u,f,h)}}return[a,i]}}function xF(t,e,n,r,o,s,i,a){return new xne(n,r,o,s,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yne(t,e,n,r){if(!t.length)return;if(e.length===0){for(let s=0;s<t.length;++s)r.push(t.subarray(s,s+1));return}if(e.length===1){const s=e[0];let i=t.indexOf(s);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&r.push(a),t=t.subarray(i+1),i=t.indexOf(s)}(!n||t.length!==0)&&r.push(t);return}let o=0;for(let s=0;s<t.length+1;s++)if(s===t.length||e.indexOf(t[s])!==-1){const i=t.subarray(o,s);(!n||i.length!==0)&&r.push(i),o=s+1}}function yF(t,e,n){const r=t.length,o=[];let s=0,i=0;const a=new Array(r);for(let h=0;h<r;++h){const f=o.length;yne(t[h],e,n,o);const p=o.length-f;a[h]=p,s+=p,i=Math.max(i,p)}const l=Dn("int32",s*2),c=new Array(s),u=[r,i];let d=0;for(let h=0;h<r;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=o[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wF(t,e){const n=Dn("int32",t.length);for(let r=0;r<t.length;++r)n[r]=M8(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CF=On((t,e)=>t-e),wne=nC((t,e,n,r)=>({real:t-n,imag:e-r})),aC=tr(Rh,CF,wne),Cne={kernelName:Rh,backendName:"cpu",kernelFunc:aC};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $F(t,e){const n=new Array(t.rank);for(let o=0;o<n.length;o++)n[o]=t.shape[o]*e[o];const r=wt(n,t.dtype);for(let o=0;o<r.values.length;++o){const s=r.indexToLoc(o),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=s[l]%t.shape[l];const a=t.locToIndex(i);r.values[o]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _u=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function SF(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),f=Math.min(r,Math.floor(e+(a-l)*u/a+d));SF(t,e,h,f)}const o=t[e];let s=n,i=r;for(Gl(t,n,e),_u(t[r],o)>0&&Gl(t,n,r);s<i;){for(Gl(t,s,i),s++,i--;_u(t[s],o)<0;)s=s+1;for(;_u(t[i],o)>0;)i=i-1}_u(t[n],o)===0?Gl(t,n,i):(i=i+1,Gl(t,i,r)),i<=e&&(n=i+1),e<=i&&(r=i-1)}}function IF(t,e,n,r,o){const s=e[e.length-1],[i,a]=[t.length/s,s],l=sr(n,i*r),c=sr("int32",i*r);for(let d=0;d<i;d++){const h=d*a,f=t.subarray(h,h+a);let p=new Array(f.length);f.forEach((v,w)=>p[w]={value:v,index:w}),r<p.length&&(SF(p,r),p=p.slice(0,r)),o&&p.sort(_u);const m=d*r,g=l.subarray(m,m+r),b=c.subarray(m,m+r);for(let v=0;v<r;v++)g[v]=p[v].value,b[v]=p[v].index}const u=e.slice();return u[u.length-1]=r,[wt(u,n,l),wt(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kF(t,e,n,r){const o=Ct(e,n)[0],s=[1,n[0],1];for(let p=0;p<o;p++)s[0]*=n[p];s[1]=n[o];for(let p=o+1;p<n.length;p++)s[2]*=n[p];const i={},a=new Int32Array(n[o]),l=new pr(s,r,t),c=[],u=s[0]===1&&s[2]===1;for(let p=0;p<n[o];p++){let m;if(u)m=t[p].toString();else{const g=[];for(let b=0;b<s[0];b++)for(let v=0;v<s[2];v++)g.push(l.get(b,p,v));m=g.join(",")}if(i[m]!==void 0)a[p]=i[m];else{const g=Object.keys(i).length;i[m]=g,a[p]=g,c.push(p)}}const d=s.slice();d[1]=Object.keys(i).length;const h=new pr(d,r);c.forEach((p,m)=>{for(let g=0;g<s[0];g++)for(let b=0;b<s[2];b++)h.set(l.get(g,p,b),g,m,b)});const f=n.slice();return f[o]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ne=Object.freeze(Object.defineProperty({__proto__:null,simpleAbsImpl:PD,addImpl:LD,bincountImpl:rC,bincountReduceImpl:BD,castImpl:MD,ceilImpl:zD,concatImpl:WD,equalImpl:VD,expImpl:HD,expm1Impl:jD,floorImpl:KD,gatherNdImpl:qD,gatherV2Impl:XD,greaterImpl:YD,greaterEqualImpl:ZD,lessImpl:JD,lessEqualImpl:QD,linSpaceImpl:eF,logImpl:tF,maxImpl:nF,maximumImpl:rF,minimumImpl:oF,multiplyImpl:oC,negImpl:sF,notEqualImpl:iF,prodImpl:aF,raggedGatherImpl:lF,raggedRangeImpl:cF,raggedTensorToTensorImpl:uF,rangeImpl:dF,rsqrtImpl:hF,scatterImpl:Yl,sigmoidImpl:dne,sliceImpl:pF,sparseFillEmptyRowsImpl:mF,sparseReshapeImpl:gF,sparseSegmentReductionImpl:iC,sqrtImpl:pne,squaredDifferenceImpl:bF,stridedSliceImpl:vF,stringNGramsImpl:xF,stringSplitImpl:yF,stringToHashBucketFastImpl:wF,subImpl:CF,tileImpl:$F,topKImpl:IF,transposeImpl:sC,uniqueImpl:kF},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */iN("cpu",()=>new mb,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TF=zt(Jd,t=>t>=0?t:Math.exp(t)-1),Sne={kernelName:Jd,backendName:"cpu",kernelFunc:TF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EF(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{alpha:s}=r;Ke([o],"leakyRelu");const i=me(o.shape),a=n.data.get(o.dataId).values,l=sr("float32",i);for(let c=0;c<a.length;c++)l[c]=a[c]<0?s*a[c]:a[c];return n.makeTensorInfo(o.shape,"float32",l)}const Ine={kernelName:cg,backendName:"cpu",kernelFunc:EF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kne=On((t,e)=>t<0?e*t:t);function RF(t){const{inputs:e,backend:n}=t,{x:r,alpha:o}=e;Ke([r,o],"prelu");const s=n.data.get(r.dataId).values,i=n.data.get(o.dataId).values,[a,l]=kne(r.shape,o.shape,s,i,"float32");return n.makeTensorInfo(l,"float32",a)}const Tne={kernelName:Eg,backendName:"cpu",kernelFunc:RF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NF=zt(bh,t=>Math.max(0,t)),Ene={kernelName:bh,backendName:"cpu",kernelFunc:NF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _F=zt(vh,t=>Math.min(Math.max(0,t),6)),Rne={kernelName:vh,backendName:"cpu",kernelFunc:_F};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sm(t,e,n,r,o){if(n==="linear")return Ls({inputs:{x:e},backend:t});if(n==="relu")return NF({inputs:{x:e},backend:t});if(n==="elu")return TF({inputs:{x:e},backend:t});if(n==="relu6")return _F({inputs:{x:e},backend:t});if(n==="prelu")return RF({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return EF({inputs:{x:e},backend:t,attrs:{alpha:o}});if(n==="sigmoid")return fF({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jt(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{shape:s}=r,i=me(o.shape),a=hR(s,i),l=me(a);D(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${o.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(o.dataId);const c=n.data.get(o.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:o.dataId,shape:a,dtype:o.dtype}}const Nne={kernelName:Ng,backendName:"cpu",kernelFunc:Jt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AF(t){const{inputs:e,backend:n,attrs:r}=t,{a:o,b:s}=e,{transposeA:i,transposeB:a}=r;Ke([o,s],"matMul");const l=o.shape.length,c=s.shape.length,u=i?o.shape[l-2]:o.shape[l-1],d=a?s.shape[c-1]:s.shape[c-2],h=i?o.shape[l-1]:o.shape[l-2],f=a?s.shape[c-2]:s.shape[c-1],p=o.shape.slice(0,-2),m=s.shape.slice(0,-2),g=me(p),b=me(m),w=bt(o.shape.slice(0,-2),s.shape.slice(0,-2)).concat([h,f]);D(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${o.shape} and ${s.shape} and transposeA=${i} and transposeB=${a} must match.`);const y=i?[g,u,h]:[g,h,u],C=a?[b,f,d]:[b,d,f],S=Jt({inputs:{x:o},backend:n,attrs:{shape:y}}),$=Jt({inputs:{x:s},backend:n,attrs:{shape:C}}),I=i?S.shape[1]:S.shape[2],R=i?S.shape[2]:S.shape[1],T=a?$.shape[1]:$.shape[2],N=Math.max(g,b),_=n.data.get(S.dataId).values,P=n.data.get($.dataId).values,z=tt(S.shape),L=tt($.shape),[O,B,U]=i?[z[0],1,z[1]]:[z[0],z[1],1],[Q,se,ce]=a?[1,L[1],L[0]]:[L[1],1,L[0]],de=R*T,we=wt([N,R,T],S.dtype),Ie=we.values,j=n.blockSize;for(let re=0;re<N;re++)for(let le=0;le<R;le+=j)for(let Ce=0;Ce<T;Ce+=j)for(let ve=0;ve<I;ve+=j){const Le=Math.min(le+j,R),_e=Math.min(Ce+j,T),F=Math.min(ve+j,I);for(let V=le;V<Le;V++)for(let oe=Ce;oe<_e;oe++){let G=0;for(let Y=ve;Y<F;Y++){const ae=Math.min(re,g-1)*O,pe=Math.min(re,b-1)*ce,ye=_[ae+V*B+Y*U],ge=P[Y*Q+oe*se+pe];G+=ye*ge}Ie[re*de+(V*T+oe)]+=G}}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo($),n.makeTensorInfo(w,we.dtype,we.values)}const _ne={kernelName:qm,backendName:"cpu",kernelFunc:AF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t){const{inputs:e,backend:n,attrs:r}=t,{a:o,b:s,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;let h,f,p;const m=[];h=AF({inputs:{a:o,b:s},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(f=Ic({inputs:{a:h,b:i},backend:n}),m.push(h),h=f),u&&(p=sm(n,h,u,a,d),m.push(h),h=p);for(const b of m)n.disposeIntermediateTensorInfo(b);return h}const Dne={kernelName:Mp,backendName:"cpu",kernelFunc:Ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fne=zt(Bd,t=>Math.acos(t)),One={kernelName:Bd,backendName:"cpu",kernelFunc:Fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pne=zt(zd,t=>Math.acosh(t)),Mne={kernelName:zd,backendName:"cpu",kernelFunc:Pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t){const{inputs:e,backend:n}=t,r=e;Ke(e,"addN");const o=r.map(a=>n.data.get(a.dataId).values),s=wt(r[0].shape,r[0].dtype),i=s.values;for(let a=0;a<r.length;a++){const l=o[a];for(let c=0;c<i.length;c++)i[c]+=l[c]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}const Bne={kernelName:Ny,backendName:"cpu",kernelFunc:Lne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r;Ke(o,"all");const a=Ct(s,o.shape);let l=a;const c=wn(l,o.shape.length);let u=o;c!=null&&(u=Or({inputs:{x:o},backend:n,attrs:{perm:c}}),l=En(l.length,o.shape.length)),ar("all",l,u.shape.length);const[d,h]=er(u.shape,l),f=me(h),p=gr(me(d),u.dtype),m=n.data.get(u.dataId).values;for(let b=0;b<p.length;++b){const v=b*f;let w=m[v];for(let y=0;y<f;++y){const C=m[v+y];w=w&&C}p[b]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(i){const b=Tn(d,a),v=Jt({inputs:{x:g},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(g),v}return g}const Wne={kernelName:_y,backendName:"cpu",kernelFunc:zne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r;Ke(o,"any");const a=Ct(s,o.shape);let l=a;const c=wn(l,o.shape.length);let u=o;c!=null&&(u=Or({inputs:{x:o},backend:n,attrs:{perm:c}}),l=En(l.length,o.shape.length)),ar("any",l,u.shape.length);const[d,h]=er(u.shape,l),f=me(h),p=gr(me(d),u.dtype),m=n.data.get(u.dataId).values;for(let b=0;b<p.length;++b){const v=b*f;let w=m[v];for(let y=0;y<f;++y){const C=m[v+y];w=w||C}p[b]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(i){const b=Tn(d,a),v=Jt({inputs:{x:g},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(g),v}return g}const Une={kernelName:Ay,backendName:"cpu",kernelFunc:Vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s}=r;Ke(o,"argMax");let i=Ct(s,o.shape);const a=wn(i,o.shape.length);let l=o;const c=[];a!=null&&(l=Or({inputs:{x:o},backend:n,attrs:{perm:a}}),c.push(l),i=En(i.length,l.shape.length)),i=[i[0]],ar("argMax",i,l.shape.length);const[u,d]=er(l.shape,i),h=me(u),f=gr(h,"int32"),p=me(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const b=g*p;let v=m[b],w=0;for(let y=0;y<p;++y){const C=m[b+y];C>v&&(v=C,w=y)}f[g]=w}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const Gne={kernelName:Hm,backendName:"cpu",kernelFunc:Hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s}=r;Ke(o,"argMin");let i=Ct(s,o.shape);const a=wn(i,o.shape.length);let l=o;const c=[];a!=null&&(l=Or({inputs:{x:o},backend:n,attrs:{perm:a}}),c.push(l),i=En(i.length,l.shape.length)),i=[i[0]],ar("argMin",i,l.shape.length);const[u,d]=er(l.shape,i),h=me(u),f=gr(h,"int32"),p=me(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const b=g*p;let v=m[b],w=0;for(let y=0;y<p;++y){const C=m[b+y];C<v&&(v=C,w=y)}f[g]=w}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const Kne={kernelName:Gm,backendName:"cpu",kernelFunc:jne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qne=zt(Wd,t=>Math.asin(t)),Xne={kernelName:Wd,backendName:"cpu",kernelFunc:qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yne=zt(Vd,t=>Math.asinh(t)),Zne={kernelName:Vd,backendName:"cpu",kernelFunc:Yne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jne=zt(Ud,t=>Math.atan(t)),Qne={kernelName:Ud,backendName:"cpu",kernelFunc:Jne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ere=On((t,e)=>Math.atan2(t,e)),tre=tr(Gd,ere),nre={kernelName:Gd,backendName:"cpu",kernelFunc:tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rre=zt(Hd,t=>Math.atanh(t)),ore={kernelName:Hd,backendName:"cpu",kernelFunc:rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lC(t,e,n,r,o,s){const i=o.strideHeight,a=o.strideWidth,l=o.dilationHeight,c=o.dilationWidth,u=o.effectiveFilterHeight,d=o.effectiveFilterWidth,h=o.padInfo.top,f=o.padInfo.left,p=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=wt(o.outShape,n),g=m.values,b=o.outShape[1]*o.outShape[2]*o.outShape[3],v=o.outShape[2]*o.outShape[3],w=o.outShape[3];for(let y=0;y<o.batchSize;++y){const C=y*b,S=y*r[0];for(let $=0;$<o.inChannels;++$)for(let I=0;I<o.outHeight;++I){const R=I*i-h,T=Math.max(0,R),N=Math.min(o.inHeight,u+R),_=C+I*v;for(let P=0;P<o.outWidth;++P){const z=P*a-f,L=Math.max(0,z),O=Math.min(o.inWidth,d+z);let B=p,U=0,Q=0;for(let ce=T;ce<N;ce+=l){const de=S+ce*r[1];for(let we=L;we<O;we+=c){const Ie=de+we*r[2],j=t[Ie+$];s==="max"&&j>B?B=j:s==="avg"&&(U+=j,Q++)}if(isNaN(B))break}const se=_+P*w+$;g[se]=s==="avg"?U/Q:B}}}return m}function DF(t,e,n,r,o=!1,s=!1){const i=wt(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,m=wt(e,n,t);for(let g=0;g<r.batchSize;++g)for(let b=0;b<r.inChannels;++b)for(let v=0;v<r.outHeight;++v){const w=v*a-f;let y=w;for(;y<0;)y+=c;const C=Math.min(r.inHeight,d+w);for(let S=0;S<r.outWidth;++S){const $=S*l-p;let I=$;for(;I<0;)I+=u;const R=Math.min(r.inWidth,h+$);let T=Number.NEGATIVE_INFINITY,N=-1;for(let _=y;_<C;_+=c){const P=_-w;for(let z=I;z<R;z+=u){const L=z-$,O=m.get(g,_,z,b);O>T&&(T=O,o?N=s?((g*r.inHeight+_)*r.inWidth+z)*r.inChannels+b:(_*r.inWidth+z)*r.inChannels+b:N=P*h+L)}}i.set(N,g,v,S,b)}}return i}function FF(t,e,n,r,o,s){const i=o.strideDepth,a=o.strideHeight,l=o.strideWidth,c=o.dilationDepth,u=o.dilationHeight,d=o.dilationWidth,h=o.effectiveFilterDepth,f=o.effectiveFilterHeight,p=o.effectiveFilterWidth,m=o.padInfo.front,g=o.padInfo.top,b=o.padInfo.left,v=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=wt(o.outShape,n),y=w.values,C=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],S=o.outShape[2]*o.outShape[3]*o.outShape[4],$=o.outShape[3]*o.outShape[4],I=o.outShape[4];for(let R=0;R<o.batchSize;++R){const T=R*C,N=R*r[0];for(let _=0;_<o.inChannels;++_)for(let P=0;P<o.outDepth;++P){const z=P*i-m;let L=z;for(;L<0;)L+=c;const O=Math.min(o.inDepth,h+z),B=T+P*S;for(let U=0;U<o.outHeight;++U){const Q=U*a-g;let se=Q;for(;se<0;)se+=u;const ce=Math.min(o.inHeight,f+Q),de=B+U*$;for(let we=0;we<o.outWidth;++we){const Ie=we*l-b;let j=Ie;for(;j<0;)j+=d;const re=Math.min(o.inWidth,p+Ie),le=de+we*I;let Ce=v,ve=0,Le=0;for(let F=L;F<O;F+=c){const V=N+F*r[1];for(let oe=se;oe<ce;oe+=u){const G=V+oe*r[2];for(let Y=j;Y<re;Y+=d){const ae=G+Y*r[3],pe=t[ae+_];if(s==="max"&&pe>Ce?Ce=pe:s==="avg"&&(ve+=pe,Le++),isNaN(Ce))break}if(isNaN(Ce))break}if(isNaN(Ce))break}const _e=le+_;y[_e]=s==="avg"?ve/Le:Ce}}}}return w}function sre(t,e){const n=wt(e.outShape,"int32"),r=e.strideDepth,o=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let b=0;b<e.outDepth;++b){const v=b*r-h;let w=v;for(;w<0;)w+=i;const y=Math.min(e.inDepth,c+v);for(let C=0;C<e.outHeight;++C){const S=C*o-f;let $=S;for(;$<0;)$+=a;const I=Math.min(e.inHeight,u+S);for(let R=0;R<e.outWidth;++R){const T=R*s-p;let N=T;for(;N<0;)N+=l;const _=Math.min(e.inWidth,d+T);let P=Number.NEGATIVE_INFINITY,z=-1;for(let L=w;L<y;L+=i){const O=L-v;for(let B=$;B<I;B+=a){const U=B-S;for(let Q=N;Q<_;Q+=l){const se=Q-T,ce=t.get(m,L,B,Q,g);ce>=P&&(P=ce,z=O*u*d+U*u+se)}}}n.set(z,m,b,C,R,g)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;Ke(o,"avgPool");const{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;D(br(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Wo(o.shape,s,i,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Bt(u.inShape,u.outShape))d=Ls({inputs:{x:o},backend:n});else{const h=n.data.get(o.dataId).values,f=tt(o.shape),p=lC(h,o.shape,o.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,o.dtype,p.values)}return d}const are={kernelName:jm,backendName:"cpu",kernelFunc:ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r;Ke(o,"avgPool3d");const u=li(o.shape,s,i,1,a,l,c),d=n.data.get(o.dataId).values,h=FF(d,o.shape,o.dtype,tt(o.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const cre={kernelName:Km,backendName:"cpu",kernelFunc:lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:s}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=r;Ke([o,s],"avgPool3DGrad");const u=li(s.shape,i,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,g=u.filterWidth,b=u.dilationDepth,v=u.dilationHeight,w=u.dilationWidth,y=u.effectiveFilterDepth,C=u.effectiveFilterHeight,S=u.effectiveFilterWidth,$=y-1-u.padInfo.front,I=S-1-u.padInfo.left,R=C-1-u.padInfo.top,T=wt(s.shape,"float32"),N=1/(p*m*g),_=n.bufferSync(o);for(let P=0;P<u.batchSize;++P)for(let z=0;z<u.inChannels;++z)for(let L=0;L<u.inDepth;++L)for(let O=0;O<u.inHeight;++O)for(let B=0;B<u.inWidth;++B){const U=L-$,Q=O-R,se=B-I;let ce=0;for(let de=0;de<y;de+=b){const we=(U+de)/d;if(!(we<0||we>=u.outDepth||Math.floor(we)!==we))for(let Ie=0;Ie<C;Ie+=v){const j=(Q+Ie)/h;if(!(j<0||j>=u.outHeight||Math.floor(j)!==j))for(let re=0;re<S;re+=w){const le=(se+re)/f;if(le<0||le>=u.outWidth||Math.floor(le)!==le)continue;const Ce=_.get(P,we,j,le,z);ce+=Ce}}}T.set(ce*N,P,L,O,B,z)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const dre={kernelName:Fy,backendName:"cpu",kernelFunc:ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:s}=e,i=s;Ke([o,s],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=r,u=Wo(i.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,b=u.effectiveFilterHeight,v=u.effectiveFilterWidth,w=v-1-u.padInfo.left,y=b-1-u.padInfo.top,C=wt(i.shape,"float32"),S=1/(f*p),$=n.data.get(o.dataId).values,I=wt(o.shape,"float32",$);for(let R=0;R<u.batchSize;++R)for(let T=0;T<u.inChannels;++T)for(let N=0;N<u.inHeight;++N)for(let _=0;_<u.inWidth;++_){const P=N-y,z=_-w;let L=0;for(let O=0;O<b;O+=m){const B=(P+O)/d;if(!(B<0||B>=u.outHeight||Math.floor(B)!==B))for(let U=0;U<v;U+=g){const Q=(z+U)/h;if(Q<0||Q>=u.outWidth||Math.floor(Q)!==Q)continue;const se=I.get(R,B,Q,T);L+=se}}C.set(L*S,R,N,_,T)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const fre={kernelName:Dy,backendName:"cpu",kernelFunc:hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,scale:s,offset:i,mean:a,variance:l}=e;D(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ke([o,a,l,s,i],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);const u=n.data.get(o.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=s?n.data.get(s.dataId).values:new Float32Array([1]),p=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=p.length,b=f.length,v=h.length,w=d.length;let y=0,C=0,S=0,$=0;for(let I=0;I<u.length;++I)m[I]=p[y++]+(u[I]-d[C++])*f[S++]/Math.sqrt(h[$++]+c),y>=g&&(y=0),C>=w&&(C=0),S>=b&&(S=0),$>=v&&($=0);return n.makeTensorInfo(o.shape,o.dtype,m)}const mre={kernelName:ig,backendName:"cpu",kernelFunc:pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockShape:s,crops:i}=r;Ke([o],"batchToSpaceND");const a=s.reduce((b,v)=>b*v),l=zh(o.shape,s,a),c=Wh(l.length,s.length),u=Vh(o.shape,s,a),d=vw(i,s.length),h=xw(u,i,s.length),f=Jt({inputs:{x:o},backend:n,attrs:{shape:l}}),p=Or({inputs:{x:f},backend:n,attrs:{perm:c}}),m=Jt({inputs:{x:p},backend:n,attrs:{shape:u}}),g=dl({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const bre={kernelName:Xm,backendName:"cpu",kernelFunc:gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,weights:s}=e,{size:i}=r,a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values,c=rC(a,l,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,c)}const xre={kernelName:Oy,backendName:"cpu",kernelFunc:vre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yre(t){const{inputs:e,backend:n}=t,{s0:r,s1:o}=e,s=n.data.get(r.dataId).values,i=n.data.get(o.dataId).values,a=bt(Array.from(s),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const wre={kernelName:xR,backendName:"cpu",kernelFunc:yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cre=zt(qd,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),$re={kernelName:qd,backendName:"cpu",kernelFunc:Cre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sre=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(me(e.shape)),o=n.data.get(e.dataId),s=o.complexTensorInfos.real,i=o.complexTensorInfos.imag,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];r[c]=Math.hypot(u,d)}return n.makeOutput(r,e.shape,"float32")},Ire={kernelName:Ym,backendName:"cpu",kernelFunc:Sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kc(t){const{inputs:e,backend:n}=t,{input:r}=e,o=n.data.get(r.dataId).complexTensorInfos.imag,s=n.data.get(o.dataId).values;return n.makeTensorInfo(o.shape,o.dtype,s)}const kre={kernelName:Zy,backendName:"cpu",kernelFunc:kc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tc(t){const{inputs:e,backend:n,attrs:r}=t,{axis:o}=r,s=Ct(o,e[0].shape)[0],i=e.map(m=>m.shape);mw(i,s);let a=Ns(e.map(m=>m.shape),s);if(me(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>me(m.shape)>0);if(l.length===1)return Ls({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(y=>ul({inputs:{input:y},backend:n})),g=l.map(y=>kc({inputs:{input:y},backend:n})),b=Tc({inputs:m,backend:n,attrs:{axis:s}}),v=Tc({inputs:g,backend:n,attrs:{axis:s}}),w=jr({inputs:{real:b,imag:v},backend:n});return m.forEach(y=>n.disposeIntermediateTensorInfo(y)),g.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),w}const c=l.map(m=>{const b=[-1,me(m.shape.slice(s))];return Jt({inputs:{x:m},backend:n,attrs:{shape:b}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=Ns(c.map(m=>m.shape),1);const d=c[0].shape[0]===1,h=WD(u,a,e[0].dtype,d),f=Ns(l.map(m=>m.shape),s),p=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Tre={kernelName:Zm,backendName:"cpu",kernelFunc:Tc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OF(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r;Ke([o,s],"conv2d");const d=ci(l),h=ir(o.shape,s.shape,i,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,b=h.padInfo.left,v=h.padInfo.top,w=h.dataFormat==="channelsLast",y=new pr(h.outShape,o.dtype),C=tt(o.shape),S=tt(s.shape),$=C[0],I=w?C[1]:C[2],R=w?C[2]:1,T=w?1:C[1],N=y.strides[0],_=w?y.strides[1]:y.strides[2],P=w?y.strides[2]:1,z=w?1:y.strides[1],L=n.data.get(o.dataId).values,O=n.data.get(s.dataId).values,B=y.values;for(let U=0;U<h.batchSize;++U){const Q=U*$,se=U*N;for(let ce=0;ce<h.outHeight;++ce){const de=se+ce*_,we=ce*h.strideHeight-v;for(let Ie=0;Ie<f;++Ie){const j=we+Ie*m;if(j<0||j>=h.inHeight)continue;const re=Ie*S[0],le=Q+j*I;for(let Ce=0;Ce<h.outWidth;++Ce){const ve=de+Ce*P,Le=Ce*h.strideWidth-b;for(let _e=0;_e<p;++_e){const F=Le+_e*g;if(F<0||F>=h.inWidth)continue;const V=re+_e*S[1],oe=le+F*R;let G=V;for(let Y=0;Y<h.inChannels;++Y){const ae=L[oe+Y*T];for(let pe=0;pe<h.outChannels;++pe)B[ve+pe*z]+=ae*O[G+pe];G+=h.outChannels}}}}}}return n.makeTensorInfo(y.shape,y.dtype,B)}const Ere={kernelName:Jm,backendName:"cpu",kernelFunc:OF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:s}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;Ke([o,s],"conv2dBackpropFilter");const d=ci(l),h=ir(o.shape,u,i,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:g}=h,b=h.dataFormat==="channelsLast",v=new pr(h.filterShape,"float32"),w=h.padInfo.left,y=h.padInfo.top,C=n.data.get(o.dataId).values,S=n.data.get(s.dataId).values,$=new pr(o.shape,o.dtype,C),I=new pr(s.shape,s.dtype,S);for(let R=0;R<m;++R){const T=Math.max(0,Math.ceil((y-R)/f)),N=Math.min(h.outHeight,(h.inHeight+y-R)/f);for(let _=0;_<g;++_){const P=Math.max(0,Math.ceil((w-_)/p)),z=Math.min(h.outWidth,(h.inWidth+w-_)/p);for(let L=0;L<h.inChannels;++L)for(let O=0;O<h.outChannels;++O){let B=0;for(let U=0;U<h.batchSize;++U)for(let Q=T;Q<N;++Q){const se=R+Q*f-y;for(let ce=P;ce<z;++ce){const de=_+ce*p-w;b?B+=$.get(U,se,de,L)*I.get(U,Q,ce,O):B+=$.get(U,L,se,de)*I.get(U,O,Q,ce)}}v.set(B,R,_,L,O)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const Nre={kernelName:My,backendName:"cpu",kernelFunc:Rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:s}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r;Ke([o,s],"conv2dBackpropInput");const d=tt(s.shape),h=tt(o.shape);let f=ci(c);const p=ir(i,s.shape,a,1,l,u,!1,f),m=new pr(p.inShape,"float32"),g=m.values,b=n.data.get(o.dataId).values,v=n.data.get(s.dataId).values,[w,y,C]=d,{batchSize:S,filterHeight:$,filterWidth:I,inChannels:R,inHeight:T,inWidth:N,outChannels:_,outHeight:P,outWidth:z,strideHeight:L,strideWidth:O}=p;f=p.dataFormat;const B=$-1-p.padInfo.top,U=I-1-p.padInfo.left,Q=f==="channelsLast",se=m.strides[0],ce=Q?m.strides[1]:m.strides[2],de=Q?m.strides[2]:1,we=Q?1:m.strides[1],Ie=h[0],j=Q?h[1]:h[2],re=Q?h[2]:1,le=Q?1:h[1];for(let Ce=0;Ce<S;++Ce)for(let ve=0;ve<R;++ve)for(let Le=0;Le<T;++Le){const _e=Le-B,F=Math.max(0,Math.ceil(_e/L)),V=Math.min(P,($+_e)/L);for(let oe=0;oe<N;++oe){const G=oe-U,Y=Math.max(0,Math.ceil(G/O)),ae=Math.min(z,(I+G)/O);let pe=0;for(let ge=F;ge<V;++ge){const be=ge*L-_e;for(let De=Y;De<ae;++De){const Oe=De*O-G,Pe=Ie*Ce+j*ge+re*De,qe=w*($-1-be)+y*(I-1-Oe)+C*ve;for(let nt=0;nt<_;++nt){const dt=b[Pe+le*nt],ht=v[qe+nt];pe+=dt*ht}}}const ye=se*Ce+ce*Le+de*oe+we*ve;g[ye]=pe}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Are={kernelName:Qm,backendName:"cpu",kernelFunc:_re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s}=e,{strides:i,pad:a,dilations:l}=r;Ke([o,s],"conv3d");const c=Qi(o.shape,s.shape,i,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:g}=c,b=g.front,v=g.left,w=g.top,y=new pr(c.outShape,o.dtype),C=n.data.get(o.dataId).values,S=n.data.get(s.dataId).values,$=y.values,I=tt(o.shape),R=tt(s.shape);for(let T=0;T<c.batchSize;++T){const N=T*I[0],_=T*y.strides[0];for(let P=0;P<c.outDepth;++P){const z=_+P*y.strides[1],L=P*c.strideDepth-b;for(let O=0;O<u;++O){const B=L+O*f;if(B<0||B>=c.inDepth)continue;const U=O*R[0],Q=N+B*I[1];for(let se=0;se<c.outHeight;++se){const ce=z+se*y.strides[2],de=se*c.strideHeight-w;for(let we=0;we<d;++we){const Ie=de+we*p;if(Ie<0||Ie>=c.inHeight)continue;const j=U+we*R[1],re=Q+Ie*I[2];for(let le=0;le<c.outWidth;++le){const Ce=ce+le*c.outChannels,ve=le*c.strideWidth-v;for(let Le=0;Le<h;++Le){const _e=ve+Le*m;if(_e<0||_e>=c.inWidth)continue;const F=j+Le*R[2],V=re+_e*c.inChannels;let oe=F;for(let G=0;G<c.inChannels;++G){const Y=C[V+G];for(let ae=0;ae<c.outChannels;++ae)$[Ce+ae]+=Y*S[oe+ae];oe+=c.outChannels}}}}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Fre={kernelName:eg,backendName:"cpu",kernelFunc:Dre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:s}=e,{strides:i,pad:a,filterShape:l}=r;Ke([o,s],"conv3dBackpropFilterV2");const c=tt(o.shape),u=tt(s.shape),d=Qi(o.shape,l,i,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,g=d.filterHeight,b=d.filterWidth,v=new pr(d.filterShape,"float32"),w=v.values,[y,C,S,$]=v.strides,I=n.data.get(s.dataId).values,[R,T,N,_]=u,P=n.data.get(o.dataId).values,[z,L,O,B]=c,U=d.padInfo.front,Q=d.padInfo.left,se=d.padInfo.top;for(let ce=0;ce<m;++ce){const de=Math.max(0,Math.ceil((U-ce)/h)),we=Math.min(d.outDepth,(d.inDepth+U-ce)/h),Ie=ce*y;for(let j=0;j<g;++j){const re=Math.max(0,Math.ceil((se-j)/f)),le=Math.min(d.outHeight,(d.inHeight+se-j)/f),Ce=j*C+Ie;for(let ve=0;ve<b;++ve){const Le=Math.max(0,Math.ceil((Q-ve)/p)),_e=Math.min(d.outWidth,(d.inWidth+Q-ve)/p),F=ve*S+Ce;for(let V=0;V<d.inChannels;++V){const oe=V*$+F;for(let G=0;G<d.outChannels;++G){let Y=0;for(let ae=0;ae<d.batchSize;++ae){const pe=ae*z,ye=ae*R;for(let ge=de;ge<we;++ge){const De=(ce+ge*h-U)*L+pe,Oe=ge*T+ye;for(let Pe=re;Pe<le;++Pe){const nt=(j+Pe*f-se)*O+De,dt=Pe*N+Oe;for(let ht=Le;ht<_e;++ht){const ln=(ve+ht*p-Q)*B+nt,Cn=ht*_+dt;Y+=P[ln+V]*I[Cn+G]}}}}w[oe+G]=Y}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const Pre={kernelName:Ly,backendName:"cpu",kernelFunc:Ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mre(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:s}=e,{pad:i,strides:a,inputShape:l}=r;Ke([o],"conv3dBackpropInputV2");const c=tt(o.shape),u=tt(s.shape),d=Qi(l,s.shape,a,1,i),h=new pr(d.inShape,"float32"),f=h.values,[p,m,g,b]=h.strides,v=n.data.get(o.dataId).values,[w,y,C,S]=c,$=n.data.get(s.dataId).values,[I,R,T,N]=u,{batchSize:_,filterDepth:P,filterHeight:z,filterWidth:L,inChannels:O,inDepth:B,inHeight:U,inWidth:Q,outChannels:se,outDepth:ce,outHeight:de,outWidth:we,strideDepth:Ie,strideHeight:j,strideWidth:re}=d,le=P-1-d.padInfo.front,Ce=z-1-d.padInfo.top,ve=L-1-d.padInfo.left;for(let Le=0;Le<_;++Le)for(let _e=0;_e<O;++_e)for(let F=0;F<B;++F){const V=F-le,oe=Math.max(0,Math.ceil(V/Ie)),G=Math.min(ce,(P+V)/Ie);for(let Y=0;Y<U;++Y){const ae=Y-Ce,pe=Math.max(0,Math.ceil(ae/j)),ye=Math.min(de,(z+ae)/j);for(let ge=0;ge<Q;++ge){const be=ge-ve,De=Math.max(0,Math.ceil(be/re)),Oe=Math.min(we,(L+be)/re);let Pe=0;for(let qe=oe;qe<G;++qe){const nt=qe*Ie-V;for(let dt=pe;dt<ye;++dt){const ht=dt*j-ae;for(let $t=De;$t<Oe;++$t){const ln=$t*re-be,Cn=w*Le+y*qe+C*dt+S*$t,ro=I*(P-1-nt)+R*(z-1-ht)+T*(L-1-ln)+N*_e;for(let Pn=0;Pn<se;++Pn){const Nn=v[Cn+Pn],Ht=$[ro+Pn];Pe+=Nn*Ht}}}}f[p*Le+m*F+g*Y+b*ge+_e]=Pe}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const Lre={kernelName:By,backendName:"cpu",kernelFunc:Mre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bre=zt(Xd,t=>Math.cos(t)),zre={kernelName:Xd,backendName:"cpu",kernelFunc:Bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wre=zt(Yd,t=>Math.cosh(t)),Vre={kernelName:Yd,backendName:"cpu",kernelFunc:Wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ure(t){const{inputs:e,backend:n,attrs:r}=t,{image:o,boxes:s,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=r,[u,d,h,f]=o.shape,p=s.shape[0],[m,g]=a,b=wt([p,m,g,f],"float32"),v=n.data.get(s.dataId).values,w=n.data.get(i.dataId).values,y=n.data.get(o.dataId).values,C=tt(o.shape),S=tt(b.shape);for(let $=0;$<p;$++){const I=$*4,R=v[I],T=v[I+1],N=v[I+2],_=v[I+3],P=w[$];if(P>=u)continue;const z=m>1?(N-R)*(d-1)/(m-1):0,L=g>1?(_-T)*(h-1)/(g-1):0;for(let O=0;O<m;O++){const B=m>1?R*(d-1)+O*z:.5*(R+N)*(d-1);if(B<0||B>d-1){for(let U=0;U<g;U++)for(let Q=0;Q<f;Q++){const se=Q+U*S[2]+O*S[1]+$*S[0];b.values[se]=c}continue}if(l==="bilinear"){const U=Math.floor(B),Q=Math.ceil(B),se=B-U;for(let ce=0;ce<g;ce++){const de=g>1?T*(h-1)+ce*L:.5*(T+_)*(h-1);if(de<0||de>h-1){for(let re=0;re<f;re++){const le=re+ce*S[2]+O*S[1]+$*S[0];b.values[le]=c}continue}const we=Math.floor(de),Ie=Math.ceil(de),j=de-we;for(let re=0;re<f;re++){let le=re+we*C[2]+U*C[1]+P*C[0];const Ce=y[le];le=re+Ie*C[2]+U*C[1]+P*C[0];const ve=y[le];le=re+we*C[2]+Q*C[1]+P*C[0];const Le=y[le];le=re+Ie*C[2]+Q*C[1]+P*C[0];const _e=y[le],F=Ce+(ve-Ce)*j,V=Le+(_e-Le)*j;le=re+ce*S[2]+O*S[1]+$*S[0],b.values[le]=F+(V-F)*se}}}else for(let U=0;U<g;++U){const Q=g>1?T*(h-1)+U*L:.5*(T+_)*(h-1);if(Q<0||Q>h-1){for(let de=0;de<f;de++){const we=de+U*S[2]+O*S[1]+$*S[0];b.values[we]=c}continue}const se=Math.round(Q),ce=Math.round(B);for(let de=0;de<f;de++){const we=de+se*C[2]+ce*C[1]+P*C[0],Ie=de+U*S[2]+O*S[1]+$*S[0];b.values[Ie]=y[we]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const Hre={kernelName:Wy,backendName:"cpu",kernelFunc:Ure};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,exclusive:i,reverse:a}=r;Ke(o,"cumprod");const l=wn([s],o.shape.length);let c=o;l!=null&&(c=Or({inputs:{x:o},backend:n,attrs:{perm:l}}));const u=En(1,o.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Jr(c.dtype,"int32"),h=Ey(me(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(b,v)=>b+p-v-1:(b,v)=>b+v;for(let b=0;b<f.length;b+=p)for(let v=0;v<p;v++){const w=m(b,v);if(v===0)h[w]=i?1:f[w];else{const y=m(b,v-1);h[w]=i?f[y]*h[y]:f[w]*h[y]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const b=ea(l),v=Or({inputs:{x:g},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),v}return g}const jre={kernelName:zy,backendName:"cpu",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,exclusive:i,reverse:a}=r;Ke(o,"cumsum");const l=wn([s],o.shape.length);let c=o;l!=null&&(c=Or({inputs:{x:o},backend:n,attrs:{perm:l}}));const u=En(1,o.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Jr(c.dtype,"int32"),h=gr(me(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(b,v)=>b+p-v-1:(b,v)=>b+v;for(let b=0;b<f.length;b+=p)for(let v=0;v<p;v++){const w=m(b,v);if(v===0)h[w]=i?0:f[w];else{const y=m(b,v-1);h[w]=i?f[y]+h[y]:f[w]+h[y]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const b=ea(l),v=Or({inputs:{x:g},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),v}return g}const qre={kernelName:tg,backendName:"cpu",kernelFunc:Kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,weights:s}=e,{size:i,binaryOutput:a}=r;if(o.shape.length===1){const l=n.data.get(o.dataId).values,c=n.data.get(s.dataId).values,u=rC(l,c,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,u)}else if(o.shape.length===2){const l=n.bufferSync(o),c=n.bufferSync(s),u=BD(l,c,i,a);return n.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}const Yre={kernelName:Vy,backendName:"cpu",kernelFunc:Xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockSize:s,dataFormat:i}=r;D(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=o.shape[0],l=o.shape[1],c=o.shape[2],u=o.shape[3],d=l*s,h=c*s,f=u/(s*s),p=n.data.get(o.dataId).values,m=new Float32Array(a*d*h*f);let g=0;for(let b=0;b<a;++b)for(let v=0;v<d;++v){const w=Math.floor(v/s),y=v%s;for(let C=0;C<h;++C){const S=Math.floor(C/s),$=C%s,I=(y*s+$)*f;for(let R=0;R<f;++R){const N=R+I+u*(S+c*(w+l*b));m[g++]=p[N]}}}return n.makeTensorInfo([a,d,h,f],o.dtype,m)}const Jre={kernelName:Uy,backendName:"cpu",kernelFunc:Zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PF(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=r;Ke([o,s],"depthwiseConv2DNative");const u=tt(o.shape),d=tt(s.shape);let h=l;h==null&&(h=[1,1]),D(br(i,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const f=ir(o.shape,s.shape,i,h,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:b,padInfo:v}=f,w=v.left,y=v.top,C=f.outChannels/f.inChannels,S=new pr(f.outShape,o.dtype),$=n.data.get(o.dataId).values,I=n.data.get(s.dataId).values,R=S.values;for(let T=0;T<f.batchSize;++T){const N=T*u[0],_=T*S.strides[0];for(let P=0;P<f.outHeight;++P){const z=_+P*S.strides[1],L=P*f.strideHeight-y;for(let O=0;O<p;++O){const B=L+O*g;if(B<0||B>=f.inHeight)continue;const U=O*d[0],Q=N+B*u[1];for(let se=0;se<f.outWidth;++se){const ce=z+se*S.strides[2],de=se*f.strideWidth-w;for(let we=0;we<m;++we){const Ie=de+we*b;if(Ie<0||Ie>=f.inWidth)continue;const j=U+we*d[1],re=Q+Ie*f.inChannels;let le=ce,Ce=j;for(let ve=0;ve<f.inChannels;++ve){const Le=$[re+ve];for(let _e=0;_e<C;++_e)R[le+_e]+=Le*I[Ce+_e];le+=C,Ce+=C}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const Qre={kernelName:ng,backendName:"cpu",kernelFunc:PF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eoe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:s}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r;Ke([o,s],"depthwiseConv2dNativeBackpropFilter");const d=ir(o.shape,u,i,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,g=new pr(d.filterShape,"float32"),b=d.padInfo.left,v=d.padInfo.top,w=d.outChannels/d.inChannels,y=n.data.get(o.dataId).values,C=new pr(o.shape,o.dtype,y),S=n.data.get(s.dataId).values,$=new pr(s.shape,s.dtype,S);for(let I=0;I<p;++I){const R=Math.max(0,Math.ceil((v-I)/h)),T=Math.min(d.outHeight,(d.inHeight+v-I)/h);for(let N=0;N<m;++N){const _=Math.max(0,Math.ceil((b-N)/f)),P=Math.min(d.outWidth,(d.inWidth+b-N)/f);for(let z=0;z<d.outChannels;++z){const L=Math.trunc(z/w),O=z%w;let B=0;for(let U=0;U<d.batchSize;++U)for(let Q=R;Q<T;++Q){const se=I+Q*h-v;for(let ce=_;ce<P;++ce){const de=N+ce*f-b;B+=C.get(U,se,de,L)*$.get(U,Q,ce,z)}}g.set(B,I,N,L,O)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const toe={kernelName:Hy,backendName:"cpu",kernelFunc:eoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:s}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r;Ke([o,s],"depthwiseConv2DNativeBackpropInput");const d=tt(o.shape),h=tt(s.shape),f=ir(u,s.shape,i,a,l,c,!0),p=new pr(f.inShape,"float32"),m=p.values,[g,b,v]=p.strides,w=n.data.get(o.dataId).values,[y,C,S]=d,$=n.data.get(s.dataId).values,[I,R,T]=h,{batchSize:N,filterHeight:_,filterWidth:P,inChannels:z,inHeight:L,inWidth:O,outChannels:B,outHeight:U,outWidth:Q,strideHeight:se,strideWidth:ce}=f,de=_-1-f.padInfo.top,we=P-1-f.padInfo.left,Ie=B/z;for(let j=0;j<N;++j)for(let re=0;re<z;++re)for(let le=0;le<L;++le){const Ce=le-de,ve=Math.max(0,Math.ceil(Ce/se)),Le=Math.min(U,(_+Ce)/se);for(let _e=0;_e<O;++_e){const F=_e-we,V=Math.max(0,Math.ceil(F/ce)),oe=Math.min(Q,(P+F)/ce);let G=0;for(let Y=ve;Y<Le;++Y){const ae=Y*se-Ce;for(let pe=V;pe<oe;++pe){const ye=pe*ce-F,ge=y*j+C*Y+S*pe,be=I*(_-1-ae)+R*(P-1-ye)+T*re;for(let De=0;De<Ie;++De){const Oe=re*Ie+De,Pe=w[ge+Oe],qe=$[be+De];G+=Pe*qe}}}m[g*j+b*le+v*_e+re]=G}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const roe={kernelName:Gy,backendName:"cpu",kernelFunc:noe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ooe(t){const{inputs:e,backend:n}=t,{x:r}=e,o=me(r.shape),s=n.data.get(r.dataId).values,i=wt([o,o],r.dtype),a=i.values;for(let c=0;c<s.length;c++)a[c*o+c]=s[c];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const soe={kernelName:yR,backendName:"cpu",kernelFunc:ooe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ioe={kernelName:rg,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:o}=t,{strides:s,pad:i,dilations:a}=n,l=e,c=l.data.get(r.dataId).values,u=r.shape.length,d=l.data.get(o.dataId).values,h=o.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:b,outWidth:v,padInfo:w,strideHeight:y,strideWidth:C,filterHeight:S,filterWidth:$,dilationHeight:I,dilationWidth:R,outShape:T}=Oh(r.shape,o.shape,s,i,"NHWC",a),N=me(T),_=T.length,P=Dn(r.dtype,N);for(let L=0;L<f;++L)for(let O=0;O<b;++O){const B=O*y-w.top;for(let U=0;U<v;++U){const Q=U*C-w.left;for(let se=0;se<g;++se){let ce=Number.MIN_SAFE_INTEGER;for(let we=0;we<S;++we){const Ie=B+we*I;if(Ie>=0&&Ie<p)for(let j=0;j<$;++j){const re=Q+j*R;if(re>=0&&re<m){const le=Es([L,Ie,re,se],u,tt(r.shape)),Ce=Es([we,j,se],h,tt(o.shape)),ve=c[le]+d[Ce];ve>ce&&(ce=ve)}}}const de=Es([L,O,U,se],_,tt(T));P[de]=ce}}}return{dataId:l.write(yl(P,r.dtype),T,r.dtype),shape:T,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aoe={kernelName:Tx,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:o,dy:s}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=Jo(r.shape,c.data.get(r.dataId).values),d=Jo(o.shape,c.data.get(o.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:b,padInfo:v,strideHeight:w,strideWidth:y,filterHeight:C,filterWidth:S,dilationHeight:$,dilationWidth:I,outShape:R}=Oh(r.shape,o.shape,i,a,"NHWC",l);D(s.rank===R.length,()=>`Error in ${Tx}, dy must have the same rank as output ${R.length}, but got ${s.rank}`);const T=Jo(R,c.data.get(s.dataId).values),N=mR(o.shape,o.dtype);for(let P=0;P<h;++P)for(let z=0;z<g;++z){const L=z*w-v.top;for(let O=0;O<b;++O){const B=O*y-v.left;for(let U=0;U<m;++U){let Q=Number.MIN_SAFE_INTEGER,se=0,ce=0;for(let de=0;de<C;++de){const we=L+de*$;if(we>=0&&we<f)for(let Ie=0;Ie<S;++Ie){const j=B+Ie*I;if(j>=0&&j<p){const re=u[P][we][j][U]+d[de][Ie][U];re>Q&&(Q=re,se=de,ce=Ie)}}}N[se][ce][U]+=T[P][z][O][U]}}}return{dataId:c.write(yl(N,r.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const loe={kernelName:kx,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:o,dy:s}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=Jo(r.shape,c.data.get(r.dataId).values),d=Jo(o.shape,c.data.get(o.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:b,padInfo:v,strideHeight:w,strideWidth:y,filterHeight:C,filterWidth:S,dilationHeight:$,dilationWidth:I,outShape:R}=Oh(r.shape,o.shape,i,a,"NHWC",l);D(s.rank===R.length,()=>`Error in ${kx}, dy must have the same rank as output ${R.length}, but got ${s.rank}`);const T=Jo(R,c.data.get(s.dataId).values),N=mR(r.shape,r.dtype);for(let P=0;P<h;++P)for(let z=0;z<g;++z){const L=z*w-v.top;for(let O=0;O<b;++O){const B=O*y-v.left;for(let U=0;U<m;++U){let Q=Number.MIN_SAFE_INTEGER,se=L<0?0:L,ce=B<0?0:B;for(let de=0;de<C;++de){const we=L+de*$;if(we>=0&&we<f)for(let Ie=0;Ie<S;++Ie){const j=B+Ie*I;if(j>=0&&j<p){const re=u[P][we][j][U]+d[de][Ie][U];re>Q&&(Q=re,se=we,ce=j)}}}N[P][se][ce][U]+=T[P][z][O][U]}}}return{dataId:c.write(yl(N,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zh(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r;Ke(o,"sum");let a;o.dtype==="bool"?a=Ki({inputs:{x:o},backend:n,attrs:{dtype:"int32"}}):a=Ls({inputs:{x:o},backend:n});const l=a.shape.length,c=Ct(s,a.shape),u=wn(c,l);let d=c,h=a;u!=null&&(h=Or({inputs:{x:a},backend:n,attrs:{perm:u}}),d=En(d.length,l)),ar("sum",d,h.shape.length);const[f,p]=er(h.shape,d),m=Jr(h.dtype,"int32");let g=rm(n,f,m);const b=me(p),v=n.data.get(g.dataId).values,w=n.data.get(h.dataId).values;for(let y=0;y<v.length;++y){const C=y*b;let S=0;for(let $=0;$<b;++$)S+=w[C+$];v[y]=S}if(i){const y=Tn(g.shape,c),C=g;g=Jt({inputs:{x:g},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),g}const coe={kernelName:Pg,backendName:"cpu",kernelFunc:Zh};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:o}=r,s=e,{allDims:i,summedDims:a,idDims:l}=Tw(o,s.length);Rw(i.length,l,s);const{path:c,steps:u}=Nw(a,l),d=u.length;let h=null,f=i.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:b,expandDims:v}=Ew(f,l[g]);let w;_w(b)?w=s[g]:(w=Or({inputs:{x:s[g]},backend:n,attrs:{perm:b}}),p.push(w));const y=w.shape.slice();for(let C=0;C<v.length;++C)y.splice(v[C],0,1);Bt(w.shape,y)||(w=Jt({inputs:{x:w},backend:n,attrs:{shape:y}}),p.push(w)),h===null?h=w:(h=gb({inputs:{a:w,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=Zh({inputs:{x:h},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const doe={kernelName:wR,backendName:"cpu",kernelFunc:uoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hoe(t){const{inputs:e,backend:n}=t,{dy:r,y:o}=e;Ke([r,o],"eluGrad");const s=new Float32Array(me(o.shape)),i=n.data.get(o.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=1?s[l]=a[l]:s[l]=a[l]*(c+1)}return n.makeTensorInfo(o.shape,"float32",s)}const foe={kernelName:jy,backendName:"cpu",kernelFunc:hoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const poe=yw,moe=ww,goe=Cw,boe=$w,voe=Sw,xoe=Iw,yoe=zt(Qd,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+poe*n);return e*(1-((((xoe*r+voe)*r+boe)*r+goe)*r+moe)*r*Math.exp(-n*n))}),woe={kernelName:Qd,backendName:"cpu",kernelFunc:yoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function im(t){const{inputs:e,backend:n,attrs:r}=t,{input:o}=e,{dim:s}=r,i=o.shape.length,a=o.shape.slice();let l=s;return s<0&&(D(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),Jt({inputs:{x:o},backend:n,attrs:{shape:a}})}const Coe={kernelName:sg,backendName:"cpu",kernelFunc:im};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $oe=On((t,e)=>t/e),cC=tr(Zd,$oe),n0={kernelName:Zd,backendName:"cpu",kernelFunc:cC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MF(t,e,n){const r=t.shape,o=r[0],s=r[1],i=n.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[o,s],u=me(c),d=sr("float32",u),h=sr("float32",u);for(let g=0;g<o;g++){const b=dl({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,s]}}),v=dl({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,s]}}),w=jr({inputs:{real:b,imag:v},backend:n}),{real:y,imag:C}=Soe(w,e,n),S=ni(y,C);for(let $=0;$<s;$++){const I=kw(S,$);d[g*s+$]=I.real,h[g*s+$]=I.imag}n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),m=jr({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function Soe(t,e,n){const r=me(t.shape),o=n.data.get(t.dataId),s=n.data.get(o.complexTensorInfos.real.dataId).values,i=n.data.get(o.complexTensorInfos.imag.dataId).values;if(Ioe(r)){const a=r0(s,i,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",Ji(r,"float32")),h=Ls({inputs:{x:d},backend:n}),f=n0.kernelFunc({inputs:{a:c,b:d},backend:n}),p=n0.kernelFunc({inputs:{a:u,b:h},backend:n}),m=n.data.get(f.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return a}else{const a=ni(s,i),l=koe(a,r,e);return s_(l)}}function Ioe(t){return(t&t-1)===0}function r0(t,e,n,r,o){if(n===1)return{real:t,imag:e};const s=ni(t,e),i=n/2,a=i_(s),l=a.real,c=a.imag,u=[l.length],d=o.makeTensorInfo(u,"float32",l),h=o.makeTensorInfo(u,"float32",c),f=jr({inputs:{real:d,imag:h},backend:o}),p=a_(s),m=p.real,g=p.imag,b=[m.length],v=o.makeTensorInfo(b,"float32",m),w=o.makeTensorInfo(b,"float32",g),y=jr({inputs:{real:v,imag:w},backend:o}),C=r0(l,c,i,r,o),S=C.real,$=C.imag,I=[S.length],R=o.makeTensorInfo(I,"float32",S),T=o.makeTensorInfo(I,"float32",$),N=jr({inputs:{real:R,imag:T},backend:o}),_=r0(m,g,i,r,o),P=_.real,z=_.imag,L=[P.length],O=o.makeTensorInfo(L,"float32",P),B=o.makeTensorInfo(L,"float32",z),U=jr({inputs:{real:O,imag:B},backend:o}),Q=c_(n,r),se=[Q.real.length],ce=o.makeTensorInfo(se,"float32",Q.real),de=o.makeTensorInfo(se,"float32",Q.imag),we=jr({inputs:{real:ce,imag:de},backend:o}),Ie=gb({inputs:{a:we,b:U},backend:o}),j=Ic({inputs:{a:N,b:Ie},backend:o}),re=aC({inputs:{a:N,b:Ie},backend:o}),le=ul({inputs:{input:j},backend:o}),Ce=ul({inputs:{input:re},backend:o}),ve=kc({inputs:{input:j},backend:o}),Le=kc({inputs:{input:re},backend:o}),_e=Tc({inputs:[le,Ce],backend:o,attrs:{axis:0}}),F=Tc({inputs:[ve,Le],backend:o,attrs:{axis:0}}),V=o.data.get(_e.dataId).values,oe=o.data.get(F.dataId).values;return o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(h),o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(v),o.disposeIntermediateTensorInfo(w),o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(R),o.disposeIntermediateTensorInfo(T),o.disposeIntermediateTensorInfo(N),o.disposeIntermediateTensorInfo(O),o.disposeIntermediateTensorInfo(B),o.disposeIntermediateTensorInfo(U),o.disposeIntermediateTensorInfo(ce),o.disposeIntermediateTensorInfo(de),o.disposeIntermediateTensorInfo(we),o.disposeIntermediateTensorInfo(Ie),o.disposeIntermediateTensorInfo(j),o.disposeIntermediateTensorInfo(re),o.disposeIntermediateTensorInfo(le),o.disposeIntermediateTensorInfo(ve),o.disposeIntermediateTensorInfo(Ce),o.disposeIntermediateTensorInfo(Le),o.disposeIntermediateTensorInfo(_e),o.disposeIntermediateTensorInfo(F),{real:V,imag:oe}}function koe(t,e,n){const r=new Float32Array(e*2);for(let o=0;o<e;o++){let s=0,i=0;for(let a=0;a<e;a++){const l=u_(o*a,e,n),c=kw(t,a);s+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}n&&(s/=e,i/=e),l_(r,s,i,o)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t){const{inputs:e,backend:n}=t,{input:r}=e,o=me(r.shape),s=r.shape[r.shape.length-1],i=o/s,a=Jt({inputs:{x:r},backend:n,attrs:{shape:[i,s]}}),l=MF(a,!1,n),c=Jt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Eoe={kernelName:Ky,backendName:"cpu",kernelFunc:Toe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uC(t){const{backend:e,attrs:n}=t,{shape:r,value:o,dtype:s}=n,i=s||Ld(o),a=Dn(i,me(r));return Noe(a,o,i),e.makeTensorInfo(r,i,a)}const Roe={kernelName:qy,backendName:"cpu",kernelFunc:uC};function Noe(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _oe={kernelName:Xy,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,o=n,s=sr(r.dtype,me(r.shape)),[i,a,l,c]=r.shape,u=o.data.get(r.dataId).values;for(let h=0;h<i;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let g=0;g<l;g++){const b=g*c;for(let v=0;v<c;v++){const w=Math.round(l-g-1),y=f+m+b+v;let C=u[y];if(w>=0&&w<l){const S=w*c,$=f+m+S+v;C=u[$]}s[y]=C}}}}return{dataId:o.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aoe=On((t,e)=>Math.floor(t/e)),Doe=tr(rh,Aoe,null,"int32"),Foe={kernelName:rh,backendName:"cpu",kernelFunc:Doe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ooe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r;let m=OF({inputs:{x:o,filter:s},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const g=m;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const b=Jt({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=Ic({inputs:{a:m,b},backend:n}),n.disposeIntermediateTensorInfo(b)}else m=Ic({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(g)}if(f){const g=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const b=Jt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=sm(n,m,f,b,p),n.disposeIntermediateTensorInfo(b)}else m=sm(n,m,f,a,p);n.disposeIntermediateTensorInfo(g)}return m}const Poe={kernelName:Lp,backendName:"cpu",kernelFunc:Ooe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Moe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r;let m=PF({inputs:{x:o,filter:s},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const g=m;m=Ic({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(g)}if(f){const g=m;m=sm(n,m,f,a,p),n.disposeIntermediateTensorInfo(g)}return m}const Loe={kernelName:AR,backendName:"cpu",kernelFunc:Moe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(t){const{inputs:e,backend:n}=t,{params:r,indices:o}=e,s=me(r.shape),i=o.shape,a=i[i.length-1],[l,c,u,d]=k1(r,o);if(c===0)return n.makeTensorInfo(l,r.dtype,[]);const h=n.data.get(o.dataId).values,f=n.bufferSync(r),p=qD(h,f,r.dtype,c,a,u,d,r.shape,s);return n.makeTensorInfo(l,r.dtype,p.values)}const zoe={kernelName:CR,backendName:"cpu",kernelFunc:Boe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Woe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,indices:s}=e,{axis:i,batchDims:a}=r;Ke([o,s],"gatherV2");const l=Ct(i,o.shape)[0],c=n.data.get(s.dataId).values,u=o.shape[l];for(let y=0;y<c.length;++y){const C=c[y];D(C<=u-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=me(s.shape),f=Dw(o,s,l,d),p=Jt({inputs:{x:o},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=Jt({inputs:{x:s},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),g=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],b=n.bufferSync(m),v=n.bufferSync(p),w=XD(v,b,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,w.dtype,w.values)}const Voe={kernelName:ag,backendName:"cpu",kernelFunc:Woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t){const{inputs:e,backend:n}=t,{input:r}=e,o=me(r.shape),s=r.shape[r.shape.length-1],i=o/s,a=Jt({inputs:{x:r},backend:n,attrs:{shape:[i,s]}}),l=MF(a,!0,n),c=Jt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Hoe={kernelName:Yy,backendName:"cpu",kernelFunc:Uoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Goe=zt(ih,t=>Number.isFinite(t)?1:0,"bool"),joe={kernelName:ih,backendName:"cpu",kernelFunc:Goe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Koe=zt(ah,t=>Math.abs(t)===1/0?1:0,"bool"),qoe={kernelName:ah,backendName:"cpu",kernelFunc:Koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xoe=zt(lh,t=>Number.isNaN(t)?1:0,"bool"),Yoe={kernelName:lh,backendName:"cpu",kernelFunc:Xoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(t){const{backend:e,attrs:n}=t,{start:r,stop:o,num:s}=n,i=eF(r,o,s);return e.makeTensorInfo([i.length],"float32",i)}const Joe={kernelName:$R,backendName:"cpu",kernelFunc:Zoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qoe=zt(uh,t=>Math.log1p(t)),ese={kernelName:uh,backendName:"cpu",kernelFunc:Qoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tse=On((t,e)=>t&&e),nse=tr(hg,tse,null,"bool"),rse={kernelName:hg,backendName:"cpu",kernelFunc:nse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ose=zt(fg,t=>t?0:1,"bool"),sse={kernelName:fg,backendName:"cpu",kernelFunc:ose};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ise=On((t,e)=>t||e),ase=tr(pg,ise,null,"bool"),lse={kernelName:pg,backendName:"cpu",kernelFunc:ase};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cse(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{depthRadius:s,bias:i,alpha:a,beta:l}=r;Ke(o,"LRN");const c=o.shape[3],u=c-1,d=n.data.get(o.dataId).values,h=me(o.shape),f=new Float32Array(h);function p(m){const g=m%c;let b=m-g+Math.max(0,g-s);const v=m-g+Math.min(g+s,u);let w=0;for(;b<=v;b++){const y=d[b];w+=y*y}return w}for(let m=0;m<h;m++){const g=p(m),b=d[m]*Math.pow(i+a*g,-l);f[m]=b}return n.makeTensorInfo(o.shape,o.dtype,f)}const use={kernelName:mg,backendName:"cpu",kernelFunc:cse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dse(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,y:s,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=r;Ke(i,"LRNGrad");const d=me(i.shape),h=i.shape[3],f=n.data.get(i.dataId).values,p=n.data.get(o.dataId).values,m=n.data.get(s.dataId).values,g=new Float32Array(d),b=d;for(let v=0;v<b;v++){const w=v%h,y=v-w+Math.max(0,w-a),C=v-w+Math.min(h,w+a+1);let S=0;for(let $=y;$<C;$++)S+=Math.pow(p[$],2);S=c*S+l;for(let $=y;$<C;$++){let I=-2*c*u*p[$]*m[v]/S;v===$&&(I+=Math.pow(S,-u)),I*=f[v],g[$]+=I}}return n.makeTensorInfo(i.shape,o.dtype,g)}const hse={kernelName:Jy,backendName:"cpu",kernelFunc:dse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LF(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reductionIndices:s,keepDims:i}=r,a=n;let l=o.shape;const c=l.length,u=Ct(s,l);let d=u;const h=wn(d,c);let f=a.data.get(o.dataId).values;if(h!=null){const y=new Array(c);for(let C=0;C<y.length;C++)y[C]=l[h[C]];f=sC(f,l,o.dtype,h,y),d=En(d.length,c),l=y}Ke(o,"max"),ar("max",d,c);const[p,m]=er(l,d),g=me(m),b=nF(f,g,p,o.dtype),v=a.write(b,p,o.dtype);let w=p;return i&&(w=Tn(p,u)),{dataId:v,shape:w,dtype:o.dtype}}const fse={kernelName:gg,backendName:"cpu",kernelFunc:LF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pse(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;Ke(o,"maxPool");const{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;D(br(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Wo(o.shape,s,i,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Bt(u.inShape,u.outShape))d=Ls({inputs:{x:o},backend:n});else{const h=n.data.get(o.dataId).values,f=tt(o.shape),p=lC(h,o.shape,o.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,o.dtype,p.values)}return d}const mse={kernelName:bg,backendName:"cpu",kernelFunc:pse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r;Ke(o,"maxPool3d");const u=li(o.shape,s,i,1,a,l,c),d=n.data.get(o.dataId).values,h=FF(d,o.shape,o.dtype,tt(o.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const bse={kernelName:vg,backendName:"cpu",kernelFunc:gse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vse(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:s}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=r;Ke([o,s],"maxPool3DGrad");const u=li(s.shape,i,a,1,l,c),d=n.bufferSync(s),h=sre(d,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,b=u.dilationHeight,v=u.dilationWidth,w=u.effectiveFilterDepth,y=u.effectiveFilterHeight,C=u.effectiveFilterWidth,S=w-1-u.padInfo.front,$=C-1-u.padInfo.left,I=y-1-u.padInfo.top,R=wt(s.shape,"float32"),T=n.bufferSync(o);for(let N=0;N<u.batchSize;++N)for(let _=0;_<u.inChannels;++_)for(let P=0;P<u.inDepth;++P)for(let z=0;z<u.inHeight;++z)for(let L=0;L<u.inWidth;++L){const O=P-S,B=z-I,U=L-$;let Q=0;for(let se=0;se<w;se+=g){const ce=(O+se)/f;if(!(ce<0||ce>=u.outDepth||Math.floor(ce)!==ce))for(let de=0;de<y;de+=b){const we=(B+de)/p;if(!(we<0||we>=u.outHeight||Math.floor(we)!==we))for(let Ie=0;Ie<C;Ie+=v){const j=(U+Ie)/m;if(j<0||j>=u.outWidth||Math.floor(j)!==j)continue;const re=w*y*C-1-h.get(N,ce,we,j,_),le=se*y*C+de*C+Ie,Ce=re===le?1:0;if(Ce===0)continue;const ve=T.get(N,ce,we,j,_);Q+=ve*Ce}}}R.set(Q,N,P,z,L,_)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const xse={kernelName:e1,backendName:"cpu",kernelFunc:vse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:s,output:i}=e,a=s;Ke([s,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,h=Wo(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,p=wt(h.outShape,a.dtype,DF(f,a.shape,a.dtype,h).values),m=h.strideHeight,g=h.strideWidth,b=h.dilationHeight,v=h.dilationWidth,w=h.effectiveFilterHeight,y=h.effectiveFilterWidth,C=y-1-h.padInfo.left,S=w-1-h.padInfo.top,$=wt(a.shape,"float32"),I=n.data.get(o.dataId).values,R=wt(o.shape,"float32",I);for(let T=0;T<h.batchSize;++T)for(let N=0;N<h.inChannels;++N)for(let _=0;_<h.inHeight;++_)for(let P=0;P<h.inWidth;++P){const z=_-S,L=P-C;let O=0;for(let B=0;B<w;B+=b){const U=(z+B)/m;if(!(U<0||U>=h.outHeight||Math.floor(U)!==U))for(let Q=0;Q<y;Q+=v){const se=(L+Q)/g;if(se<0||se>=h.outWidth||Math.floor(se)!==se)continue;const ce=w*y-1-p.get(T,U,se,N),de=B*y+Q,we=ce===de?1:0;if(we===0)continue;const Ie=R.get(T,U,se,N);O+=Ie*we}}$.set(O,T,_,P,N)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const wse={kernelName:Qy,backendName:"cpu",kernelFunc:yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cse(t,e,n,r,o){const s=tt(e),i=lC(t,e,n,s,o,"max"),a=DF(t,e,n,o,!0,r);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $se={kernelName:SR,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:o,strides:s,pad:i,includeBatchInIndex:a}=e,l=n;Ke(r,"MaxPoolWithArgmax");const c=l.data.get(r.dataId).values,u=Wo(r.shape,o,s,[1,1],i),[d,h]=Cse(c,r.shape,r.dtype,a,u),f=l.write(d,u.outShape,r.dtype),p=l.write(h,u.outShape,r.dtype);return[{dataId:f,shape:u.outShape,dtype:r.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sse(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r,a=Ct(s,o.shape),c=er(o.shape,a)[1],u=me(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=Ki({inputs:{x:o},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=cC({inputs:{a:f,b:h},backend:n});d.push(p);const m=Zh({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:i}});return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const Ise={kernelName:xg,backendName:"cpu",kernelFunc:Sse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kse(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r;Ke(o,"min");const a=Ct(s,o.shape);let l=a;const c=wn(l,o.shape.length);let u=o;c!=null&&(u=Or({inputs:{x:o},backend:n,attrs:{perm:c}}),l=En(l.length,o.shape.length)),ar("min",l,u.shape.length);const[d,h]=er(u.shape,l),f=me(h),p=gr(me(d),u.dtype),m=n.data.get(u.dataId).values;for(let b=0;b<p.length;++b){const v=b*f;let w=m[v];for(let y=0;y<f;++y){const C=m[v+y];(Number.isNaN(C)||C<w)&&(w=C)}p[b]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(i){const b=Tn(d,a),v=Jt({inputs:{x:g},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(g),v}return g}const Tse={kernelName:yg,backendName:"cpu",kernelFunc:kse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{paddings:s,mode:i}=r;Ke(o,"mirrorPad");const a=s.map((w,y)=>w[0]+o.shape[y]+w[1]),l=s.map(w=>w[0]),c=s.map((w,y)=>w[0]+o.shape[y]),u=i==="reflect"?0:1,d=n.data.get(o.dataId).values,h=o.shape.length,f=tt(o.shape),p=me(a),m=a.length,g=tt(a),b=sr(o.dtype,p);for(let w=0;w<p;w++){let y=Kc(w,m,g);for(let S=0;S<m;S++)y[S]<l[S]?y[S]=l[S]*2-y[S]-u:y[S]>=c[S]&&(y[S]=(c[S]-1)*2-y[S]+u);y=y.map((S,$)=>S-l[$]);const C=Es(y,h,f);b[w]=d[C]}return{dataId:n.write(b,a,o.dtype),shape:a,dtype:o.dtype}}const Rse={kernelName:wg,backendName:"cpu",kernelFunc:Ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nse=On((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),_se=tr(fh,Nse),Ase={kernelName:fh,backendName:"cpu",kernelFunc:_se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BF(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{dim:s}=r,i=o.shape.length;let a=s;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=Ct([a],o.shape),c=LF({inputs:{x:o},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Tn(c.shape,l),d=Jt({inputs:{x:c},backend:n,attrs:{shape:u}}),h=aC({inputs:{a:o,b:d},backend:n}),f=GD({inputs:{x:h},backend:n}),p=Zh({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=Jt({inputs:{x:p},backend:n,attrs:{shape:u}}),g=cC({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const Dse={kernelName:Bg,backendName:"cpu",kernelFunc:BF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{numSamples:s,seed:i,normalized:a}=r;Ke(o,"multinomial");const l=a?o:BF({inputs:{logits:o},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,s],f=gr(me(h),"int32");for(let p=0;p<c;++p){const m=p*u,g=new Float32Array(u-1);g[0]=d[m];for(let w=1;w<g.length;++w)g[w]=g[w-1]+d[m+w];const b=X1.alea(i.toString()),v=p*s;for(let w=0;w<s;++w){const y=b();f[v+w]=g.length;for(let C=0;C<g.length;C++)if(y<g[C]){f[v+w]=C;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const Ose={kernelName:IR,backendName:"cpu",kernelFunc:Fse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pse=ow;function Mse(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r;Ke(o,"NonMaxSuppression");const c=n.data.get(o.dataId).values,u=n.data.get(s.dataId).values,{selectedIndices:d}=Pse(c,u,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Lse={kernelName:t1,backendName:"cpu",kernelFunc:Mse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bse=sw;function zse(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r;Ke(o,"NonMaxSuppressionPadded");const u=n.data.get(o.dataId).values,d=n.data.get(s.dataId).values,{selectedIndices:h,validOutputs:f}=Bse(u,d,i,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const Wse={kernelName:n1,backendName:"cpu",kernelFunc:zse};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vse=iw;function Use(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r;Ke(o,"NonMaxSuppressionWithScore");const u=n.data.get(o.dataId).values,d=n.data.get(s.dataId).values,h=i,f=a,p=l,m=c,{selectedIndices:g,selectedScores:b}=Vse(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const Hse={kernelName:r1,backendName:"cpu",kernelFunc:Use};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gse(t){const{inputs:e,backend:n,attrs:r}=t,{indices:o}=e,{dtype:s,depth:i,onValue:a,offValue:l}=r;Ke(o,"oneHot");const c=me(o.shape),u=new Float32Array(c*i);u.fill(l);const d=n.data.get(o.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<i&&(u[h*i+d[h]]=a);return n.makeTensorInfo([...o.shape,i],s,u)}const jse={kernelName:Ig,backendName:"cpu",kernelFunc:Gse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function am(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const o=ul({inputs:{input:r},backend:n}),s=am({inputs:{x:o},backend:n}),i=kc({inputs:{input:r},backend:n}),a=am({inputs:{x:i},backend:n}),l=jr({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return uC({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const Kse={kernelName:Vg,backendName:"cpu",kernelFunc:am};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zF(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const o=ul({inputs:{input:r},backend:n}),s=zF({inputs:{x:o},backend:n}),i=kc({inputs:{input:r},backend:n}),a=am({inputs:{x:i},backend:n}),l=jr({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return uC({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const qse={kernelName:Sg,backendName:"cpu",kernelFunc:zF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WF(t){const{inputs:e,backend:n,attrs:r}=t,{axis:o}=r;if(e.length===1)return im({inputs:{input:e[0]},backend:n,attrs:{dim:o}});const s=e[0].shape,i=e[0].dtype;e.forEach(u=>{zo(s,u.shape,"All tensors passed to stack must have matching shapes"),D(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=im({inputs:{input:u},backend:n,attrs:{dim:o}});return a.push(d),d}),c=Tc({inputs:l,backend:n,attrs:{axis:o}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const Xse={kernelName:kg,backendName:"cpu",kernelFunc:WF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yse(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{paddings:s,constantValue:i}=r;Ke(o,"pad");const a=s.map((v,w)=>v[0]+o.shape[w]+v[1]),l=s.map(v=>v[0]),c=n.data.get(o.dataId).values,u=me(o.shape),d=o.shape.length,h=tt(o.shape),f=me(a),p=a.length,m=tt(a),g=sr(o.dtype,f);i!==0&&g.fill(i);for(let v=0;v<u;v++){const y=Kc(v,d,h).map((S,$)=>S+l[$]),C=Es(y,p,m);g[C]=c[v]}return{dataId:n.write(g,a,o.dtype),shape:a,dtype:o.dtype}}const VF={kernelName:Tg,backendName:"cpu",kernelFunc:Yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zse=On((t,e)=>Math.pow(t,e)),Jse=tr(mh,Zse),Qse={kernelName:mh,backendName:"cpu",kernelFunc:Jse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eie(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:o,paramsDenseValues:s,indices:i}=e,a=o.map(g=>n.data.get(g.dataId).values),l=o.map(g=>g.shape),c=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,[d,h,f]=lF(a,l,c,s.shape,s.dtype,u,i.shape),p=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(f,s.dtype,h);return p.concat([m])}const tie={kernelName:kR,backendName:"cpu",kernelFunc:eie};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nie(t){const{inputs:e,backend:n}=t,{starts:r,limits:o,deltas:s}=e,i=n.data.get(r.dataId).values,a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values,[c,u]=cF(i,r.shape,r.dtype,a,o.shape,l,s.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],r.dtype,u);return[d,h]}const rie={kernelName:TR,backendName:"cpu",kernelFunc:nie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oie(t){const{inputs:e,backend:n,attrs:r}=t,{shape:o,values:s,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,c=n.data.get(o.dataId).values,u=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,h=a.map(g=>n.data.get(g.dataId).values),f=a.map(g=>g.shape),[p,m]=uF(c,o.shape,u,s.shape,s.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(p,s.dtype,m)}const sie={kernelName:ER,backendName:"cpu",kernelFunc:oie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(t){const{backend:e,attrs:n}=t,{start:r,stop:o,dtype:s,step:i}=n,a=dF(r,o,i,s);return e.makeTensorInfo([a.length],s,a)}const aie={kernelName:o1,backendName:"cpu",kernelFunc:iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lie=zt(gh,t=>1/t),cie={kernelName:gh,backendName:"cpu",kernelFunc:lie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uie(t){const{inputs:e,backend:n,attrs:r}=t,{images:o}=e,{alignCorners:s,halfPixelCenters:i,size:a}=r;Ke(o,"resizeBilinear");const l=tt(o.shape),[c,u]=a,[d,h,f,p]=o.shape,m=n.data.get(o.dataId).values,g=new Float32Array(me([d,c,u,p])),b=[s&&c>1?h-1:h,s&&u>1?f-1:f],v=[s&&c>1?c-1:c,s&&u>1?u-1:u];let w=0;const y=b[0]/v[0],C=b[1]/v[1];for(let S=0;S<d;S++)for(let $=0;$<c;$++){let I;i?I=y*($+.5)-.5:I=y*$;const R=Math.max(0,Math.floor(I)),T=I-R,N=Math.min(h-1,Math.ceil(I)),_=S*l[0]+R*l[1],P=S*l[0]+N*l[1];for(let z=0;z<u;z++){let L;i?L=C*(z+.5)-.5:L=C*z;const O=Math.max(0,Math.floor(L)),B=L-O,U=Math.min(f-1,Math.ceil(L)),Q=_+O*l[2],se=P+O*l[2],ce=_+U*l[2],de=P+U*l[2];for(let we=0;we<p;we++){const Ie=m[Q+we],j=m[se+we],re=m[ce+we],le=m[de+we],Ce=Ie+(re-Ie)*B,ve=j+(le-j)*B,Le=Ce+(ve-Ce)*T;g[w++]=Le}}}return n.makeTensorInfo([d,c,u,p],"float32",g)}const die={kernelName:Ag,backendName:"cpu",kernelFunc:uie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(t){const{inputs:e,backend:n,attrs:r}=t,{images:o,dy:s}=e,{alignCorners:i}=r;Ke([s,o],"resizeBilinearGrad");const a=tt(o.shape),[l,c,u,d]=o.shape,[,h,f]=s.shape,p=new Float32Array(l*c*u*d),m=[i&&h>1?c-1:c,i&&f>1?u-1:u],g=[i&&h>1?h-1:h,i&&f>1?f-1:f],b=m[0]/g[0],v=m[1]/g[1],w=n.data.get(s.dataId).values;let y=0;for(let C=0;C<l;C++){const S=C*a[0];for(let $=0;$<h;$++){const I=$*b,R=Math.floor(I),T=Math.min(Math.ceil(I),c-1),N=S+R*a[1],_=S+T*a[1],P=I-R,z=1-P;for(let L=0;L<f;L++){const O=L*v,B=Math.floor(O),U=Math.min(Math.ceil(O),u-1),Q=O-B,se=1-Q,ce=N+B*a[2],de=N+U*a[2],we=_+B*a[2],Ie=_+U*a[2],j=z*se,re=z*Q,le=P*se,Ce=P*Q;for(let ve=0;ve<d;ve++){const Le=w[y++];p[ce+ve]+=Le*j,p[de+ve]+=Le*re,p[we+ve]+=Le*le,p[Ie+ve]+=Le*Ce}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const fie={kernelName:a1,backendName:"cpu",kernelFunc:hie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(t){const{inputs:e,backend:n,attrs:r}=t,{images:o}=e,{alignCorners:s,halfPixelCenters:i,size:a}=r;Ke(o,"resizeNearestNeighbor");const l=tt(o.shape),[c,u]=a,[d,h,f,p]=o.shape,m=n.data.get(o.dataId).values,g=new Float32Array(d*c*u*p),b=[s&&c>1?h-1:h,s&&u>1?f-1:f],v=[s&&c>1?c-1:c,s&&u>1?u-1:u],w=b[0]/v[0],y=b[1]/v[1];let C=0;for(let S=0;S<d;S++){const $=S*l[0];for(let I=0;I<c;I++){const R=i?w*(I+.5):w*I;let T=Math.min(h-1,s?Math.round(R):Math.floor(R));i&&(T=Math.max(0,T));const N=$+T*l[1];for(let _=0;_<u;_++){const P=i?y*(_+.5):y*_;let z=Math.min(f-1,s?Math.round(P):Math.floor(P));i&&(z=Math.max(0,z));const L=N+z*l[2];for(let O=0;O<p;O++){const B=m[L+O];g[C++]=B}}}}return n.makeTensorInfo([d,c,u,p],o.dtype,g)}const mie={kernelName:_g,backendName:"cpu",kernelFunc:pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(t){const{inputs:e,backend:n,attrs:r}=t,{images:o,dy:s}=e,{alignCorners:i}=r;Ke([s,o],"resizeNearestNeighborGrad");const a=tt(o.shape),l=tt(s.shape),[c,u,d,h]=o.shape,[,f,p]=s.shape,m=new Float32Array(c*u*d*h),g=n.data.get(s.dataId).values,b=[i&&f>1?u-1:u,i&&p>1?d-1:d],v=[i&&f>1?f-1:f,i&&p>1?p-1:p],w=b[0]/v[0],y=b[1]/v[1],C=1/w,S=1/y,$=Math.ceil(C)*2+2,I=Math.ceil(S)*2+2;for(let R=0;R<c;R++){const T=R*a[0];for(let N=0;N<u;N++){const _=T+N*a[1],P=Math.floor(N*C),z=Math.floor(P-$/2);for(let L=0;L<d;L++){const O=_+L*a[2],B=Math.floor(L*S),U=Math.floor(B-I/2);for(let Q=0;Q<h;Q++){let se=0;for(let ce=0;ce<$;ce++){const de=ce+z;if(de<0||de>=f)continue;const we=T+de*l[1],Ie=de*w,j=Math.min(u-1,i?Math.round(Ie):Math.floor(Ie));if(N===j)for(let re=0;re<I;re++){const le=re+U;if(le<0||le>=p)continue;const Ce=we+le*l[2],ve=le*y,Le=Math.min(d-1,i?Math.round(ve):Math.floor(ve));L===Le&&(se+=g[Ce+Q])}}m[O+Q]=se}}}}return n.makeTensorInfo(o.shape,o.dtype,m)}const bie={kernelName:i1,backendName:"cpu",kernelFunc:gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{dims:s}=r;Ke(o,"reverse");const i=o.shape.length,a=Ct(s,o.shape);if(i===0)return Ls({inputs:{x:o},backend:n});const l=new pr(o.shape,o.dtype),c=n.bufferSync(o);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=o.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const xie={kernelName:Dg,backendName:"cpu",kernelFunc:vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yie={kernelName:y1,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:o,fillValue:s,center:i}=e,a=n,l=sr(r.dtype,me(r.shape)),[c,u,d,h]=r.shape,[f,p]=bw(i,u,d),m=255,g=Math.sin(o),b=Math.cos(o),v=a.data.get(r.dataId).values;for(let y=0;y<c;y++){const C=y*d*u*h;for(let S=0;S<u;S++){const $=S*(d*h);for(let I=0;I<d;I++){const R=I*h;for(let T=0;T<h;T++){const N=[c,S,I,T],_=N[2],P=N[1];let z=(_-f)*b-(P-p)*g,L=(_-f)*g+(P-p)*b;z=Math.round(z+f),L=Math.round(L+p);let O=s;if(typeof s!="number"&&(T===3?O=m:O=s[T]),z>=0&&z<d&&L>=0&&L<u){const U=L*(d*h),Q=z*h,se=C+U+Q+T;O=v[se]}const B=C+$+R+T;l[B]=O}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wie=zt(xh,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Cie={kernelName:xh,backendName:"cpu",kernelFunc:wie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t){const{inputs:e,backend:n,attrs:r}=t,{indices:o,updates:s}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Fh(s,o,i),h=!0,f=n.bufferSync(o),p=n.bufferSync(s),m=Yl(f,p,i,d,c,l,a,u,0,h);return n.makeTensorInfo(i,m.dtype,m.values)}const Sie={kernelName:RR,backendName:"cpu",kernelFunc:$ie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iie(t,e){let n=0,r=t.length,o=0;for(;n<r;)o=Math.floor((n+r)/2),t[o]<e?n=o+1:r=o;return r}function kie(t,e){let n=0,r=t.length,o=0;for(;n<r;)o=Math.floor((n+r)/2),t[o]<=e?n=o+1:r=o;return r}function Tie(t,e,n,r,o,s){const i=Dn("int32",n*o);for(let a=0;a<n;++a){const l=t.slice(a*r,(a+1)*r),c=a*o;for(let u=0;u<o;++u)i[c+u]=s==="left"?Iie(l,e[u+c]):kie(l,e[u+c])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:o,values:s}=e,{side:i}=r,a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values,c=Tie(a,l,o.shape[0],o.shape[1],s.shape[1],i);return n.makeTensorInfo(s.shape,"int32",c)}const Rie={kernelName:NR,backendName:"cpu",kernelFunc:Eie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(t){const{inputs:e,backend:n}=t,{condition:r,t:o,e:s}=e;Ke([r,o,s],"select");const i=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,c=n.data.get(s.dataId).values,u=Jr(o.dtype,s.dtype),d=gr(me(o.shape),u);let h=0;const f=i===0||i>1||o.shape.length===1?1:me(o.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(o.shape,u,d)}const _ie={kernelName:Fg,backendName:"cpu",kernelFunc:Nie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aie=nb,Die=rb,Fie=zt(wh,t=>t>=0?Die*t:Aie*(Math.exp(t)-1)),Oie={kernelName:wh,backendName:"cpu",kernelFunc:Fie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pie=zt(Sh,t=>t<0?-1:t>0?1:0),Mie={kernelName:Sh,backendName:"cpu",kernelFunc:Pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lie=zt(Ch,t=>Math.sin(t)),Bie={kernelName:Ch,backendName:"cpu",kernelFunc:Lie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zie=zt($h,t=>Math.sinh(t)),Wie={kernelName:$h,backendName:"cpu",kernelFunc:zie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vie=11920928955078125e-23,Ck=Math.log(Vie)+2,Uie=zt(kh,t=>{const e=t>-Ck,n=t<Ck,r=Math.exp(t);let o;return n?o=r:e?o=t:o=Math.log(1+r),o}),Hie={kernelName:kh,backendName:"cpu",kernelFunc:Uie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockShape:s,paddings:i}=r;Ke([o],"spaceToBatchND");const a=me(s),l=[[0,0]];l.push(...i);for(let S=1+s.length;S<o.shape.length;++S)l.push([0,0]);const c=VF.kernelFunc({inputs:{x:o},backend:n,attrs:{paddings:l,constantValue:0}}),u=zh(c.shape,s,a,!1),d=Wh(u.length,s.length,!1),h=Vh(c.shape,s,a,!1),m=Jt({inputs:{x:c},backend:n,attrs:{shape:u}}),v=Or({inputs:{x:m},backend:n,attrs:{perm:d}}),C=Jt({inputs:{x:v},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),C}const jie={kernelName:Mg,backendName:"cpu",kernelFunc:Gie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(t){const{inputs:e,backend:n}=t,{indices:r,values:o,denseShape:s,defaultValue:i}=e;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,c=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values[0],[d,h,f,p,m]=mF(a,r.shape,r.dtype,l,o.dtype,c,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],o.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const qie={kernelName:l1,backendName:"cpu",kernelFunc:Kie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xie(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:o,newShape:s}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${o.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const i=Array.from(n.data.get(o.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(s.dataId).values),[c,u,d]=gF(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],s.dtype,new Int32Array(d))]}const Yie={kernelName:c1,backendName:"cpu",kernelFunc:Xie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zie(t){const{inputs:e,backend:n}=t,{data:r,indices:o,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(o.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values,[c,u]=iC(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(u,r.dtype,c)}const Jie={kernelName:u1,backendName:"cpu",kernelFunc:Zie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qie(t){const{inputs:e,backend:n}=t,{data:r,indices:o,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(o.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values,[c,u]=iC(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(u,r.dtype,c)}const eae={kernelName:d1,backendName:"cpu",kernelFunc:Qie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tae(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:o,sparseValues:s,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Fh(s,o,a),f=!1,p=n.bufferSync(o);let m;switch(s.dtype){case"bool":{const g=n.bufferSync(s),b=Boolean(n.data.get(i.dataId).values[0]);m=Yl(p,g,a,h,u,c,l,d,b,f);break}case"float32":{const g=n.bufferSync(s),b=n.data.get(i.dataId).values[0];m=Yl(p,g,a,h,u,c,l,d,b,f);break}case"int32":{const g=n.bufferSync(s),b=n.data.get(i.dataId).values[0];m=Yl(p,g,a,h,u,c,l,d,b,f);break}case"string":{const g=n.bufferSync(s),b=Wi(n.data.get(i.dataId).values[0]);m=Yl(p,g,a,h,u,c,l,d,b,f);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const nae={kernelName:_R,backendName:"cpu",kernelFunc:tae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rae(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{numOrSizeSplits:s,axis:i}=r,a=Ct(i,o.shape)[0],l=Aw(o,s,a),c=new Array(o.shape.length).fill(0),u=o.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=dl({inputs:{x:o},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const oae={kernelName:Lg,backendName:"cpu",kernelFunc:rae};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sae={kernelName:h1,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;Ke(n,"square");const o=r.data.get(n.dataId).values,s=new Float32Array(o.length);for(let a=0;a<o.length;++a){const l=o[a];s[a]=l*l}return{dataId:r.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iae=zt(Dh,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),aae={kernelName:Dh,backendName:"cpu",kernelFunc:iae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lae(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{begin:s,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r;Ke(o,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:b,begin:v,end:w,strides:y}=_1(o.shape,s,i,a,l,c,u,d,h);let C;if(m)C=Jt({inputs:{x:o},backend:n,attrs:{shape:p}});else if(g||b){D(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);const S=E1(v,w,y),$=dl({inputs:{x:o},backend:n,attrs:{begin:v,size:S}});C=Jt({inputs:{x:$},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo($)}else{const S=n.bufferSync(o),$=vF(f,S,y,v);C=n.makeTensorInfo(p,$.dtype,$.values)}return C}const cae={kernelName:f1,backendName:"cpu",kernelFunc:lae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uae(t){const{inputs:e,backend:n,attrs:r}=t,{separator:o,nGramWidths:s,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,m]=xF(h,f,o,s,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const dae={kernelName:p1,backendName:"cpu",kernelFunc:uae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hae(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:o}=r,{input:s,delimiter:i}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,d]=yF(a,l,o),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const fae={kernelName:m1,backendName:"cpu",kernelFunc:hae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pae(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:o}=r,{input:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(s.dataId).values,a=wF(i,o);return n.makeTensorInfo(s.shape,"int32",a)}const mae={kernelName:g1,backendName:"cpu",kernelFunc:pae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gae=zt(Nh,t=>Math.tan(t)),bae={kernelName:Nh,backendName:"cpu",kernelFunc:gae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vae=zt(_h,t=>Math.tanh(t)),xae={kernelName:_h,backendName:"cpu",kernelFunc:vae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yae(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reps:s}=r;Ke(o,"tile");const i=$F(n.bufferSync(o),s);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const wae={kernelName:Ah,backendName:"cpu",kernelFunc:yae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cae(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{k:s,sorted:i}=r;Ke(o,"topk");const a=n.data.get(o.dataId).values,[l,c]=IF(a,o.shape,o.dtype,s,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const $ae={kernelName:b1,backendName:"cpu",kernelFunc:Cae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(t){const{inputs:e,attrs:n,backend:r}=t,{image:o,transforms:s}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=o.shape,[p,m]=c!=null?c:[d,h],g=[u,p,m,f],b=tt(o.shape),v=b[0],w=b[1],y=b[2],C=tt(g),S=C[0],$=C[1],I=C[2],R=sr(o.dtype,me(g));R.fill(l);const T=r.data.get(o.dataId).values,N=r.data.get(s.dataId).values;for(let P=0;P<u;++P){const z=s.shape[0]===1?N:N.subarray(P*8,P*8+8);for(let L=0;L<p;++L)for(let O=0;O<m;++O)for(let B=0;B<f;++B){let U;const Q=z[6]*O+z[7]*L+1;if(Q===0)continue;const se=(z[0]*O+z[1]*L+z[2])/Q,ce=(z[3]*O+z[4]*L+z[5])/Q,de=$k(se,h,a),we=$k(ce,d,a);switch(i){case"nearest":U=Nae(T,d,h,v,w,y,P,we,de,B,l);break;case"bilinear":U=_ae(T,d,h,v,w,y,P,we,de,B,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const Ie=P*S+L*$+O*I+B;R[Ie]=U}return r.makeTensorInfo(g,o.dtype,R)}return{dataId:r.write(R,g,o.dtype),shape:o.shape,dtype:o.dtype}}const Iae={kernelName:v1,backendName:"cpu",kernelFunc:Sae};function $k(t,e,n){switch(n){case"reflect":return kae(t,e);case"wrap":return Tae(t,e);case"nearest":return Rae(t,e);case"constant":default:return Eae(t)}}function kae(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return Ja(0,n,e-1)}function Tae(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return Ja(0,n,e-1)}function Eae(t,e){return t}function Rae(t,e){return Ja(0,t,e-1)}function Au(t,e,n,r,o,s,i,a,l,c,u){const d=i*r+a*o+l*s+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function Nae(t,e,n,r,o,s,i,a,l,c,u){const d=Math.round(a),h=Math.round(l);return Au(t,e,n,r,o,s,i,d,h,c,u)}function _ae(t,e,n,r,o,s,i,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*Au(t,e,n,r,o,s,i,d,h,c,u)+(l-h)*Au(t,e,n,r,o,s,i,d,p,c,u),g=(p-l)*Au(t,e,n,r,o,s,i,f,h,c,u)+(l-h)*Au(t,e,n,r,o,s,i,f,p,c,u);return(f-a)*m+(a-d)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aae(t){const{inputs:e,attrs:n,backend:r}=t,{axis:o}=n,{x:s}=e;Ke(s,"unique");const i=r.data.get(s.dataId).values,{outputValues:a,outputShape:l,indices:c}=kF(i,o,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}const Dae={kernelName:x1,backendName:"cpu",kernelFunc:Aae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fae(t){const{inputs:e,backend:n,attrs:r}=t,{value:o}=e;let{axis:s}=r;s<0&&(s+=o.shape.length);const i=o.shape.length,a=o.shape[s],l=new Array(i-1);let c=0;for(let f=0;f<i;f++)f!==s&&(l[c++]=o.shape[f]);const u=new Array(i).fill(0),d=o.shape.slice();d[s]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[s]=f;const p=dl({inputs:{x:o},backend:n,attrs:{begin:u,size:d}});h[f]=Jt({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const Oae={kernelName:zg,backendName:"cpu",kernelFunc:Fae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pae(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,segmentIds:s}=e,{numSegments:i}=r;Ke(o,"unsortedSegmentSum");const a=o.shape.length,l=s.shape.length,c=[],u=[],d=a-l;let h=s;for(let p=0;p<d;++p){const m=im({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,u.push(m)}for(let p=0;p<i;++p){const m=Ji(p,"int32"),g=n.makeTensorInfo([],"int32",m),b=UD({inputs:{a:g,b:h},backend:n}),v=Ki({inputs:{x:b},backend:n,attrs:{dtype:"float32"}}),w=gb({inputs:{a:v,b:o},backend:n}),y=Zh({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});c.push(y),u.push(g),u.push(b),u.push(v),u.push(w),u.push(y)}const f=WF({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const Mae={kernelName:Wg,backendName:"cpu",kernelFunc:Pae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lae=[Dne,xte,One,Mne,Ite,Bne,Wne,Une,Gne,Kne,Xne,Zne,Qne,nre,ore,are,cre,dre,fre,_ne,mre,bre,xre,wre,$te,Tte,$re,yte,Ire,Tre,Ere,Nre,Are,Fre,Pre,Lre,zre,Vre,Hre,jre,qre,Yre,Jre,Qre,toe,roe,soe,ioe,aoe,loe,doe,Sne,foe,Ete,woe,Rte,Coe,_te,Eoe,Roe,_oe,Dte,Foe,Poe,Loe,zoe,Voe,Ote,Mte,wte,Hoe,kre,joe,qoe,Yoe,Ine,Bte,Wte,Joe,Ute,ese,rse,sse,lse,use,hse,fse,Gte,mse,bse,xse,wse,$se,Ise,Tse,Kte,Rse,Ase,Ose,Xte,Zte,Lse,Wse,Hse,Qte,jse,qse,Xse,VF,Qse,Tne,nne,tie,rie,sie,aie,Cte,n0,cie,Ene,Rne,Nne,die,fie,mie,bie,xie,yie,Cie,une,Sie,Rie,_ie,Oie,hne,Mie,Bie,Wie,fne,Dse,Hie,jie,qie,Yie,Jie,eae,nae,oae,gne,sae,vne,aae,cae,dae,fae,mae,Cne,coe,bae,xae,wae,$ae,Iae,ene,Dae,Oae,Mae,Kse];for(const t of Lae)DR(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ta={},ep={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Bae(t,e){Ta[t]=e}function is(t,e){if(!(t in Ta)||e!=null){const r=Wae(t,e);if(r!==null)Ta[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Ta[t];return n==null||n.isContextLost()?(delete Ta[t],is(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ta[t])}function zae(t){if(typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Wae(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e==null?zae(t):e;return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Ta[t]},!1),ue().getBool("SOFTWARE_WEBGL_ENABLED")&&(ep.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",ep)||n.getContext("experimental-webgl",ep):n.getContext("webgl2",ep)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wd;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(wd||(wd={}));var lo;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(lo||(lo={}));var rr;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(rr||(rr={}));function Jh(t,e){return[e,t]}function Vae(t,e){return t*e}function tp(t){const e=me(t),n=Math.ceil(e/4);return wx(n)}function tu(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Uae(t,e){const[n,r]=tu(t,e);return n*r*4}function dC(t,e){const n=t;let r,o,s,i,a,l,c,u,d,h;return ue().getNumber("WEBGL_VERSION")===2?(r=n.R32F,o=n.R16F,s=n.RGBA16F,i=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=t.RGBA,o=t.RGBA,s=t.RGBA,i=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(t,e){const n=e();return ue().getBool("DEBUG")&&Hae(t),n}function Hae(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+qae(t,e))}const Gae=596e-10,jae=65504;function Kae(t){return!!(ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||Gae<Math.abs(t)&&Math.abs(t)<jae)}function qae(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function np(t,e){return di(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Xae(t,e){const n=di(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ue(t,()=>t.shaderSource(n,e)),Ue(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Yae(t,e){const n=di(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ue(t,()=>t.shaderSource(n,e)),Ue(t,()=>t.compileShader(n)),ue().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw UF(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Zae=/ERROR: [0-9]+:([0-9]+):/g;function UF(t,e){const n=Zae.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],o=t.split(`
`),s=o.length.toString().length+2,i=o.map((d,h)=>nc((h+1).toString(),s)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,r-1),c=i.slice(r-1,r),u=i.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${nc(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function Jae(t){return di(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function Qae(t,e){if(Ue(t,()=>t.linkProgram(e)),!ue().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Iv(t,e){if(Ue(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function ele(t,e){const n=di(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Ue(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function tle(t,e){const n=di(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ue(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Ue(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function nle(t){return di(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function rle(t,e){const n=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,o=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+o+".")}}function ole(t){return di(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function Sk(t,e,n,r,o,s,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(Ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),Ue(t,()=>t.vertexAttribPointer(a,o,t.FLOAT,!1,s,i)),Ue(t,()=>t.enableVertexAttribArray(a)),!0)}function sle(t,e,n){ule(t,n),Ue(t,()=>t.activeTexture(t.TEXTURE0+n)),Ue(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function ile(t,e,n){return di(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function ale(t,e,n){return t.getUniformLocation(e,n)}function lle(t,e,n,r){Ue(t,()=>sle(t,e,r)),Ue(t,()=>t.uniform1i(n,r))}function kv(t,e,n){Ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function Ik(t,e){Ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function rp(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+cle(t,e))}function cle(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function di(t,e,n){const r=Ue(t,()=>e());if(r==null)throw new Error(n);return r}function ule(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const o=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${o}.`)}}function Ec(t,e=2){return me(t.slice(0,t.length-e))}function Rc(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function op(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Ec(t),...Rc(t)]),e}function dle(t,e=!1){let n=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ue().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&ue().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?Ty(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Zi(t).newShape);let o=me(t),s=null;t.length<=1&&o<=n?s=[1,o]:t.length===2&&t[0]<=n&&t[1]<=n?s=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?s=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?s=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?s=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(s=[t[0],t[1]*t[2]*t[3]]);const i=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(e?2:1)&&Math.min(...s)>0;if(s==null||i)if(e){const a=Ec(t);let l=2,c=2;t.length&&([l,c]=Rc(t)),o=a*(l/2)*(c/2),s=wx(o).map(u=>u*2)}else s=wx(o);return s}function sp(t){return t%2===0}function lm(t,e){if(t=t.slice(-2),e=e.slice(-2),Bt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r||sp(n)&&sp(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&sp(t[0])&&sp(e[0])}let Tv,Ev;function hle(t){if(Tv==null){const e=is(t);Tv=e.getParameter(e.MAX_TEXTURE_SIZE)}return Tv}function fle(t){if(Ev==null){const e=is(t);Ev=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Ev)}function ple(t){if(t===0)return 0;let e;const n=is(t);return _o(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:_o(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function _o(t,e){return t.getExtension(e)!=null}function kk(t){try{if(is(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function mle(t){if(t===0)return!1;const e=is(t);if(t===1){if(!_o(e,"OES_texture_float"))return!1}else if(!_o(e,"EXT_color_buffer_float"))return!1;return o0(e)}function gle(t){if(t===0)return!1;const e=is(t);if(t===1){if(!_o(e,"OES_texture_float")||!_o(e,"WEBGL_color_buffer_float"))return!1}else{if(_o(e,"EXT_color_buffer_float"))return o0(e);const r="EXT_color_buffer_half_float";if(_o(e,r)){const o=e.getExtension(r);return ble(e,o)}return!1}return o0(e)}function o0(t){const e=dC(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=1,o=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,r,o,0,e.textureFormatFloat,e.textureTypeFloat,null);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(s),i}function ble(t,e){const n=dC(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const o=1,s=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,o,s,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}function vle(t){return t!==2?!1:is(t).fenceSync!=null}function Qh(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ze=ue();Ze.registerFlag("HAS_WEBGL",()=>Ze.getNumber("WEBGL_VERSION")>0);Ze.registerFlag("WEBGL_VERSION",()=>kk(2)?2:kk(1)?1:0);Ze.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ze.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ze.get("WEBGL_VERSION")===2);Ze.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ze.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ze.registerFlag("WEBGL_PACK",()=>Ze.getBool("HAS_WEBGL"));Ze.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_CLIP",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_REDUCE",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_CONV_IM2COL",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>hle(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>fle(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ze.getNumber("WEBGL_VERSION");return t===0?0:ple(t)});Ze.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ze.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!GR());Ze.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>mle(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ze.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ze.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ze.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>gle(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_FENCE_API_ENABLED",()=>vle(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ze.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ze.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ze.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>GR()?1:-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ze.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ze.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ze.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ze.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ze.registerFlag("WEBGL_EXP_CONV",()=>!1);Ze.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ze.getBool("IS_TEST"));Ze.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ze.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ze.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ze.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Er(){let t,e,n,r,o,s,i,a,l,c;return ue().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",o="texture",s="outputColor",i="out vec4 outputColor;",a=ue().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",o="texture2D",s="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:o,output:s,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Il(t,e,n="index"){const r=tt(e);return r.map((o,s)=>{const i=`int ${t[s]} = ${n} / ${o}`,a=s===r.length-1?`int ${t[s+1]} = ${n} - ${t[s]} * ${o}`:`index -= ${t[s]} * ${o}`;return`${i}; ${a};`}).join("")}function bb(t,e,n="index"){const r=tt(e);return r.map((o,s)=>{const i=`int ${t[s]} = ${n} / outShapeStrides[${s}]`,a=s===r.length-1?`int ${t[s+1]} = ${n} - ${t[s]} * outShapeStrides[${s}]`:`index -= ${t[s]} * outShapeStrides[${s}]`;return`${i}; ${a};`}).join("")}function xle(t,e){const n=t.length,r=t.map(s=>`${e}[${s}]`),o=new Array(n-1);o[n-2]=r[n-1];for(let s=n-3;s>=0;--s)o[s]=`(${o[s+1]} * ${r[s+1]})`;return o}function yle(t,e,n="index"){const r=t.map((s,i)=>i),o=xle(r,e);return o.map((s,i)=>{const a=`int ${t[i]} = ${n} / ${o[i]}`,l=i===o.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${o[i]}`:`index -= ${t[i]} * ${o[i]}`;return`${a}; ${l};`}).join("")}function hC(t){const e=tt(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function fC(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const HF=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:GF}=vZ;function wle(t,e,n){const r=[];if(t.forEach(f=>{const p=me(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=pC(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const o=r.join(`
`),s=t.map(f=>Cle(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=Er(),l=Ile(a);let c,u,d=Ele(a);return e.isPacked?(c=$le(e.logicalShape,i,n.enableShapeUniforms),u=Tle(a)):(c=Sle(e.logicalShape,i,n.enableShapeUniforms),u=kle(a)),n.packedInputs&&(d+=Ale),[d,l,u,o,c,s,n.userCode].join(`
`)}function nu(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return Hle(t,e);case 1:return jle(t,e);case 2:return qle(t,e);case 3:return Yle(t,e);case 4:return Jle(t,e);case 5:return Qle(t);case 6:return ece(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function jF(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return Ule(t);case 1:return Gle(t,e);case 2:return Kle(t,e);case 3:return Xle(t,e);default:return Zle(t,e)}}function Cle(t,e,n=!1,r){let o="";n?o+=jF(t,r):o+=nu(t,r);const s=t.shapeInfo.logicalShape,i=e.logicalShape;return s.length<=i.length&&(n?o+=tce(t,e):o+=nce(t,e)),o}function $le(t,e,n){switch(t.length){case 0:return KF();case 1:return Dle(t,e,n);case 2:return Wle(t,e,n);case 3:return Ole(t,e,n);default:return Mle(t,e,n)}}function Sle(t,e,n){switch(t.length){case 0:return KF();case 1:return Fle(t,e,n);case 2:return Vle(t,e,n);case 3:return Ple(t,e,n);case 4:return Lle(t,e,n);case 5:return Ble(t,e);case 6:return zle(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Ile(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function kle(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Tle(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Ele(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Rle}
    ${Nle}
    ${_le}
  `}const Rle=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Nle=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_le=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Ale=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function KF(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Dle(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Fle(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Ole(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(t[2]/2),s=o*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function Ple(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${bb(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=Il(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Mle(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(t[t.length-1]/2),s=o*Math.ceil(t[t.length-2]/2);let i=s,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)i*=t[t.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${t.length}(${l});
    }
  `}function Lle(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${bb(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Il(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Ble(t,e){const n=Il(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function zle(t,e){const n=Il(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Wle(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Bt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const o=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function Vle(t,e,n){return Bt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function kl(t){return`offset${t}`}function Ule(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Er();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Hle(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[o,s]=t.shapeInfo.texShape;if(o===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=kl(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function Gle(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t.shapeInfo.texShape,s=Er();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${s.texture2D}(${n}, uv);
    }
  `}function jle(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${ru(t)}
      }
    `;const o=t.shapeInfo.texShape,s=o[0],i=o[1];if(i===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=kl(n);return i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${s}.0);
        return sampleTexture(${n}, uv);
      }
    `:s===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function Kle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,i=s[0],a=s[1],l=Er();if(s!=null&&Bt(n,s))return e?`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${o}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function qle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape;if(s!=null&&Bt(n,s)){if(e)return`
      float ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=s[0],f=s[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:i,keptDims:a}=Zi(n),l=i;if(l.length<n.length){const h=ou(t,l),f=["row","col"];return`
      ${nu(h,e)}
      float ${o}(int row, int col) {
        return ${o}(${su(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${ru(t)}
      }
    `;const c=s[0],u=s[1],d=kl(r);return u===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${o}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function Xle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=ou(t,h),m=["b","row","col"];return`
        ${jF(p,e)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${su(m,f)});
        }
      `}const a=Er();if(e)return`
    vec4 ${o}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=i[0],c=i[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function Yle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=Zi(n),c=a;if(c.length<n.length){const m=ou(t,c),g=["row","col","depth"];return`
        ${nu(m,e)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${su(g,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${i}, 1)));
        ${ru(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===s&&f==null)return e?`
      float ${o}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===i&&f==null)return e?`
      float ${o}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=kl(r);return e?`
    float ${o}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Zle(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=Er();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${o.texture2D}(${n}, uv);
    }
  `;const s=t.shapeInfo.logicalShape,i=s.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(s[i-1]/2);let h=d*Math.ceil(s[i-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,h*=s[i-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${r}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${o.texture2D}(${n}, uv);
    }
  `}function Jle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],i=n[2]*s,a=n[1]*i,{newShape:l,keptDims:c}=Zi(n);if(l.length<n.length){const v=ou(t,l),w=["row","col","depth","depth2"];return`
      ${nu(v,e)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${su(w,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${s}, 1)));
        ${ru(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===s&&u==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const b=kl(r);return e?`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${b});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${b});
      return sampleTexture(${r}, uv);
    }
  `}function Qle(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e[4],s=e[3]*o,i=e[2]*s,a=e[1]*i,{newShape:l,keptDims:c}=Zi(e);if(l.length<e.length){const m=ou(t,l),g=["row","col","depth","depth2","depth3"];return`
      ${nu(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${su(g,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${s}, ${o})) +
          depth3;
        ${ru(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${s}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===o&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=kl(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${s} +
          depth2 * ${o} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function ece(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:o,keptDims:s}=Zi(e);if(o.length<e.length){const g=ou(t,o),b=["row","col","depth","depth2","depth3","depth4"];return`
      ${nu(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${su(b,s)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${ru(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=kl(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function ru(t){const e=t.name,n=me(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function tce(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",s=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=GF(t.shapeInfo.logicalShape,e.logicalShape),l=Qt(i),c=i-s;let u;const d=["x","y","z","w","u","v"];s===0?u="":i<2&&a.length>=1?u="coords = 0;":u=a.map(v=>`coords.${d[v+c]} = 0;`).join(`
`);let h="";i<2&&s>0?h="coords":h=t.shapeInfo.logicalShape.map((v,w)=>`coords.${d[w+c]}`).join(", ");let f="return outputValue;";const m=me(t.shapeInfo.logicalShape)===1,b=me(e.logicalShape)===1;if(s===1&&!m&&!b)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!b)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const v=s-2,w=s-1;a.indexOf(v)>-1&&a.indexOf(w)>-1?f="return vec4(outputValue.x);":a.indexOf(v)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(w)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${o}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${h});
      ${f}
    }
  `}function nce(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",s=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Bt(i,s))return`
      float ${o}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=Qt(l),u=GF(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+d]}`).join(", "),`
    float ${o}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${r}(${p});
    }
  `}function Qt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function pC(t,e,n){const{newShape:r,keptDims:o}=Zi(e),s=e.length,i=t&&s===3&&e[0]===1,a=i?e.slice(1):r,l=!t&&s>1&&!Bt(e,n)&&r.length<s||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:o}}function ou(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function su(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(t,e,n,r){const o=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),s=o.map(u=>u.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=wle(o,i,e),l=Yae(t.gl,a),c=t.createProgram(l);return ue().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:s,outShapeInfo:i,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:s,outShapeInfo:i},qF(t,e,c))}function qF(t,e,n){const r={},o={},s={},i=[];let a,l,c,u=null,d=null;d=t.getUniformLocation(n,"NAN",!1),ue().getNumber("WEBGL_VERSION")===1&&(u=t.getUniformLocation(n,"INFINITY",!1));const h=!1;for(let f=0;f<e.variableNames.length;f++){const p=e.variableNames[f];r[p]=t.getUniformLocation(n,p,h),r[`offset${p}`]=t.getUniformLocation(n,`offset${p}`,h),e.enableShapeUniforms&&(o[`${p}Shape`]=t.getUniformLocation(n,`${p}Shape`,h),s[`${p}TexShape`]=t.getUniformLocation(n,`${p}TexShape`,h))}return e.enableShapeUniforms&&(a=t.getUniformLocation(n,"outShape",h),c=t.getUniformLocation(n,"outShapeStrides",h),l=t.getUniformLocation(n,"outTexShape",h)),e.customUniforms&&e.customUniforms.forEach((f,p)=>{i[p]=t.getUniformLocation(n,f.name,h)}),{uniformLocations:r,customUniformLocations:i,infLoc:u,nanLoc:d,inShapesLocations:o,inTexShapesLocations:s,outShapeLocation:a,outShapeStridesLocation:c,outTexShapeLocation:l}}function Tk(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const o=n.logicalShape,s=e[r],i=s.shape;if(!Bt(o,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${o} and ${i} must match`);if(n.isUniform&&s.isUniform)return;const a=n.texShape,l=s.isUniform?null:s.texData.texShape;if(!Bt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function oce(t,e,n,r,o){e.program.enableShapeUniforms||(Tk(e.inShapeInfos,n),Tk([e.outShapeInfo],[r]));const s=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(s.texture,i[0],i[1]):t.setOutputMatrixTexture(s.texture,i[0],i[1]),t.setProgram(e.webGLProgram),ue().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((l,c)=>{const u=e.program.variableNames[c],d=e.uniformLocations[u],h=e.uniformLocations[`offset${u}`],f=e.inShapesLocations[`${u}Shape`],p=e.inTexShapesLocations[`${u}TexShape`];if(f){const{uniformShape:m}=pC(e.program.packedInputs,l.shape,l.texData.texShape);switch(m.length){case 1:t.gl.uniform1iv(f,new Int32Array(m));break;case 2:t.gl.uniform2iv(f,new Int32Array(m));break;case 3:t.gl.uniform3iv(f,new Int32Array(m));break;case 4:t.gl.uniform4iv(f,new Int32Array(m));break}}if(p&&t.gl.uniform2i(p,l.texData.texShape[0],l.texData.texShape[1]),d!=null){if(l.isUniform){if(me(l.shape)<2)t.gl.uniform1f(d,l.uniformValues[0]);else{let m=l.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),t.gl.uniform1fv(d,m)}return}l.texData.slice!=null&&h!=null&&t.gl.uniform1i(h,l.texData.slice.flatOffset),t.setInputMatrixTexture(l.texData.texture.texture,d,c)}});const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=tt(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&o&&e.program.customUniforms.forEach((l,c)=>{const u=e.customUniformLocations[c],d=o[c];if(l.type==="float")t.gl.uniform1fv(u,d);else if(l.type==="vec2")t.gl.uniform2fv(u,d);else if(l.type==="vec3")t.gl.uniform3fv(u,d);else if(l.type==="vec4")t.gl.uniform4fv(u,d);else if(l.type==="int")t.gl.uniform1iv(u,d);else if(l.type==="ivec2")t.gl.uniform2iv(u,d);else if(l.type==="ivec3")t.gl.uniform3iv(u,d);else if(l.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${l.type} is not supported yet.`)}),t.executeProgram()}function sce(t,e,n){let r="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=pC(t.packedInputs,i.shape,l);let h="",f="",p="";if(u.length===1&&t.packedInputs){const C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${C[0]>1}_${C[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const C=tt(u);p=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}const m=i.shape.length,g=u.length===2&&Bt(i.shape,l),b=me(i.shape)===1,v=wc(i.shape,n.shape),w=!t.packedInputs&&m===n.shape.length&&Bt(l,n.texData.texShape),y=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${w}_${c?d:""}_${u.length}_${b}_${v}_${g}_${h}_${f}_${p}_${y}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${a}`}});const o=t.userCode;let s=t.constructor.name;return s+="_"+r+"_"+o+`${ue().getNumber("WEBGL_VERSION")}`,s}function Rr(t){return ue().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ice{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=wd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Er();this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?bb(["r","c","d"],e):Il(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ace{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=wd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Er();this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?bb(["r","c","d"],e):Il(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lce{constructor(e){this.variableNames=["A"],this.outTexUsage=lo.DOWNLOAD;const n=Er();this.outputShape=e,this.userCode=`
      ${HF}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cce{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=lo.DOWNLOAD;const n=Er();this.outputShape=e,this.userCode=`
      ${HF}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uce={R:0,G:1,B:2,A:3};class Ek{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const o=Er();this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length);let s="result";n&&(s="floor(result * 255. + 0.5)");let i="";for(let a=0;a<r.length;a++){const l=r[a];i+=`
          if(offset == ${a}) {
            result = values[${uce[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?fC():hC(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${o.texture2D}(A, uv);
          ${i}
        }
        ${o.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dce{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Er();this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length);let o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;o+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?fC():hC(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${o}

          ${r.output} = ${s};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(t){const e=Er(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Xae(t,n)}function fce(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return ele(t,e)}function pce(t){const e=new Uint16Array([0,1,2,2,1,3]);return tle(t,e)}function ef(t,e,n,r,o,s){rle(e,n);const i=nle(t),a=t.TEXTURE_2D;return Ue(t,()=>t.bindTexture(a,i)),Ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Ue(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),Ue(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),ue().getNumber("WEBGL_VERSION")===1?Ue(t,()=>t.texImage2D(a,0,r,e,n,0,o,s,null)):Ue(t,()=>t.texStorage2D(a,1,r,e,n)),Ue(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function XF(t){return t.internalFormatFloat}function mce(t,e,n,r){const[o,s]=Jh(e,n);return ef(t,o,s,XF(r),r.textureFormatFloat,t.FLOAT)}function YF(t){return t.internalFormatHalfFloat}function gce(t,e,n,r){const[o,s]=Jh(e,n);return ef(t,o,s,YF(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function ZF(t){return t.downloadTextureFormat}function bce(t,e,n,r){const[o,s]=Jh(e,n);return ef(t,o,s,ZF(r),t.RGBA,t.UNSIGNED_BYTE)}function JF(t){return t.internalFormatPackedFloat}function vce(t,e,n,r){const[o,s]=tu(e,n);return ef(t,o,s,JF(r),t.RGBA,t.FLOAT)}function QF(t){return t.internalFormatPackedHalfFloat}function xce(t,e,n,r){const[o,s]=tu(e,n);return ef(t,o,s,QF(r),t.RGBA,r.textureTypeHalfFloat)}function yce(t,e,n){return Ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Sk(t,e,"clipSpacePos",n,3,20,0)&&Sk(t,e,"uv",n,2,20,12)}function wce(t,e,n,r,o,s){Ue(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;o instanceof Uint8Array?(i=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*r*4),a=t.FLOAT,l=s.internalFormatPackedFloat),i.set(o),ue().getNumber("WEBGL_VERSION")===2?Ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,i)):Ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,i)),Ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Cce(t,e,n){Ue(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?ue().getNumber("WEBGL_VERSION")===2?Ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):ue().getNumber("WEBGL_VERSION")===2?Ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function $ce(t,e,n,r){const o=t.createBuffer();Ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,o));const a=4*4*e*n;return Ue(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),Ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),o}function Sce(t,e,n){const r=t,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function Ice(t,e,n,r){const[o,s]=Jh(e,n),i=4,a=new Uint8Array(Vae(e*n,i));return Ue(t,()=>t.readPixels(0,0,o,s,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function kce(t,e,n,r,o,s,i,a){const l=t,c=new Float32Array(Uae(s,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Tce(t,e,n){const r=new Float32Array(e*n*4);return Ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rv{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=ue().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Bae(n,e)):this.gl=is(n),e=this.gl,ue().getNumber("WEBGL_VERSION")===2){const s=e;this.createVertexArray=()=>Ue(s,()=>s.createVertexArray()),this.bindVertexArray=i=>Ue(s,()=>s.bindVertexArray(i)),this.deleteVertexArray=i=>Ue(s,()=>s.deleteVertexArray(i)),this.getVertexArray=()=>Ue(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(e!=null){const s=e.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ue(e,()=>s.createVertexArrayOES()),this.bindVertexArray=i=>Ue(e,()=>s.bindVertexArrayOES(i)),this.deleteVertexArray=i=>Ue(e,()=>s.deleteVertexArrayOES(i)),this.getVertexArray=()=>Ue(e,()=>e.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ue().getNumber("WEBGL_VERSION")===1){const s="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=np(this.gl,s),_o(this.gl,i))this.textureHalfFloatExtension=np(this.gl,i);else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),_o(this.gl,o))this.colorBufferHalfFloatExtension=np(this.gl,o);else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",_o(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(_o(this.gl,o))this.colorBufferHalfFloatExtension=this.gl.getExtension(o);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=fce(this.gl),this.indexBuffer=pce(this.gl),this.framebuffer=ole(this.gl),this.textureConfig=dC(this.gl,this.textureHalfFloatExtension)}get debug(){return ue().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ue(e,()=>e.finish()),Ue(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ue(e,()=>e.deleteFramebuffer(this.framebuffer)),Ue(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ue(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ue(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),mce(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),gce(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),bce(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Cce(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,o){this.throwIfDisposed(),wce(this.gl,e,n,r,o,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),xce(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),vce(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(Ik(this.gl,this.framebuffer),this.outputTexture=null),Ue(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Ice(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,o,s,i){return kce(this.gl,e,n,r,o,s,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Sce(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const o=$ce(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(ue().getBool("WEBGL_FENCE_API_ENABLED")){const o=e,s=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const i=o.clientWaitSync(s,0,0);return i===o.ALREADY_SIGNALED||i===o.CONDITION_SATISFIED},n=s}else ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Tce(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=hce(n));const r=Jae(n);Ue(n,()=>n.attachShader(r,this.vertexShader)),Ue(n,()=>n.attachShader(r,e)),Qae(n,r);let o;return o=Object.assign(r,{vao:this.createVertexArray()}),this.bindVertexArray(o.vao),Ue(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),console.assert(yce(n,o,this.vertexBuffer),"gpgpu_util.bindVertexProgramAttributeStreams not fully successful."),this.debug&&Iv(n,o),this.setProgram(o),o}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ue(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&(this.bindVertexArray(this.program.vao),this.debug&&Iv(this.gl,this.program)),Ue(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?ile(this.gl,e,n):ale(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Ue(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),lle(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[o,s]=tu(n,r);this.setOutputMatrixTextureDriver(e,o,s)}setOutputMatrixWriteRegion(e,n,r,o){this.setOutputMatrixWriteRegionDriver(r,e,o,n)}setOutputPackedMatrixWriteRegion(e,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Iv(this.gl,this.program),rp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ue(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ue(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=np(this.gl,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,o=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(o.TIME_ELAPSED_EXT,s),s}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await hI(()=>this.disposed||this.isQueryAvailable(e,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,o=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),o=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=Ece(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in ue().platform&&(r=ue().platform.setTimeoutCustom.bind(ue().platform)),hI(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),kv(this.gl,e,this.framebuffer),this.debug&&rp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(kv(this.gl,this.outputTexture,this.framebuffer),this.debug&&rp(this.gl)):Ik(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const o=this.gl;kv(o,e,this.framebuffer),this.debug&&rp(o),this.outputTexture=e,Ue(o,()=>o.viewport(0,0,n,r)),Ue(o,()=>o.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,o){this.throwIfDisposed(),Ue(this.gl,()=>this.gl.scissor(e,n,r,o))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Ece(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Rce,bincountImpl:eO,bincountReduceImpl:Nce,castImpl:_ce,ceilImpl:Ace,concatImpl:Dce,equalImpl:Fce,expImpl:Oce,expm1Impl:Pce,floorImpl:Mce,gatherNdImpl:Lce,gatherV2Impl:Bce,greaterImpl:zce,greaterEqualImpl:Wce,lessImpl:Vce,lessEqualImpl:Uce,linSpaceImpl:Hce,logImpl:Gce,maxImpl:jce,maximumImpl:Kce,minimumImpl:qce,multiplyImpl:Xce,negImpl:Yce,notEqualImpl:Zce,prodImpl:Jce,raggedGatherImpl:Qce,raggedRangeImpl:eue,raggedTensorToTensorImpl:tue,rangeImpl:nue,rsqrtImpl:rue,scatterImpl:oue,sigmoidImpl:sue,simpleAbsImpl:tO,sliceImpl:iue,sparseFillEmptyRowsImpl:aue,sparseReshapeImpl:lue,sparseSegmentReductionImpl:nO,sqrtImpl:cue,stridedSliceImpl:uue,stringNGramsImpl:due,stringSplitImpl:hue,stringToHashBucketFastImpl:fue,subImpl:pue,tileImpl:mue,topKImpl:gue,transposeImpl:mC,uniqueImpl:bue}=$ne;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rO(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function $r(t,e){return e===1?[t]:rO(t,e)}function vue(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xue{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Rr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=$r("rc",this.rank),r=Qt(this.rank),o=this.getOutOfBoundsCondition(n),s=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${o}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let o=0;o<=1;o++){let s=`${r===0?"r":"rp1"}, ${o===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)s=`${e[e.length-1-i]},`+s;n.push(s)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],o=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${o};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oO{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length);let r="";for(let o=0;o<4;o++){let s="thisRC = rc;";o%2===1&&(s+="thisRC.z += 1;"),o>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${o>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${o}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${o>0?"}":""}
      `}this.userCode=`
      ${yue(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?fC():hC(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function yue(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?yle(["r","c","d"],"inputShape"):Il(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wue{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,n,r){const o=Nk(n,r),s=_k(e,o,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const i=Rk(e,o,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[s].shift();return this.usedTextures[s].push(l),l}let a;return o===rr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===rr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===rr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===rr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===rr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,r,o){if(this.freeTextures==null)return;const s=Nk(r,o),i=_k(n,s,o);i in this.freeTextures||(this.freeTextures[i]=[]);const a=Rk(n,s,this.gpgpu.gl,this.gpgpu.textureConfig,o),l=ue().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[i],u=c.indexOf(e);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(u,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Cue(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function Rk(t,e,n,r,o){const s=$ue(e,r);let i;if(o){const[l,c]=tu(t[0],t[1]);i=l*c}else{const[l,c]=Jh(t[0],t[1]);i=l*c}const a=Cue(n,s);return i*a}function $ue(t,e){switch(t){case rr.PACKED_2X2_FLOAT32:return JF(e);case rr.PACKED_2X2_FLOAT16:return QF(e);case rr.UNPACKED_FLOAT32:return XF(e);case rr.UNPACKED_FLOAT16:return YF(e);case rr.PACKED_4X1_UNSIGNED_BYTE:return ZF(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Sue(t){return ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?rr.PACKED_2X2_FLOAT32:rr.UNPACKED_FLOAT32:t?rr.PACKED_2X2_FLOAT16:rr.UNPACKED_FLOAT16}function Nk(t,e){if(t===lo.UPLOAD)return rr.PACKED_2X2_FLOAT32;if(t===lo.RENDER||t==null)return Sue(e);if(t===lo.DOWNLOAD||t===lo.PIXELS)return rr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function _k(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ts{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Uo="if (isnan(x)) return x;",Iue="return x;",Ak="return abs(x);",kue="return (x >= 0.0) ? x : (exp(x) - 1.0);",Tue=Uo+`
  return (x < 0.0) ? 0.0 : x;
`,Eue=Uo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,$i="return x;",Rue="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nue="return x;",_ue=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Aue=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Due=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Fue="return 1.0 / (1.0 + exp(-1.0 * x));";class Ei{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oue{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length);const n=e.length,r=$r("rc",n),o=Qt(n),s=vue(n,r),i=r.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pue=ZN,Mue=1e-7,Lue=1e-4,ip={};function Bue(t){return t in ip||(ip[t]={}),ip[t]}const zue=ue().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Wue=600;function Vue(){return ue().global.screen==null?1024:ue().global.screen.height*ue().global.screen.width*window.devicePixelRatio*Wue/1024/1024}class vb extends ky{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ue().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Rv)n=e;else{const r=is(ue().getNumber("WEBGL_VERSION"),e);n=new Rv(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=is(ue().getNumber("WEBGL_VERSION"));n=new Rv(r),this.binaryCache=Bue(ue().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new wue(this.gpgpu),this.numMBBeforeWarning=Vue(),this.texData=new uR(this,bs())}nextDataId(){return vb.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,o,s,i){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[o,s]},l.texShape=[o,s];const c=op(n),u=new Ek(c,!1,i),d=this.runWebGLProgram(u,[a],r,[[o,s]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((ue().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ue().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const o={id:this.nextDataId()};return this.texData.set(o,{shape:n,dtype:r,values:e,usage:lo.UPLOAD,refCount:1}),o}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,o,s){if(ue().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:o,values:n,usage:lo.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:o,complexTensorInfos:s,slice:i,shape:a,isPacked:l}=n;if(i!=null){let h;l?h=new Ei(a,$i):h=new Ts(a,$i);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:o}],o),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(o==="string")return r;const c=this.activeTimers!=null;let u;c&&(u=_r());let d;if(o==="complex64"){const h=this.readSync(s.real.dataId),f=this.readSync(s.imag.dataId);d=ni(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=_r()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:r,shape:o,slice:s,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(s!=null){let p;l?p=new Ei(o,$i):p=new Ts(o,$i);const m=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:i}],i),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(r!=null)return this.convertAndCacheOnCPU(e);if(ue().getBool("DEBUG")&&!ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ue().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(i!=="complex64"&&ue().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...tp(o))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],g=p[1];d=ni(m,g)}else if(c==null)d=this.getValuesFromTexture(e);else{const p=me(o);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;Ue(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&bs().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const r=this.texData.get(e),{values:o,shape:s,slice:i,dtype:a,isPacked:l,texture:c}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;l?f=new Ei(s,$i):f=new Ts(s,$i);const p=this.runWebGLProgram(f,[{dataId:e,shape:s,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw o!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=bs().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(o=>Wi(o));return wt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return wt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!Kae(r))throw ue().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:o}=this.texData.get(e),s=me(n);if(ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...tp(n)).subarray(0,s);return this.disposeIntermediateTensorInfo(h),p}const i=ue().getBool("WEBGL_PACK")&&o===!0,a=i?op(n):n,l=i?new cce(a):new lce(a),c=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let o=!1;this.programTimersStack==null?(this.programTimersStack=r,o=!0):this.activeTimers.push(r),this.activeTimers=r,e();const s=bc(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=bc(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,o&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(s);a.kernelMs=m8(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:i[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:_r(),endMs:null}}endTimer(e){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=_r(),e)}async getQueryTime(e){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:o,usage:s,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(o,r),this.textureManager.releaseTexture(n,o,s,i)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=zue){return ue().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&me(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){ao("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Pue(e.shape,n)}packedUnaryOp(e,n,r){const o=new Ei(e.shape,n),s=this.compileAndRun(o,[e],r);return bs().makeTensorFromTensorInfo(s)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const o=tO(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,o)}if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ak,e.dtype);const n=new Ts(e.shape,Ak),r=this.compileAndRun(n,[e]);return bs().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let o;if(n==="string"&&r!=null&&r.length>0&&Md(r[0])){const s=r.map(i=>Di(i));o=this.write(s,e,n)}else o=this.write(r,e,n);return this.texData.get(o).usage=null,{dataId:o,shape:e,dtype:n}}makeOutput(e,n,r){return bs().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new Oue(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new xue(e.shape),r=!0;return this.runWebGLProgram(n,[e],e.dtype,null,r)}packedReshape(e,n){const r=[Ec(e.shape),...Rc(e.shape)],o={dtype:e.dtype,shape:r,dataId:e.dataId},s=[Ec(n),...Rc(n)],i=new oO(s,r),a=!0,l=[r],c=this.runWebGLProgram(i,[o],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:o,shape:s,dtype:i}=r;if(n!=null){const h=me(s),f=n[0]*n[1]*4;D(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=op(s);let l;o?l=new ace(a):l=new ice(a);const c=!0,u=[n!=null?n:tp(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,u,c,n);return{dtype:i,shape:s,dataId:d.dataId}}runWebGLProgram(e,n,r,o,s=!1,i){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===wd.DENSE){const b=i!=null?i:tp(e.outputShape);l.texShape=b.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),me(a.shape)===0)return l.values=sr(a.dtype,0),a;const c=[],u=n.map(b=>{if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(b.dataId);if(v.texture==null){if(!e.packedInputs&&me(b.shape)<=ue().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=b.shape)}if(this.uploadToGPU(b.dataId),!!v.isPacked!=!!e.packedInputs)b=v.isPacked?this.unpackTensor(b):this.packTensor(b),c.push(b),v=this.texData.get(b.dataId);else if(v.isPacked&&!lm(v.shape,b.shape)){const w=b,y=b.shape;b.shape=v.shape,b=this.packedReshape(b,y),c.push(b),v=this.texData.get(b.dataId),w.shape=y}return{shape:b.shape,texData:v,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=sce(e,u,d),f=this.getAndSaveBinary(h,()=>rce(this.gpgpu,e,u,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),ue().get("ENGINE_COMPILE_ONLY")||oce(this.gpgpu,f,u,d,o),c.forEach(b=>this.disposeIntermediateTensorInfo(b)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const g=ue().get("WEBGL_FLUSH_THRESHOLD");if(g>0){const b=_r();b-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=b)}if(!ue().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){const b=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),b}return a}compileAndRun(e,n,r,o,s=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,o,s)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ue().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ie(()=>{if(!ue().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ue().getBool("DEBUG");ue().set("DEBUG",!1);const n=this.abs(ut(1e-8)).dataSync()[0];if(ue().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Mue:Lue}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:o,values:s,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const c=this.activeTimers!=null;let u;c&&(u=_r());let d=n.texShape;if(d==null&&(d=dle(r,l),n.texShape=d),s!=null){const h=op(r);let f,p=d[1],m=d[0];const g=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(l||!g)&&([p,m]=tu(d[0],d[1])),l?f=new dce(h,g):f=new Ek(h,g);const b=g?[m,p]:d,v=this.makeTensorInfo(b,o),w=this.texData.get(v.dataId);g?w.usage=lo.PIXELS:w.usage=lo.UPLOAD,w.texShape=b,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,m,s);const y=[[m,p]],C=!0,S=this.runWebGLProgram(f,[v],o,y,C),$=this.texData.get(S.dataId);n.texShape=$.texShape,n.isPacked=$.isPacked,n.usage=$.usage,ue().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(n.texture=$.texture,n.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(v),c&&(this.uploadWaitMs+=_r()-u)}else{const h=this.acquireTexture(d,a,o,l);n.texture=h}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:o}=r;return n!=null&&(r.values=Uue(n,o)),r.values}acquireTexture(e,n,r,o){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,o)}computeBytes(e,n){return e[0]*e[1]*Cx(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(o=>{try{this.checkCompletion_(n),o(!0)}catch(s){throw s}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await pw(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(UF(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:n,customUniformLocations:r,infLoc:o,nanLoc:s,inShapesLocations:i,inTexShapesLocations:a,outShapeLocation:l,outShapeStridesLocation:c,outTexShapeLocation:u}=qF(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=n,e.customUniformLocations=r,e.infLoc=o,e.nanLoc=s,e.inShapesLocations=i,e.inTexShapesLocations=a,e.outShapeLocation=l,e.outShapeStridesLocation=c,e.outTexShapeLocation=u}}createTensorFromTexture(e,n,r){const{texture:o,height:s,width:i,channels:a}=e,l=bs().backend;if(!l.gpgpu.gl.isTexture(o))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(o,n,r,s,i,a);return bs().makeTensorFromDataId(c,n,r,l)}}vb.nextDataId=0;function Uue(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */jR()&&iN("webgl",()=>new vb,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gC=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Nc{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=bt(n,r),this.enableShapeUniforms=Rr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tf=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class nf{constructor(e,n,r,o=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=bt(n,r);const s=this.outputShape.length;this.enableShapeUniforms=Rr(s);let i="";if(o)if(s===0||me(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${Qt(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=$r("coords",s);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function to(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Hue={kernelName:sh,backendName:"webgl",kernelFunc:to};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aa(t){const{inputs:e,backend:n}=t,{real:r,imag:o}=e,s=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(s.dataId),a=to({inputs:{x:r},backend:n}),l=to({inputs:{x:o},backend:n});return i.complexTensorInfos={real:a,imag:l},s}const Gue={kernelName:Py,backendName:"webgl",kernelFunc:aa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sO="return (a < 0.) ? b * a : a;",iO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function jue(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{alpha:s}=r,i=n.makeTensorInfo([],"float32",Ji(s,"float32")),a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new nf(iO,o.shape,i.shape):new Nc(sO,o.shape,i.shape),l=n.runWebGLProgram(a,[o,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const Kue={kernelName:cg,backendName:"webgl",kernelFunc:jue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aO="return (a < 0.) ? b * a : a;",lO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function que(t){const{inputs:e,backend:n}=t,{x:r,alpha:o}=e,s=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new nf(lO,r.shape,o.shape):new Nc(aO,r.shape,o.shape);return n.runWebGLProgram(s,[r,o],"float32")}const Xue={kernelName:Eg,backendName:"webgl",kernelFunc:que};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iu="if (isnan(x)) return x;";function _t({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:o,backend:s})=>{const{x:i}=o,a=s,l=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),h=n(d.values,l);return a.makeTensorInfo(i.shape,l,h)}const c=ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Ei(i.shape,e):u=new Ts(i.shape,t),a.runWebGLProgram(u,[i],l)}}function lr({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:o,dtype:s}){return({inputs:i,backend:a})=>{const{a:l,b:c}=i,u=a;if(r&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,b]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(w=>{const[y,C]=w,S={dataId:y.dataId,dtype:y.dtype,shape:l.shape},$={dataId:C.dataId,dtype:C.dtype,shape:c.shape},I=new Nc(t,l.shape,c.shape);return u.runWebGLProgram(I,[S,$],Jr(y.dtype,C.dtype))}),v=aa({inputs:{real:g,imag:b},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(b),v}const d=s||Jr(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&o!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?ll(p):p,b=l.dtype==="string"?ll(m):m,[v,w]=o(l.shape,c.shape,g,b,d),y=u.makeTensorInfo(w,d),C=u.texData.get(y.dataId);return C.values=v,y}const h=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new nf(e,l.shape,c.shape,n):f=new Nc(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function Cd(t,e=!1){if(t==="linear")return e?Nue:Iue;if(t==="relu")return e?Aue:Tue;if(t==="elu")return e?_ue:kue;if(t==="relu6")return e?Due:Eue;if(t==="prelu")return e?lO:aO;if(t==="leakyrelu")return e?iO:sO;if(t==="sigmoid")return e?Fue:Rue;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cO{constructor(e,n,r,o=!1,s=!1,i=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Rr(this.outputShape.length);const u=o?e[1]:e[2],d=Math.ceil(u/2),h=o?"i * 2, rc.y":"rc.y, i * 2",f=s?"rc.z, i * 2":"i * 2, rc.z",p=o?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",b="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,b="result = activation(result);");const v=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let w="rc.x",y="rc.x";e[0]<n[0]?w=`int(min(float(rc.x), ${e[0]-1}.))`:n[0]<e[0]&&(y=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${d}; i++) {
          int batchA = ${w};
          int batchB = ${y};
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${b}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dk={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Fk{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=bt(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ok="return a * b;";function bC(t){const{inputs:e,backend:n}=t,{a:r,b:o}=e,s=Jr(r.dtype,o.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(o.dataId),c=new Fk(Dk.REAL,r.shape,o.shape),u=new Fk(Dk.IMAG,r.shape,o.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:o.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:o.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=aa({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([r,o])){const a=n.texData.get(r.dataId),l=n.texData.get(o.dataId),[c,u]=Xce(r.shape,o.shape,a.values,l.values,s),d=n.makeTensorInfo(u,s),h=n.texData.get(d.dataId);return h.values=c,d}let i;return ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new nf(Ok,r.shape,o.shape):i=new Nc(Ok,r.shape,o.shape),n.runWebGLProgram(i,[r,o],s)}const Yue={kernelName:ph,backendName:"webgl",kernelFunc:bC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(t,e,n){const r=[Ec(t.shape),...Rc(t.shape)],o={dtype:t.dtype,shape:r,dataId:t.dataId},s=[Ec(e),...Rc(e)],i=new oO(s,r),a=!0,l=[r],c=n.runWebGLProgram(i,[o],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ze(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{shape:s}=r,i=n,a=me(o.shape),l=hR(s,a),c=me(l);D(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${o.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=i.texData.get(o.dataId);return u.isPacked&&!lm(o.shape,l)&&!(u.texture!==null&&lm(u.shape,l))?Zue(o,l,i):(i.incRef(o.dataId),{dataId:o.dataId,shape:l,dtype:o.dtype})}const Jue={kernelName:Ng,backendName:"webgl",kernelFunc:ze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pk{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:o,inSize:s,outSize:i}=e;this.outputShape=[o,i];const a=Math.floor(r/4)*4,l=r%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${vc(d)?d.toPrecision(2):d}, ones);`}let u="";s%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Que{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:o,inSize:s,outSize:i}=e;this.outputShape=[o,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(r/4)*4,d=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ede(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=tb(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Tl(t,e,n,r){const o=ede(t.shape);let s=t;for(let i=0;i<o.length;i++){const{inSize:a,windowSize:l,outSize:c}=o[i];let u,d;n==="mean"?u=i===0?new Pk({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new Pk({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new Que({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=s,s=r.runWebGLProgram(u,[s],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tde{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[n[i]];this.outputShape=r,this.rank=r.length;const o=Qt(this.rank),s=nde(n);this.userCode=`
    void main() {
      ${o} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}}function nde(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let o=0;o<t.length;o++)r[t[o]]=n[o];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rde{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let u=0;u<r.length;u++)r[u]=e[n[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const o=Qt(this.rank),s=rO("rc",this.rank),i=new Array(this.rank);for(let u=0;u<n.length;u++)i[n[u]]=s[u];const a=`vec2(${i.slice(-2).join()})`,l=`++${s[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${o} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xb(t,e,n){const r=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rde(t.shape,e):new tde(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ode(t,e,n,r){const o=e,s=t.shape.length,i=Ct(o,t.shape);let a=i;const l=wn(a,s),c=l!=null;let u=t;c&&(u=xb(t,l,r),a=En(a.length,s)),ar("sum",a,s);const[d,h]=er(u.shape,a);let f=d;n&&(f=Tn(d,i));const p=me(h),g=me(t.shape)/p,b=ze({inputs:{x:u},attrs:{shape:[g,p]},backend:r}),v=C1(t.dtype),w=Tl(b,v,"sum",r),y=ze({inputs:{x:w},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(w),c&&r.disposeIntermediateTensorInfo(u),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yb(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r;return ode(o,s,i,n)}const sde={kernelName:Pg,backendName:"webgl",kernelFunc:yb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tr(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{perm:s}=r,i=n,a=o.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=o.shape[s[u]];let c;if(i.shouldExecuteOnCPU([o])){const d=i.texData.get(o.dataId).values,h=mC(d,o.shape,o.dtype,s,l);c=i.makeTensorInfo(l,o.dtype);const f=i.texData.get(c.dataId);f.values=h}else c=xb(o,s,i);return c}const ide={kernelName:rc,backendName:"webgl",kernelFunc:Tr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uO=1e3;function cm({a:t,b:e,transposeA:n,transposeB:r,backend:o,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=r?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=r?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),g=e.shape.slice(0,-2),b=me(m),v=me(g),y=bt(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);D(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const C=n?[b,d,f]:[b,f,d],S=r?[v,p,h]:[v,h,p],$=ze({inputs:{x:t},backend:o,attrs:{shape:C}}),I=ze({inputs:{x:e},backend:o,attrs:{shape:S}}),R=[$,I],T=Math.max(b,v),N=n?$.shape[1]:$.shape[2],_=s!=null,P=i!=null,z=l==="leakyrelu",L=l!=null?Cd(l,!0):null,O=_||P||z||L!=null;let B;if((f===1||p===1)&&N>uO&&O===!1){let Q=$,se=I;n&&(Q=Tr({inputs:{x:$},backend:o,attrs:{perm:[0,2,1]}}),R.push(Q)),r&&(se=Tr({inputs:{x:I},backend:o,attrs:{perm:[0,2,1]}}),R.push(se));const ce=p!==1,de=p===1;let we=Q;ce&&(we=ze({inputs:{x:Q},backend:o,attrs:{shape:[T,N,1]}}),R.push(we));const Ie=p===1?2:1;let j=se;de&&(j=ze({inputs:{x:se},backend:o,attrs:{shape:[T,1,N]}}),R.push(j));const re=bC({inputs:{a:we,b:j},backend:o});B=yb({inputs:{x:re},backend:o,attrs:{axis:Ie,keepDims:!0}}),R.push(re)}else{const Q=Jr(t.dtype,e.dtype),se=new cO(C,S,[T,f,p],n,r,_,L,P,z),ce=[$,I];if(s!=null&&ce.push(s),P&&ce.push(i),z){const de=o.makeTensorInfo([],"float32",Ji(a,"float32"));ce.push(de),R.push(de)}B=o.runWebGLProgram(se,ce,Q)}const U=ze({inputs:{x:B},backend:o,attrs:{shape:y}});R.push(B);for(const Q of R)o.disposeIntermediateTensorInfo(Q);return U}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade(t){const{inputs:e,backend:n,attrs:r}=t,{a:o,b:s,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;return cm({a:o,b:s,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const lde={kernelName:Mp,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mk="return abs(x);";function cde(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const s=n.texData.get(r.dataId),i=tO(s.values);return n.makeTensorInfo(r.shape,r.dtype,i)}let o;return ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new Ei(r.shape,Mk):o=new Ts(r.shape,Mk),n.runWebGLProgram(o,[r],r.dtype)}const ude={kernelName:Um,backendName:"webgl",kernelFunc:cde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dde=Uo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,hde=_t({opSnippet:dde}),fde={kernelName:Bd,backendName:"webgl",kernelFunc:hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pde=Uo+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,mde=_t({opSnippet:pde}),gde={kernelName:zd,backendName:"webgl",kernelFunc:mde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lk="return a + b;",bde=lr({opSnippet:Lk,packedOpSnippet:Lk,supportsComplex:!0,cpuKernelImpl:Rce}),vde={kernelName:qc,backendName:"webgl",kernelFunc:bde};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xde{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((s,i)=>`T${i}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const o=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${o};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yde{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((s,i)=>`T${i}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const o=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${o};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vp(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return to({inputs:{x:r[0]},backend:n});if(r.length>ue().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),c=vp({inputs:r.slice(0,l),backend:n}),u=vp({inputs:r.slice(l),backend:n});return vp({inputs:[c,u],backend:n})}const o=r.map(l=>l.dtype).reduce((l,c)=>Jr(l,c)),s=r.map(l=>l.shape),a=ue().getBool("WEBGL_PACK")?new yde(r[0].shape,s):new xde(r[0].shape,s);return n.runWebGLProgram(a,r,o)}const wde={kernelName:Ny,backendName:"webgl",kernelFunc:vp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cde(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r,a=o.shape.length,l=Ct(s,o.shape);let c=l;const u=wn(c,a);let d=o;u!=null&&(d=Tr({inputs:{x:o},backend:n,attrs:{perm:u}}),c=En(c.length,a)),ar("all",c,a);const[h,f]=er(d.shape,c),p=me(f),m=ze({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Tl(m,m.dtype,"all",n);let b;if(i){const v=Tn(h,l);b=ze({inputs:{x:g},backend:n,attrs:{shape:v}})}else b=ze({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),b}const $de={kernelName:_y,backendName:"webgl",kernelFunc:Cde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sde(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r,a=o.shape.length,l=Ct(s,o.shape);let c=l;const u=wn(c,a);let d=o;u!=null&&(d=Tr({inputs:{x:o},backend:n,attrs:{perm:u}}),c=En(c.length,a)),ar("any",c,a);const[h,f]=er(d.shape,c),p=me(f),m=ze({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Tl(m,m.dtype,"any",n);let b;if(i){const v=Tn(h,l);b=ze({inputs:{x:g},backend:n,attrs:{shape:v}})}else b=ze({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),b}const Ide={kernelName:Ay,backendName:"webgl",kernelFunc:Sde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kde{constructor(e,n,r){this.variableNames=["A"];const{windowSize:o,batchSize:s,outSize:i}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,i];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${o}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tde{constructor(e,n,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,D(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const s=e[e.length-1],i=Math.ceil(s/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),o||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=Qt(l),u=$r("coords",l);let d,h;if(i===1){h=l+1;const I=Qt(h);d=`
        ${I} sourceLocR = ${I}(${u.join()}, 0);
        ++${u[l-1]};
        ${I} sourceLocG = ${I}(${u.join()}, 0);
        ++${u[l-2]};
        ${I} sourceLocA = ${I}(${u.join()}, 0);
        --${u[l-1]};
        ${I} sourceLocB = ${I}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map(I=>"int "+I),g=$r("sourceLocR",h-1).concat("inIdx.r"),b=$r("sourceLocG",h-1).concat("inIdx.g"),v=$r("sourceLocB",h-1).concat("inIdx.b"),w=$r("sourceLocA",h-1).concat("inIdx.a"),y=r==="max"?"greaterThan":"lessThan",C=o?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()})));`,S=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${b.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,$=o?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${$}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${y}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dO(t,e,n,r=null){let o=e.shape[0],s=e.shape[1];r!=null&&(o=r.shape[0],s=r.shape[1]);const i=tb(s),a={windowSize:i,inSize:s,batchSize:o,outSize:Math.ceil(s/i)},l=new kde(a,n,r==null),c=[e];r!=null&&c.push(r);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=dO(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function hO(t,e,n,r=null){const o=r!=null?r.shape:e.shape,s=o[o.length-1],i=tb(s),a=new Tde(o,i,n,r==null),l=r==null?[e]:[e,r],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=hO(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function fO(t,e,n,r){const o=[n];if(ar("arg"+r.charAt(0).toUpperCase()+r.slice(1),o,e.shape.length),!ue().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const s=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),s.push(l));const[c,u]=er(l.shape,o),d=me(u),h=ze({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});s.push(h);const f=dO(t,h,r);s.push(f);const p=ze({inputs:{x:f},backend:t,attrs:{shape:c}});return s.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return hO(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ede(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s}=r;let i=Ct(s,o.shape);const a=wn(i,o.shape.length);let l=o;const c=[];a!=null&&(l=Tr({inputs:{x:o},backend:n,attrs:{perm:a}}),c.push(l),i=En(i.length,l.shape.length)),ar("argMax",[i[0]],l.shape.length);const u=fO(n,l,i[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const Rde={kernelName:Hm,backendName:"webgl",kernelFunc:Ede};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s}=r;let i=Ct(s,o.shape);const a=wn(i,o.shape.length);let l=o;const c=[];a!=null&&(l=Tr({inputs:{x:o},backend:n,attrs:{perm:a}}),c.push(l),i=En(i.length,l.shape.length)),ar("argMin",[i[0]],l.shape.length);const u=fO(n,l,i[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const _de={kernelName:Gm,backendName:"webgl",kernelFunc:Nde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ade=Uo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Dde=_t({opSnippet:Ade}),Fde={kernelName:Wd,backendName:"webgl",kernelFunc:Dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ode=Uo+"return log(x + sqrt(x * x + 1.0));",Pde=_t({opSnippet:Ode}),Mde={kernelName:Vd,backendName:"webgl",kernelFunc:Pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lde=Uo+`
  return atan(x);
`,Bde=_t({opSnippet:Lde}),zde={kernelName:Ud,backendName:"webgl",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wde=gC+`
  return atan(a, b);
`,Vde=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+tf+`
  return result;
`,Ude=lr({opSnippet:Wde,packedOpSnippet:Vde}),Hde={kernelName:Gd,backendName:"webgl",kernelFunc:Ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gde=Uo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,jde=_t({opSnippet:Gde}),Kde={kernelName:Hd,backendName:"webgl",kernelFunc:jde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $d{constructor(e,n,r,o=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,b=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(m||(v="-1.0 / 1e-20"),r){const I=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${I} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${o?s?g:b:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let y=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(y="avgValue / count");const C=Math.floor(i/4)*4,S=i%4,$=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${$}
          }

          int xC = xCCorner + ${C};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${$}
          }
        }
        setOutput(${y});
      }
    `}}class vC{constructor(e,n,r,o=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,b=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let y="0.0";if(w||(y="-1.0 / 1e-20"),r){const T=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${g}, ${b}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${T} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${o?s?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / count");const $=Math.floor(i/4)*4,I=i%4,R=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${g}, ${b}, ${v});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${R}
            }

            int xC = xCCorner + ${$};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${R}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${R}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${R}
            }
          }
          setOutput(${S});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qde(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;Qh(o,"avgPool");const{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;D(br(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Wo(o.shape,s,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Bt(u.inShape,u.outShape))return to({inputs:{x:o},backend:n});const d=new $d(u,"avg",!1);return n.runWebGLProgram(d,[o],"float32")}const Xde={kernelName:jm,backendName:"webgl",kernelFunc:qde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yde(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],d=li(o.shape,s,i,u,a,l,c),h=new vC(d,"avg",!1);return n.runWebGLProgram(h,[o],"float32")}const Zde={kernelName:Km,backendName:"webgl",kernelFunc:Yde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jde{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,o=e.strideHeight,s=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Qde{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,o=e.filterWidth,s=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,g=f-1-e.padInfo.left,b=1/(n*r*o);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${b});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:s}=e,i=s,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],h=li(i.shape,a,l,d,c,u),f=new Qde(h);return n.runWebGLProgram(f,[o],i.dtype)}const the={kernelName:Fy,backendName:"webgl",kernelFunc:ehe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:s}=e,i=s;Qh([o,s],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=r,u=Wo(i.shape,a,l,1,c),d=new Jde(u);return n.runWebGLProgram(d,[o],i.dtype)}const rhe={kernelName:Dy,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(t){const{inputs:e,backend:n,attrs:r}=t,{a:o,b:s}=e,{transposeA:i,transposeB:a}=r;return cm({a:o,b:s,transposeA:i,transposeB:a,backend:n})}const she={kernelName:qm,backendName:"webgl",kernelFunc:ohe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ihe{constructor(e,n,r,o,s,i){this.outputShape=[],this.variableNames=["x","mean","variance"],bt(e,n),bt(e,r);let a="0.0";o!=null&&(bt(e,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";s!=null&&(bt(e,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ahe{constructor(e,n,r,o,s,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],bt(e,n),bt(e,r);let a="vec4(0.0)";o!=null&&(bt(e,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";s!=null&&(bt(e,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:o,variance:s,offset:i,scale:a}=t;D(o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[r,o,s];let u=null;i!=null&&(u=i.shape,c.push(i));let d=null;a!=null&&(d=a.shape,c.push(a));const h=ue().getBool("WEBGL_PACK_NORMALIZATION")?new ahe(r.shape,o.shape,s.shape,u,d,l):new ihe(r.shape,o.shape,s.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},che={kernelName:ig,backendName:"webgl",kernelFunc:lhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uhe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=Qt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=dhe(this.rank);let o;const s=e.map((i,a)=>`sourceLoc.${s0[a]} = start[${a}] + coords.${s0[a]};`);o=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${o}
        setOutput(getSource(${r}));
      }
    `}}const s0=["x","y","z","w","u","v"];function dhe(t){if(t===1)return"sourceLoc";if(t<=6)return s0.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hhe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Qt(this.rank),r=$r("coords",this.rank),o=$r("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${o.slice(-2).join()})`,i=`getChannel(getSource(${o.join()}), ${s})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${o[this.rank-1]};
        result.y = ${i};
        --${o[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${o[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${o[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${o[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fhe(t,e,n,r){const o=r.texData.get(t.dataId),s=r.makeTensorInfo(n,t.dtype),i=r.texData.get(s.dataId);Object.assign(i,o),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=N1(e,tt(t.shape));o.slice&&(a+=o.slice.flatOffset),i.slice={flatOffset:a,origDataId:o.slice&&o.slice.origDataId||t.dataId};const l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),s}function au(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{begin:s,size:i}=r,[a,l]=Kg(o,s,i);if(T1(o,a,l),me(l)===0)return n.makeTensorInfo(l,o.dtype,[]);if(n.shouldExecuteOnCPU([o])||o.dtype==="string"){const d=n.texData.get(o.dataId),h=iue(d.values,a,l,o.shape,o.dtype);return n.makeTensorInfo(l,o.dtype,h)}const{isPacked:c}=n.texData.get(o.dataId),u=R1(o.shape,a,l);if(c||!u){const d=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hhe(l):new uhe(l),h=[a];return n.runWebGLProgram(d,[o],o.dtype,h)}return n.uploadToGPU(o.dataId),fhe(o,a,l,n)}const phe={kernelName:Og,backendName:"webgl",kernelFunc:au};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mhe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockShape:s,crops:i}=r;D(o.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=s.reduce((v,w)=>v*w),l=zh(o.shape,s,a),c=Wh(l.length,s.length),u=Vh(o.shape,s,a),d=vw(i,s.length),h=xw(u,i,s.length),f=[],p=ze({inputs:{x:o},backend:n,attrs:{shape:l}}),m=Tr({inputs:{x:p},backend:n,attrs:{perm:c}}),g=ze({inputs:{x:m},backend:n,attrs:{shape:u}}),b=au({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(g),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),b},ghe={kernelName:Xm,backendName:"webgl",kernelFunc:mhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,weights:s}=e,{size:i}=r,a=n.readSync(o.dataId),l=n.readSync(s.dataId),c=eO(a,l,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,c)}const vhe={kernelName:Oy,backendName:"webgl",kernelFunc:bhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xhe(t){const{inputs:e,backend:n}=t,{s0:r,s1:o}=e,s=n.readSync(r.dataId),i=n.readSync(o.dataId),a=bt(Array.from(s),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const yhe={kernelName:xR,backendName:"webgl",kernelFunc:xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const whe="return float(a != b);",pO=lr({opSnippet:whe,cpuKernelImpl:Zce,dtype:"bool"}),Che={kernelName:$g,backendName:"webgl",kernelFunc:pO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rf(t){const{inputs:e,backend:n}=t,{input:r}=e,o=n.texData.get(r.dataId);return to({inputs:{x:o.complexTensorInfos.real},backend:n})}const $he={kernelName:s1,backendName:"webgl",kernelFunc:rf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const She="return float(int(x));";function Ihe(t,e){const n=new Ts(t.shape,She),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{dtype:s}=r;if(s==="complex64"){if(o.dtype==="complex64")return to({inputs:{x:o},backend:n});const i=Zn(o.shape),a=i0({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),l=aa({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(o.dtype==="complex64"){const i=rf({inputs:{input:o},backend:n}),a=i0({inputs:{x:i},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(i),a}if(!fR(o.dtype,s)){const i=to({inputs:{x:o},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:s}}if(n.shouldExecuteOnCPU([o])){const i=n.texData.get(o.dataId).values,[a,l,c]=_ce(i,o.shape,o.dtype,s);return n.makeTensorInfo(a,l,c)}if(s==="int32")return Ihe(o,n);if(s==="bool"){const i=n.makeTensorInfo([],"bool",sr("bool",1)),l=pO({inputs:{a:o,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${s}`)}const khe={kernelName:jd,backendName:"webgl",kernelFunc:i0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bk="return ceil(x);",The=_t({opSnippet:Bk,packedOpSnippet:Bk,cpuKernelImpl:Ace}),Ehe={kernelName:Kd,backendName:"webgl",kernelFunc:The};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rhe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nhe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _he(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{clipValueMin:s,clipValueMax:i}=r;let a;ue().getBool("WEBGL_PACK_CLIP")?a=new Nhe(o.shape):a=new Rhe(o.shape);const l=[[s],[i]];return n.runWebGLProgram(a,[o],o.dtype,l)}const Ahe={kernelName:qd,backendName:"webgl",kernelFunc:_he};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dhe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zk(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function Fhe(t){const{inputs:e,backend:n}=t,{x:r}=e,o=n.texData.get(r.dataId),s=new Dhe(r.shape),i=[zk(r,o.complexTensorInfos.real),zk(r,o.complexTensorInfos.imag)];return n.runWebGLProgram(s,i,i[0].dtype)}const Ohe={kernelName:Ym,backendName:"webgl",kernelFunc:Fhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Phe{constructor(e){this.outputShape=[],this.outputShape=Ns(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];r.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const o=n.length,s=n[n.length-1];r.push(`else setOutput(getT${o}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mhe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ns(e,n);const r=this.outputShape,o=r.length,s=Qt(o),i=$r("coords",o),a=["x","y","z","w","u","v"].slice(0,o);this.variableNames=e.map((m,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];h+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${ap(a,c,g)}),
            vec2(${ap(u,c,g)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${ap(a,c,p)}),
          vec2(${ap(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[o-1]} = ${i[o-1]} + 1;
        if (${i[o-1]} < ${r[o-1]}) {
          result.g = getValue(${i});
        }

        ${i[o-2]} = ${i[o-2]} + 1;
        if (${i[o-2]} < ${r[o-2]}) {
          result.a = getValue(${i});
        }

        ${i[o-1]} = ${i[o-1]} - 1;
        if (${i[o-2]} < ${r[o-2]} &&
            ${i[o-1]} < ${r[o-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function ap(t,e,n){const r=t.indexOf(e);return t.map((s,i)=>i===r?`${s} - ${n}`:s).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wb(t){const{inputs:e,backend:n}=t,{input:r}=e,o=n.texData.get(r.dataId);return to({inputs:{x:o.complexTensorInfos.imag},backend:n})}const Lhe={kernelName:Zy,backendName:"webgl",kernelFunc:wb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Du(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(v=>rf({inputs:{input:v},backend:n})),p=t.map(v=>wb({inputs:{input:v},backend:n})),m=Du(f,e,n),g=Du(p,e,n),b=aa({inputs:{real:m,imag:g},backend:n});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}let o=n.shouldExecuteOnCPU(t);if(r==="string"&&(o=!0),o){const f=t.map(y=>{const S=[-1,me(y.shape.slice(e))];return ze({inputs:{x:y},backend:n,attrs:{shape:S}})}),p=f.map(y=>({vals:n.readSync(y.dataId),shape:y.shape})),m=Ns(f.map(y=>y.shape),1),g=f[0].shape[0]===1,b=Dce(p,m,r,g),v=Ns(t.map(y=>y.shape),e),w=n.makeTensorInfo(v,r,b);return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),w}const s=t.filter(f=>me(f.shape)>0),i=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){const f=i?new Ts(t[0].shape,$i):new Ei(t[0].shape,$i);return n.runWebGLProgram(f,t,r)}const a=ue().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>a){const f=[];for(let m=0;m<s.length;m+=a){const g=s.slice(m,m+a);f.push(Du(g,e,n))}const p=Du(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(i){const f=new Mhe(s.map(p=>p.shape),e);return n.runWebGLProgram(f,s,r)}const{tensors2D:l,outShape:c}=Bhe(s,e,n),u=new Phe(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,r);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=ze({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function Bhe(t,e,n){const r=Ns(t.map(s=>s.shape),e);return{tensors2D:t.map(s=>ze({inputs:{x:s},attrs:{shape:[-1,me(s.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mO(t){const{inputs:e,backend:n,attrs:r}=t,{axis:o}=r,s=Ct(o,e[0].shape)[0],i=e.map(c=>c.shape);mw(i,s);const a=Ns(e.map(c=>c.shape),s);if(me(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>me(c.shape)>0);return l.length===1?to({inputs:{x:l[0]},backend:n}):Du(l,s,n)}const zhe={kernelName:Zm,backendName:"webgl",kernelFunc:mO};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gO{constructor(e,n=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",b=g?1:2,v=g?2:3,w=g?3:1;let y="",C="";r&&(o?y=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?y=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:y=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");const S=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${b}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${C}
        setOutput(result);
      }
    `}}class Whe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,o=e.padInfo.left,s=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${o});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bO{constructor(e,n=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Rr(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)h+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<u;g++)h+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(d+1)/2;g++){const b=g*2;if(h+=`
           xC = xCCorner + ${b*l};
           `,a===1){if(b<u&&(i%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }
               `,l===1&&b>0?h+=`
                 xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                   } else {
                     xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xC${b} = xTexelC${b};
                 `,b+1<u)){const v=i%2===0?Ty(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                     xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${b+1}.zw = vec2(0.0);
                     }
                     xTexelC${b+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                     } else {
                      xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                     }
                     `:h+=`
                     xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                     `):v===1?h+=`
                     xC${b+1} = xTexelC${b};
                     `:h+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                       xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${b+1}.zw = vec2(0.0);
                       }
                       xTexelC${b+1}Ready = 1;
                     }

                     xC${b+1} = xTexelC${b+1};
                     `}}else b<u&&(i%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.0);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
               `,b+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(
                   xTexelC${b}.xy, xTexelC${b+1}.xy);
               `,b+1<u&&(h+=`
                   xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                 `)));b<u&&(h+=`
             wTexel = getW(r, ${b}, d1, d2);
             dotProd += xC${b}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${b}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,b+1<u&&(h+=`
               wTexel = getW(r, ${b+1}, d1, d2);
               dotProd += xC${b+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${b+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";r&&(o?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vhe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Rr(this.outputShape.length);const{dataFormat:r}=n,o=Er(),s=r==="channelsLast",i=s?1:2,a=s?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${o.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function um(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function vO({x:t,filter:e,convInfo:n,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,c=r.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let g;const b=[];if(s!=null){const y=um(s.shape,f);y!=null&&(s=ze({inputs:{x:s},backend:r,attrs:{shape:y}}),b.push(s))}if(o!=null){const y=um(o.shape,f);y!=null&&(o=ze({inputs:{x:o},backend:r,attrs:{shape:y}}),b.push(o))}if(!((d===1||h===1)&&u>uO)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Bt(c.shape.slice(-3),l.slice(-3))){const y=l[0]*l[1]*(l[2]+1),C={dataId:t.dataId,shape:[1,y,n.inChannels],dtype:t.dtype},S=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,D(lm(c.shape,C.shape),()=>`packed reshape ${c.shape} to ${C.shape} isn't free`);const $=ze({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});b.push($);const I=cm({a:C,b:$,backend:r,transposeA:p,transposeB:m,bias:o,activation:a,preluActivationWeights:s,leakyreluAlpha:i}),R=r.texData.get(I.dataId);D(R.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=S,R.shape=n.outShape,g=to({inputs:{x:I},backend:r}),g.shape=n.outShape,b.push(I)}else{const y=n.outHeight*n.outWidth,C=ze({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,y,n.inChannels]:[n.batchSize,n.inChannels,y]}}),S=ze({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),$=cm({a:f?C:S,b:f?S:C,transposeA:!f,transposeB:m,backend:r,bias:o,activation:a,preluActivationWeights:s,leakyreluAlpha:i});g=ze({inputs:{x:$},backend:r,attrs:{shape:n.outShape}}),b.push(C),b.push(S),b.push($)}for(const y of b)r.disposeIntermediateTensorInfo(y);return g}function xO({x:t,filter:e,convInfo:n,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,g=h*d,b=[n.batchSize,m,g],v=!0,w=!1,y=[];if(s!=null){const U=um(s.shape,p);U!=null&&(s=ze({inputs:{x:s},backend:r,attrs:{shape:U}}),y.push(s))}if(o!=null){const U=um(o.shape,p);U!=null&&(o=ze({inputs:{x:o},backend:r,attrs:{shape:U}}),y.push(o))}const C=ze({inputs:{x:e},backend:r,attrs:{shape:[1,m,me(e.shape)/m]}});y.push(C);const S=new Vhe(b,n),$=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=r.runWebGLProgram(S,[t],"float32",$),R=ze({inputs:{x:I},backend:r,attrs:{shape:b}});y.push(I),y.push(R);const T=o!=null,N=s!=null,_=a==="leakyrelu",P=a?Cd(a,!0):null,z=new cO(p?R.shape:C.shape,p?C.shape:R.shape,p?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],v,w,T,P,N,_),L=p?[R,C]:[C,R];if(o&&L.push(o),N&&L.push(s),_){const U=r.makeTensorInfo([],"float32",Ji(i,"float32"));L.push(U),y.push(U)}const O=r.runWebGLProgram(z,L,"float32"),B=ze({inputs:{x:O},backend:r,attrs:{shape:n.outShape}});y.push(O);for(const U of y)r.disposeIntermediateTensorInfo(U);return B}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r,d=ci(l),h=ir(o.shape,s.shape,i,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=vO({x:o,filter:s,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&ue().getBool("WEBGL_EXP_CONV")){const m=new bO(h),g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[o,s],"float32",g)}else if(ue().getBool("WEBGL_CONV_IM2COL"))f=xO({x:o,filter:s,convInfo:h,backend:n});else{const m=new gO(h);f=n.runWebGLProgram(m,[o,s],"float32")}const p=ze({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const Hhe={kernelName:Jm,backendName:"webgl",kernelFunc:Uhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ghe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,o=e.padInfo.top,s=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${i}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class jhe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,o=e.strideHeight,s=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,c=i?1:2,u=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Khe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,o=e.strideWidth,s=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${s};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${o} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class qhe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,o=e.filterWidth,s=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=r-1-e.padInfo.top,u=o-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${o}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${o} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:s}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,d=ci(l),h=ir(o.shape,u,i,1,a,c,!1,d),f=new Ghe(h);return n.runWebGLProgram(f,[o,s],"float32")}const Yhe={kernelName:My,backendName:"webgl",kernelFunc:Xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zhe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:s}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r,d=ci(c),h=ir(i,s.shape,a,1,l,u,!1,d),f=new jhe(h);return n.runWebGLProgram(f,[o,s],"float32")}const Jhe={kernelName:Qm,backendName:"webgl",kernelFunc:Zhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s}=e,{strides:i,pad:a,dilations:l}=r,c=Qi(o.shape,s.shape,i,l,a),u=new Whe(c);return n.runWebGLProgram(u,[o,s],"float32")}const efe={kernelName:eg,backendName:"webgl",kernelFunc:Qhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:s}=e,{strides:i,pad:a,filterShape:l}=r,c=Qi(o.shape,l,i,1,a),u=new Khe(c);return n.runWebGLProgram(u,[o,s],"float32")}const nfe={kernelName:Ly,backendName:"webgl",kernelFunc:tfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:s}=e,{pad:i,strides:a,inputShape:l}=r,c=Qi(l,s.shape,a,1,i),u=new qhe(c);return n.runWebGLProgram(u,[o,s],"float32")}const ofe={kernelName:By,backendName:"webgl",kernelFunc:rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe=iu+`
  return cos(x);
`,ife=_t({opSnippet:sfe}),afe={kernelName:Xd,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lfe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,cfe=_t({opSnippet:lfe}),ufe={kernelName:Yd,backendName:"webgl",kernelFunc:cfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dfe{constructor(e,n,r,o,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,c]=e,[u]=n,[d,h]=r;this.outputShape=[u,d,h,c];const f=o==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[g,b,v]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[w,y,C]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${b};
        float width_scale = ${y};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hfe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:o,boxes:s,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=r,u=new dfe(o.shape,s.shape,a,l,c);return n.runWebGLProgram(u,[o,s,i],"float32")},ffe={kernelName:Wy,backendName:"webgl",kernelFunc:hfe};var Sd;(function(t){t.Prod="*",t.Sum="+"})(Sd||(Sd={}));class Wk{constructor(e,n,r,o){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,i=this.op===Sd.Prod?"1.0":"0.0",a=r?i:`getX(${Vk(s,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";r?(c=o?`end != ${l-1}`:"end != 0",u=o?"end + 1":"end - 1"):(c=o?`end + pow2 < ${l}`:"end >= pow2",u=o?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Qt(s)} coords = getOutputCoords();
        int end = ${Uk(s,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${Uk(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${Vk(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function Vk(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function Uk(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yO(t,e,n,r,o,s){const i=e.shape.length,a=wn([r],i);let l=e;a!=null&&(l=Tr({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=En(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const u=l.shape[c];let d=to({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new Wk(t,l.shape,!1,s),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(o){const h=new Wk(t,l.shape,o,s),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=ea(a),f=Tr({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,exclusive:i,reverse:a}=r;return yO(Sd.Prod,o,n,s,i,a)}const mfe={kernelName:zy,backendName:"webgl",kernelFunc:pfe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,exclusive:i,reverse:a}=r;return yO(Sd.Sum,o,n,s,i,a)}const bfe={kernelName:tg,backendName:"webgl",kernelFunc:gfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,weights:s}=e,{size:i,binaryOutput:a}=r;if(o.shape.length===1){const l=n.readSync(o.dataId),c=n.readSync(s.dataId),u=eO(l,c,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,u)}else if(o.shape.length===2){const l=n.bufferSync(o),c=n.bufferSync(s),u=Nce(l,c,i,a);return n.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}const xfe={kernelName:Vy,backendName:"webgl",kernelFunc:vfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yfe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockSize:s,dataFormat:i}=r,a=o.shape[0],l=i==="NHWC"?o.shape[1]:o.shape[2],c=i==="NHWC"?o.shape[2]:o.shape[3],u=i==="NHWC"?o.shape[3]:o.shape[1],d=l*s,h=c*s,f=u/(s*s),p=i==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new yfe(p,s,i);return n.runWebGLProgram(m,[o],o.dtype)}const Cfe={kernelName:Uy,backendName:"webgl",kernelFunc:wfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wO{constructor(e,n=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Rr(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";r&&(o?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CO{constructor(e,n=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Rr(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<d;b++)f+=`
          vec4 xTexelC${b*2};
          int xTexelC${b*2}Ready;
          vec4 xTexelC${b*2+1};
          int xTexelC${b*2+1}Ready;
          vec4 xC${b};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let b=0;b<d;b++)f+=`
          xTexelC${b*2} = vec4(0.0);
          xTexelC${b*2}Ready = 0;
          xTexelC${b*2+1} = vec4(0.0);
          xTexelC${b*2+1}Ready = 0;
          xC${b} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let b=0;b<(h+1)/2;b++){const v=b*2;if(f+=`
          xC = xCCorner + ${v*c};
          `,l===1){if(v<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,c===1&&v>0?f+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const w=a%2===0?Ty(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:f+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):w===1?f+=`
                    xC${v+1} = xTexelC${v};
                    `:f+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(f+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(f+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(f+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";r&&(o?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $fe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=r;let u=l;u==null&&(u=[1,1]),D(br(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=ir(o.shape,s.shape,i,u,a,c,!0);let h;ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new CO(d):h=new wO(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[o,s],"float32",f)}const Sfe={kernelName:ng,backendName:"webgl",kernelFunc:$fe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ife{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,o=e.padInfo.top,s=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class kfe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,o=e.strideHeight,s=e.strideWidth,i=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:s}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r,d=ir(o.shape,u,i,a,l,c,!0),h=new Ife(d);return n.runWebGLProgram(h,[o,s],"float32")}const Efe={kernelName:Hy,backendName:"webgl",kernelFunc:Tfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:s}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r,d=ir(u,s.shape,i,a,l,c,!0),h=new kfe(d);return n.runWebGLProgram(h,[o,s],"float32")}const Nfe={kernelName:Gy,backendName:"webgl",kernelFunc:Rfe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _fe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Afe(t){const{inputs:e,backend:n}=t,{x:r}=e,o=[...r.shape,...r.shape],s=me(r.shape),i=ze({inputs:{x:r},backend:n,attrs:{shape:[s]}}),a=new _fe(s),l=n.runWebGLProgram(a,[i],i.dtype),c=ze({inputs:{x:l},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}const Dfe={kernelName:yR,backendName:"webgl",kernelFunc:Afe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ffe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:o,strideHeight:s,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=o;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${i});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ofe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s}=e,{strides:i,pad:a,dilations:l}=r,c=Oh(o.shape,s.shape,i,a,"NHWC",l);let u;const d=new Ffe(c);u=n.runWebGLProgram(d,[o,s],"float32");const h=ze({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const Pfe={kernelName:rg,backendName:"webgl",kernelFunc:Ofe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mfe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:o}=r,s=e,{allDims:i,summedDims:a,idDims:l}=Tw(o,s.length);Rw(i.length,l,s);const{path:c,steps:u}=Nw(a,l),d=u.length;let h=null,f=i.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:b,expandDims:v}=Ew(f,l[g]);let w;_w(b)?w=s[g]:(w=Tr({inputs:{x:s[g]},backend:n,attrs:{perm:b}}),p.push(w));const y=w.shape.slice();for(let C=0;C<v.length;++C)y.splice(v[C],0,1);Bt(w.shape,y)||(w=ze({inputs:{x:w},backend:n,attrs:{shape:y}}),p.push(w)),h===null?h=w:(h=bC({inputs:{a:w,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=yb({inputs:{x:h},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const Lfe={kernelName:wR,backendName:"webgl",kernelFunc:Mfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe="return (x >= 0.0) ? x : (exp(x) - 1.0);",zfe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Wfe=_t({opSnippet:Bfe,packedOpSnippet:zfe}),Vfe={kernelName:Jd,backendName:"webgl",kernelFunc:Wfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ufe="return (b >= 1.0) ? a : a * (b + 1.0);",Hfe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Gfe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:o}=e,s=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new nf(Hfe,r.shape,o.shape):new Nc(Ufe,r.shape,o.shape);return n.runWebGLProgram(s,[r,o],r.dtype)},jfe={kernelName:jy,backendName:"webgl",kernelFunc:Gfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe=`
  return vec4(equal(a, b));
`,qfe="return float(a == b);",Xfe=lr({opSnippet:qfe,packedOpSnippet:Kfe,dtype:"bool",cpuKernelImpl:Fce}),Yfe={kernelName:og,backendName:"webgl",kernelFunc:Xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zfe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${yw};
  float a1 = ${ww};
  float a2 = ${Cw};
  float a3 = ${$w};
  float a4 = ${Sw};
  float a5 = ${Iw};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Jfe=_t({opSnippet:Zfe}),Qfe={kernelName:Qd,backendName:"webgl",kernelFunc:Jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const epe=iu+`
  return exp(x);
`,tpe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$O=_t({opSnippet:epe,packedOpSnippet:tpe,cpuKernelImpl:Oce,dtype:"float32"}),npe={kernelName:eh,backendName:"webgl",kernelFunc:$O};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a0(t){const{inputs:e,attrs:n,backend:r}=t,{dim:o}=n,{input:s}=e,i=s.shape.length,a=s.shape.slice();let l=o;return o<0&&(D(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),ze({inputs:{x:s},backend:r,attrs:{shape:a}})}const rpe={kernelName:sg,backendName:"webgl",kernelFunc:a0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hk="return exp(x) - 1.0;",ope=_t({opSnippet:Hk,packedOpSnippet:Hk,cpuKernelImpl:Pce}),spe={kernelName:th,backendName:"webgl",kernelFunc:ope};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gk{constructor(e,n,r){this.variableNames=["real","imag"];const o=n[1];this.outputShape=n;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${o}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${o});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${o}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SO(t,e,n){const r=n.texData.get(t.dataId),o=me(t.shape),s=t.shape[t.shape.length-1],i=o/s,a=ze({inputs:{x:t},backend:n,attrs:{shape:[i,s]}}),l=a.shape,c=new Gk("real",l,e),u=new Gk("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=aa({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=ze({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ipe(t){const{inputs:e,backend:n}=t,{input:r}=e;return SO(r,!1,n)}const ape={kernelName:Ky,backendName:"webgl",kernelFunc:ipe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lpe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function of(t){const{backend:e,attrs:n}=t,{shape:r,value:o}=n;let{dtype:s}=n;if(s=s||Ld(o),s==="string"){const i=Dn(s,me(r));return i.fill(o),e.makeTensorInfo(r,s,i)}else{const i=new lpe(r,o),a=[[o]];return e.runWebGLProgram(i,[],s,a)}}const cpe={kernelName:qy,backendName:"webgl",kernelFunc:of};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class upe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dpe={kernelName:Xy,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,o=new upe(n.shape);return r.runWebGLProgram(o,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jk="return floor(x);",hpe=_t({opSnippet:jk,packedOpSnippet:jk,cpuKernelImpl:Mce}),fpe={kernelName:nh,backendName:"webgl",kernelFunc:hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,mpe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,gpe=lr({opSnippet:ppe,packedOpSnippet:mpe,dtype:"int32"}),bpe={kernelName:rh,backendName:"webgl",kernelFunc:gpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vpe{constructor(e){this.variableNames=["A"];const n=Er(),[r,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${o}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xpe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Er(),[r,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${o}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype={kernelName:E8,backendName:"webgl",kernelFunc:wpe};let Bl,Nv=ue().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function wpe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:o}=e;const{numChannels:s}=r,i=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,[l,c]=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],u=[c,l],d=[c,l,s];if(a||i){const m=ue().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Bl==null||m!==Nv)&&(Nv=m,Bl=document.createElement("canvas").getContext("2d",{willReadFrequently:Nv})),Bl.canvas.width=l,Bl.canvas.height=c,Bl.drawImage(o,0,0,l,c),o=Bl.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=lo.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);const f=ue().getBool("WEBGL_PACK")?new xpe(d):new vpe(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r,m=ci(u),g=ir(o.shape,s.shape,l,d,c,h,!1,m);let b;const v=[],w=i!=null,y=a!=null,C=f==="leakyrelu",S=()=>{const I=[o,s],R=(T,N)=>{if(N==="NCHW"&&T.shape.length===1&&T.shape[0]!==1){const _=ze({inputs:{x:T},backend:n,attrs:{shape:[T.shape[0],1,1]}});return v.push(_),_}return T};if(w&&I.push(R(i,u)),y&&I.push(R(a,u)),C){const T=n.makeTensorInfo([],"float32",Ji(p,"float32"));I.push(T),v.push(T)}return I};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))b=vO({x:o,filter:s,convInfo:g,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&ue().getBool("WEBGL_EXP_CONV")){const I=f?Cd(f,!0):null,R=new bO(g,w,I,y,C),T=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],N=S();b=n.runWebGLProgram(R,N,"float32",T)}else if(ue().getBool("WEBGL_CONV_IM2COL"))b=xO({x:o,filter:s,convInfo:g,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const I=f?Cd(f,!1):null,R=new gO(g,w,I,y,C),T=S();b=n.runWebGLProgram(R,T,"float32")}const $=ze({inputs:{x:b},backend:n,attrs:{shape:g.outShape}});return v.push(b),v.forEach(I=>n.disposeIntermediateTensorInfo(I)),$}const $pe={kernelName:Lp,backendName:"webgl",kernelFunc:Cpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r,p=[];let m=u;m==null&&(m=[1,1]),D(br(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=ir(o.shape,s.shape,l,m,c,d,!0),b=ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=h?Cd(h,b):null,w=[o,s],y=i!=null,C=a!=null,S=h==="leakyrelu";if(y&&w.push(i),C&&w.push(a),S){const T=n.makeTensorInfo([],"float32",Ji(f,"float32"));w.push(T),p.push(T)}let $;b?$=new CO(g,y,v,C,S):$=new wO(g,y,v,C,S);const I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],R=n.runWebGLProgram($,w,"float32",I);return p.forEach(T=>n.disposeIntermediateTensorInfo(T)),R}const Ipe={kernelName:AR,backendName:"webgl",kernelFunc:Spe};class kpe{constructor(e,n,r,o){this.sliceDim=e,this.strides=n,this.paramsShape=o,this.variableNames=["x","indices"],this.outputShape=r;const s=Qt(r.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tpe(t){const{inputs:e,backend:n}=t,{params:r,indices:o}=e,s=o.shape,i=s[s.length-1],a=me(r.shape),[l,c,u,d]=k1(r,o),h=ze({inputs:{x:o},backend:n,attrs:{shape:[c,i]}}),f=ze({inputs:{x:r},backend:n,attrs:{shape:[me(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const b=n.readSync(o.dataId),v=n.bufferSync(r),w=Lce(b,v,r.dtype,c,i,u,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,w.values)}const p=new kpe(i,d,[c,u],r.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),g=ze({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const Epe={kernelName:CR,backendName:"webgl",kernelFunc:Tpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rpe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=Qt(this.rank),o=Npe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${o}));
      }
    `}}function Npe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let o=0;o<t.length;o++)o===2?r.push("index"):r.push(`${n[o]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IO(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,indices:s}=e,{axis:i,batchDims:a}=r,l=Ct(i,o.shape)[0];if(ue().get("DEBUG")){const v=n.readSync(s.dataId),w=o.shape[l];for(let y=0;y<v.length;++y){const C=v[y];D(C<=w-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${w-1}]`)}}const c=Dw(o,s,l,a),u=me(s.shape),d=[],h=ze({inputs:{x:o},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=ze({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([o,s])||o.dtype==="string"){const v=n.bufferSync(f),w=n.bufferSync(h),y=Bce(w,v,p);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(c.outputShape,y.dtype,y.values)}const m=new Rpe(h.shape,p),g=n.runWebGLProgram(m,[h,f],h.dtype);d.push(g);const b=ze({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const _pe={kernelName:ag,backendName:"webgl",kernelFunc:IO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ape="return float(a > b);",Dpe=`
  return vec4(greaterThan(a, b));
`,Fpe=lr({opSnippet:Ape,packedOpSnippet:Dpe,cpuKernelImpl:zce,dtype:"bool"}),Ope={kernelName:lg,backendName:"webgl",kernelFunc:Fpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ppe="return float(a >= b);",Mpe=`
  return vec4(greaterThanEqual(a, b));
`,Lpe=lr({opSnippet:Ppe,packedOpSnippet:Mpe,dtype:"bool",cpuKernelImpl:Wce}),Bpe={kernelName:oh,backendName:"webgl",kernelFunc:Lpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpe(t){const{inputs:e,backend:n}=t,{input:r}=e;return SO(r,!0,n)}const Wpe={kernelName:Yy,backendName:"webgl",kernelFunc:zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vpe="return float(!isnan(x) && !isinf(x));",Upe=_t({opSnippet:Vpe,dtype:"bool"}),Hpe={kernelName:ih,backendName:"webgl",kernelFunc:Upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gpe="return float(isinf(x));",jpe=_t({opSnippet:Gpe,dtype:"bool"}),Kpe={kernelName:ah,backendName:"webgl",kernelFunc:jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpe="return float(isnan(x));",Xpe=_t({opSnippet:qpe,dtype:"bool"}),Ype={kernelName:lh,backendName:"webgl",kernelFunc:Xpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe="return float(a < b);",Jpe=`
  return vec4(lessThan(a, b));
`,Qpe=lr({opSnippet:Zpe,packedOpSnippet:Jpe,cpuKernelImpl:Vce,dtype:"bool"}),eme={kernelName:ug,backendName:"webgl",kernelFunc:Qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tme="return float(a <= b);",nme=`
  return vec4(lessThanEqual(a, b));
`,rme=lr({opSnippet:tme,packedOpSnippet:nme,cpuKernelImpl:Uce,dtype:"bool"}),ome={kernelName:dg,backendName:"webgl",kernelFunc:rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sme(t){const{backend:e,attrs:n}=t,{start:r,stop:o,num:s}=n,i=Hce(r,o,s);return e.makeTensorInfo([i.length],"float32",i)}const ime={kernelName:$R,backendName:"webgl",kernelFunc:sme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ame=iu+`
  return x < 0.0 ? 0./0. : log(x);
`,lme=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,cme=_t({opSnippet:ame,packedOpSnippet:lme,cpuKernelImpl:Gce}),ume={kernelName:ch,backendName:"webgl",kernelFunc:cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dme=iu+`
  return log(1.0 + x);
`,hme=_t({opSnippet:dme}),fme={kernelName:uh,backendName:"webgl",kernelFunc:hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pme="return float(a >= 1.0 && b >= 1.0);",mme=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,gme=lr({opSnippet:pme,packedOpSnippet:mme,dtype:"bool"}),bme={kernelName:hg,backendName:"webgl",kernelFunc:gme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vme="return float(!(x >= 1.0));",xme=_t({opSnippet:vme}),yme={kernelName:fg,backendName:"webgl",kernelFunc:xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wme="return float(a >= 1.0 || b >= 1.0);",Cme=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,$me=lr({opSnippet:wme,packedOpSnippet:Cme,dtype:"bool"}),Sme={kernelName:pg,backendName:"webgl",kernelFunc:$me};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ime{constructor(e,n,r,o,s){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${o}) * sum`;s===.5?l=`inversesqrt(${c})`:s===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kme{constructor(e,n,r,o,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${o}) * sum`;s===.5?l=`inversesqrt(${c})`:s===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tme=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{depthRadius:s,bias:i,alpha:a,beta:l}=r,c=ue().getBool("WEBGL_PACK_NORMALIZATION")?new kme(o.shape,s,i,a,l):new Ime(o.shape,s,i,a,l);return n.runWebGLProgram(c,[o],o.dtype)},Eme={kernelName:mg,backendName:"webgl",kernelFunc:Tme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rme{constructor(e,n,r,o,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=o,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${o}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${o})
                * float(${s})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nme=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o,y:s,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=r,d=new Rme(o.shape,a,l,c,u);return n.runWebGLProgram(d,[o,s,i],o.dtype)},_me={kernelName:Jy,backendName:"webgl",kernelFunc:Nme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ame(t,e,n,r){const o=me(e),i=me(t.shape)/o,a=ze({inputs:{x:t},attrs:{shape:[i,o]},backend:r}),l=Tl(a,t.dtype,"max",r),c=ze({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kO(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reductionIndices:s,keepDims:i}=r,a=o.shape.length,l=Ct(s,o.shape);let c=l;const u=wn(c,a),d=u!=null,h=n.shouldExecuteOnCPU([o]);let f=o;if(d){if(h){const w=n.texData.get(f.dataId).values,y=new Array(a);for(let $=0;$<y.length;$++)y[$]=o.shape[u[$]];const C=mC(w,o.shape,o.dtype,u,y);f=n.makeTensorInfo(y,o.dtype);const S=n.texData.get(f.dataId);S.values=C}else f=xb(o,u,n);c=En(c.length,a)}ar("max",c,a);const[p,m]=er(f.shape,c);let g=p;i&&(g=Tn(p,l));let b;if(h){const w=n.texData.get(f.dataId).values,y=jce(w,me(m),g,o.dtype);b=n.makeTensorInfo(g,o.dtype);const C=n.texData.get(b.dataId);C.values=y}else b=Ame(f,m,g,n);return d&&n.disposeIntermediateTensorInfo(f),b}const Dme={kernelName:gg,backendName:"webgl",kernelFunc:kO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fme=gC+`
  return max(a, b);
`,Ome=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+tf+`
  return result;
`,Pme=lr({opSnippet:Fme,packedOpSnippet:Ome,cpuKernelImpl:Kce}),Mme={kernelName:dh,backendName:"webgl",kernelFunc:Pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lme(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;Qh(o,"maxPool");const{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;D(br(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Wo(o.shape,s,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Bt(u.inShape,u.outShape))return to({inputs:{x:o},backend:n});const d=new $d(u,"max",!1);return n.runWebGLProgram(d,[o],o.dtype)}const Bme={kernelName:bg,backendName:"webgl",kernelFunc:Lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zme(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{filterSize:s,strides:i,pad:a,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],d=li(o.shape,s,i,u,a,c,l),h=new vC(d,"max",!1);return n.runWebGLProgram(h,[o],o.dtype)}const Wme={kernelName:vg,backendName:"webgl",kernelFunc:zme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vme{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,o=e.dilationHeight,s=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=s-1-e.padInfo.top,l=i-1-e.padInfo.left,c=s*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Ume{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:s}=e,i=s,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],h=li(i.shape,a,l,d,c,u),f=new vC(h,"max",!0),p=n.runWebGLProgram(f,[i],i.dtype),m=new Ume(h),g=n.runWebGLProgram(m,[o,p],i.dtype);return n.disposeIntermediateTensorInfo(p),g}const Gme={kernelName:e1,backendName:"webgl",kernelFunc:Hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:s,output:i}=e,a=s;Qh([s,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,h=Wo(a.shape,l,c,1,u,d),f=!0,p=new $d(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),g=new Vme(h),b=n.runWebGLProgram(g,[o,m],a.dtype);return n.disposeIntermediateTensorInfo(m),b}const Kme={kernelName:Qy,backendName:"webgl",kernelFunc:jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qme(t,e,n,r){let o=new $d(n,"max",!1);const s=r.runWebGLProgram(o,[t],"float32");o=new $d(n,"max",!0,!0,e);const i=r.runWebGLProgram(o,[t],"float32");return[s,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xme={kernelName:SR,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:o,strides:s,pad:i,includeBatchInIndex:a}=e,l=n;D(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];D(br(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const u=Wo(r.shape,o,s,c,i),[d,h]=qme(r,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yme(t,e,n,r){const o=me(e),i=me(t.shape)/o,a=ze({inputs:{x:t},attrs:{shape:[i,o]},backend:r}),l=Tl(a,"float32","mean",r),c=ze({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zme={kernelName:xg,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:o,axis:s}=e,i=n,a=r.shape.length,l=Ct(s,r.shape);let c=l;const u=wn(c,a),d=u!=null,h=i.shouldExecuteOnCPU([r]),f=[];let p=r;if(d){if(h){const y=i.texData.get(p.dataId).values,C=new Array(a);for(let I=0;I<C.length;I++)C[I]=r.shape[u[I]];const S=mC(y,r.shape,r.dtype,u,C);p=i.makeTensorInfo(C,r.dtype);const $=i.texData.get(p.dataId);$.values=S}else p=xb(r,u,i);f.push(p),c=En(c.length,a)}ar("sum",c,a);const[m,g]=er(p.shape,c);let b=m;o&&(b=Tn(m,l));const v=Yme(p,g,b,i);for(const w of f)i.disposeIntermediateTensorInfo(w);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jme(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r,a=o.shape.length,l=Ct(s,o.shape);let c=l;const u=wn(c,a);let d=o;u!=null&&(d=Tr({inputs:{x:o},backend:n,attrs:{perm:u}}),c=En(c.length,o.shape.length)),ar("min",c,a);const[h,f]=er(d.shape,c),p=me(f),m=ze({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Tl(m,m.dtype,"min",n);let b;if(i){const v=Tn(h,l);b=ze({inputs:{x:g},backend:n,attrs:{shape:v}})}else b=ze({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),b}const Qme={kernelName:yg,backendName:"webgl",kernelFunc:Jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ege=gC+`
  return min(a, b);
`,tge=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+tf+`
  return result;
`,nge=lr({opSnippet:ege,packedOpSnippet:tge,cpuKernelImpl:qce}),rge={kernelName:hh,backendName:"webgl",kernelFunc:nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oge{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const o=e.length,s=Qt(o),i=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),c=r==="reflect"?0:1;if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${i});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${o}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sge{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const o=e.length,s=Qt(o),i=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=$r("rc",o),c=$r("source",o),u=`${l[o-1]} < ${this.outputShape[o-1]}`,d=o===1?"source":`vec2(${c.slice(-2).join()})`,h=r==="reflect"?0:1;let f="";if(o===1){const p=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[o-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[o-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[o-2]} += 1;
        if(${l[o-2]} < ${this.outputShape[o-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[o-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${i});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ige=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:o,mode:s}=n,i=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sge(r.shape,o,s):new oge(r.shape,o,s);return e.runWebGLProgram(i,[r],r.dtype)},age={kernelName:wg,backendName:"webgl",kernelFunc:ige};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lge=`if (b == 0.0) return NAN;
  return mod(a, b);`,cge=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+tf+`
  return result;
`,uge=lr({opSnippet:lge,packedOpSnippet:cge}),dge={kernelName:fh,backendName:"webgl",kernelFunc:uge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hge{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fge=`
if (a == b) {
  return 1.0;
};
return a / b;`,pge=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,TO=lr({opSnippet:fge,packedOpSnippet:pge,checkOutOfBounds:!0}),mge={kernelName:Zd,backendName:"webgl",kernelFunc:TO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kk="return a - b;",EO=lr({opSnippet:Kk,packedOpSnippet:Kk,supportsComplex:!0,cpuKernelImpl:pue}),gge={kernelName:Rh,backendName:"webgl",kernelFunc:EO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RO(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{dim:s}=r,i=Ct([s],o.shape),a=kO({inputs:{x:o},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=Tn(a.shape,i),c=ze({inputs:{x:a},backend:n,attrs:{shape:l}}),u=EO({inputs:{a:o,b:c},backend:n}),d=$O({inputs:{x:u},backend:n}),h=yb({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),f=ze({inputs:{x:h},backend:n,attrs:{shape:l}}),p=TO({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const bge={kernelName:Bg,backendName:"webgl",kernelFunc:RO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vge(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{numSamples:s,seed:i,normalized:a}=r,l=a?o:RO({inputs:{logits:o},backend:n,attrs:{dim:o.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new hge(c,u,s),h=[[i]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const xge={kernelName:IR,backendName:"webgl",kernelFunc:vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yge=Uo+`
  return -x;
`,wge=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Cge(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const s=n.texData.get(r.dataId),[i,a]=Yce(s.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}let o;return ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new Ei(r.shape,wge):o=new Ts(r.shape,yge),n.runWebGLProgram(o,[r],r.dtype)}const $ge={kernelName:Cg,backendName:"webgl",kernelFunc:Cge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sge=ow;function Ige(t){ao("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,c=n.readSync(o.dataId),u=n.readSync(s.dataId),{selectedIndices:d}=Sge(c,u,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const kge={kernelName:t1,backendName:"webgl",kernelFunc:Ige};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tge=sw;function Ege(t){ao("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(o.dataId),d=n.readSync(s.dataId),{selectedIndices:h,validOutputs:f}=Tge(u,d,i,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const Rge={kernelName:n1,backendName:"webgl",kernelFunc:Ege};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nge=iw;function _ge(t){ao("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(o.dataId),d=n.readSync(s.dataId),h=i,f=a,p=l,m=c,{selectedIndices:g,selectedScores:b}=Nge(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const Age={kernelName:r1,backendName:"webgl",kernelFunc:_ge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dge{constructor(e,n,r,o){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${o}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fge=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:o}=e,{dtype:s,depth:i,onValue:a,offValue:l}=r,c=me(o.shape),u=new Dge(c,i,a,l),d=ze({inputs:{x:o},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],s);n.disposeIntermediateTensorInfo(d);const f=[...o.shape,i],p=ze({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},Oge={kernelName:Ig,backendName:"webgl",kernelFunc:Fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dm(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const o=rf({inputs:{input:r},backend:n}),s=dm({inputs:{x:o},backend:n}),i=wb({inputs:{input:r},backend:n}),a=dm({inputs:{x:i},backend:n}),l=aa({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return of({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const Pge={kernelName:Vg,backendName:"webgl",kernelFunc:dm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NO(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const o=rf({inputs:{input:r},backend:n}),s=NO({inputs:{x:o},backend:n}),i=wb({inputs:{input:r},backend:n}),a=dm({inputs:{x:i},backend:n}),l=aa({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return of({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const Mge={kernelName:Sg,backendName:"webgl",kernelFunc:NO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lge(t){const{inputs:e,backend:n,attrs:r}=t,{axis:o}=r;if(e.length===1)return a0({inputs:{input:e[0]},backend:n,attrs:{dim:o}});const s=e[0].shape,i=e[0].dtype;e.forEach(u=>{zo(s,u.shape,"All tensors passed to stack must have matching shapes"),D(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=a0({inputs:{input:u},backend:n,attrs:{dim:o}});return a.push(d),d}),c=mO({inputs:l,backend:n,attrs:{axis:o}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const Bge={kernelName:kg,backendName:"webgl",kernelFunc:Lge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zge{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const o=e.length,s=Qt(o),i=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${i});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wge{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,g)=>m[0]+e[g]+m[1]);const o=e.length,s=Qt(o),i=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+e[g]).join(","),l=$r("rc",o),c=$r("source",o),u=`${l[o-1]} < ${this.outputShape[o-1]}`,d=o===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${s} rc = outputLoc;`,`${l[o-1]} += 1;
       if(${u}) {
      `,o===1?"":`}
       rc = outputLoc;
       ${l[o-2]} += 1;
       if(${l[o-2]} < ${this.outputShape[o-2]}) {`,o===1?"":`  ${l[o-1]} += 1;
         if(${u}) {`],f=o===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=o===1?2:4;m<g;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=o===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${i});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _O=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{paddings:s,constantValue:i}=r;if(me(o.shape)===0){const c=s.map((u,d)=>u[0]+o.shape[d]+u[1]);return of({backend:n,attrs:{shape:c,value:i,dtype:o.dtype}})}const a=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wge(o.shape,s,i):new zge(o.shape,s,i),l=[[i]];return n.runWebGLProgram(a,[o],o.dtype,l)},Vge={kernelName:Tg,backendName:"webgl",kernelFunc:_O};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uge=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Hge=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+tf+`
  return result;
`,Gge=lr({opSnippet:Uge,packedOpSnippet:Hge}),jge={kernelName:mh,backendName:"webgl",kernelFunc:Gge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kge(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,keepDims:i}=r,a=o.shape.length,l=[],c=Ct(s,o.shape);let u=c;const d=wn(u,a);let h=o;d!=null&&(h=Tr({inputs:{x:o},backend:n,attrs:{perm:d}}),u=En(u.length,a),l.push(h)),ar("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:g,outDtype:b}=Jce(h.shape,h.dtype,p,u);f=n.makeTensorInfo(g,b,m)}else{const[p,m]=er(h.shape,u),g=me(m),b=ze({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),v=C1(o.dtype),w=Tl(b,v,"prod",n);f=ze({inputs:{x:w},backend:n,attrs:{shape:p}}),l.push(b),l.push(w)}if(i){l.push(f);const p=Tn(f.shape,c);f=ze({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const qge={kernelName:Rg,backendName:"webgl",kernelFunc:Kge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xge(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:o,paramsDenseValues:s,indices:i}=e,{outputRaggedRank:a}=r,l=o.map(b=>n.readSync(b.dataId)),c=o.map(b=>b.shape),u=n.readSync(s.dataId),d=n.readSync(i.dataId),[h,f,p]=Qce(l,c,u,s.shape,s.dtype,d,i.shape,a),m=h.map(b=>n.makeTensorInfo([b.length],"int32",b)),g=n.makeTensorInfo(p,s.dtype,f);return m.concat([g])}const Yge={kernelName:kR,backendName:"webgl",kernelFunc:Xge};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zge(t){const{inputs:e,backend:n}=t,{starts:r,limits:o,deltas:s}=e,i=n.readSync(r.dataId),a=n.readSync(o.dataId),l=n.readSync(s.dataId),[c,u]=eue(i,r.shape,r.dtype,a,o.shape,l,s.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],r.dtype,u);return[d,h]}const Jge={kernelName:TR,backendName:"webgl",kernelFunc:Zge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qge(t){const{inputs:e,backend:n,attrs:r}=t,{shape:o,values:s,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,c=n.readSync(o.dataId),u=n.readSync(s.dataId),d=n.readSync(i.dataId),h=a.map(g=>n.readSync(g.dataId)),f=a.map(g=>g.shape),[p,m]=tue(c,o.shape,u,s.shape,s.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(p,s.dtype,m)}const ebe={kernelName:ER,backendName:"webgl",kernelFunc:Qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AO=t=>{const{backend:e,attrs:n}=t,{start:r,stop:o,step:s,dtype:i}=n,a=nue(r,o,s,i);return e.makeTensorInfo([a.length],i,a)},tbe={kernelName:o1,backendName:"webgl",kernelFunc:AO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nbe="return 1.0 / x;",rbe=_t({opSnippet:nbe}),obe={kernelName:gh,backendName:"webgl",kernelFunc:rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sbe=Uo+`
  return (x < 0.0) ? 0.0 : x;
`,ibe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,abe=_t({opSnippet:sbe,packedOpSnippet:ibe}),lbe={kernelName:bh,backendName:"webgl",kernelFunc:abe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cbe=Uo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ube=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dbe=_t({opSnippet:cbe,packedOpSnippet:ube}),hbe={kernelName:vh,backendName:"webgl",kernelFunc:dbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fbe{constructor(e,n,r,o,s){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,r,c];const u=[o&&n>1?a-1:a,o&&r>1?l-1:l],d=[o&&n>1?n-1:n,o&&r>1?r-1:r];let h;s?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pbe{constructor(e,n,r,o,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,r,c];const u=[o&&n>1?a-1:a,o&&r>1?l-1:l],d=[o&&n>1?n-1:n,o&&r>1?r-1:r];let h;s?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbe(t){const{inputs:e,backend:n,attrs:r}=t,{images:o}=e,{alignCorners:s,halfPixelCenters:i,size:a}=r,[l,c]=a,u=ue().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new pbe(o.shape,l,c,s,i):new fbe(o.shape,l,c,s,i);return n.runWebGLProgram(u,[o],"float32")}const gbe={kernelName:Ag,backendName:"webgl",kernelFunc:mbe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bbe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,o,s]=n,[,i,a]=e,l=[r&&i>1?o-1:o,r&&a>1?s-1:s],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${o-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vbe(t){const{inputs:e,backend:n,attrs:r}=t,{images:o,dy:s}=e,{alignCorners:i}=r,a=new bbe(s.shape,o.shape,i);return n.runWebGLProgram(a,[s],s.dtype)}const xbe={kernelName:a1,backendName:"webgl",kernelFunc:vbe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ybe{constructor(e,n,r,o,s){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,r,c];const u=[o&&n>1?a-1:a,o&&r>1?l-1:l],d=[o&&n>1?n-1:n,o&&r>1?r-1:r],h=o?"0.5":"0.0";let f;s?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wbe{constructor(e,n,r,o,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,r,c];const u=[o&&n>1?a-1:a,o&&r>1?l-1:l],d=[o&&n>1?n-1:n,o&&r>1?r-1:r],h=o?"0.5":"0.0";let f;s?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(t){const{inputs:e,backend:n,attrs:r}=t,{images:o}=e,{alignCorners:s,halfPixelCenters:i,size:a}=r,[l,c]=a,u=ue().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new wbe(o.shape,l,c,s,i):new ybe(o.shape,l,c,s,i);return n.runWebGLProgram(u,[o],o.dtype)}const $be={kernelName:_g,backendName:"webgl",kernelFunc:Cbe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sbe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,o,s]=n,[,i,a]=e,l=[r&&i>1?o-1:o,r&&a>1?s-1:s],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(t){const{inputs:e,backend:n,attrs:r}=t,{images:o,dy:s}=e,{alignCorners:i}=r,a=new Sbe(s.shape,o.shape,i);return n.runWebGLProgram(a,[s],s.dtype)}const kbe={kernelName:i1,backendName:"webgl",kernelFunc:Ibe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tbe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const o=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,s=e.map((a,l)=>o(l)).join(","),i=Qt(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ebe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const o=$r("rc",r),s=`${o[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${o[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Qt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(o.slice())};
          if(${s}){
            result.g = ${c(o.slice())};
          }
          if(${i}) {
            result.b = ${u(o.slice())};
            if(${s}) {
              result.a = ${d(o.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[r-1]="("+p[r-1]+" + 1)",h(p)}function u(p){return p[r-2]="("+p[r-2]+" + 1)",h(p)}function d(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",h(p)}function h(p){const m=e.map((v,w)=>f(w,p)),g=m.join(","),b=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${b}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{dims:s}=r,i=o.shape.length,a=Ct(s,o.shape);if(i===0)return to({inputs:{x:o},backend:n});const l=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ebe(o.shape,a):new Tbe(o.shape,a);return n.runWebGLProgram(l,[o],o.dtype)}const Nbe={kernelName:Dg,backendName:"webgl",kernelFunc:Rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _be{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],o=e[2];this.outputShape=e;let s="";typeof n=="number"?s=`float outputValue = ${n.toFixed(2)};`:s=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${o} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Abe={kernelName:y1,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:o,fillValue:s,center:i}=e,a=n,l=new _be(r.shape,s),[c,u]=bw(i,r.shape[1],r.shape[2]),d=[[c,u,Math.sin(o),Math.cos(o)]];return a.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dbe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Fbe=_t({opSnippet:Dbe}),Obe={kernelName:xh,backendName:"webgl",kernelFunc:Fbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pbe="return inversesqrt(x);",Mbe=_t({opSnippet:Pbe,cpuKernelImpl:rue}),Lbe={kernelName:yh,backendName:"webgl",kernelFunc:Mbe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DO{constructor(e,n,r,o,s,i,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const l=Qt(s.length),c=Qt(i.length);let u="";r===1?u="i":r===2&&(u="i, j");const d=`getIndices(${u})`;let h="";o===1?h="i":o===2&&(h="i, coords[1]");const f=`getUpdates(${h})`,p=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${p};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bbe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:o,updates:s}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Fh(s,o,i),h=[d/c,c];if(d===0)return n.makeTensorInfo(i,o.dtype);const f=ze({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=ze({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new DO(l,a,f.shape.length,p.shape.length,u,h),b=n.runWebGLProgram(g,[p,f,m],p.dtype),v=ze({inputs:{x:b},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(m),v}const zbe={kernelName:RR,backendName:"webgl",kernelFunc:Bbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wbe{constructor(e,n,r,o){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const s="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=ue().getNumber("WEBGL_VERSION")===2?s:i,l=o==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:o,values:s}=e,{side:i}=r,a=new Wbe(o.shape[0],o.shape[1],s.shape[1],i),l=[[o.shape[1]]];return n.runWebGLProgram(a,[o,s],"int32",l)}const Ube={kernelName:NR,backendName:"webgl",kernelFunc:Vbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hbe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let o,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",o="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);o=l.join(),s=c.join()}const i=Qt(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${o});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(t){const{inputs:e,backend:n}=t,{condition:r,t:o,e:s}=e,i=new Hbe(r.shape.length,o.shape,o.shape.length);return n.runWebGLProgram(i,[r,o,s],Jr(o.dtype,s.dtype))}const jbe={kernelName:Fg,backendName:"webgl",kernelFunc:Gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kbe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${nb};
  float scale = ${rb};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,qbe=_t({opSnippet:Kbe}),Xbe={kernelName:wh,backendName:"webgl",kernelFunc:qbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ybe=iu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Zbe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Jbe=_t({opSnippet:Ybe,packedOpSnippet:Zbe,cpuKernelImpl:sue}),Qbe={kernelName:Ih,backendName:"webgl",kernelFunc:Jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eve=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,tve=_t({opSnippet:eve}),nve={kernelName:Sh,backendName:"webgl",kernelFunc:tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rve=iu+`
  return sin(x);
`,ove=_t({opSnippet:rve}),sve={kernelName:Ch,backendName:"webgl",kernelFunc:ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ive=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,ave=_t({opSnippet:ive}),lve={kernelName:$h,backendName:"webgl",kernelFunc:ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cve=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,uve=_t({opSnippet:cve}),dve={kernelName:kh,backendName:"webgl",kernelFunc:uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hve=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockShape:s,paddings:i}=r;D(o.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=s.reduce((b,v)=>b*v),l=[[0,0]];l.push(...i);for(let b=1+s.length;b<o.shape.length;++b)l.push([0,0]);const c=[],u=_O({inputs:{x:o},backend:n,attrs:{paddings:l,constantValue:0}}),d=zh(u.shape,s,a,!1),h=Wh(d.length,s.length,!1),f=Vh(u.shape,s,a,!1),p=ze({inputs:{x:u},backend:n,attrs:{shape:d}}),m=Tr({inputs:{x:p},backend:n,attrs:{perm:h}}),g=ze({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(b=>n.disposeIntermediateTensorInfo(b)),g},fve={kernelName:Mg,backendName:"webgl",kernelFunc:hve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pve(t){const{inputs:e,backend:n}=t,{indices:r,values:o,denseShape:s,defaultValue:i}=e;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(r.dataId),l=n.readSync(o.dataId),c=n.readSync(s.dataId),u=n.readSync(i.dataId)[0],[d,h,f,p,m]=aue(a,r.shape,r.dtype,l,o.dtype,c,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],o.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const mve={kernelName:l1,backendName:"webgl",kernelFunc:pve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gve(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:o,newShape:s}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${o.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const i=Array.from(n.readSync(o.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(s.dataId)),[c,u,d]=lue(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],s.dtype,new Int32Array(d))]}const bve={kernelName:c1,backendName:"webgl",kernelFunc:gve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vve(t){const{inputs:e,backend:n}=t,{data:r,indices:o,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);const i=n.readSync(r.dataId),a=n.readSync(o.dataId),l=n.readSync(s.dataId),[c,u]=nO(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(u,r.dtype,c)}const xve={kernelName:u1,backendName:"webgl",kernelFunc:vve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t){const{inputs:e,backend:n}=t,{data:r,indices:o,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);const i=n.readSync(r.dataId),a=n.readSync(o.dataId),l=n.readSync(s.dataId),[c,u]=nO(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(u,r.dtype,c)}const wve={kernelName:d1,backendName:"webgl",kernelFunc:yve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cve(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:o,sparseValues:s,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Fh(s,o,a),f=!1;if(s.dtype==="string"){const b=n.bufferSync(o),v=n.bufferSync(s),w=Wi(n.readSync(i.dataId)[0]),y=oue(b,v,a,h,u,c,l,d,w,f);return n.makeTensorInfo(a,y.dtype,y.values)}const p=new DO(c,l,o.shape.length,s.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[s,o,i],s.dtype),g=ze({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}const $ve={kernelName:_R,backendName:"webgl",kernelFunc:Cve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sve(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{numOrSizeSplits:s,axis:i}=r,a=Ct(i,o.shape)[0],l=Aw(o,s,a),c=o.shape.length,u=new Array(c).fill(0),d=o.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=au({inputs:{x:o},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,p})}const Ive={kernelName:Lg,backendName:"webgl",kernelFunc:Sve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qk="return sqrt(x);",kve=_t({opSnippet:qk,packedOpSnippet:qk,cpuKernelImpl:cue}),Tve={kernelName:Th,backendName:"webgl",kernelFunc:kve};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eve="return x * x;",Rve=_t({opSnippet:Eve}),Nve={kernelName:h1,backendName:"webgl",kernelFunc:Rve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xk="return (a - b) * (a - b);",_ve=lr({opSnippet:Xk,packedOpSnippet:Xk}),Ave={kernelName:Eh,backendName:"webgl",kernelFunc:_ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dve({inputs:t,attrs:e,backend:n}){const{x:r}=t,o=Uo+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,s=new Ts(r.shape,o);return n.runWebGLProgram(s,[r],r.dtype)}const Fve={kernelName:Dh,backendName:"webgl",kernelFunc:Dve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ove{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const o=r.length,s=Qt(r.length),i=Qt(r.length);let a="";if(o===1)a="coords * strides + begin";else{let l=0;a=r.map((c,u)=>(l++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${e});
      ${s} strides = ${s}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pve(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{begin:s,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:b,begin:v,end:w,strides:y}=_1(o.shape,s,i,a,l,c,u,d,h);let C;if(m)C=ze({inputs:{x:o},backend:n,attrs:{shape:p}});else if(g||b){D(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);const $=E1(v,w,y),I=au({inputs:{x:o},backend:n,attrs:{begin:v,size:$}});C=ze({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([o])){const I=n.readSync(o.dataId),R=wt(o.shape,o.dtype,I),T=uue(f,R,y,v);C=n.makeTensorInfo(p,o.dtype,T.values)}else{const I=new Ove(v,y,f);C=n.runWebGLProgram(I,[o],o.dtype)}const S=ze({inputs:{x:C},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(C),S}const Mve={kernelName:f1,backendName:"webgl",kernelFunc:Pve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lve(t){const{inputs:e,backend:n,attrs:r}=t,{separator:o,nGramWidths:s,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,m]=due(h,f,o,s,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const Bve={kernelName:p1,backendName:"webgl",kernelFunc:Lve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zve(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:o}=r,{input:s,delimiter:i}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(s.dataId),l=n.readSync(i.dataId)[0],[c,u,d]=hue(a,l,o),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Wve={kernelName:m1,backendName:"webgl",kernelFunc:zve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:o}=r,{input:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(s.dataId),a=fue(i,o);return n.makeTensorInfo(s.shape,"int32",a)}const Uve={kernelName:g1,backendName:"webgl",kernelFunc:Vve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hve="return tan(x);",Gve=_t({opSnippet:Hve}),jve={kernelName:Nh,backendName:"webgl",kernelFunc:Gve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kve=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,qve=_t({opSnippet:Kve}),Xve={kernelName:_h,backendName:"webgl",kernelFunc:qve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yve{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[i]*n[i];this.outputShape=r,this.rank=r.length;const o=Qt(this.rank),s=Zve(e);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}}function Zve(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let o=0;o<t.length;o++)r.push(`imod(${n[o]}, ${t[o]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FO(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reps:s}=r;if(o.dtype==="string"||o.shape.length>5){const l=n.readSync(o.dataId),c=o.dtype==="string"?l.map(h=>Wi(h)):l,u=wt(o.shape,o.dtype,c),d=mue(u,s);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new Yve(o.shape,s);return n.runWebGLProgram(i,[o],o.dtype)}const Jve={kernelName:Ah,backendName:"webgl",kernelFunc:FO};class Qve{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class exe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xa(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function Yk(t){let e=1;for(;e<t;)e*=2;return e}function txe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{k:s,sorted:i}=r,a=ue().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ue().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=o.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([o])||u<a||s>l){const T=n.readSync(o.dataId),[N,_]=gue(T,c,o.dtype,s,i);return[n.makeTensorInfo(N.shape,N.dtype,N.values),n.makeTensorInfo(_.shape,_.dtype,_.values)]}if(s===0)return c[c.length-1]=0,[n.makeTensorInfo(c,o.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[o,of({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(o.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(o):o,m=me(c)/u,g=ze({inputs:{x:f},attrs:{shape:[m,u]},backend:n});h&&xa(n,f);const b=Yk(s),v=Yk(u);let w=null;const y=()=>w===null?[g,g]:[g,w],C=(T,N,_)=>{const P=y(),z=new Qve(_),O=[[u],[w===null?1:0],[Number.NEGATIVE_INFINITY],[T],[N]],B=w;w=n.runWebGLProgram(z,P,"int32",O),xa(n,B)};for(let T=1;T<b;T*=2){const N=T*2;for(let _=T;_>=1;_/=2)C(N,_,[m,v])}for(let T=v;T>b;T/=2){const N=y(),_=new exe([m,T/2]),z=[[u],[w===null?1:0],[b]],L=w;w=n.runWebGLProgram(_,N,"int32",z),xa(n,L);const O=b/2,B=O*2;for(let U=O;U>=1;U/=2)C(B,U,w.shape)}let S=w;w=au({inputs:{x:w},backend:n,attrs:{begin:0,size:[m,s]}}),xa(n,S);let $=IO({inputs:{x:g,indices:w},backend:n,attrs:{axis:1,batchDims:1}});xa(n,g);const I=c.slice(0,-1);I.push(s),S=w,w=ze({inputs:{x:w},attrs:{shape:I},backend:n}),xa(n,S);const R=$;return $=ze({inputs:{x:$},attrs:{shape:I},backend:n}),xa(n,R),[$,w]}const nxe={kernelName:b1,backendName:"webgl",kernelFunc:txe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rxe{constructor(e,n,r,o,s,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=r==="nearest"?1:2;let l;switch(o){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oxe(t){const{inputs:e,backend:n,attrs:r}=t,{image:o,transforms:s}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=r,[u,d,h,f]=o.shape,[p,m]=c!=null?c:[d,h],g=[u,p,m,f],b=new rxe(d,h,i,a,l,g);return n.runWebGLProgram(b,[o,s],"float32")}const sxe={kernelName:v1,backendName:"webgl",kernelFunc:oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ixe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:o}=n,{x:s}=e;Qh(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(s.dataId),{outputValues:a,outputShape:l,indices:c}=bue(i,o,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}const axe={kernelName:x1,backendName:"webgl",kernelFunc:ixe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lxe(t){const{inputs:e,backend:n,attrs:r}=t,{value:o}=e;let{axis:s}=r;s<0&&(s+=o.shape.length);const i=o,a=i.shape.length,l=o.shape[s],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==s&&(c[u++]=i.shape[m]);const d=[],h=new Array(a).fill(0),f=i.shape.slice();f[s]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[s]=m;const g=au({inputs:{x:i},backend:n,attrs:{begin:h,size:f}}),b=ze({inputs:{x:g},backend:n,attrs:{shape:c}});p[m]=b,d.push(g)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const cxe={kernelName:zg,backendName:"webgl",kernelFunc:lxe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uxe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,o=e.batchSize,s=e.inSize,i=e.numSegments,a=i*Math.ceil(s/r);this.outputShape=[o,a];const l="0.0",c="sumValue",u=Math.floor(r/4)*4,d=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";s%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,segmentIds:s}=e,{numSegments:i}=r,a=o.shape.length,l=[];let c=0;const u=wn([c],a);let d=o;u!=null&&(d=Tr({inputs:{x:o},backend:n,attrs:{perm:u}}),l.push(d),c=En(1,a)[0]);const h=$_(d.shape,c,i),f=me([d.shape[c]]),p=ze({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=C1(o.dtype),g=(y,C,S,$,I)=>{const R=y.shape[0],T=y.shape[1],N=C_(T,I),_={windowSize:N,inSize:T,batchSize:R,numSegments:I},P=new uxe(_,C),z=n.compileAndRun(P,[y,S],$);if(l.push(z),z.shape[1]===I)return z;const L=AO({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),O=FO({inputs:{x:L},backend:n,attrs:{reps:[T/N]}});return l.push(L),l.push(O),g(z,C,O,$,I)},b=g(p,"unsortedSegmentSum",s,m,i),v=ze({inputs:{x:b},backend:n,attrs:{shape:h}});let w=v;if(u!=null){l.push(v);const y=ea(u);w=Tr({inputs:{x:w},backend:n,attrs:{perm:y}})}return l.forEach(y=>n.disposeIntermediateTensorInfo(y)),w}const hxe={kernelName:Wg,backendName:"webgl",kernelFunc:dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fxe=[lde,ude,fde,gde,vde,wde,$de,Ide,Rde,_de,Fde,Mde,zde,Hde,Kde,Xde,Zde,the,rhe,she,che,ghe,vhe,yhe,khe,Ehe,Ahe,Gue,Ohe,zhe,Hhe,Yhe,Jhe,efe,nfe,ofe,afe,ufe,ffe,mfe,bfe,xfe,Cfe,Sfe,Efe,Nfe,Dfe,Pfe,Lfe,Vfe,jfe,Yfe,Qfe,npe,rpe,spe,ape,cpe,dpe,fpe,bpe,ype,$pe,Ipe,Epe,_pe,Ope,Bpe,Hue,Wpe,Lhe,Hpe,Kpe,Ype,Kue,eme,ome,ime,ume,fme,bme,yme,Sme,Eme,_me,Dme,Mme,Bme,Wme,Gme,Kme,Xme,Zme,Qme,rge,age,dge,xge,Yue,$ge,kge,Rge,Age,Che,Oge,Mge,Bge,Vge,jge,Xue,qge,Yge,Jge,ebe,tbe,$he,mge,obe,lbe,hbe,Jue,gbe,xbe,$be,kbe,Nbe,Abe,Obe,Lbe,zbe,Ube,jbe,Xbe,Qbe,nve,sve,lve,phe,bge,dve,fve,mve,bve,xve,wve,$ve,Ive,Tve,Nve,Ave,Fve,Mve,Bve,Wve,Uve,gge,sde,jve,Xve,Jve,nxe,sxe,ide,axe,cxe,hxe,Pge];for(const t of fxe)DR(t);/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OO(t="indexeddb://gesture-recongition-model"){let e=null;const n=lR("gesture-recognition-model-labels",{0:"victory",1:"pause",2:"spiderman",3:"l",4:"flat"}),r=async s=>{let i="",a=0;try{const l=ic(s.tensoredLandmarks,[1,42]),u=await(await(await o()).predict(l)).array();a=Math.max(...u[0]);const d=u[0].indexOf(a);i=n.value[d],console.log("PREDICTION",i,a)}catch(l){console.error(l)}return{className:i,probability:a}},o=async()=>{if(!e)try{e=await t0(t)}catch(s){e=await t0("model/gesture-recongition-model.json"),console.error("Error loading indexedDB model, using default",s)}return e};return{predict:r}}const pxe=lt({__name:"InIframe",setup(t){const{predict:e}=OO();Wm(Vm).on(async({landmarks:i})=>{for(const a of i){const l=await e(a);window.parent.postMessage({message:"gesture",value:l.className,probability:l.probability},"*")}});const r=Ne(null);function o(){var i;(i=r.value)==null||i.startCamera()}function s(){var i;(i=r.value)==null||i.stopCamera()}return addEventListener("message",i=>{switch(i.data){case"startRecognition":o();break;case"stopRecognition":s();break}}),(i,a)=>(Zr(),Oc(cR,{ref_key:"gestures",ref:r,"throttle-landmarks":100},null,512))}});/*!
  * pinia v2.0.28
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let PO;const Cb=t=>PO=t,MO=Symbol();function l0(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var qu;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(qu||(qu={}));function mxe(){const t=x2(!0),e=t.run(()=>Ne({}));let n=[],r=[];const o=dc({install(s){Cb(o),o._a=s,s.provide(MO,o),s.config.globalProperties.$pinia=o,r.forEach(i=>n.push(i)),r=[]},use(s){return!this._a&&!kj?r.push(s):n.push(s),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return o}const LO=()=>{};function Zk(t,e,n,r=LO){t.push(e);const o=()=>{const s=t.indexOf(e);s>-1&&(t.splice(s,1),r())};return!n&&V0()&&y2(o),o}function zl(t,...e){t.slice().forEach(n=>{n(...e)})}function c0(t,e){t instanceof Map&&e instanceof Map&&e.forEach((n,r)=>t.set(r,n)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n],o=t[n];l0(o)&&l0(r)&&t.hasOwnProperty(n)&&!$n(r)&&!Zs(r)?t[n]=c0(o,r):t[n]=r}return t}const gxe=Symbol();function bxe(t){return!l0(t)||!t.hasOwnProperty(gxe)}const{assign:Si}=Object;function vxe(t){return!!($n(t)&&t.effect)}function xxe(t,e,n,r){const{state:o,actions:s,getters:i}=e,a=n.state.value[t];let l;function c(){a||(n.state.value[t]=o?o():{});const u=S3(n.state.value[t]);return Si(u,s,Object.keys(i||{}).reduce((d,h)=>(d[h]=dc(Me(()=>{Cb(n);const f=n._s.get(t);return i[h].call(f,f)})),d),{}))}return l=BO(t,c,e,n,r,!0),l.$reset=function(){const d=o?o():{};this.$patch(h=>{Si(h,d)})},l}function BO(t,e,n={},r,o,s){let i;const a=Si({actions:{}},n),l={deep:!0};let c,u,d=dc([]),h=dc([]),f;const p=r.state.value[t];!s&&!p&&(r.state.value[t]={}),Ne({});let m;function g($){let I;c=u=!1,typeof $=="function"?($(r.state.value[t]),I={type:qu.patchFunction,storeId:t,events:f}):(c0(r.state.value[t],$),I={type:qu.patchObject,payload:$,storeId:t,events:f});const R=m=Symbol();Do().then(()=>{m===R&&(c=!0)}),u=!0,zl(d,I,r.state.value[t])}const b=LO;function v(){i.stop(),d=[],h=[],r._s.delete(t)}function w($,I){return function(){Cb(r);const R=Array.from(arguments),T=[],N=[];function _(L){T.push(L)}function P(L){N.push(L)}zl(h,{args:R,name:$,store:C,after:_,onError:P});let z;try{z=I.apply(this&&this.$id===t?this:C,R)}catch(L){throw zl(N,L),L}return z instanceof Promise?z.then(L=>(zl(T,L),L)).catch(L=>(zl(N,L),Promise.reject(L))):(zl(T,z),z)}}const y={_p:r,$id:t,$onAction:Zk.bind(null,h),$patch:g,$reset:b,$subscribe($,I={}){const R=Zk(d,$,I.detached,()=>T()),T=i.run(()=>Fn(()=>r.state.value[t],N=>{(I.flush==="sync"?u:c)&&$({storeId:t,type:qu.direct,events:f},N)},Si({},l,I)));return R},$dispose:v},C=pl(y);r._s.set(t,C);const S=r._e.run(()=>(i=x2(),i.run(()=>e())));for(const $ in S){const I=S[$];if($n(I)&&!vxe(I)||Zs(I))s||(p&&bxe(I)&&($n(I)?I.value=p[$]:c0(I,p[$])),r.state.value[t][$]=I);else if(typeof I=="function"){const R=w($,I);S[$]=R,a.actions[$]=I}}return Si(C,S),Si(At(C),S),Object.defineProperty(C,"$state",{get:()=>r.state.value[t],set:$=>{g(I=>{Si(I,$)})}}),r._p.forEach($=>{Si(C,i.run(()=>$({store:C,app:r._a,pinia:r,options:a})))}),p&&s&&n.hydrate&&n.hydrate(C.$state,p),c=!0,u=!0,C}function yxe(t,e,n){let r,o;const s=typeof e=="function";typeof t=="string"?(r=t,o=s?n:e):(o=t,r=t.id);function i(a,l){const c=Pc();return a=a||c&&Kt(MO,null),a&&Cb(a),a=PO,a._s.has(r)||(s?BO(r,e,o,a):xxe(r,o,a)),a._s.get(r)}return i.$id=r,i}function wxe(t){{t=At(t);const e={};for(const n in t){const r=t[n];($n(r)||Zs(r))&&(e[n]=Bn(t,n))}return e}}const Cxe=yxe("captureControl",()=>{const t=Ne(""),e=Ne(!1);function n(){e.value=!0}function r(){e.value=!1}function o(s){t.value=s}return{label:t,capture:e,startCapture:n,stopCapture:r,setLabel:o}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Rt=function(){return Rt=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Rt.apply(this,arguments)};function u0(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var pn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Gn=Object.keys,Ir=Array.isArray;typeof Promise<"u"&&!pn.Promise&&(pn.Promise=Promise);function Pr(t,e){return typeof e!="object"||Gn(e).forEach(function(n){t[n]=e[n]}),t}var Id=Object.getPrototypeOf,$xe={}.hasOwnProperty;function go(t,e){return $xe.call(t,e)}function _c(t,e){typeof e=="function"&&(e=e(Id(t))),(typeof Reflect>"u"?Gn:Reflect.ownKeys)(e).forEach(function(n){ri(t,n,e[n])})}var zO=Object.defineProperty;function ri(t,e,n,r){zO(t,e,Pr(n&&go(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function lu(t){return{from:function(e){return t.prototype=Object.create(e.prototype),ri(t.prototype,"constructor",t),{extend:_c.bind(null,t.prototype)}}}}var Sxe=Object.getOwnPropertyDescriptor;function xC(t,e){var n=Sxe(t,e),r;return n||(r=Id(t))&&xC(r,e)}var Ixe=[].slice;function $b(t,e,n){return Ixe.call(t,e,n)}function WO(t,e){return e(t)}function Fu(t){if(!t)throw new Error("Assertion Failed")}function VO(t){pn.setImmediate?setImmediate(t):setTimeout(t,0)}function UO(t,e){return t.reduce(function(n,r,o){var s=e(r,o);return s&&(n[s[0]]=s[1]),n},{})}function kxe(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function Js(t,e){if(go(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,o=e.length;r<o;++r){var s=Js(t,e[r]);n.push(s)}return n}var i=e.indexOf(".");if(i!==-1){var a=t[e.substr(0,i)];return a===void 0?void 0:Js(a,e.substr(i+1))}}function ts(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){Fu(typeof n!="string"&&"length"in n);for(var r=0,o=e.length;r<o;++r)ts(t,e[r],n[r])}else{var s=e.indexOf(".");if(s!==-1){var i=e.substr(0,s),a=e.substr(s+1);if(a==="")n===void 0?Ir(t)&&!isNaN(parseInt(i))?t.splice(i,1):delete t[i]:t[i]=n;else{var l=t[i];(!l||!go(t,i))&&(l=t[i]={}),ts(l,a,n)}}else n===void 0?Ir(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Txe(t,e){typeof e=="string"?ts(t,e,void 0):"length"in e&&[].map.call(e,function(n){ts(t,n,void 0)})}function HO(t){var e={};for(var n in t)go(t,n)&&(e[n]=t[n]);return e}var Exe=[].concat;function GO(t){return Exe.apply([],t)}var jO="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(GO([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return pn[t]}),Rxe=jO.map(function(t){return pn[t]});UO(jO,function(t){return[t,!0]});var Ii=null;function sf(t){Ii=typeof WeakMap<"u"&&new WeakMap;var e=d0(t);return Ii=null,e}function d0(t){if(!t||typeof t!="object")return t;var e=Ii&&Ii.get(t);if(e)return e;if(Ir(t)){e=[],Ii&&Ii.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(d0(t[n]))}else if(Rxe.indexOf(t.constructor)>=0)e=t;else{var o=Id(t);e=o===Object.prototype?{}:Object.create(o),Ii&&Ii.set(t,e);for(var s in t)go(t,s)&&(e[s]=d0(t[s]))}return e}var Nxe={}.toString;function h0(t){return Nxe.call(t).slice(8,-1)}var f0=typeof Symbol<"u"?Symbol.iterator:"@@iterator",_xe=typeof f0=="symbol"?function(t){var e;return t!=null&&(e=t[f0])&&e.apply(t)}:function(){return null},ql={};function Xs(t){var e,n,r,o;if(arguments.length===1){if(Ir(t))return t.slice();if(this===ql&&typeof t=="string")return[t];if(o=_xe(t)){for(n=[];r=o.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var yC=typeof Symbol<"u"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Bs=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function KO(t,e){Bs=t,qO=e}var qO=function(){return!0},Axe=!new Error("").stack;function El(){if(Axe)try{throw El.arguments,new Error}catch(t){return t}return new Error}function p0(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(qO).map(function(r){return`
`+r}).join("")):""}var Dxe=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],XO=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],wC=Dxe.concat(XO),Fxe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function cu(t,e){this._e=El(),this.name=t,this.message=e}lu(cu).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+p0(this._e,2))}},toString:function(){return this.name+": "+this.message}});function YO(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,o){return o.indexOf(n)===r}).join(`
`)}function hm(t,e,n,r){this._e=El(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=YO(t,e)}lu(hm).from(cu);function Xu(t,e){this._e=El(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=YO(t,e)}lu(Xu).from(cu);var CC=wC.reduce(function(t,e){return t[e]=e+"Error",t},{}),Oxe=cu,ct=wC.reduce(function(t,e){var n=e+"Error";function r(o,s){this._e=El(),this.name=n,o?typeof o=="string"?(this.message=""+o+(s?`
 `+s:""),this.inner=s||null):typeof o=="object"&&(this.message=o.name+" "+o.message,this.inner=o):(this.message=Fxe[e]||n,this.inner=null)}return lu(r).from(Oxe),t[e]=r,t},{});ct.Syntax=SyntaxError;ct.Type=TypeError;ct.Range=RangeError;var Jk=XO.reduce(function(t,e){return t[e+"Error"]=ct[e],t},{});function Pxe(t,e){if(!t||t instanceof cu||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Jk[t.name])return t;var n=new Jk[t.name](e||t.message,t);return"stack"in t&&ri(n,"stack",{get:function(){return this.inner.stack}}),n}var Sb=wC.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=ct[e]),t},{});Sb.ModifyError=hm;Sb.DexieError=cu;Sb.BulkError=Xu;function Yt(){}function af(t){return t}function Mxe(t,e){return t==null||t===af?e:function(n){return e(t(n))}}function hl(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Lxe(t,e){return t===Yt?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?hl(r,this.onsuccess):r),o&&(this.onerror=this.onerror?hl(o,this.onerror):o),s!==void 0?s:n}}function Bxe(t,e){return t===Yt?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?hl(n,this.onsuccess):n),r&&(this.onerror=this.onerror?hl(r,this.onerror):r)}}function zxe(t,e){return t===Yt?e:function(n){var r=t.apply(this,arguments);Pr(n,r);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?hl(o,this.onsuccess):o),s&&(this.onerror=this.onerror?hl(s,this.onerror):s),r===void 0?i===void 0?void 0:i:Pr(r,i)}}function Wxe(t,e){return t===Yt?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function $C(t,e){return t===Yt?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}var kd={},Vxe=100,Uxe=20,ZO=100,SC=typeof Promise>"u"?[]:function(){var t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,Id(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Id(e),t]}(),m0=SC[0],fm=SC[1],g0=SC[2],JO=fm&&fm.then,xp=m0&&m0.constructor,IC=!!g0,b0=!1,Hxe=g0?function(){g0.then(lp)}:pn.setImmediate?setImmediate.bind(null,lp):pn.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){lp(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(lp,0)},Td=function(t,e){Ou.push([t,e]),pm&&(Hxe(),pm=!1)},v0=!0,pm=!0,qa=[],yp=[],x0=null,y0=af,cc={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:t2,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{t2(t[0],t[1])}catch{}})}},st=cc,Ou=[],Xa=0,wp=[];function je(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Yt,this._lib=!1;var e=this._PSD=st;if(Bs&&(this._stackHolder=El(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==kd)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&C0(this,this._value);return}this._state=null,this._value=null,++e.ref,eP(this,t)}var w0={get:function(){var t=st,e=mm;function n(r,o){var s=this,i=!t.global&&(t!==st||e!==mm),a=i&&!oi(),l=new je(function(c,u){kC(s,new QO(bm(r,t,i,a),bm(o,t,i,a),c,u,t))});return Bs&&rP(l,this),l}return n.prototype=kd,n},set:function(t){ri(this,"then",t&&t.prototype===kd?w0:{get:function(){return t},set:w0.set})}};_c(je.prototype,{then:w0,_then:function(t,e){kC(this,new QO(null,null,t,e,st))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,function(r){return r instanceof e?n(r):Cp(r)}):this.then(null,function(r){return r&&r.name===e?n(r):Cp(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),Cp(e)})},stack:{get:function(){if(this._stack)return this._stack;try{b0=!0;var t=nP(this,[],Uxe),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{b0=!1}}},timeout:function(t,e){var n=this;return t<1/0?new je(function(r,o){var s=setTimeout(function(){return o(new ct.Timeout(e))},t);n.then(r,o).finally(clearTimeout.bind(null,s))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&ri(je.prototype,Symbol.toStringTag,"Dexie.Promise");cc.env=oP();function QO(t,e,n,r,o){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=o}_c(je,{all:function(){var t=Xs.apply(null,arguments).map(gm);return new je(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(o,s){return je.resolve(o).then(function(i){t[s]=i,--r||e(t)},n)})})},resolve:function(t){if(t instanceof je)return t;if(t&&typeof t.then=="function")return new je(function(n,r){t.then(n,r)});var e=new je(kd,!0,t);return rP(e,x0),e},reject:Cp,race:function(){var t=Xs.apply(null,arguments).map(gm);return new je(function(e,n){t.map(function(r){return je.resolve(r).then(e,n)})})},PSD:{get:function(){return st},set:function(t){return st=t}},totalEchoes:{get:function(){return mm}},newPSD:qi,usePSD:du,scheduler:{get:function(){return Td},set:function(t){Td=t}},rejectionMapper:{get:function(){return y0},set:function(t){y0=t}},follow:function(t,e){return new je(function(n,r){return qi(function(o,s){var i=st;i.unhandleds=[],i.onunhandled=s,i.finalize=hl(function(){var a=this;jxe(function(){a.unhandleds.length===0?o():s(a.unhandleds[0])})},i.finalize),t()},e,n,r)})}});xp&&(xp.allSettled&&ri(je,"allSettled",function(){var t=Xs.apply(null,arguments).map(gm);return new je(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(o,s){return je.resolve(o).then(function(i){return r[s]={status:"fulfilled",value:i}},function(i){return r[s]={status:"rejected",reason:i}}).then(function(){return--n||e(r)})})})}),xp.any&&typeof AggregateError<"u"&&ri(je,"any",function(){var t=Xs.apply(null,arguments).map(gm);return new je(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,o=new Array(r);t.forEach(function(s,i){return je.resolve(s).then(function(a){return e(a)},function(a){o[i]=a,--r||n(new AggregateError(o))})})})}));function eP(t,e){try{e(function(n){if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&lf();n&&typeof n.then=="function"?eP(t,function(o,s){n instanceof je?n._then(o,s):n.then(o,s)}):(t._state=!0,t._value=n,tP(t)),r&&cf()}},C0.bind(null,t))}catch(n){C0(t,n)}}function C0(t,e){if(yp.push(e),t._state===null){var n=t._lib&&lf();e=y0(e),t._state=!1,t._value=e,Bs&&e!==null&&typeof e=="object"&&!e._promise&&kxe(function(){var r=xC(e,"stack");e._promise=t,ri(e,"stack",{get:function(){return b0?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),Kxe(t),tP(t),n&&cf()}}function tP(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)kC(t,e[n]);var o=t._PSD;--o.ref||o.finalize(),Xa===0&&(++Xa,Td(function(){--Xa===0&&TC()},[]))}function kC(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Xa,Td(Gxe,[n,t,e])}function Gxe(t,e,n){try{x0=e;var r,o=e._value;e._state?r=t(o):(yp.length&&(yp=[]),r=t(o),yp.indexOf(o)===-1&&qxe(e)),n.resolve(r)}catch(s){n.reject(s)}finally{x0=null,--Xa===0&&TC(),--n.psd.ref||n.psd.finalize()}}function nP(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var o=t._value,s,i;o!=null?(s=o.name||"Error",i=o.message||o,r=p0(o,0)):(s=o,i=""),e.push(s+(i?": "+i:"")+r)}return Bs&&(r=p0(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&nP(t._prev,e,n)),e}function rP(t,e){var n=e?e._numPrev+1:0;n<Vxe&&(t._prev=e,t._numPrev=n)}function lp(){lf()&&cf()}function lf(){var t=v0;return v0=!1,pm=!1,t}function cf(){var t,e,n;do for(;Ou.length>0;)for(t=Ou,Ou=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(Ou.length>0);v0=!0,pm=!0}function TC(){var t=qa;qa=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=wp.slice(0),n=e.length;n;)e[--n]()}function jxe(t){function e(){t(),wp.splice(wp.indexOf(e),1)}wp.push(e),++Xa,Td(function(){--Xa===0&&TC()},[])}function Kxe(t){qa.some(function(e){return e._value===t._value})||qa.push(t)}function qxe(t){for(var e=qa.length;e;)if(qa[--e]._value===t._value){qa.splice(e,1);return}}function Cp(t){return new je(kd,!1,t)}function vn(t,e){var n=st;return function(){var r=lf(),o=st;try{return Xi(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{Xi(o,!1),r&&cf()}}}var Sr={awaits:0,echoes:0,id:0},Xxe=0,$p=[],_v=0,mm=0,Yxe=0;function qi(t,e,n,r){var o=st,s=Object.create(o);s.parent=o,s.ref=0,s.global=!1,s.id=++Yxe;var i=cc.env;s.env=IC?{Promise:je,PromiseProp:{value:je,configurable:!0,writable:!0},all:je.all,race:je.race,allSettled:je.allSettled,any:je.any,resolve:je.resolve,reject:je.reject,nthen:Qk(i.nthen,s),gthen:Qk(i.gthen,s)}:{},e&&Pr(s,e),++o.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=du(s,t,n,r);return s.ref===0&&s.finalize(),a}function uu(){return Sr.id||(Sr.id=++Xxe),++Sr.awaits,Sr.echoes+=ZO,Sr.id}function oi(){return Sr.awaits?(--Sr.awaits===0&&(Sr.id=0),Sr.echoes=Sr.awaits*ZO,!0):!1}(""+JO).indexOf("[native code]")===-1&&(uu=oi=Yt);function gm(t){return Sr.echoes&&t&&t.constructor===xp?(uu(),t.then(function(e){return oi(),e},function(e){return oi(),Qn(e)})):t}function Zxe(t){++mm,(!Sr.echoes||--Sr.echoes===0)&&(Sr.echoes=Sr.id=0),$p.push(st),Xi(t,!0)}function Jxe(){var t=$p[$p.length-1];$p.pop(),Xi(t,!1)}function Xi(t,e){var n=st;if((e?Sr.echoes&&(!_v++||t!==st):_v&&(!--_v||t!==st))&&sP(e?Zxe.bind(null,t):Jxe),t!==st&&(st=t,n===cc&&(cc.env=oP()),IC)){var r=cc.env.Promise,o=t.env;fm.then=o.nthen,r.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(pn,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function oP(){var t=pn.Promise;return IC?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(pn,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:fm.then,gthen:t.prototype.then}:{}}function du(t,e,n,r,o){var s=st;try{return Xi(t,!0),e(n,r,o)}finally{Xi(s,!1)}}function sP(t){JO.call(m0,t)}function bm(t,e,n,r){return typeof t!="function"?t:function(){var o=st;n&&uu(),Xi(e,!0);try{return t.apply(this,arguments)}finally{Xi(o,!1),r&&sP(oi)}}}function Qk(t,e){return function(n,r){return t.call(this,bm(n,e),bm(r,e))}}var e2="unhandledrejection";function t2(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,o={promise:e,reason:t};if(pn.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(e2,!0,!0),Pr(r,o)):pn.CustomEvent&&(r=new CustomEvent(e2,{detail:o}),Pr(r,o)),r&&pn.dispatchEvent&&(dispatchEvent(r),!pn.PromiseRejectionEvent&&pn.onunhandledrejection))try{pn.onunhandledrejection(r)}catch{}Bs&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var Qn=je.reject;function $0(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!st.letThrough&&!t._vip){if(t._state.openComplete)return Qn(new ct.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Qn(new ct.DatabaseClosed);t.open().catch(Yt)}return t._state.dbReadyPromise.then(function(){return $0(t,e,n,r)})}else{var o=t._createTransaction(e,n,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===CC.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return $0(t,e,n,r)})):Qn(s)}return o._promise(e,function(s,i){return qi(function(){return st.trans=o,r(s,i,o)})}).then(function(s){return o._completion.then(function(){return s})})}}var n2="3.2.2",Ma=String.fromCharCode(65535),S0=-1/0,Vs="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",iP="String expected.",Yu=[],Ib=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Qxe=Ib,e0e=Ib,aP=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},kb="__dbnames",Av="readonly",Dv="readwrite";function fl(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var lP={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function cp(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=sf(e),delete e[t]),e}:function(e){return e}}var t0e=function(){function t(){}return t.prototype._trans=function(e,n,r){var o=this._tx||st.trans,s=this.name;function i(l,c,u){if(!u.schema[s])throw new ct.NotFound("Table "+s+" not part of transaction");return n(u.idbtrans,u)}var a=lf();try{return o&&o.db===this.db?o===st.trans?o._promise(e,i,r):qi(function(){return o._promise(e,i,r)},{trans:o,transless:st.transless||st}):$0(this.db,e,[this.name],i)}finally{a&&cf()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(o){return r.core.get({trans:o,key:e}).then(function(s){return r.hook.reading.fire(s)})}).then(n)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(Ir(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=Gn(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(u){return u.compound&&n.every(function(d){return u.keyPath.indexOf(d)>=0})&&u.keyPath.every(function(d){return n.indexOf(d)>=0})})[0];if(r&&this.db._maxKey!==Ma)return this.where(r.name).equals(r.keyPath.map(function(u){return e[u]}));!r&&Bs&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var o=this.schema.idxByName,s=this.db._deps.indexedDB;function i(u,d){try{return s.cmp(u,d)===0}catch{return!1}}var a=n.reduce(function(u,d){var h=u[0],f=u[1],p=o[d],m=e[d];return[h||p,h||!p?fl(f,p&&p.multi?function(g){var b=Js(g,d);return Ir(b)&&b.some(function(v){return i(m,v)})}:function(g){return i(m,Js(g,d))}):f]},[null,null]),l=a[0],c=a[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(c):r?this.filter(c):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,Ir(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var o=Object.create(e.prototype);for(var s in r)if(go(r,s))try{o[s]=r[s]}catch{}return o};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){function e(n){Pr(this,n)}return this.mapToClass(e)},t.prototype.add=function(e,n){var r=this,o=this.schema.primKey,s=o.auto,i=o.keyPath,a=e;return i&&s&&(a=cp(i)(e)),this._trans("readwrite",function(l){return r.core.mutate({trans:l,type:"add",keys:n!=null?[n]:null,values:[a]})}).then(function(l){return l.numFailures?je.reject(l.failures[0]):l.lastResult}).then(function(l){if(i)try{ts(e,i,l)}catch{}return l})},t.prototype.update=function(e,n){if(typeof e=="object"&&!Ir(e)){var r=Js(e,this.schema.primKey.keyPath);if(r===void 0)return Qn(new ct.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?Gn(n).forEach(function(o){ts(e,o,n[o])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)},t.prototype.put=function(e,n){var r=this,o=this.schema.primKey,s=o.auto,i=o.keyPath,a=e;return i&&s&&(a=cp(i)(e)),this._trans("readwrite",function(l){return r.core.mutate({trans:l,type:"put",values:[a],keys:n!=null?[n]:null})}).then(function(l){return l.numFailures?je.reject(l.failures[0]):l.lastResult}).then(function(l){if(i)try{ts(e,i,l)}catch{}return l})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?je.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:lP})}).then(function(n){return n.numFailures?je.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(o){return o.map(function(s){return n.hook.reading.fire(s)})})})},t.prototype.bulkAdd=function(e,n,r){var o=this,s=Array.isArray(n)?n:void 0;r=r||(s?void 0:n);var i=r?r.allKeys:void 0;return this._trans("readwrite",function(a){var l=o.schema.primKey,c=l.auto,u=l.keyPath;if(u&&s)throw new ct.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new ct.InvalidArgument("Arguments objects and keys must have the same length");var d=e.length,h=u&&c?e.map(cp(u)):e;return o.core.mutate({trans:a,type:"add",keys:s,values:h,wantResults:i}).then(function(f){var p=f.numFailures,m=f.results,g=f.lastResult,b=f.failures,v=i?m:g;if(p===0)return v;throw new Xu(o.name+".bulkAdd(): "+p+" of "+d+" operations failed",b)})})},t.prototype.bulkPut=function(e,n,r){var o=this,s=Array.isArray(n)?n:void 0;r=r||(s?void 0:n);var i=r?r.allKeys:void 0;return this._trans("readwrite",function(a){var l=o.schema.primKey,c=l.auto,u=l.keyPath;if(u&&s)throw new ct.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new ct.InvalidArgument("Arguments objects and keys must have the same length");var d=e.length,h=u&&c?e.map(cp(u)):e;return o.core.mutate({trans:a,type:"put",keys:s,values:h,wantResults:i}).then(function(f){var p=f.numFailures,m=f.results,g=f.lastResult,b=f.failures,v=i?m:g;if(p===0)return v;throw new Xu(o.name+".bulkPut(): "+p+" of "+d+" operations failed",b)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(o){return n.core.mutate({trans:o,type:"delete",keys:e})}).then(function(o){var s=o.numFailures,i=o.lastResult,a=o.failures;if(s===0)return i;throw new Xu(n.name+".bulkDelete(): "+s+" of "+r+" operations failed",a)})},t}();function uf(t){var e={},n=function(a,l){if(l){for(var c=arguments.length,u=new Array(c-1);--c;)u[c-1]=arguments[c];return e[a].subscribe.apply(null,u),t}else if(typeof a=="string")return e[a]};n.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return n;function s(a,l,c){if(typeof a=="object")return i(a);l||(l=Wxe),c||(c=Yt);var u={subscribers:[],fire:c,subscribe:function(d){u.subscribers.indexOf(d)===-1&&(u.subscribers.push(d),u.fire=l(u.fire,d))},unsubscribe:function(d){u.subscribers=u.subscribers.filter(function(h){return h!==d}),u.fire=u.subscribers.reduce(l,c)}};return e[a]=n[a]=u,u}function i(a){Gn(a).forEach(function(l){var c=a[l];if(Ir(c))s(l,a[l][0],a[l][1]);else if(c==="asap")var u=s(l,af,function(){for(var h=arguments.length,f=new Array(h);h--;)f[h]=arguments[h];u.subscribers.forEach(function(p){VO(function(){p.apply(null,f)})})});else throw new ct.InvalidArgument("Invalid event config")})}}function df(t,e){return lu(e).from({prototype:t}),e}function n0e(t){return df(t0e.prototype,function(n,r,o){this.db=t,this._tx=o,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:uf(null,{creating:[Lxe,Yt],reading:[Mxe,af],updating:[zxe,Yt],deleting:[Bxe,Yt]})})}function Wl(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Fv(t,e){t.filter=fl(t.filter,e)}function Ov(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return fl(r(),e())}:e,t.justLimit=n&&!r}function r0e(t,e){t.isMatch=fl(t.isMatch,e)}function Sp(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new ct.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function r2(t,e,n){var r=Sp(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function up(t,e,n,r){var o=t.replayFilter?fl(t.filter,t.replayFilter()):t.filter;if(t.or){var s={},i=function(a,l,c){if(!o||o(l,c,function(h){return l.stop(h)},function(h){return l.fail(h)})){var u=l.primaryKey,d=""+u;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(u)),go(s,d)||(s[d]=!0,e(a,l,c))}};return Promise.all([t.or._iterate(i,n),o2(r2(t,r,n),t.algorithm,i,!t.keysOnly&&t.valueMapper)])}else return o2(r2(t,r,n),fl(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function o2(t,e,n,r){var o=r?function(i,a,l){return n(r(i),a,l)}:n,s=vn(o);return t.then(function(i){if(i)return i.start(function(){var a=function(){return i.continue()};(!e||e(i,function(l){return a=l},function(l){i.stop(l),a=Yt},function(l){i.fail(l),a=Yt}))&&s(i.value,i,function(l){return a=l}),a()})})}function Fr(t,e){try{var n=s2(t),r=s2(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return s0e(i2(t),i2(e));case"Array":return o0e(t,e)}}catch{}return NaN}function o0e(t,e){for(var n=t.length,r=e.length,o=n<r?n:r,s=0;s<o;++s){var i=Fr(t[s],e[s]);if(i!==0)return i}return n===r?0:n<r?-1:1}function s0e(t,e){for(var n=t.length,r=e.length,o=n<r?n:r,s=0;s<o;++s)if(t[s]!==e[s])return t[s]<e[s]?-1:1;return n===r?0:n<r?-1:1}function s2(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var n=h0(t);return n==="ArrayBuffer"?"binary":n}function i2(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var i0e=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,Qn.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,Qn.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=fl(n.algorithm,e)},t.prototype._iterate=function(e,n){return up(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Pr(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return up(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var o=n._ctx,s=o.table.core;if(Wl(o,!0))return s.count({trans:r,query:{index:Sp(o,s.schema),range:o.range}}).then(function(a){return Math.min(a,o.limit)});var i=0;return up(o,function(){return++i,!1},r,s).then(function(){return i})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),o=r[0],s=r.length-1;function i(c,u){return u?i(c[r[u]],u-1):c[o]}var a=this._ctx.dir==="next"?1:-1;function l(c,u){var d=i(c,s),h=i(u,s);return d<h?-a:d>h?a:0}return this.toArray(function(c){return c.sort(l)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var o=n._ctx;if(o.dir==="next"&&Wl(o,!0)&&o.limit>0){var s=o.valueMapper,i=Sp(o,o.table.core.schema);return o.table.core.query({trans:r,limit:o.limit,values:!0,query:{index:i,range:o.range}}).then(function(l){var c=l.result;return s?c.map(s):c})}else{var a=[];return up(o,function(l){return a.push(l)},r,o.table.core).then(function(){return a})}},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Wl(n)?Ov(n,function(){var r=e;return function(o,s){return r===0?!0:r===1?(--r,!1):(s(function(){o.advance(r),r=0}),!1)}}):Ov(n,function(){var r=e;return function(){return--r<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Ov(this._ctx,function(){var n=e;return function(r,o,s){return--n<=0&&o(s),n>=0}},!0),this},t.prototype.until=function(e,n){return Fv(this._ctx,function(r,o,s){return e(r.value)?(o(s),n):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return Fv(this._ctx,function(n){return e(n.value)}),r0e(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.key,o)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.primaryKey,o)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&Wl(n,!0)&&n.limit>0)return this._read(function(o){var s=Sp(n,n.table.core.schema);return n.table.core.query({trans:o,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(function(o){var s=o.result;return s}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return Fv(this._ctx,function(o){var s=o.primaryKey.toString(),i=go(r,s);return r[s]=!0,!i}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(o){var s;if(typeof e=="function")s=e;else{var i=Gn(e),a=i.length;s=function(b){for(var v=!1,w=0;w<a;++w){var y=i[w],C=e[y];Js(b,y)!==C&&(ts(b,y,C),v=!0)}return v}}var l=r.table.core,c=l.schema.primaryKey,u=c.outbound,d=c.extractKey,h=n.db._options.modifyChunkSize||200,f=[],p=0,m=[],g=function(b,v){var w=v.failures,y=v.numFailures;p+=b-y;for(var C=0,S=Gn(w);C<S.length;C++){var $=S[C];f.push(w[$])}};return n.clone().primaryKeys().then(function(b){var v=function(w){var y=Math.min(h,b.length-w);return l.getMany({trans:o,keys:b.slice(w,w+y),cache:"immutable"}).then(function(C){for(var S=[],$=[],I=u?[]:null,R=[],T=0;T<y;++T){var N=C[T],_={value:sf(N),primKey:b[w+T]};s.call(_,_.value,_)!==!1&&(_.value==null?R.push(b[w+T]):!u&&Fr(d(N),d(_.value))!==0?(R.push(b[w+T]),S.push(_.value)):($.push(_.value),u&&I.push(b[w+T])))}var P=Wl(r)&&r.limit===1/0&&(typeof e!="function"||e===Pv)&&{index:r.index,range:r.range};return Promise.resolve(S.length>0&&l.mutate({trans:o,type:"add",values:S}).then(function(z){for(var L in z.failures)R.splice(parseInt(L),1);g(S.length,z)})).then(function(){return($.length>0||P&&typeof e=="object")&&l.mutate({trans:o,type:"put",keys:I,values:$,criteria:P,changeSpec:typeof e!="function"&&e}).then(function(z){return g($.length,z)})}).then(function(){return(R.length>0||P&&e===Pv)&&l.mutate({trans:o,type:"delete",keys:R,criteria:P}).then(function(z){return g(R.length,z)})}).then(function(){return b.length>w+y&&v(w+h)})})};return v(0).then(function(){if(f.length>0)throw new hm("Error modifying one or more objects",f,p,m);return b.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return Wl(e)&&(e.isPrimKey&&!e0e||n.type===3)?this._write(function(r){var o=e.table.core.schema.primaryKey,s=n;return e.table.core.count({trans:r,query:{index:o,range:s}}).then(function(i){return e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(function(a){var l=a.failures;a.lastResult,a.results;var c=a.numFailures;if(c)throw new hm("Could not delete some values",Object.keys(l).map(function(u){return l[u]}),i-c);return i-c})})}):this.modify(Pv)},t}(),Pv=function(t,e){return e.value=null};function a0e(t){return df(i0e.prototype,function(n,r){this.db=t;var o=lP,s=null;if(r)try{o=r()}catch(c){s=c}var i=n._ctx,a=i.table,l=a.hook.reading.fire;this._ctx={table:a,index:i.index,isPrimKey:!i.index||a.schema.primKey.keyPath&&i.index===a.schema.primKey.name,range:o,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:s,or:i.or,valueMapper:l!==af?l:null}})}function l0e(t,e){return t<e?-1:t===e?0:1}function c0e(t,e){return t>e?-1:t===e?0:1}function so(t,e,n){var r=t instanceof uP?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Vl(t){return new t.Collection(t,function(){return cP("")}).limit(0)}function u0e(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function d0e(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function h0e(t,e,n,r,o,s){for(var i=Math.min(t.length,r.length),a=-1,l=0;l<i;++l){var c=e[l];if(c!==r[l])return o(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):o(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;o(t[l],c)<0&&(a=l)}return i<r.length&&s==="next"?t+n.substr(t.length):i<t.length&&s==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function dp(t,e,n,r){var o,s,i,a,l,c,u,d=n.length;if(!n.every(function(m){return typeof m=="string"}))return so(t,iP);function h(m){o=u0e(m),s=d0e(m),i=m==="next"?l0e:c0e;var g=n.map(function(b){return{lower:s(b),upper:o(b)}}).sort(function(b,v){return i(b.lower,v.lower)});a=g.map(function(b){return b.upper}),l=g.map(function(b){return b.lower}),c=m,u=m==="next"?"":r}h("next");var f=new t.Collection(t,function(){return xi(a[0],l[d-1]+r)});f._ondirectionchange=function(m){h(m)};var p=0;return f._addAlgorithm(function(m,g,b){var v=m.key;if(typeof v!="string")return!1;var w=s(v);if(e(w,l,p))return!0;for(var y=null,C=p;C<d;++C){var S=h0e(v,w,a[C],l[C],i,c);S===null&&y===null?p=C+1:(y===null||i(y,S)>0)&&(y=S)}return g(y!==null?function(){m.continue(y+u)}:b),!1}),f}function xi(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function cP(t){return{type:1,lower:t,upper:t}}var uP=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,o){r=r!==!1,o=o===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||o)&&!(r&&o)?Vl(this):new this.Collection(this,function(){return xi(e,n,!r,!o)})}catch{return so(this,Vs)}},t.prototype.equals=function(e){return e==null?so(this,Vs):new this.Collection(this,function(){return cP(e)})},t.prototype.above=function(e){return e==null?so(this,Vs):new this.Collection(this,function(){return xi(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?so(this,Vs):new this.Collection(this,function(){return xi(e,void 0,!1)})},t.prototype.below=function(e){return e==null?so(this,Vs):new this.Collection(this,function(){return xi(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?so(this,Vs):new this.Collection(this,function(){return xi(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?so(this,iP):this.between(e,e+Ma,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):dp(this,function(n,r){return n.indexOf(r[0])===0},[e],Ma)},t.prototype.equalsIgnoreCase=function(e){return dp(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=Xs.apply(ql,arguments);return e.length===0?Vl(this):dp(this,function(n,r){return r.indexOf(n)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=Xs.apply(ql,arguments);return e.length===0?Vl(this):dp(this,function(n,r){return r.some(function(o){return n.indexOf(o)===0})},e,Ma)},t.prototype.anyOf=function(){var e=this,n=Xs.apply(ql,arguments),r=this._cmp;try{n.sort(r)}catch{return so(this,Vs)}if(n.length===0)return Vl(this);var o=new this.Collection(this,function(){return xi(n[0],n[n.length-1])});o._ondirectionchange=function(i){r=i==="next"?e._ascending:e._descending,n.sort(r)};var s=0;return o._addAlgorithm(function(i,a,l){for(var c=i.key;r(c,n[s])>0;)if(++s,s===n.length)return a(l),!1;return r(c,n[s])===0?!0:(a(function(){i.continue(n[s])}),!1)}),o},t.prototype.notEqual=function(e){return this.inAnyRange([[S0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=Xs.apply(ql,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return so(this,Vs)}var n=e.reduce(function(r,o){return r?r.concat([[r[r.length-1][1],o]]):[[S0,o]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,o=this._cmp,s=this._ascending,i=this._descending,a=this._min,l=this._max;if(e.length===0)return Vl(this);if(!e.every(function(C){return C[0]!==void 0&&C[1]!==void 0&&s(C[0],C[1])<=0}))return so(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ct.InvalidArgument);var c=!n||n.includeLowers!==!1,u=n&&n.includeUppers===!0;function d(C,S){for(var $=0,I=C.length;$<I;++$){var R=C[$];if(o(S[0],R[1])<0&&o(S[1],R[0])>0){R[0]=a(R[0],S[0]),R[1]=l(R[1],S[1]);break}}return $===I&&C.push(S),C}var h=s;function f(C,S){return h(C[0],S[0])}var p;try{p=e.reduce(d,[]),p.sort(f)}catch{return so(this,Vs)}var m=0,g=u?function(C){return s(C,p[m][1])>0}:function(C){return s(C,p[m][1])>=0},b=c?function(C){return i(C,p[m][0])>0}:function(C){return i(C,p[m][0])>=0};function v(C){return!g(C)&&!b(C)}var w=g,y=new this.Collection(this,function(){return xi(p[0][0],p[p.length-1][1],!c,!u)});return y._ondirectionchange=function(C){C==="next"?(w=g,h=s):(w=b,h=i),p.sort(f)},y._addAlgorithm(function(C,S,$){for(var I=C.key;w(I);)if(++m,m===p.length)return S($),!1;return v(I)?!0:(r._cmp(I,p[m][1])===0||r._cmp(I,p[m][0])===0||S(function(){h===s?C.continue(p[m][0]):C.continue(p[m][1])}),!1)}),y},t.prototype.startsWithAnyOf=function(){var e=Xs.apply(ql,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?Vl(this):this.inAnyRange(e.map(function(n){return[n,n+Ma]})):so(this,"startsWithAnyOf() only works with strings")},t}();function f0e(t){return df(uP.prototype,function(n,r,o){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:o};var s=t._deps.indexedDB;if(!s)throw new ct.MissingAPI;this._cmp=this._ascending=s.cmp.bind(s),this._descending=function(i,a){return s.cmp(a,i)},this._max=function(i,a){return s.cmp(i,a)>0?i:a},this._min=function(i,a){return s.cmp(i,a)<0?i:a},this._IDBKeyRange=t._deps.IDBKeyRange})}function xs(t){return vn(function(e){return Ed(e),t(e.target.error),!1})}function Ed(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var Rd="storagemutated",Ri="x-storagemutated-1",Yi=uf(null,Rd),p0e=function(){function t(){}return t.prototype._lock=function(){return Fu(!st.global),++this._reculock,this._reculock===1&&!st.global&&(st.lockOwnerFor=this),this},t.prototype._unlock=function(){if(Fu(!st.global),--this._reculock===0)for(st.global||(st.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{du(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&st.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,o=this.db._state.dbOpenError;if(Fu(!this.idbtrans),!e&&!r)switch(o&&o.name){case"DatabaseClosedError":throw new ct.DatabaseClosed(o);case"MissingAPIError":throw new ct.MissingAPI(o.message,o);default:throw new ct.OpenFailed(o)}if(!this.active)throw new ct.TransactionInactive;return Fu(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=vn(function(s){Ed(s),n._reject(e.error)}),e.onabort=vn(function(s){Ed(s),n.active&&n._reject(new ct.Abort(e.error)),n.active=!1,n.on("abort").fire(s)}),e.oncomplete=vn(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&Yi.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var o=this;if(e==="readwrite"&&this.mode!=="readwrite")return Qn(new ct.ReadOnly("Transaction is readonly"));if(!this.active)return Qn(new ct.TransactionInactive);if(this._locked())return new je(function(i,a){o._blockedFuncs.push([function(){o._promise(e,n,r).then(i,a)},st])});if(r)return qi(function(){var i=new je(function(a,l){o._lock();var c=n(a,l,o);c&&c.then&&c.then(a,l)});return i.finally(function(){return o._unlock()}),i._lib=!0,i});var s=new je(function(i,a){var l=n(i,a,o);l&&l.then&&l.then(i,a)});return s._lib=!0,s},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=je.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var o=n.idbtrans.objectStore(n.storeNames[0]);(function i(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(o.get(-1/0).onsuccess=i)})()}var s=n._waitingFor;return new je(function(i,a){r.then(function(l){return n._waitingQueue.push(vn(i.bind(null,l)))},function(l){return n._waitingQueue.push(vn(a.bind(null,l)))}).finally(function(){n._waitingFor===s&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ct.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(go(n,e))return n[e];var r=this.schema[e];if(!r)throw new ct.NotFound("Table "+e+" not part of transaction");var o=new this.db.Table(e,r,this);return o.core=this.db.core.table(e),n[e]=o,o},t}();function m0e(t){return df(p0e.prototype,function(n,r,o,s,i){var a=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=o,this.chromeTransactionDurability=s,this.idbtrans=null,this.on=uf(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new je(function(l,c){a._resolve=l,a._reject=c}),this._completion.then(function(){a.active=!1,a.on.complete.fire()},function(l){var c=a.active;return a.active=!1,a.on.error.fire(l),a.parent?a.parent._reject(l):c&&a.idbtrans&&a.idbtrans.abort(),Qn(l)})})}function I0(t,e,n,r,o,s,i){return{name:t,keyPath:e,unique:n,multi:r,auto:o,compound:s,src:(n&&!i?"&":"")+(r?"*":"")+(o?"++":"")+dP(e)}}function dP(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function hP(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:UO(n,function(r){return[r.name,r]})}}function g0e(t){return t.length===1?t[0]:t}var Nd=function(t){try{return t.only([[]]),Nd=function(){return[[]]},[[]]}catch{return Nd=function(){return Ma},Ma}};function k0(t){return t==null?function(){}:typeof t=="string"?b0e(t):function(e){return Js(e,t)}}function b0e(t){var e=t.split(".");return e.length===1?function(n){return n[t]}:function(n){return Js(n,t)}}function a2(t){return[].slice.call(t)}var v0e=0;function Zu(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function x0e(t,e,n){function r(d,h){var f=a2(d.objectStoreNames);return{schema:{name:d.name,tables:f.map(function(p){return h.objectStore(p)}).map(function(p){var m=p.keyPath,g=p.autoIncrement,b=Ir(m),v=m==null,w={},y={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:v,compound:b,keyPath:m,autoIncrement:g,unique:!0,extractKey:k0(m)},indexes:a2(p.indexNames).map(function(C){return p.index(C)}).map(function(C){var S=C.name,$=C.unique,I=C.multiEntry,R=C.keyPath,T=Ir(R),N={name:S,compound:T,keyPath:R,unique:$,multiEntry:I,extractKey:k0(R)};return w[Zu(R)]=N,N}),getIndexByKeyPath:function(C){return w[Zu(C)]}};return w[":id"]=y.primaryKey,m!=null&&(w[Zu(m)]=y.primaryKey),y})},hasGetAll:f.length>0&&"getAll"in h.objectStore(f[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function o(d){if(d.type===3)return null;if(d.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var h=d.lower,f=d.upper,p=d.lowerOpen,m=d.upperOpen,g=h===void 0?f===void 0?null:e.upperBound(f,!!m):f===void 0?e.lowerBound(h,!!p):e.bound(h,f,!!p,!!m);return g}function s(d){var h=d.name;function f(g){var b=g.trans,v=g.type,w=g.keys,y=g.values,C=g.range;return new Promise(function(S,$){S=vn(S);var I=b.objectStore(h),R=I.keyPath==null,T=v==="put"||v==="add";if(!T&&v!=="delete"&&v!=="deleteRange")throw new Error("Invalid operation type: "+v);var N=(w||y||{length:1}).length;if(w&&y&&w.length!==y.length)throw new Error("Given keys array must have same length as given values array.");if(N===0)return S({numFailures:0,failures:{},results:[],lastResult:void 0});var _,P=[],z=[],L=0,O=function(de){++L,Ed(de)};if(v==="deleteRange"){if(C.type===4)return S({numFailures:L,failures:z,results:[],lastResult:void 0});C.type===3?P.push(_=I.clear()):P.push(_=I.delete(o(C)))}else{var B=T?R?[y,w]:[y,null]:[w,null],U=B[0],Q=B[1];if(T)for(var se=0;se<N;++se)P.push(_=Q&&Q[se]!==void 0?I[v](U[se],Q[se]):I[v](U[se])),_.onerror=O;else for(var se=0;se<N;++se)P.push(_=I[v](U[se])),_.onerror=O}var ce=function(de){var we=de.target.result;P.forEach(function(Ie,j){return Ie.error!=null&&(z[j]=Ie.error)}),S({numFailures:L,failures:z,results:v==="delete"?w:P.map(function(Ie){return Ie.result}),lastResult:we})};_.onerror=function(de){O(de),ce(de)},_.onsuccess=ce})}function p(g){var b=g.trans,v=g.values,w=g.query,y=g.reverse,C=g.unique;return new Promise(function(S,$){S=vn(S);var I=w.index,R=w.range,T=b.objectStore(h),N=I.isPrimaryKey?T:T.index(I.name),_=y?C?"prevunique":"prev":C?"nextunique":"next",P=v||!("openKeyCursor"in N)?N.openCursor(o(R),_):N.openKeyCursor(o(R),_);P.onerror=xs($),P.onsuccess=vn(function(z){var L=P.result;if(!L){S(null);return}L.___id=++v0e,L.done=!1;var O=L.continue.bind(L),B=L.continuePrimaryKey;B&&(B=B.bind(L));var U=L.advance.bind(L),Q=function(){throw new Error("Cursor not started")},se=function(){throw new Error("Cursor not stopped")};L.trans=b,L.stop=L.continue=L.continuePrimaryKey=L.advance=Q,L.fail=vn($),L.next=function(){var ce=this,de=1;return this.start(function(){return de--?ce.continue():ce.stop()}).then(function(){return ce})},L.start=function(ce){var de=new Promise(function(Ie,j){Ie=vn(Ie),P.onerror=xs(j),L.fail=j,L.stop=function(re){L.stop=L.continue=L.continuePrimaryKey=L.advance=se,Ie(re)}}),we=function(){if(P.result)try{ce()}catch(Ie){L.fail(Ie)}else L.done=!0,L.start=function(){throw new Error("Cursor behind last entry")},L.stop()};return P.onsuccess=vn(function(Ie){P.onsuccess=we,we()}),L.continue=O,L.continuePrimaryKey=B,L.advance=U,we(),de},S(L)},$)})}function m(g){return function(b){return new Promise(function(v,w){v=vn(v);var y=b.trans,C=b.values,S=b.limit,$=b.query,I=S===1/0?void 0:S,R=$.index,T=$.range,N=y.objectStore(h),_=R.isPrimaryKey?N:N.index(R.name),P=o(T);if(S===0)return v({result:[]});if(g){var z=C?_.getAll(P,I):_.getAllKeys(P,I);z.onsuccess=function(U){return v({result:U.target.result})},z.onerror=xs(w)}else{var L=0,O=C||!("openKeyCursor"in _)?_.openCursor(P):_.openKeyCursor(P),B=[];O.onsuccess=function(U){var Q=O.result;if(!Q)return v({result:B});if(B.push(C?Q.value:Q.primaryKey),++L===S)return v({result:B});Q.continue()},O.onerror=xs(w)}})}}return{name:h,schema:d,mutate:f,getMany:function(g){var b=g.trans,v=g.keys;return new Promise(function(w,y){w=vn(w);for(var C=b.objectStore(h),S=v.length,$=new Array(S),I=0,R=0,T,N=function(L){var O=L.target;($[O._pos]=O.result)!=null,++R===I&&w($)},_=xs(y),P=0;P<S;++P){var z=v[P];z!=null&&(T=C.get(v[P]),T._pos=P,T.onsuccess=N,T.onerror=_,++I)}I===0&&w($)})},get:function(g){var b=g.trans,v=g.key;return new Promise(function(w,y){w=vn(w);var C=b.objectStore(h),S=C.get(v);S.onsuccess=function($){return w($.target.result)},S.onerror=xs(y)})},query:m(l),openCursor:p,count:function(g){var b=g.query,v=g.trans,w=b.index,y=b.range;return new Promise(function(C,S){var $=v.objectStore(h),I=w.isPrimaryKey?$:$.index(w.name),R=o(y),T=R?I.count(R):I.count();T.onsuccess=vn(function(N){return C(N.target.result)}),T.onerror=xs(S)})}}}var i=r(t,n),a=i.schema,l=i.hasGetAll,c=a.tables.map(function(d){return s(d)}),u={};return c.forEach(function(d){return u[d.name]=d}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(d){var h=u[d];if(!h)throw new Error("Table '"+d+"' not found");return u[d]},MIN_KEY:-1/0,MAX_KEY:Nd(e),schema:a}}function y0e(t,e){return e.reduce(function(n,r){var o=r.create;return Rt(Rt({},n),o(n))},t)}function w0e(t,e,n,r){var o=n.IDBKeyRange;n.indexedDB;var s=y0e(x0e(e,o,r),t.dbcore);return{dbcore:s}}function EC(t,e){var n=t._novip,r=e.db,o=w0e(n._middlewares,r,n._deps,e);n.core=o.dbcore,n.tables.forEach(function(s){var i=s.name;n.core.schema.tables.some(function(a){return a.name===i})&&(s.core=n.core.table(i),n[i]instanceof n.Table&&(n[i].core=s.core))})}function vm(t,e,n,r){var o=t._novip;n.forEach(function(s){var i=r[s];e.forEach(function(a){var l=xC(a,s);(!l||"value"in l&&l.value===void 0)&&(a===o.Transaction.prototype||a instanceof o.Transaction?ri(a,s,{get:function(){return this.table(s)},set:function(c){zO(this,s,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):a[s]=new o.Table(s,i))})})}function T0(t,e){var n=t._novip;e.forEach(function(r){for(var o in r)r[o]instanceof n.Table&&delete r[o]})}function C0e(t,e){return t._cfg.version-e._cfg.version}function $0e(t,e,n,r){var o=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,o);s.create(n),s._completion.catch(r);var i=s._reject.bind(s),a=st.transless||st;qi(function(){st.trans=s,st.transless=a,e===0?(Gn(o).forEach(function(l){RC(n,l,o[l].primKey,o[l].indexes)}),EC(t,n),je.follow(function(){return t.on.populate.fire(s)}).catch(i)):S0e(t,e,s,n).catch(i)})}function S0e(t,e,n,r){var o=t._novip,s=[],i=o._versions,a=o._dbSchema=NC(o,o.idbdb,r),l=!1,c=i.filter(function(d){return d._cfg.version>=e});c.forEach(function(d){s.push(function(){var h=a,f=d._cfg.dbschema;R0(o,h,r),R0(o,f,r),a=o._dbSchema=f;var p=fP(h,f);p.add.forEach(function(y){RC(r,y[0],y[1].primKey,y[1].indexes)}),p.change.forEach(function(y){if(y.recreate)throw new ct.Upgrade("Not yet support for changing primary key");var C=r.objectStore(y.name);y.add.forEach(function(S){return E0(C,S)}),y.change.forEach(function(S){C.deleteIndex(S.name),E0(C,S)}),y.del.forEach(function(S){return C.deleteIndex(S)})});var m=d._cfg.contentUpgrade;if(m&&d._cfg.version>e){EC(o,r),n._memoizedTables={},l=!0;var g=HO(f);p.del.forEach(function(y){g[y]=h[y]}),T0(o,[o.Transaction.prototype]),vm(o,[o.Transaction.prototype],Gn(g),g),n.schema=g;var b=yC(m);b&&uu();var v,w=je.follow(function(){if(v=m(n),v&&b){var y=oi.bind(null,null);v.then(y,y)}});return v&&typeof v.then=="function"?je.resolve(v):w.then(function(){return v})}}),s.push(function(h){if(!l||!Qxe){var f=d._cfg.dbschema;k0e(f,h)}T0(o,[o.Transaction.prototype]),vm(o,[o.Transaction.prototype],o._storeNames,o._dbSchema),n.schema=o._dbSchema})});function u(){return s.length?je.resolve(s.shift()(n.idbtrans)).then(u):je.resolve()}return u().then(function(){I0e(a,r)})}function fP(t,e){var n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){var o=t[r],s=e[r];if(!o)n.add.push([r,s]);else{var i={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||o.primKey.auto!==s.primKey.auto&&!Ib)i.recreate=!0,n.change.push(i);else{var a=o.idxByName,l=s.idxByName,c=void 0;for(c in a)l[c]||i.del.push(c);for(c in l){var u=a[c],d=l[c];u?u.src!==d.src&&i.change.push(d):i.add.push(d)}(i.del.length>0||i.add.length>0||i.change.length>0)&&n.change.push(i)}}}return n}function RC(t,e,n,r){var o=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(s){return E0(o,s)}),o}function I0e(t,e){Gn(t).forEach(function(n){e.db.objectStoreNames.contains(n)||RC(e,n,t[n].primKey,t[n].indexes)})}function k0e(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return t[n]==null&&e.db.deleteObjectStore(n)})}function E0(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function NC(t,e,n){var r={},o=$b(e.objectStoreNames,0);return o.forEach(function(s){for(var i=n.objectStore(s),a=i.keyPath,l=I0(dP(a),a||"",!1,!1,!!i.autoIncrement,a&&typeof a!="string",!0),c=[],u=0;u<i.indexNames.length;++u){var d=i.index(i.indexNames[u]);a=d.keyPath;var h=I0(d.name,a,!!d.unique,!!d.multiEntry,!1,a&&typeof a!="string",!1);c.push(h)}r[s]=hP(s,l,c)}),r}function T0e(t,e,n){var r=t._novip;r.verno=e.version/10;var o=r._dbSchema=NC(r,e,n);r._storeNames=$b(e.objectStoreNames,0),vm(r,[r._allTables],Gn(o),o)}function E0e(t,e){var n=NC(t,t.idbdb,e),r=fP(n,t._dbSchema);return!(r.add.length||r.change.some(function(o){return o.add.length||o.change.length}))}function R0(t,e,n){for(var r=t._novip,o=n.db.objectStoreNames,s=0;s<o.length;++s){var i=o[s],a=n.objectStore(i);r._hasGetAll="getAll"in a;for(var l=0;l<a.indexNames.length;++l){var c=a.indexNames[l],u=a.index(c).keyPath,d=typeof u=="string"?u:"["+$b(u).join("+")+"]";if(e[i]){var h=e[i].idxByName[d];h&&(h.name=c,delete e[i].idxByName[d],e[i].idxByName[c]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&pn.WorkerGlobalScope&&pn instanceof pn.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function R0e(t){return t.split(",").map(function(e,n){e=e.trim();var r=e.replace(/([&*]|\+\+)/g,""),o=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return I0(r,o||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),Ir(o),n===0)})}var N0e=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){Gn(e).forEach(function(r){if(e[r]!==null){var o=R0e(e[r]),s=o.shift();if(s.multi)throw new ct.Schema("Primary key cannot be multi-valued");o.forEach(function(i){if(i.auto)throw new ct.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new ct.Schema("Index must have a name and cannot be an empty string")}),n[r]=hP(r,s,o)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?Pr(this._cfg.storesSource,e):e;var r=n._versions,o={},s={};return r.forEach(function(i){Pr(o,i._cfg.storesSource),s=i._cfg.dbschema={},i._parseStoresSpec(o,s)}),n._dbSchema=s,T0(n,[n._allTables,n,n.Transaction.prototype]),vm(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Gn(s),s),n._storeNames=Gn(s),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=$C(this._cfg.contentUpgrade||Yt,e),this},t}();function _0e(t){return df(N0e.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function _C(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new OC(kb,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function AC(t){return t&&typeof t.databases=="function"}function A0e(t){var e=t.indexedDB,n=t.IDBKeyRange;return AC(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(o){return o.name}).filter(function(o){return o!==kb})}):_C(e,n).toCollection().primaryKeys()}function D0e(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!AC(n)&&e!==kb&&_C(n,r).put({name:e}).catch(Yt)}function F0e(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!AC(n)&&e!==kb&&_C(n,r).delete(e).catch(Yt)}function N0(t){return qi(function(){return st.letThrough=!0,t()})}function O0e(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function P0e(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?Qn(e.dbOpenError):t});Bs&&(e.openCanceller._stackHolder=El()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function o(){if(e.openCanceller!==r)throw new ct.DatabaseClosed("db.open() was cancelled")}var s=e.dbReadyResolve,i=null,a=!1;return je.race([r,(typeof navigator>"u"?je.resolve():O0e()).then(function(){return new je(function(l,c){if(o(),!n)throw new ct.MissingAPI;var u=t.name,d=e.autoSchema?n.open(u):n.open(u,Math.round(t.verno*10));if(!d)throw new ct.MissingAPI;d.onerror=xs(c),d.onblocked=vn(t._fireOnBlocked),d.onupgradeneeded=vn(function(h){if(i=d.transaction,e.autoSchema&&!t._options.allowEmptyDB){d.onerror=Ed,i.abort(),d.result.close();var f=n.deleteDatabase(u);f.onsuccess=f.onerror=vn(function(){c(new ct.NoSuchDatabase("Database "+u+" doesnt exist"))})}else{i.onerror=xs(c);var p=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;a=p<1,t._novip.idbdb=d.result,$0e(t,p/10,i,c)}},c),d.onsuccess=vn(function(){i=null;var h=t._novip.idbdb=d.result,f=$b(h.objectStoreNames);if(f.length>0)try{var p=h.transaction(g0e(f),"readonly");e.autoSchema?T0e(t,h,p):(R0(t,t._dbSchema,p),E0e(t,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),EC(t,p)}catch{}Yu.push(t),h.onversionchange=vn(function(m){e.vcFired=!0,t.on("versionchange").fire(m)}),h.onclose=vn(function(m){t.on("close").fire(m)}),a&&D0e(t._deps,u),l()},c)})})]).then(function(){return o(),e.onReadyBeingFired=[],je.resolve(N0(function(){return t.on.ready.fire(t.vip)})).then(function l(){if(e.onReadyBeingFired.length>0){var c=e.onReadyBeingFired.reduce($C,Yt);return e.onReadyBeingFired=[],je.resolve(N0(function(){return c(t.vip)})).then(l)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(l){e.dbOpenError=l;try{i&&i.abort()}catch{}return r===e.openCanceller&&t._close(),Qn(l)}).finally(function(){e.openComplete=!0,s()})}function _0(t){var e=function(i){return t.next(i)},n=function(i){return t.throw(i)},r=s(e),o=s(n);function s(i){return function(a){var l=i(a),c=l.value;return l.done?c:!c||typeof c.then!="function"?Ir(c)?Promise.all(c).then(r,o):r(c):c.then(r,o)}}return s(e)()}function M0e(t,e,n){var r=arguments.length;if(r<2)throw new ct.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];n=o.pop();var s=GO(o);return[t,s,n]}function pP(t,e,n,r,o){return je.resolve().then(function(){var s=st.transless||st,i=t._createTransaction(e,n,t._dbSchema,r),a={trans:i,transless:s};if(r)i.idbtrans=r.idbtrans;else try{i.create(),t._state.PR1398_maxLoop=3}catch(d){return d.name===CC.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return pP(t,e,n,null,o)})):Qn(d)}var l=yC(o);l&&uu();var c,u=je.follow(function(){if(c=o.call(i,i),c)if(l){var d=oi.bind(null,null);c.then(d,d)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=_0(c))},a);return(c&&typeof c.then=="function"?je.resolve(c).then(function(d){return i.active?d:Qn(new ct.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):u.then(function(){return c})).then(function(d){return r&&i._resolve(),i._completion.then(function(){return d})}).catch(function(d){return i._reject(d),Qn(d)})})}function hp(t,e,n){for(var r=Ir(t)?t.slice():[t],o=0;o<n;++o)r.push(e);return r}function L0e(t){return Rt(Rt({},t),{table:function(e){var n=t.table(e),r=n.schema,o={},s=[];function i(m,g,b){var v=Zu(m),w=o[v]=o[v]||[],y=m==null?0:typeof m=="string"?1:m.length,C=g>0,S=Rt(Rt({},b),{isVirtual:C,keyTail:g,keyLength:y,extractKey:k0(m),unique:!C&&b.unique});if(w.push(S),S.isPrimaryKey||s.push(S),y>1){var $=y===2?m[0]:m.slice(0,y-1);i($,g+1,b)}return w.sort(function(I,R){return I.keyTail-R.keyTail}),S}var a=i(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[a];for(var l=0,c=r.indexes;l<c.length;l++){var u=c[l];i(u.keyPath,0,u)}function d(m){var g=o[Zu(m)];return g&&g[0]}function h(m,g){return{type:m.type===1?2:m.type,lower:hp(m.lower,m.lowerOpen?t.MAX_KEY:t.MIN_KEY,g),lowerOpen:!0,upper:hp(m.upper,m.upperOpen?t.MIN_KEY:t.MAX_KEY,g),upperOpen:!0}}function f(m){var g=m.query.index;return g.isVirtual?Rt(Rt({},m),{query:{index:g,range:h(m.query.range,g.keyTail)}}):m}var p=Rt(Rt({},n),{schema:Rt(Rt({},r),{primaryKey:a,indexes:s,getIndexByKeyPath:d}),count:function(m){return n.count(f(m))},query:function(m){return n.query(f(m))},openCursor:function(m){var g=m.query.index,b=g.keyTail,v=g.isVirtual,w=g.keyLength;if(!v)return n.openCursor(m);function y(C){function S(I){I!=null?C.continue(hp(I,m.reverse?t.MAX_KEY:t.MIN_KEY,b)):m.unique?C.continue(C.key.slice(0,w).concat(m.reverse?t.MIN_KEY:t.MAX_KEY,b)):C.continue()}var $=Object.create(C,{continue:{value:S},continuePrimaryKey:{value:function(I,R){C.continuePrimaryKey(hp(I,t.MAX_KEY,b),R)}},primaryKey:{get:function(){return C.primaryKey}},key:{get:function(){var I=C.key;return w===1?I[0]:I.slice(0,w)}},value:{get:function(){return C.value}}});return $}return n.openCursor(f(m)).then(function(C){return C&&y(C)})}});return p}})}var B0e={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:L0e};function DC(t,e,n,r){return n=n||{},r=r||"",Gn(t).forEach(function(o){if(!go(e,o))n[r+o]=void 0;else{var s=t[o],i=e[o];if(typeof s=="object"&&typeof i=="object"&&s&&i){var a=h0(s),l=h0(i);a!==l?n[r+o]=e[o]:a==="Object"?DC(s,i,n,r+o+"."):s!==i&&(n[r+o]=e[o])}else s!==i&&(n[r+o]=e[o])}}),Gn(e).forEach(function(o){go(t,o)||(n[r+o]=e[o])}),n}function z0e(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var W0e={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return Rt(Rt({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,o=Rt(Rt({},n),{mutate:function(s){var i=st.trans,a=i.table(e).hook,l=a.deleting,c=a.creating,u=a.updating;switch(s.type){case"add":if(c.fire===Yt)break;return i._promise("readwrite",function(){return d(s)},!0);case"put":if(c.fire===Yt&&u.fire===Yt)break;return i._promise("readwrite",function(){return d(s)},!0);case"delete":if(l.fire===Yt)break;return i._promise("readwrite",function(){return d(s)},!0);case"deleteRange":if(l.fire===Yt)break;return i._promise("readwrite",function(){return h(s)},!0)}return n.mutate(s);function d(p){var m=st.trans,g=p.keys||z0e(r,p);if(!g)throw new Error("Keys missing");return p=p.type==="add"||p.type==="put"?Rt(Rt({},p),{keys:g}):Rt({},p),p.type!=="delete"&&(p.values=u0([],p.values,!0)),p.keys&&(p.keys=u0([],p.keys,!0)),V0e(n,p,g).then(function(b){var v=g.map(function(w,y){var C=b[y],S={onerror:null,onsuccess:null};if(p.type==="delete")l.fire.call(S,w,C,m);else if(p.type==="add"||C===void 0){var $=c.fire.call(S,w,p.values[y],m);w==null&&$!=null&&(w=$,p.keys[y]=w,r.outbound||ts(p.values[y],r.keyPath,w))}else{var I=DC(C,p.values[y]),R=u.fire.call(S,I,w,C,m);if(R){var T=p.values[y];Object.keys(R).forEach(function(N){go(T,N)?T[N]=R[N]:ts(T,N,R[N])})}}return S});return n.mutate(p).then(function(w){for(var y=w.failures,C=w.results,S=w.numFailures,$=w.lastResult,I=0;I<g.length;++I){var R=C?C[I]:g[I],T=v[I];R==null?T.onerror&&T.onerror(y[I]):T.onsuccess&&T.onsuccess(p.type==="put"&&b[I]?p.values[I]:R)}return{failures:y,results:C,numFailures:S,lastResult:$}}).catch(function(w){return v.forEach(function(y){return y.onerror&&y.onerror(w)}),Promise.reject(w)})})}function h(p){return f(p.trans,p.range,1e4)}function f(p,m,g){return n.query({trans:p,values:!1,query:{index:r,range:m},limit:g}).then(function(b){var v=b.result;return d({type:"delete",keys:v,trans:p}).then(function(w){return w.numFailures>0?Promise.reject(w.failures[0]):v.length<g?{failures:[],numFailures:0,lastResult:void 0}:f(p,Rt(Rt({},m),{lower:v[v.length-1],lowerOpen:!0}),g)})})}}});return o}})}};function V0e(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function mP(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],o=0,s=0;o<e.keys.length&&s<t.length;++o)Fr(e.keys[o],t[s])===0&&(r.push(n?sf(e.values[o]):e.values[o]),++s);return r.length===t.length?r:null}catch{return null}}var U0e={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return Rt(Rt({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var o=mP(r.keys,r.trans._cache,r.cache==="clone");return o?je.resolve(o):n.getMany(r).then(function(s){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?sf(s):s},s})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},Mv;function FC(t){return!("from"in t)}var js=function(t,e){if(this)Pr(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var n=new js;return t&&"d"in t&&Pr(n,t),n}};_c(js.prototype,(Mv={add:function(t){return xm(this,t),this},addKey:function(t){return _d(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return _d(e,n,n)}),this}},Mv[f0]=function(){return A0(this)},Mv));function _d(t,e,n){var r=Fr(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(FC(t))return Pr(t,{from:e,to:n,d:1});var o=t.l,s=t.r;if(Fr(n,t.from)<0)return o?_d(o,e,n):t.l={from:e,to:n,d:1,l:null,r:null},l2(t);if(Fr(e,t.to)>0)return s?_d(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},l2(t);Fr(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),Fr(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var i=!t.r;o&&!t.l&&xm(t,o),s&&i&&xm(t,s)}}function xm(t,e){function n(r,o){var s=o.from,i=o.to,a=o.l,l=o.r;_d(r,s,i),a&&n(r,a),l&&n(r,l)}FC(e)||n(t,e)}function H0e(t,e){var n=A0(e),r=n.next();if(r.done)return!1;for(var o=r.value,s=A0(t),i=s.next(o.from),a=i.value;!r.done&&!i.done;){if(Fr(a.from,o.to)<=0&&Fr(a.to,o.from)>=0)return!0;Fr(o.from,a.from)<0?o=(r=n.next(a.from)).value:a=(i=s.next(o.from)).value}return!1}function A0(t){var e=FC(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&Fr(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||Fr(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function l2(t){var e,n,r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){var s=o==="r"?"l":"r",i=Rt({},t),a=t[o];t.from=a.from,t.to=a.to,t[o]=a[o],i[o]=a[s],t[s]=i,i.d=c2(i)}t.d=c2(t)}function c2(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}var G0e={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new js(t.MIN_KEY,t.MAX_KEY);return Rt(Rt({},t),{table:function(r){var o=t.table(r),s=o.schema,i=s.primaryKey,a=i.extractKey,l=i.outbound,c=Rt(Rt({},o),{mutate:function(h){var f=h.trans,p=f.mutatedParts||(f.mutatedParts={}),m=function($){var I="idb://"+e+"/"+r+"/"+$;return p[I]||(p[I]=new js)},g=m(""),b=m(":dels"),v=h.type,w=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[],y=w[0],C=w[1],S=h.trans._cache;return o.mutate(h).then(function($){if(Ir(y)){v!=="delete"&&(y=$.results),g.addKeys(y);var I=mP(y,S);!I&&v!=="add"&&b.addKeys(y),(I||C)&&j0e(m,s,I,C)}else if(y){var R={from:y.lower,to:y.upper};b.add(R),g.add(R)}else g.add(n),b.add(n),s.indexes.forEach(function(T){return m(T.name).add(n)});return $})}}),u=function(h){var f,p,m=h.query,g=m.index,b=m.range;return[g,new js((f=b.lower)!==null&&f!==void 0?f:t.MIN_KEY,(p=b.upper)!==null&&p!==void 0?p:t.MAX_KEY)]},d={get:function(h){return[i,new js(h.key)]},getMany:function(h){return[i,new js().addKeys(h.keys)]},count:u,query:u,openCursor:u};return Gn(d).forEach(function(h){c[h]=function(f){var p=st.subscr;if(p){var m=function(S){var $="idb://"+e+"/"+r+"/"+S;return p[$]||(p[$]=new js)},g=m(""),b=m(":dels"),v=d[h](f),w=v[0],y=v[1];if(m(w.name||"").add(y),!w.isPrimaryKey)if(h==="count")b.add(n);else{var C=h==="query"&&l&&f.values&&o.query(Rt(Rt({},f),{values:!1}));return o[h].apply(this,arguments).then(function(S){if(h==="query"){if(l&&f.values)return C.then(function(T){var N=T.result;return g.addKeys(N),S});var $=f.values?S.result.map(a):S.result;f.values?g.addKeys($):b.addKeys($)}else if(h==="openCursor"){var I=S,R=f.values;return I&&Object.create(I,{key:{get:function(){return b.addKey(I.primaryKey),I.key}},primaryKey:{get:function(){var T=I.primaryKey;return b.addKey(T),T}},value:{get:function(){return R&&g.addKey(I.primaryKey),I.value}}})}return S})}}return o[h].apply(this,arguments)}}),c}})}};function j0e(t,e,n,r){function o(s){var i=t(s.name||"");function a(c){return c!=null?s.extractKey(c):null}var l=function(c){return s.multiEntry&&Ir(c)?c.forEach(function(u){return i.addKey(u)}):i.addKey(c)};(n||r).forEach(function(c,u){var d=n&&a(n[u]),h=r&&a(r[u]);Fr(d,h)!==0&&(d!=null&&l(d),h!=null&&l(h))})}e.indexes.forEach(o)}var OC=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var o=t.dependencies;this._options=n=Rt({addons:t.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var s=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Yt,dbReadyPromise:null,cancelOpen:Yt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};i.dbReadyPromise=new je(function(a){i.dbReadyResolve=a}),i.openCanceller=new je(function(a,l){i.cancelOpen=l}),this._state=i,this.name=e,this.on=uf(this,"populate","blocked","versionchange","close",{ready:[$C,Yt]}),this.on.ready.subscribe=WO(this.on.ready.subscribe,function(a){return function(l,c){t.vip(function(){var u=r._state;if(u.openComplete)u.dbOpenError||je.resolve().then(l),c&&a(l);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(l),c&&a(l);else{a(l);var d=r;c||a(function h(){d.on.ready.unsubscribe(l),d.on.ready.unsubscribe(h)})}})}}),this.Collection=a0e(this),this.Table=n0e(this),this.Transaction=m0e(this),this.Version=_0e(this),this.WhereClause=f0e(this),this.on("versionchange",function(a){a.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(a){!a.newVersion||a.newVersion<a.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+a.oldVersion/10)}),this._maxKey=Nd(n.IDBKeyRange),this._createTransaction=function(a,l,c,u){return new r.Transaction(a,l,c,r._options.chromeTransactionDurability,u)},this._fireOnBlocked=function(a){r.on("blocked").fire(a),Yu.filter(function(l){return l.name===r.name&&l!==r&&!l._state.vcFired}).map(function(l){return l.on("versionchange").fire(a)})},this.use(B0e),this.use(W0e),this.use(G0e),this.use(U0e),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(function(a){return a(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ct.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new ct.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(o){return o._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(C0e),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||st.letThrough||this._vip)?e():new je(function(r,o){if(n._state.openComplete)return o(new ct.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){o(new ct.DatabaseClosed);return}n.open().catch(Yt)}n._state.dbReadyPromise.then(r,o)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,o=e.level,s=e.name;s&&this.unuse({stack:n,name:s});var i=this._middlewares[n]||(this._middlewares[n]=[]);return i.push({stack:n,create:r,level:o==null?10:o,name:s}),i.sort(function(a,l){return a.level-l.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,o=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(s){return o?s.create!==o:r?s.name!==r:!1})),this},t.prototype.open=function(){return P0e(this)},t.prototype._close=function(){var e=this._state,n=Yu.indexOf(this);if(n>=0&&Yu.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new je(function(r){e.dbReadyResolve=r}),e.openCanceller=new je(function(r,o){e.cancelOpen=o})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new ct.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new je(function(o,s){var i=function(){e.close();var a=e._deps.indexedDB.deleteDatabase(e.name);a.onsuccess=vn(function(){F0e(e._deps,e.name),o()}),a.onerror=xs(s),a.onblocked=e._fireOnBlocked};if(n)throw new ct.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(i):i()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return Gn(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=M0e.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var o=this,s=st.trans;(!s||s.db!==this||e.indexOf("!")!==-1)&&(s=null);var i=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var a,l;try{if(l=n.map(function(u){var d=u instanceof o.Table?u.name:u;if(typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),e=="r"||e===Av)a=Av;else if(e=="rw"||e==Dv)a=Dv;else throw new ct.InvalidArgument("Invalid transaction mode: "+e);if(s){if(s.mode===Av&&a===Dv)if(i)s=null;else throw new ct.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s&&l.forEach(function(u){if(s&&s.storeNames.indexOf(u)===-1)if(i)s=null;else throw new ct.SubTransaction("Table "+u+" not included in parent transaction.")}),i&&s&&!s.active&&(s=null)}}catch(u){return s?s._promise(null,function(d,h){h(u)}):Qn(u)}var c=pP.bind(null,this,a,l,s,r);return s?s._promise(a,c,"lock"):st.trans?du(st.transless,function(){return o._whenReady(c)}):this._whenReady(c)},t.prototype.table=function(e){if(!go(this._allTables,e))throw new ct.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),K0e=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",q0e=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)},t.prototype[K0e]=function(){return this},t}();function gP(t,e){return Gn(e).forEach(function(n){var r=t[n]||(t[n]=new js);xm(r,e[n])}),t}function X0e(t){return new q0e(function(e){var n=yC(t);function r(f){n&&uu();var p=function(){return qi(t,{subscr:f,trans:null})},m=st.trans?du(st.transless,p):p();return n&&m.then(oi,oi),m}var o=!1,s={},i={},a={get closed(){return o},unsubscribe:function(){o=!0,Yi.storagemutated.unsubscribe(d)}};e.start&&e.start(a);var l=!1,c=!1;function u(){return Gn(i).some(function(f){return s[f]&&H0e(s[f],i[f])})}var d=function(f){gP(s,f),u()&&h()},h=function(){if(!(l||o)){s={};var f={},p=r(f);c||(Yi(Rd,d),c=!0),l=!0,Promise.resolve(p).then(function(m){l=!1,!o&&(u()?h():(s={},i=f,e.next&&e.next(m)))},function(m){l=!1,e.error&&e.error(m),a.unsubscribe()})}};return h(),a})}var D0;try{D0={indexedDB:pn.indexedDB||pn.mozIndexedDB||pn.webkitIndexedDB||pn.msIndexedDB,IDBKeyRange:pn.IDBKeyRange||pn.webkitIDBKeyRange}}catch{D0={indexedDB:null,IDBKeyRange:null}}var Ea=OC;_c(Ea,Rt(Rt({},Sb),{delete:function(t){var e=new Ea(t,{addons:[]});return e.delete()},exists:function(t){return new Ea(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return A0e(Ea.dependencies).then(t)}catch{return Qn(new ct.MissingAPI)}},defineClass:function(){function t(e){Pr(this,e)}return t},ignoreTransaction:function(t){return st.trans?du(st.transless,t):t()},vip:N0,async:function(t){return function(){try{var e=_0(t.apply(this,arguments));return!e||typeof e.then!="function"?je.resolve(e):e}catch(n){return Qn(n)}}},spawn:function(t,e,n){try{var r=_0(t.apply(n,e||[]));return!r||typeof r.then!="function"?je.resolve(r):r}catch(o){return Qn(o)}},currentTransaction:{get:function(){return st.trans||null}},waitFor:function(t,e){var n=je.resolve(typeof t=="function"?Ea.ignoreTransaction(t):t).timeout(e||6e4);return st.trans?st.trans.waitFor(n):n},Promise:je,debug:{get:function(){return Bs},set:function(t){KO(t,t==="dexie"?function(){return!0}:aP)}},derive:lu,extend:Pr,props:_c,override:WO,Events:uf,on:Yi,liveQuery:X0e,extendObservabilitySet:gP,getByKeyPath:Js,setByKeyPath:ts,delByKeyPath:Txe,shallowClone:HO,deepClone:sf,getObjectDiff:DC,cmp:Fr,asap:VO,minKey:S0,addons:[],connections:Yu,errnames:CC,dependencies:D0,semVer:n2,version:n2.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,n*2)})}));Ea.maxKey=Nd(Ea.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Yi(Rd,function(t){if(!Ys){var e;Ib?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Ri,!0,!0,t)):e=new CustomEvent(Ri,{detail:t}),Ys=!0,dispatchEvent(e),Ys=!1}}),addEventListener(Ri,function(t){var e=t.detail;Ys||ym(e)}));function ym(t){var e=Ys;try{Ys=!0,Yi.storagemutated.fire(t)}finally{Ys=e}}var Ys=!1;if(typeof BroadcastChannel<"u"){var u2=new BroadcastChannel(Ri);Yi(Rd,function(t){Ys||u2.postMessage(t)}),u2.onmessage=function(t){t.data&&ym(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Yi(Rd,function(t){try{Ys||(typeof localStorage<"u"&&localStorage.setItem(Ri,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&u0([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:Ri,changedParts:t})}))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",function(t){if(t.key===Ri){var e=JSON.parse(t.newValue);e&&ym(e.changedParts)}});var d2=self.document&&navigator.serviceWorker;d2&&d2.addEventListener("message",Y0e)}function Y0e(t){var e=t.data;e&&e.type===Ri&&ym(e.changedParts)}je.rejectionMapper=Pxe;KO(Bs,aP);class Z0e extends OC{constructor(){super("gestueDB");jC(this,"gestures");this.version(1).stores({gestures:"++id, label, tensoredLandmarks, handedness"})}}const Ul=new Z0e;function bP(){return{db:Ul,add:async s=>Ul.gestures.add(s),bulkAdd:async s=>Ul.gestures.bulkAdd(s),getAll:async()=>Ul.gestures.toArray(),getUniqueLabels:async()=>Ul.gestures.orderBy("label").uniqueKeys(),removeByLabel:async s=>Ul.gestures.where("label").equals(s).delete()}}const J0e=lt({__name:"AddNewGesture",setup(t){const e=Cxe(),{label:n,capture:r}=wxe(e),{startCapture:o,stopCapture:s,setLabel:i}=e,{add:a}=bP();return Wm(Vm).on(({landmarks:c})=>{r.value&&c.forEach(u=>a({...u,label:n.value}))}),(c,u)=>(Zr(),Mi(fn,null,[Tt(kt(l6),{placeholder:"Input new gesture label",type:"text",value:kt(n),"on-update:value":kt(i)},null,8,["value","on-update:value"]),Tt(kt(y5),null,{default:Sn(()=>[Tt(kt(zi),{disabled:kt(r),onClick:kt(o)},{default:Sn(()=>[hr("Start")]),_:1},8,["disabled","onClick"]),Tt(kt(zi),{disabled:!kt(r),onClick:kt(s)},{default:Sn(()=>[hr("Stop")]),_:1},8,["disabled","onClick"])]),_:1})],64))}}),Q0e=Iy(J0e,[["__scopeId","data-v-16311c40"]]),Lv=lR("gesture-recognition-model-labels",{0:"victory",1:"pause",2:"spiderman",3:"l",4:"flat"});function vP(t={modelSavePath:"indexeddb://gesture-recongition-model"}){const e=[],n=[];let r=null;const o={};return{loadData:async u=>{Lv.value={},u.forEach(d=>{e.push(d.tensoredLandmarks),o[d.label]===void 0&&(o[d.label]=Object.keys(o).length),n.push(o[d.label])});for(const[d,h]of Object.entries(o))Lv.value[h]=d;console.log(o.value),console.log(e,n)},saveModel:async()=>{if(!r)throw new Error("Model doesn't exist");r.save(t.modelSavePath)},train:async()=>{if(!r)throw new Error("Model doesn't exist");const u=ic(e,[e.length,42]),d=oc(n,[n.length]);await r.fit(u,d,{epochs:800,shuffle:!0,batchSize:128,callbacks:{onEpochEnd:async(h,f)=>{h%50===0&&console.log(`useTF epoch: ${h}, loss: ${f==null?void 0:f.loss}`),await pw()}}}),console.log("useTensorflow MODEL TEACHING FINISHED",r)},prepareModel:async()=>{r=Qee({name:"simple-model"}),r.add(pk({inputShape:[42],rate:.2})),r.add(Sv({inputShape:[42],units:24,activation:"relu"})),r.add(pk({rate:.2})),r.add(Sv({units:10,activation:"relu"})),r.add(Sv({units:Object.keys(Lv.value).length,activation:"softmax"})),r.compile({optimizer:"adam",loss:"sparseCategoricalCrossentropy",metrics:["accuracy"]})},downloadModel:async()=>{if(!r&&(r=await t0(t.modelSavePath),!r))throw new Error("Model doesn't exist");r.save("downloads://gesture-recongition-model")}}}const eye={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},tye=Is("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z",fill:"currentColor"},null,-1),nye=[tye],rye=lt({name:"DeleteFilled",render:function(e,n){return Zr(),Mi("svg",eye,nye)}}),oye={class:"flex center flex-column"},sye=lt({__name:"TrainModel",setup(t){const e=vP(),n=Ne(""),r=E5(),{getUniqueLabels:o,removeByLabel:s,getAll:i}=bP(),a=p=>{n.value=p,u.value=!0},l=async()=>{u.value=!1,await s(n.value),r.success("Gestues map deleted"),h()},c=()=>{u.value=!1},u=Ne(!1),d=Ne([]),h=()=>{o().then(p=>{d.value=p})};h();const f=async()=>{const p=await i();await e.loadData(p),await e.prepareModel(),await e.train(),await e.saveModel()};return(p,m)=>(Zr(),Mi(fn,null,[Is("div",oye,[Tt(kt(zi),{onClick:f},{default:Sn(()=>[hr(" Train Model ")]),_:1}),Tt(kt(px),null,{default:Sn(()=>[hr("Labels for training:")]),_:1}),(Zr(!0),Mi(fn,null,eT(d.value,g=>(Zr(),Oc(kt(O5),null,{default:Sn(()=>[Tt(kt(WE),null,{default:Sn(()=>[hr(Ip(g),1)]),_:2},1024),Tt(kt(T6),{onClick:b=>a(g)},{default:Sn(()=>[Tt(kt(rye))]),_:2},1032,["onClick"])]),_:2},1024))),256))]),Tt(kt(H6),{show:u.value,"onUpdate:show":m[0]||(m[0]=g=>u.value=g),preset:"dialog",content:`Are you sure you want to delete ${n.value}?`,"positive-text":"Delete","negative-text":"Cancel",onPositiveClick:l,onNegativeClick:c,"positive-button-props":{type:"error"},"show-icon":!1},null,8,["show","content"])],64))}}),iye={class:"flex center flex-column"},aye=lt({__name:"TestModel",setup(t){const{downloadModel:e}=vP(),{predict:n}=OO(),r=Ne({className:"",probability:0});return Wm(Vm).on(async({landmarks:s})=>{for(const i of s){const a=await n(i);r.value=a}}),(s,i)=>(Zr(),Mi("div",iye,[Tt(kt(zi),{onClick:kt(e)},{default:Sn(()=>[hr(" Download Model ")]),_:1},8,["onClick"]),Tt(kt(px),null,{default:Sn(()=>[hr("Predicted label:")]),_:1}),hr(" "+Ip(r.value.className)+" ",1),Tt(kt(px),null,{default:Sn(()=>[hr("Accuracy:")]),_:1}),hr(" "+Ip(r.value.probability),1)]))}}),lye=[{path:"/",component:d8,children:[{path:"",component:Q0e},{path:"train-model",component:sye},{path:"test-model",component:aye}]},{path:"/iframe",component:pxe}],cye=VH({history:oH(),routes:lye}),uye=mxe();oL(z5).use(cye).use(uye).mount("#app")});export default dye();
